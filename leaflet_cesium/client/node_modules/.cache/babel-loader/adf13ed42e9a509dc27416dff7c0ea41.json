{"ast":null,"code":"/*!\n * maptalks v0.49.1\n * LICENSE : BSD-3-Clause\n * (c) 2016-2020 maptalks.org\n */\nvar version = \"0.49.1\";\nvar INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\nvar GEOMETRY_COLLECTION_TYPES = ['MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nvar GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\nvar RESOURCE_PROPERTIES = ['markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'];\nvar RESOURCE_SIZE_PROPERTIES = [['markerWidth', 'markerHeight'], [], [null, 'lineWidth'], [], [null, 'markerLineWidth']];\nvar NUMERICAL_PROPERTIES = {\n  'lineWidth': 1,\n  'lineOpacity': 1,\n  'lineDx': 1,\n  'lineDy': 1,\n  'polygonOpacity': 1,\n  'markerWidth': 1,\n  'markerHeight': 1,\n  'markerDx': 1,\n  'markerDy': 1,\n  'markerOpacity': 1,\n  'markerFillOpacity': 1,\n  'markerLineWidth': 1,\n  'markerLineOpacity': 1,\n  'textSize': 1,\n  'textOpacity': 1,\n  'textHaloRadius': 1,\n  'textWrapWidth': 1,\n  'textLineSpacing': 1,\n  'textDx': 1,\n  'textDy': 1\n};\nvar COLOR_PROPERTIES = ['lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'];\nvar DEFAULT_TEXT_SIZE = 14;\n\nfunction now() {\n  return Date.now();\n}\n\nfunction extend(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction isNil(obj) {\n  return obj == null;\n}\n\nfunction isNumber(val) {\n  return typeof val === 'number' && !isNaN(val);\n}\n\nfunction isInteger(n) {\n  return (n | 0) === n;\n}\n\nfunction isObject(obj) {\n  return typeof obj === 'object' && !!obj;\n}\n\nfunction isString(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'string' || obj.constructor !== null && obj.constructor === String;\n}\n\nfunction isFunction(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'function' || obj.constructor !== null && obj.constructor === Function;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction hasOwn(obj, key) {\n  return hasOwnProperty.call(obj, key);\n}\n\nfunction join(arr, seperator) {\n  if (arr.join) {\n    return arr.join(seperator || ',');\n  } else {\n    return Array.prototype.join.call(arr, seperator || ',');\n  }\n}\n\nfunction isEmpty(object) {\n  var property;\n\n  for (property in object) {\n    return false;\n  }\n\n  return !property;\n}\n\nvar pi = Math.PI / 180;\n\nfunction toRadian(d) {\n  return d * pi;\n}\n\nfunction toDegree(r) {\n  return r / pi;\n}\n\nvar IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\nvar requestAnimFrame, cancelAnimFrame;\n\n(function () {\n  if (IS_NODE) {\n    requestAnimFrame = function requestAnimFrame(fn) {\n      return setTimeout(fn, 16);\n    };\n\n    cancelAnimFrame = clearTimeout;\n    return;\n  }\n\n  var requestFn, cancelFn;\n  var timeToCall = 1000 / 30;\n\n  function timeoutDefer(fn) {\n    return setTimeout(fn, timeToCall);\n  }\n\n  function getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n  }\n\n  if (typeof window != 'undefined') {\n    requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n    cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') || getPrefixed('CancelRequestAnimationFrame') || function (id) {\n      window.clearTimeout(id);\n    };\n  } else {\n    requestFn = timeoutDefer;\n    cancelFn = clearTimeout;\n  }\n\n  requestAnimFrame = function requestAnimFrame(fn) {\n    return requestFn(fn);\n  };\n\n  cancelAnimFrame = function cancelAnimFrame(id) {\n    if (id) {\n      cancelFn(id);\n    }\n  };\n})();\n\nfunction isSVG(url) {\n  var prefix = 'data:image/svg+xml';\n\n  if (url.length > 4 && url.slice(-4) === '.svg') {\n    return 1;\n  } else if (url.slice(0, prefix.length) === prefix) {\n    return 2;\n  }\n\n  return 0;\n}\n\nfunction loadImage(img, imgDesc) {\n  if (IS_NODE && loadImage.node) {\n    loadImage.node(img, imgDesc);\n    return;\n  }\n\n  img.src = imgDesc[0];\n}\n\nvar uid = 0;\n\nfunction UID() {\n  return uid++;\n}\n\nvar GUID = UID;\n\nfunction parseJSON(str) {\n  if (!str || !isString(str)) {\n    return str;\n  }\n\n  return JSON.parse(str);\n}\n\nfunction pushIn(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    if (src) {\n      for (var ii = 0, ll = src.length; ii < ll; ii++) {\n        dest.push(src[ii]);\n      }\n    }\n  }\n\n  return dest.length;\n}\n\nfunction removeFromArray(obj, array) {\n  var i = array.indexOf(obj);\n\n  if (i > -1) {\n    array.splice(i, 1);\n  }\n}\n\nfunction forEachCoord(arr, fn, context) {\n  if (!Array.isArray(arr)) {\n    return context ? fn.call(context, arr) : fn(arr);\n  }\n\n  var result = [];\n  var p, pp;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    p = arr[i];\n\n    if (isNil(p)) {\n      result.push(null);\n      continue;\n    }\n\n    if (Array.isArray(p)) {\n      result.push(forEachCoord(p, fn, context));\n    } else {\n      pp = context ? fn.call(context, p) : fn(p);\n      result.push(pp);\n    }\n  }\n\n  return result;\n}\n\nfunction getValueOrDefault(v, d) {\n  return v === undefined ? d : v;\n}\n\nfunction sign(x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n\n  if (x === 0 || isNaN(x)) {\n    return Number(x);\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\nfunction log2(x) {\n  if (Math.log2) {\n    return Math.log2(x);\n  }\n\n  var v = Math.log(x) * Math.LOG2E;\n  var rounded = Math.round(v);\n\n  if (Math.abs(rounded - v) < 1E-14) {\n    return rounded;\n  } else {\n    return v;\n  }\n}\n\nfunction interpolate(a, b, t) {\n  return a * (1 - t) + b * t;\n}\n\nfunction wrap(n, min, max) {\n  if (n === max || n === min) {\n    return n;\n  }\n\n  var d = max - min;\n  var w = ((n - min) % d + d) % d + min;\n  return w;\n}\n\nfunction clamp(n, min, max) {\n  return Math.min(max, Math.max(min, n));\n}\n\nfunction isArrayHasData(obj) {\n  return Array.isArray(obj) && obj.length > 0;\n}\n\nvar urlPattern = /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i;\n\nfunction isURL(url) {\n  return urlPattern.test(url);\n}\n\nvar cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\nvar cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\n\nfunction isCssUrl(str) {\n  if (!isString(str)) {\n    return 0;\n  }\n\n  if (cssUrlRe.test(str)) {\n    return 1;\n  }\n\n  if (cssUrlReWithQuote.test(str)) {\n    return 2;\n  }\n\n  return 3;\n}\n\nfunction extractCssUrl(str) {\n  var test = isCssUrl(str);\n  var matches;\n\n  if (test === 3) {\n    return str;\n  } else if (test === 1) {\n    matches = cssUrlRe.exec(str);\n    return matches[1];\n  } else if (test === 2) {\n    matches = cssUrlReWithQuote.exec(str);\n    return matches[2];\n  } else {\n    return str;\n  }\n}\n\nvar b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfunction btoa(input) {\n  if (typeof window !== 'undefined' && window.btoa) {\n    return window.btoa(input);\n  }\n\n  var str = String(input);\n  var output = '';\n\n  for (var block, charCode, idx = 0, map = b64chrs; str.charAt(idx | 0) || (map = '=', idx % 1); output += map.charAt(63 & block >> 8 - idx % 1 * 8)) {\n    charCode = str.charCodeAt(idx += 3 / 4);\n\n    if (charCode > 0xFF) {\n      throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode;\n  }\n\n  return output;\n}\n\nfunction b64toBlob(b64Data, contentType) {\n  var byteCharacters = atob(b64Data);\n  var arraybuffer = new ArrayBuffer(byteCharacters.length);\n  var view = new Uint8Array(arraybuffer);\n\n  for (var i = 0; i < byteCharacters.length; i++) {\n    view[i] = byteCharacters.charCodeAt(i) & 0xff;\n  }\n\n  var blob = new Blob([arraybuffer], {\n    type: contentType\n  });\n  return blob;\n}\n\nfunction computeDegree(x0, y0, x1, y1) {\n  var dx = x1 - x0;\n  var dy = y1 - y0;\n  return Math.atan2(dy, dx);\n}\n\nvar emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n\nfunction equalMapView(obj1, obj2) {\n  if (!obj1 && !obj2) {\n    return true;\n  } else if (!obj1 || !obj2) {\n    return false;\n  }\n\n  for (var p in obj1) {\n    if (p === 'center') {\n      if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n        return false;\n      }\n    } else if (obj1[p] !== obj2[p]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction approx(val, expected, delta) {\n  if (delta == null) {\n    delta = 1e-6;\n  }\n\n  return val >= expected - delta && val <= expected + delta;\n}\n\nfunction flash(interval, count, cb, context) {\n  if (!interval) {\n    interval = 100;\n  }\n\n  if (!count) {\n    count = 4;\n  }\n\n  var me = this;\n  count *= 2;\n\n  if (this._flashTimeout) {\n    clearTimeout(this._flashTimeout);\n  }\n\n  function flashGeo() {\n    if (count === 0) {\n      me.show();\n\n      if (cb) {\n        if (context) {\n          cb.call(context);\n        } else {\n          cb();\n        }\n      }\n\n      return;\n    }\n\n    if (count % 2 === 0) {\n      me.hide();\n    } else {\n      me.show();\n    }\n\n    count--;\n    me._flashTimeout = setTimeout(flashGeo, interval);\n  }\n\n  this._flashTimeout = setTimeout(flashGeo, interval);\n  return this;\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nvar types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\n\nfunction createFilter(filter) {\n  return new Function('f', \"var p = (f && f.properties || {}); return \" + compile(filter));\n}\n\nfunction compile(filter) {\n  if (!filter) return 'true';\n  var op = filter[0];\n  if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n  var str = op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) : op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) : op === '<' || op === '>' || op === '<=' || op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) : op === 'any' ? compileLogicalOp(filter.slice(1), '||') : op === 'all' ? compileLogicalOp(filter.slice(1), '&&') : op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) : op === 'in' ? compileInOp(filter[1], filter.slice(2)) : op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) : op === 'has' ? compileHasOp(filter[1]) : op === '!has' ? compileNegation(compileHasOp(filter[1])) : 'true';\n  return \"(\" + str + \")\";\n}\n\nfunction compilePropertyReference(property) {\n  return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n  var left = compilePropertyReference(property);\n  var right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n  return (checkType ? \"typeof \" + left + \"=== typeof \" + right + \"&&\" : '') + left + op + right;\n}\n\nfunction compileLogicalOp(expressions, op) {\n  return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n  if (property === '$type') values = values.map(function (value) {\n    return types.indexOf(value);\n  });\n  var left = JSON.stringify(values.sort(compare));\n  var right = compilePropertyReference(property);\n  if (values.length <= 200) return left + \".indexOf(\" + right + \") !== -1\";\n  return \"function(v, a, i, j) {\\n        while (i <= j) { var m = (i + j) >> 1;\\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\\n        }\\n    return false; }(\" + right + \", \" + left + \",0,\" + (values.length - 1) + \")\";\n}\n\nfunction compileHasOp(property) {\n  return property === '$id' ? '\"id\" in f' : JSON.stringify(property) + \" in p\";\n}\n\nfunction compileNegation(expression) {\n  return \"!(\" + expression + \")\";\n}\n\nfunction compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction getFilterFeature(geometry) {\n  var json = geometry._toJSON(),\n      g = json['feature'];\n\n  g['type'] = types.indexOf(g['geometry']['type']);\n  g['subType'] = json['subType'];\n  return g;\n}\n\nfunction compileStyle(styles) {\n  if (!Array.isArray(styles)) {\n    return compileStyle([styles]);\n  }\n\n  var compiled = [];\n\n  for (var i = 0; i < styles.length; i++) {\n    var filter = void 0;\n\n    if (styles[i]['filter'] === true) {\n      filter = function filter() {\n        return true;\n      };\n    } else {\n      filter = createFilter(styles[i]['filter']);\n    }\n\n    compiled.push(extend$1({}, styles[i], {\n      filter: filter\n    }));\n  }\n\n  return compiled;\n}\n\nfunction extend$1(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction createFunction(parameters, defaultType) {\n  var fun;\n  var isFeatureConstant, isZoomConstant;\n\n  if (!isFunctionDefinition(parameters)) {\n    fun = function fun() {\n      return parameters;\n    };\n\n    isFeatureConstant = true;\n    isZoomConstant = true;\n  } else {\n    var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    var zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    var type = parameters.type || defaultType || 'exponential';\n    var innerFun;\n\n    if (type === 'exponential') {\n      innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n      innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n      innerFun = evaluateCategoricalFunction;\n    } else if (type === 'identity') {\n      innerFun = evaluateIdentityFunction;\n    } else {\n      throw new Error('Unknown function type \"' + type + '\"');\n    }\n\n    if (zoomAndFeatureDependent) {\n      var featureFunctions = {};\n      var featureFunctionStops = [];\n\n      for (var s = 0; s < parameters.stops.length; s++) {\n        var stop = parameters.stops[s];\n\n        if (featureFunctions[stop[0].zoom] === undefined) {\n          featureFunctions[stop[0].zoom] = {\n            zoom: stop[0].zoom,\n            type: parameters.type,\n            property: parameters.property,\n            default: parameters.default,\n            stops: []\n          };\n        }\n\n        featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\n      }\n\n      for (var z in featureFunctions) {\n        featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\n      }\n\n      fun = function fun(zoom, feature) {\n        var value = evaluateExponentialFunction({\n          stops: featureFunctionStops,\n          base: parameters.base\n        }, zoom)(zoom, feature);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = false;\n    } else if (zoomDependent) {\n      fun = function fun(zoom) {\n        var value = innerFun(parameters, zoom);\n        return typeof value === 'function' ? value(zoom) : value;\n      };\n\n      isFeatureConstant = true;\n      isZoomConstant = false;\n    } else {\n      fun = function fun(zoom, feature) {\n        var value = innerFun(parameters, feature ? feature[parameters.property] : null);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = true;\n    }\n  }\n\n  fun.isZoomConstant = isZoomConstant;\n  fun.isFeatureConstant = isFeatureConstant;\n  return fun;\n}\n\nfunction coalesce(a, b, c) {\n  if (a !== undefined) return a;\n  if (b !== undefined) return b;\n  if (c !== undefined) return c;\n  return null;\n}\n\nfunction evaluateCategoricalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input === parameters.stops[i][0]) {\n      return parameters.stops[i][1];\n    }\n  }\n\n  return parameters.default;\n}\n\nfunction evaluateIntervalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input < parameters.stops[i][0]) break;\n  }\n\n  return parameters.stops[Math.max(i - 1, 0)][1];\n}\n\nfunction evaluateExponentialFunction(parameters, input) {\n  var base = parameters.base !== undefined ? parameters.base : 1;\n  var i = 0;\n\n  while (true) {\n    if (i >= parameters.stops.length) break;else if (input <= parameters.stops[i][0]) break;else i++;\n  }\n\n  if (i === 0) {\n    return parameters.stops[i][1];\n  } else if (i === parameters.stops.length) {\n    return parameters.stops[i - 1][1];\n  } else {\n    return interpolate$1(input, base, parameters.stops[i - 1][0], parameters.stops[i][0], parameters.stops[i - 1][1], parameters.stops[i][1]);\n  }\n}\n\nfunction evaluateIdentityFunction(parameters, input) {\n  return coalesce(input, parameters.default);\n}\n\nfunction interpolate$1(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  if (typeof outputLower === 'function') {\n    return function () {\n      var evaluatedLower = outputLower.apply(undefined, arguments);\n      var evaluatedUpper = outputUpper.apply(undefined, arguments);\n      return interpolate$1(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\n    };\n  } else if (outputLower.length) {\n    return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  } else {\n    return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  }\n}\n\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var difference = inputUpper - inputLower;\n  var progress = input - inputLower;\n  var ratio;\n\n  if (base === 1) {\n    ratio = progress / difference;\n  } else {\n    ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n\n  return outputLower * (1 - ratio) + outputUpper * ratio;\n}\n\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var output = [];\n\n  for (var i = 0; i < outputLower.length; i++) {\n    output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\n  }\n\n  return output;\n}\n\nfunction isFunctionDefinition(obj) {\n  return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\n}\n\nfunction hasFunctionDefinition(obj) {\n  for (var p in obj) {\n    if (isFunctionDefinition(obj[p])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction interpolated(parameters) {\n  return createFunction1(parameters, 'exponential');\n}\n\nfunction piecewiseConstant(parameters) {\n  return createFunction1(parameters, 'interval');\n}\n\nfunction loadFunctionTypes(obj, argFn) {\n  if (!obj) {\n    return null;\n  }\n\n  var hit = false;\n\n  if (Array.isArray(obj)) {\n    var multResult = [],\n        loaded;\n\n    for (var i = 0; i < obj.length; i++) {\n      loaded = loadFunctionTypes(obj[i], argFn);\n\n      if (!loaded) {\n        multResult.push(obj[i]);\n      } else {\n        multResult.push(loaded);\n        hit = true;\n      }\n    }\n\n    return hit ? multResult : obj;\n  }\n\n  var result = {\n    '__fn_types_loaded': true\n  },\n      props = [],\n      p;\n\n  for (p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      props.push(p);\n    }\n  }\n\n  var buildFn = function buildFn(p) {\n    Object.defineProperty(result, p, {\n      get: function get() {\n        if (!this['__fn_' + p]) {\n          this['__fn_' + p] = interpolated(this['_' + p]);\n        }\n\n        return this['__fn_' + p].apply(this, argFn());\n      },\n      set: function set(v) {\n        this['_' + p] = v;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  };\n\n  for (var _i = 0, len = props.length; _i < len; _i++) {\n    p = props[_i];\n\n    if (isFunctionDefinition(obj[p])) {\n      hit = true;\n      result['_' + p] = obj[p];\n      buildFn(p);\n    } else {\n      result[p] = obj[p];\n    }\n  }\n\n  return hit ? result : obj;\n}\n\nfunction getFunctionTypeResources(t) {\n  if (!t || !t.stops) {\n    return [];\n  }\n\n  var res = [];\n\n  for (var i = 0, l = t.stops.length; i < l; i++) {\n    res.push(t.stops[i][1]);\n  }\n\n  return res;\n}\n\nfunction createFunction1(parameters, defaultType) {\n  if (!isFunctionDefinition(parameters)) {\n    return function () {\n      return parameters;\n    };\n  }\n\n  parameters = JSON.parse(JSON.stringify(parameters));\n  var isZoomConstant = true;\n  var isFeatureConstant = true;\n  var stops = parameters.stops;\n\n  if (stops) {\n    for (var i = 0; i < stops.length; i++) {\n      if (isFunctionDefinition(stops[i][1])) {\n        var _fn = createFunction1(stops[i][1], defaultType);\n\n        isZoomConstant = isZoomConstant && _fn.isZoomConstant;\n        isFeatureConstant = isFeatureConstant && _fn.isFeatureConstant;\n        stops[i] = [stops[i][0], _fn];\n      }\n    }\n  }\n\n  var fn = createFunction(parameters, defaultType);\n  fn.isZoomConstant = isZoomConstant && fn.isZoomConstant;\n  fn.isFeatureConstant = isFeatureConstant && fn.isFeatureConstant;\n  return fn;\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  createFilter: createFilter,\n  getFilterFeature: getFilterFeature,\n  compileStyle: compileStyle,\n  isFunctionDefinition: isFunctionDefinition,\n  hasFunctionDefinition: hasFunctionDefinition,\n  interpolated: interpolated,\n  piecewiseConstant: piecewiseConstant,\n  loadFunctionTypes: loadFunctionTypes,\n  getFunctionTypeResources: getFunctionTypeResources\n});\n\nfunction translateToSVGStyles(s) {\n  var result = {\n    'stroke': {\n      'stroke': s['markerLineColor'],\n      'stroke-width': s['markerLineWidth'],\n      'stroke-opacity': s['markerLineOpacity'],\n      'stroke-dasharray': null,\n      'stroke-linecap': 'butt',\n      'stroke-linejoin': 'round'\n    },\n    'fill': {\n      'fill': s['markerFill'],\n      'fill-opacity': s['markerFillOpacity']\n    }\n  };\n\n  if (result['stroke']['stroke-width'] === 0) {\n    result['stroke']['stroke-opacity'] = 0;\n  }\n\n  return result;\n}\n\nfunction getMarkerPathBase64(symbol, width, height) {\n  if (!symbol['markerPath']) {\n    return null;\n  }\n\n  var op = 1;\n  var styles = translateToSVGStyles(symbol);\n\n  if (isNumber(symbol['markerOpacity'])) {\n    op = symbol['markerOpacity'];\n  }\n\n  if (isNumber(symbol['opacity'])) {\n    op *= symbol['opacity'];\n  }\n\n  var svgStyles = {};\n\n  if (styles) {\n    for (var p in styles['stroke']) {\n      if (styles['stroke'].hasOwnProperty(p)) {\n        if (!isNil(styles['stroke'][p])) {\n          svgStyles[p] = styles['stroke'][p];\n        }\n      }\n    }\n\n    for (var _p in styles['fill']) {\n      if (styles['fill'].hasOwnProperty(_p)) {\n        if (!isNil(styles['fill'][_p])) {\n          svgStyles[_p] = styles['fill'][_p];\n        }\n      }\n    }\n  }\n\n  var pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n  var path;\n  var pathesToRender = [];\n\n  for (var i = 0; i < pathes.length; i++) {\n    path = isString(pathes[i]) ? {\n      'path': pathes[i]\n    } : pathes[i];\n    path = extend({}, path, svgStyles);\n    path['d'] = path['path'];\n    delete path['path'];\n    pathesToRender.push(path);\n  }\n\n  var svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n\n  if (op < 1) {\n    svg.push('opacity=\"' + op + '\"');\n  }\n\n  if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n    svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n  }\n\n  svg.push('preserveAspectRatio=\"none\"');\n\n  if (width) {\n    svg.push('width=\"' + width + '\"');\n  }\n\n  if (height) {\n    svg.push('height=\"' + height + '\"');\n  }\n\n  svg.push('><defs></defs>');\n\n  for (var _i = 0; _i < pathesToRender.length; _i++) {\n    var strPath = '<path ';\n\n    for (var _p2 in pathesToRender[_i]) {\n      if (pathesToRender[_i].hasOwnProperty(_p2)) {\n        strPath += ' ' + _p2 + '=\"' + pathesToRender[_i][_p2] + '\"';\n      }\n    }\n\n    strPath += '></path>';\n    svg.push(strPath);\n  }\n\n  svg.push('</svg>');\n  var b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n  return b64;\n}\n\nfunction getExternalResources(symbol, toAbsolute) {\n  if (!symbol) {\n    return [];\n  }\n\n  var symbols = symbol;\n\n  if (!Array.isArray(symbol)) {\n    symbols = [symbol];\n  }\n\n  var resources = [];\n  var props = RESOURCE_PROPERTIES;\n  var res, resSizeProp;\n  var w, h;\n\n  for (var i = symbols.length - 1; i >= 0; i--) {\n    symbol = symbols[i];\n\n    if (!symbol) {\n      continue;\n    }\n\n    if (toAbsolute) {\n      symbol = convertResourceUrl(symbol);\n    }\n\n    for (var ii = 0; ii < props.length; ii++) {\n      res = symbol[props[ii]];\n\n      if (isFunctionDefinition(res)) {\n        res = getFunctionTypeResources(res);\n      }\n\n      if (!res) {\n        continue;\n      }\n\n      if (!Array.isArray(res)) {\n        res = [res];\n      }\n\n      for (var iii = 0; iii < res.length; iii++) {\n        if (res[iii].slice(0, 4) === 'url(') {\n          res[iii] = extractCssUrl(res[iii]);\n        }\n\n        resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n        resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n      }\n    }\n\n    if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n      w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n      h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n\n      if (isFunctionDefinition(symbol['markerPath'])) {\n        res = getFunctionTypeResources(symbol['markerPath']);\n        var path = symbol['markerPath'];\n\n        for (var _iii = 0; _iii < res.length; _iii++) {\n          symbol['markerPath'] = res[_iii];\n          resources.push([getMarkerPathBase64(symbol), w, h]);\n        }\n\n        symbol['markerPath'] = path;\n      } else {\n        resources.push([getMarkerPathBase64(symbol), w, h]);\n      }\n    }\n  }\n\n  return resources;\n}\n\nfunction convertResourceUrl(symbol) {\n  if (!symbol) {\n    return null;\n  }\n\n  var s = symbol;\n\n  if (IS_NODE) {\n    return s;\n  }\n\n  var props = RESOURCE_PROPERTIES;\n  var res;\n\n  for (var ii = 0, len = props.length; ii < len; ii++) {\n    res = s[props[ii]];\n\n    if (!res) {\n      continue;\n    }\n\n    s[props[ii]] = _convertUrl(res);\n  }\n\n  return s;\n}\n\nfunction _convertUrl(res) {\n  if (isFunctionDefinition(res)) {\n    var stops = res.stops;\n\n    for (var i = 0; i < stops.length; i++) {\n      stops[i][1] = _convertUrl(stops[i][1]);\n    }\n\n    return res;\n  }\n\n  if (res.slice(0, 4) === 'url(') {\n    res = extractCssUrl(res);\n  }\n\n  return res;\n}\n\nfunction isGradient(g) {\n  return g && g['colorStops'];\n}\n\nfunction getGradientStamp(g) {\n  var keys = [g['type']];\n\n  if (g['places']) {\n    keys.push(g['places'].join());\n  }\n\n  if (g['colorStops']) {\n    var stops = [];\n\n    for (var i = g['colorStops'].length - 1; i >= 0; i--) {\n      stops.push(g['colorStops'][i].join());\n    }\n\n    keys.push(stops.join(','));\n  }\n\n  return keys.join('_');\n}\n\nfunction getSymbolStamp(symbol) {\n  var keys = [];\n\n  if (Array.isArray(symbol)) {\n    for (var i = 0; i < symbol.length; i++) {\n      keys.push(getSymbolStamp(symbol[i]));\n    }\n\n    return '[ ' + keys.join(' , ') + ' ]';\n  }\n\n  for (var p in symbol) {\n    if (hasOwn(symbol, p)) {\n      if (!isFunction(symbol[p])) {\n        if (isGradient(symbol[p])) {\n          keys.push(p + '=' + getGradientStamp(symbol[p]));\n        } else {\n          keys.push(p + '=' + symbol[p]);\n        }\n      }\n    }\n  }\n\n  return keys.join(';');\n}\n\nfunction lowerSymbolOpacity(symbol, ratio) {\n  function s(_symbol, _ratio) {\n    var op = _symbol['opacity'];\n\n    if (isNil(op)) {\n      _symbol['opacity'] = _ratio;\n    } else {\n      _symbol['opacity'] *= _ratio;\n    }\n  }\n\n  var lower;\n\n  if (Array.isArray(symbol)) {\n    lower = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      var d = extend({}, symbol[i]);\n      s(d, ratio);\n      lower.push(d);\n    }\n  } else {\n    lower = extend({}, symbol);\n    s(lower, ratio);\n  }\n\n  return lower;\n}\n\nfunction extendSymbol(symbol) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  if (!sources || !sources.length) {\n    sources = [{}];\n  }\n\n  if (Array.isArray(symbol)) {\n    var s, dest;\n    var result = [];\n\n    for (var i = 0, l = symbol.length; i < l; i++) {\n      s = symbol[i];\n      dest = {};\n\n      for (var ii = 0, ll = sources.length; ii < ll; ii++) {\n        if (!Array.isArray(sources[ii])) {\n          extend(dest, s, sources[ii] ? sources[ii] : {});\n        } else if (!isNil(sources[ii][i])) {\n          extend(dest, s, sources[ii][i]);\n        } else {\n          extend(dest, s ? s : {});\n        }\n      }\n\n      result.push(dest);\n    }\n\n    return result;\n  } else {\n    var args = [{}, symbol];\n    args.push.apply(args, sources);\n    return extend.apply(this, args);\n  }\n}\n\nfunction parseStyleRootPath(style) {\n  if (style.symbol) {\n    style = [style];\n  }\n\n  if (Array.isArray(style)) {\n    return style;\n  }\n\n  var root = style['$root'];\n  var iconset = style['$iconset'];\n  style = style.style;\n\n  if (root || iconset) {\n    if (root && root[root.length - 1] === '/') {\n      root = root.substring(0, root.length - 1);\n    }\n\n    if (iconset && iconset[iconset.length - 1] === '/') {\n      iconset = iconset.substring(0, iconset.length - 1);\n    }\n\n    var replacer = function replacer(match) {\n      if (match === '{$root}') {\n        return root;\n      } else if (match === '{$iconset}') {\n        return iconset;\n      }\n\n      return null;\n    };\n\n    style = convertStylePath(style, replacer);\n  }\n\n  return style;\n}\n\nfunction convertStylePath(styles, replacer) {\n  for (var i = 0; i < styles.length; i++) {\n    var symbol = styles[i].symbol;\n\n    if (symbol) {\n      parseSymbolPath(symbol, replacer);\n    }\n  }\n}\n\nvar URL_PATTERN = /(\\{\\$root\\}|\\{\\$iconset\\})/g;\n\nfunction parseSymbolPath(symbol, replacer) {\n  for (var p in symbol) {\n    if (symbol.hasOwnProperty(p) && p !== 'textName') {\n      if (isString(symbol[p]) && symbol[p].length > 2) {\n        symbol[p] = symbol[p].replace(URL_PATTERN, replacer);\n      } else if (isFunctionDefinition(symbol[p])) {\n        symbol[p] = parseStops(symbol[p], replacer);\n      } else if (isObject(symbol[p])) {\n        parseSymbolPath(symbol[p], replacer);\n      }\n    }\n  }\n}\n\nfunction parseStops(value, replacer) {\n  var defaultValue = value['default'];\n\n  if (isString(defaultValue)) {\n    value['default'] = defaultValue.replace(URL_PATTERN, replacer);\n  }\n\n  var stops = value.stops;\n\n  for (var i = 0; i < stops.length; i++) {\n    if (!Array.isArray(stops[i])) {\n      continue;\n    }\n\n    if (isString(stops[i][1])) {\n      stops[i][1] = stops[i][1].replace(URL_PATTERN, replacer);\n    } else if (isFunctionDefinition(stops[i][1])) {\n      stops[i][1] = parseStops(stops[i][1], replacer);\n    }\n  }\n\n  return value;\n}\n\nvar index$1 = /*#__PURE__*/Object.freeze({\n  now: now,\n  extend: extend,\n  isNil: isNil,\n  isNumber: isNumber,\n  isInteger: isInteger,\n  isObject: isObject,\n  isString: isString,\n  isFunction: isFunction,\n  hasOwn: hasOwn,\n  join: join,\n  isEmpty: isEmpty,\n  toRadian: toRadian,\n  toDegree: toDegree,\n  IS_NODE: IS_NODE,\n\n  get requestAnimFrame() {\n    return requestAnimFrame;\n  },\n\n  get cancelAnimFrame() {\n    return cancelAnimFrame;\n  },\n\n  isSVG: isSVG,\n  loadImage: loadImage,\n  UID: UID,\n  GUID: GUID,\n  parseJSON: parseJSON,\n  pushIn: pushIn,\n  removeFromArray: removeFromArray,\n  forEachCoord: forEachCoord,\n  getValueOrDefault: getValueOrDefault,\n  sign: sign,\n  log2: log2,\n  interpolate: interpolate,\n  wrap: wrap,\n  clamp: clamp,\n  isArrayHasData: isArrayHasData,\n  isURL: isURL,\n  isCssUrl: isCssUrl,\n  extractCssUrl: extractCssUrl,\n  btoa: btoa,\n  b64toBlob: b64toBlob,\n  computeDegree: computeDegree,\n  emptyImageUrl: emptyImageUrl,\n  equalMapView: equalMapView,\n  flash: flash,\n  _defaults: _defaults,\n  translateToSVGStyles: translateToSVGStyles,\n  getMarkerPathBase64: getMarkerPathBase64,\n  getExternalResources: getExternalResources,\n  convertResourceUrl: convertResourceUrl,\n  isGradient: isGradient,\n  getGradientStamp: getGradientStamp,\n  getSymbolStamp: getSymbolStamp,\n  lowerSymbolOpacity: lowerSymbolOpacity,\n  extendSymbol: extendSymbol,\n  parseStyleRootPath: parseStyleRootPath,\n  convertStylePath: convertStylePath\n});\nvar Browser = {};\n\nif (!IS_NODE) {\n  var ua = navigator.userAgent.toLowerCase(),\n      doc = document.documentElement,\n      ie = ('ActiveXObject' in window),\n      webkit = ua.indexOf('webkit') !== -1,\n      phantomjs = ua.indexOf('phantom') !== -1,\n      android23 = ua.search('android [23]') !== -1,\n      chrome = ua.indexOf('chrome') !== -1,\n      gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n      mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n      msPointer = !window.PointerEvent && window.MSPointerEvent,\n      pointer = window.PointerEvent && navigator.pointerEnabled || msPointer,\n      ie3d = ie && 'transition' in doc.style,\n      webkit3d = 'WebKitCSSMatrix' in window && 'm11' in new window.WebKitCSSMatrix() && !android23,\n      gecko3d = ('MozPerspective' in doc.style),\n      opera12 = ('OTransition' in doc.style),\n      any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n  var chromeVersion = 0;\n\n  if (chrome) {\n    chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n  }\n\n  var touch = !phantomjs && (pointer || 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n  var webgl;\n\n  try {\n    var canvas = document.createElement('canvas');\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    webgl = gl && gl instanceof WebGLRenderingContext;\n  } catch (err) {\n    webgl = false;\n  }\n\n  var devicePixelRatio = window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n  Browser = {\n    ie: ie,\n    ielt9: ie && !document.addEventListener,\n    edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n    webkit: webkit,\n    gecko: gecko,\n    android: ua.indexOf('android') !== -1,\n    android23: android23,\n    chrome: chrome,\n    chromeVersion: chromeVersion,\n    safari: !chrome && ua.indexOf('safari') !== -1,\n    phantomjs: phantomjs,\n    ie3d: ie3d,\n    webkit3d: webkit3d,\n    gecko3d: gecko3d,\n    opera12: opera12,\n    any3d: any3d,\n    mobile: mobile,\n    mobileWebkit: mobile && webkit,\n    mobileWebkit3d: mobile && webkit3d,\n    mobileOpera: mobile && window.opera,\n    mobileGecko: mobile && gecko,\n    touch: !!touch,\n    msPointer: !!msPointer,\n    pointer: !!pointer,\n    retina: devicePixelRatio > 1,\n    devicePixelRatio: devicePixelRatio,\n    language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n    ie9: ie && document.documentMode === 9,\n    ie10: ie && document.documentMode === 10,\n    webgl: webgl\n  };\n}\n\nvar Browser$1 = Browser;\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Position = function () {\n  function Position(x, y) {\n    if (!isNil(x) && !isNil(y)) {\n      this.x = +x;\n      this.y = +y;\n    } else if (!isNil(x.x) && !isNil(x.y)) {\n      this.x = +x.x;\n      this.y = +x.y;\n    } else if (Array.isArray(x)) {\n      this.x = +x[0];\n      this.y = +x[1];\n    }\n\n    if (this._isNaN()) {\n      throw new Error('Position is NaN');\n    }\n  }\n\n  var _proto = Position.prototype;\n\n  _proto.set = function set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.abs = function abs() {\n    return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n  };\n\n  _proto._abs = function _abs() {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this.x), Math.round(this.y));\n  };\n\n  _proto._ceil = function _ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  };\n\n  _proto.ceil = function ceil() {\n    return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n  };\n\n  _proto.distanceTo = function distanceTo(point) {\n    var x = point.x - this.x,\n        y = point.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  };\n\n  _proto._floor = function _floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  };\n\n  _proto.floor = function floor() {\n    return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this.x, this.y);\n  };\n\n  _proto._add = function _add(x, y) {\n    if (!isNil(x.x)) {\n      this.x += x.x;\n      this.y += x.y;\n    } else if (!isNil(x[0])) {\n      this.x += x[0];\n      this.y += x[1];\n    } else {\n      this.x += x;\n      this.y += y;\n    }\n\n    return this;\n  };\n\n  _proto.add = function add(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x + x.x;\n      ny = this.y + x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x + x[0];\n      ny = this.y + x[1];\n    } else {\n      nx = this.x + x;\n      ny = this.y + y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto._sub = function _sub(x, y) {\n    if (!isNil(x.x)) {\n      this.x -= x.x;\n      this.y -= x.y;\n    } else if (!isNil(x[0])) {\n      this.x -= x[0];\n      this.y -= x[1];\n    } else {\n      this.x -= x;\n      this.y -= y;\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x - x.x;\n      ny = this.y - x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x - x[0];\n      ny = this.y - x[1];\n    } else {\n      nx = this.x - x;\n      ny = this.y - y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new this.constructor(this.x * ratio, this.y * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this.x *= ratio;\n    this.y *= ratio;\n    return this;\n  };\n\n  _proto.div = function div(n) {\n    return this.multi(1 / n);\n  };\n\n  _proto._div = function _div(n) {\n    return this._multi(1 / n);\n  };\n\n  _proto.equals = function equals(c) {\n    if (!(c instanceof this.constructor)) {\n      return false;\n    }\n\n    return this.x === c.x && this.y === c.y;\n  };\n\n  _proto._isNaN = function _isNaN() {\n    return isNaN(this.x) || isNaN(this.y);\n  };\n\n  _proto.isZero = function isZero() {\n    return this.x === 0 && this.y === 0;\n  };\n\n  _proto.toArray = function toArray() {\n    return [this.x, this.y];\n  };\n\n  _proto.toFixed = function toFixed(n) {\n    return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      x: this.x,\n      y: this.y\n    };\n  };\n\n  return Position;\n}();\n\nvar Point = function (_Position) {\n  _inheritsLoose(Point, _Position);\n\n  function Point() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  var _proto = Point.prototype;\n\n  _proto.closeTo = function closeTo(p, delta) {\n    if (!delta) {\n      delta = 0;\n    }\n\n    return this.x >= p.x - delta && this.x <= p.x + delta && this.y >= p.y - delta && this.y <= p.y + delta;\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto.unit = function unit() {\n    return this.copy()._unit();\n  };\n\n  _proto._unit = function _unit() {\n    this._div(this.mag());\n\n    return this;\n  };\n\n  _proto.perp = function perp() {\n    return this.copy()._perp();\n  };\n\n  _proto._perp = function _perp() {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  };\n\n  _proto.angleWith = function angleWith(b) {\n    return this.angleWithSep(b.x, b.y);\n  };\n\n  _proto.angleWithSep = function angleWithSep(x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  };\n\n  _proto._rotate = function _rotate(angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.rotate = function rotate(a) {\n    return this.copy()._rotate(a);\n  };\n\n  return Point;\n}(Position);\n\nvar Size = function () {\n  function Size(width, height) {\n    if (isNumber(width) && isNumber(height)) {\n      this.width = width;\n      this.height = height;\n    } else if (isNumber(width['width'])) {\n      this.width = width.width;\n      this.height = width.height;\n    } else if (Array.isArray(width)) {\n      this.width = width[0];\n      this.height = width[1];\n    }\n  }\n\n  var _proto = Size.prototype;\n\n  _proto.copy = function copy() {\n    return new Size(this['width'], this['height']);\n  };\n\n  _proto.add = function add(x, y) {\n    var w, h;\n\n    if (x instanceof Size) {\n      w = this.width + x.width;\n      h = this.height + x.height;\n    } else {\n      w = this.width + x;\n      h = this.height + y;\n    }\n\n    return new Size(w, h);\n  };\n\n  _proto.equals = function equals(size) {\n    return this['width'] === size['width'] && this['height'] === size['height'];\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new Size(this['width'] * ratio, this['height'] * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this['width'] *= ratio;\n    this['height'] *= ratio;\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this['width'] = Math.round(this['width']);\n    this['height'] = Math.round(this['height']);\n    return this;\n  };\n\n  _proto.toPoint = function toPoint() {\n    return new Point(this['width'], this['height']);\n  };\n\n  _proto.toArray = function toArray() {\n    return [this['width'], this['height']];\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'width': this['width'],\n      'height': this['height']\n    };\n  };\n\n  return Size;\n}();\n\nfunction trim(str) {\n  return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\nvar specialPattern = /[\\b\\t\\r\\v\\f]/igm;\n\nfunction escapeSpecialChars(str) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(specialPattern, '');\n}\n\nfunction splitWords(chr) {\n  return trim(chr).split(/\\s+/);\n}\n\nvar rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\n\nfunction stringWidth(text, font) {\n  if (stringWidth.node) {\n    return stringWidth.node(text, font);\n  }\n\n  rulerCtx.font = font;\n  return rulerCtx.measureText(text).width;\n}\n\nfunction stringLength(text, font, size) {\n  var w = stringWidth(text, font);\n  return new Size(w, size || DEFAULT_TEXT_SIZE);\n}\n\nfunction getFontHeight(font) {\n  var domRuler = getDomRuler('span');\n\n  if (font !== '_default_') {\n    domRuler.style.font = font;\n  }\n\n  domRuler.innerHTML = '秦';\n  var h = domRuler.clientHeight;\n  removeDomNode(domRuler);\n  return h;\n}\n\nfunction splitContent(content, font, wrapWidth, textWidth) {\n  if (!content || content.length === 0) {\n    return [{\n      'text': '',\n      'width': 0\n    }];\n  }\n\n  var width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n  var chrWidth = width / content.length,\n      minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n\n  if (chrWidth >= wrapWidth || minChrCount <= 0) {\n    return [{\n      'text': '',\n      'width': wrapWidth\n    }];\n  }\n\n  if (width <= wrapWidth) return [{\n    'text': content,\n    'width': width\n  }];\n  var result = [];\n  var testStr = content.substring(0, minChrCount),\n      prew = chrWidth * minChrCount;\n\n  for (var i = minChrCount, l = content.length; i < l; i++) {\n    var chr = content[i];\n    var w = stringWidth(testStr + chr);\n\n    if (w >= wrapWidth) {\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n      testStr = content.substring(i, minChrCount + i);\n      i += minChrCount - 1;\n      prew = chrWidth * minChrCount;\n    } else {\n      testStr += chr;\n      prew = w;\n    }\n\n    if (i >= l - 1) {\n      prew = stringWidth(testStr);\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n    }\n  }\n\n  return result;\n}\n\nvar contentExpRe = /\\{([\\w_]+)\\}/g;\n\nfunction replaceVariable(str, props) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(contentExpRe, function (str, key) {\n    if (!props) {\n      return '';\n    }\n\n    var value = props[key];\n\n    if (isNil(value)) {\n      return '';\n    } else if (Array.isArray(value)) {\n      return value.join();\n    }\n\n    return value;\n  });\n}\n\nfunction getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n  var width = size['width'],\n      height = size['height'];\n  var alignW, alignH;\n\n  if (horizontalAlignment === 'left') {\n    alignW = -width;\n  } else if (horizontalAlignment === 'right') {\n    alignW = 0;\n  } else {\n    alignW = -width / 2;\n  }\n\n  if (verticalAlignment === 'top') {\n    alignH = -height;\n  } else if (verticalAlignment === 'bottom') {\n    alignH = 0;\n  } else {\n    alignH = -height / 2;\n  }\n\n  return new Point(alignW, alignH);\n}\n\nvar DEFAULT_FONT = 'monospace';\n\nfunction getFont(style) {\n  if (style['textFont']) {\n    return style['textFont'];\n  } else {\n    return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') + (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') + style['textSize'] + 'px ' + (!style['textFaceName'] ? DEFAULT_FONT : style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"');\n  }\n}\n\nfunction splitTextToRow(text, style) {\n  var font = getFont(style),\n      lineSpacing = style['textLineSpacing'] || 0,\n      size = stringLength(text, font, style['textSize']),\n      textWidth = size['width'],\n      textHeight = size['height'],\n      wrapChar = style['textWrapCharacter'],\n      textRows = [];\n  var wrapWidth = style['textWrapWidth'];\n\n  if (!wrapWidth || wrapWidth > textWidth) {\n    wrapWidth = textWidth;\n  }\n\n  if (!isString(text)) {\n    text += '';\n  }\n\n  var actualWidth = 0;\n\n  if (wrapChar && text.indexOf(wrapChar) >= 0) {\n    var texts = text.split(wrapChar);\n\n    for (var i = 0, l = texts.length; i < l; i++) {\n      var t = texts[i];\n      var tWidth = stringWidth(t, font);\n\n      if (tWidth > wrapWidth) {\n        var contents = splitContent(t, font, wrapWidth, tWidth);\n\n        for (var ii = 0, ll = contents.length; ii < ll; ii++) {\n          var w = contents[ii].width;\n\n          if (w > actualWidth) {\n            actualWidth = w;\n          }\n\n          textRows.push({\n            'text': contents[ii].text,\n            'size': new Size(w, textHeight)\n          });\n        }\n      } else {\n        if (tWidth > actualWidth) {\n          actualWidth = tWidth;\n        }\n\n        textRows.push({\n          'text': t,\n          'size': new Size(tWidth, textHeight)\n        });\n      }\n    }\n  } else if (textWidth > wrapWidth) {\n    var _contents = splitContent(text, font, wrapWidth, textWidth);\n\n    for (var _i = 0; _i < _contents.length; _i++) {\n      var _w = _contents[_i].width;\n\n      if (_w > actualWidth) {\n        actualWidth = _w;\n      }\n\n      textRows.push({\n        'text': _contents[_i].text,\n        'size': new Size(_w, textHeight)\n      });\n    }\n  } else {\n    if (textWidth > actualWidth) {\n      actualWidth = textWidth;\n    }\n\n    textRows.push({\n      'text': text,\n      'size': size\n    });\n  }\n\n  var rowNum = textRows.length;\n  var textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n  return {\n    'total': rowNum,\n    'size': textSize,\n    'rows': textRows,\n    'rawSize': size\n  };\n}\n\nvar strings = /*#__PURE__*/Object.freeze({\n  trim: trim,\n  escapeSpecialChars: escapeSpecialChars,\n  splitWords: splitWords,\n  stringWidth: stringWidth,\n  stringLength: stringLength,\n  getFontHeight: getFontHeight,\n  splitContent: splitContent,\n  replaceVariable: replaceVariable,\n  getAlignPoint: getAlignPoint,\n  getFont: getFont,\n  splitTextToRow: splitTextToRow\n});\n\nvar first = function first(props) {\n  return props[0];\n};\n\nvar testProp = IS_NODE ? first : function (props) {\n  var style = document.documentElement.style;\n\n  for (var i = 0; i < props.length; i++) {\n    if (props[i] in style) {\n      return props[i];\n    }\n  }\n\n  return false;\n};\nvar TRANSFORM = testProp(['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\nvar TRANSFORMORIGIN = testProp(['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\nvar TRANSITION = testProp(['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\nvar CSSFILTER = testProp(['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\n\nfunction createEl(tagName, className) {\n  var el = document.createElement(tagName);\n\n  if (className) {\n    setClass(el, className);\n  }\n\n  return el;\n}\n\nfunction createElOn(tagName, style, container) {\n  var el = createEl(tagName);\n\n  if (style) {\n    setStyle(el, style);\n  }\n\n  if (container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\n\nfunction removeDomNode(node) {\n  if (!node) {\n    return this;\n  }\n\n  if (Browser$1.ielt9 || Browser$1.ie9) {\n    var d = createEl('div');\n    d.appendChild(node);\n    d.innerHTML = '';\n    d = null;\n  } else if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return this;\n}\n\nfunction addDomEvent(obj, typeArr, handler, context) {\n  if (!obj || !obj.addEventListener || !typeArr || !handler) {\n    return this;\n  }\n\n  var eventHandler = function eventHandler(e) {\n    if (!e) {\n      e = window.event;\n    }\n\n    handler.call(context || obj, e);\n    return;\n  };\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!obj['Z__' + type]) {\n      obj['Z__' + type] = [];\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit >= 0) {\n      removeDomEvent(obj, type, handler);\n    }\n\n    obj['Z__' + type].push({\n      callback: eventHandler,\n      src: handler\n    });\n\n    if (Browser$1.ie) {\n      obj.addEventListener(type, eventHandler, false);\n    } else {\n      obj.addEventListener(type, eventHandler, {\n        capture: false,\n        passive: false\n      });\n    }\n  }\n\n  return this;\n}\n\nfunction removeDomEvent(obj, typeArr, handler) {\n  function doRemove(type, callback) {\n    if (type === 'mousewheel' && Browser$1.gecko) {\n      type = 'DOMMouseScroll';\n    }\n\n    obj.removeEventListener(type, callback, false);\n  }\n\n  if (!obj || !obj.removeEventListener || !typeArr) {\n    return this;\n  }\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!handler && obj['Z__' + type]) {\n      var handlers = obj['Z__' + type];\n\n      for (var j = 0, jlen = handlers.length; j < jlen; j++) {\n        doRemove(handlers[j].callback);\n      }\n\n      delete obj['Z__' + type];\n      return this;\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit < 0) {\n      return this;\n    }\n\n    var hitHandler = obj['Z__' + type][hit];\n    doRemove(type, hitHandler.callback);\n    obj['Z__' + type].splice(hit, 1);\n  }\n\n  return this;\n}\n\nfunction listensDomEvent(obj, type, handler) {\n  if (!obj || !obj['Z__' + type] || !handler) {\n    return -1;\n  }\n\n  var handlers = obj['Z__' + type];\n\n  for (var i = 0, len = handlers.length; i < len; i++) {\n    if (handlers[i].src === handler) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nfunction preventDefault(event) {\n  if (event.preventDefault) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n\n  return this;\n}\n\nfunction stopPropagation(e) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.cancelBubble = true;\n  }\n\n  return this;\n}\n\nfunction preventSelection(dom) {\n  dom.onselectstart = function () {\n    return false;\n  };\n\n  dom.ondragstart = function () {\n    return false;\n  };\n\n  dom.setAttribute('unselectable', 'on');\n  return this;\n}\n\nfunction offsetDom(dom, offset) {\n  if (!dom) {\n    return null;\n  }\n\n  if (Browser$1.any3d) {\n    setTransform(dom, offset);\n  } else {\n    dom.style.left = offset.x + 'px';\n    dom.style.top = offset.y + 'px';\n  }\n\n  return offset;\n}\n\nfunction computeDomPosition(dom) {\n  var style = window.getComputedStyle(dom);\n  var padding = [parseInt(style['padding-left']), parseInt(style['padding-top'])];\n  var rect = dom.getBoundingClientRect();\n  var offsetWidth = dom.offsetWidth,\n      offsetHeight = dom.offsetHeight;\n  var scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n      scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n  dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n  return dom.__position;\n}\n\nfunction getEventContainerPoint(ev, dom) {\n  if (!ev) {\n    ev = window.event;\n  }\n\n  var domPos = dom.__position;\n\n  if (!domPos) {\n    domPos = computeDomPosition(dom);\n  }\n\n  return new Point((ev.clientX - domPos[0] - dom.clientLeft) / domPos[2], (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]);\n}\n\nfunction endsWith(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\nfunction setStyle(dom, strCss) {\n  var cssText = dom.style.cssText;\n\n  if (!endsWith(cssText, ';')) {\n    cssText += ';';\n  }\n\n  dom.style.cssText = cssText + strCss;\n  return this;\n}\n\nfunction hasClass(el, name) {\n  if (el.classList !== undefined) {\n    return el.classList.contains(name);\n  }\n\n  var className = getClass(el);\n  return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\nfunction addClass(el, name) {\n  if (el.classList !== undefined && !hasClass(el, name)) {\n    var classes = splitWords(name);\n\n    for (var i = 0, len = classes.length; i < len; i++) {\n      el.classList.add(classes[i]);\n    }\n  } else {\n    var className = getClass(el);\n    setClass(el, (className ? className + ' ' : '') + name);\n  }\n\n  return this;\n}\n\nfunction setClass(el, name) {\n  if (isNil(el.className.baseVal)) {\n    el.className = name;\n  } else {\n    el.className.baseVal = name;\n  }\n\n  return this;\n}\n\nfunction getClass(el) {\n  return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\n\nfunction setOpacity(el, value) {\n  el.style.opacity = value;\n  return this;\n}\n\nfunction setTransform(el, offset) {\n  var pos = offset || new Point(0, 0);\n  el.style[TRANSFORM] = Browser$1.any3d ? 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' : 'translate(' + pos.x + 'px,' + pos.y + 'px)';\n  return this;\n}\n\nfunction setTransformMatrix(el, m) {\n  var text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n\n  if (el.style[TRANSFORM] !== text) {\n    el.style[TRANSFORM] = text;\n  }\n\n  return this;\n}\n\nfunction removeTransform(el) {\n  if (el.style[TRANSFORM]) {\n    el.style[TRANSFORM] = '';\n  }\n\n  return this;\n}\n\nfunction isHTML(str) {\n  return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\n\nfunction measureDom(parentTag, dom) {\n  var ruler = getDomRuler(parentTag);\n\n  if (isString(dom)) {\n    ruler.innerHTML = dom;\n  } else {\n    ruler.appendChild(dom);\n  }\n\n  var result = new Size(ruler.clientWidth, ruler.clientHeight);\n  removeDomNode(ruler);\n  return result;\n}\n\nfunction getDomRuler(tag) {\n  var span = document.createElement(tag);\n  span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n  document.body.appendChild(span);\n  return span;\n}\n\nvar on = addDomEvent;\nvar off = removeDomEvent;\nvar dom = /*#__PURE__*/Object.freeze({\n  TRANSFORM: TRANSFORM,\n  TRANSFORMORIGIN: TRANSFORMORIGIN,\n  TRANSITION: TRANSITION,\n  CSSFILTER: CSSFILTER,\n  createEl: createEl,\n  createElOn: createElOn,\n  removeDomNode: removeDomNode,\n  addDomEvent: addDomEvent,\n  removeDomEvent: removeDomEvent,\n  listensDomEvent: listensDomEvent,\n  preventDefault: preventDefault,\n  stopPropagation: stopPropagation,\n  preventSelection: preventSelection,\n  offsetDom: offsetDom,\n  computeDomPosition: computeDomPosition,\n  getEventContainerPoint: getEventContainerPoint,\n  setStyle: setStyle,\n  hasClass: hasClass,\n  addClass: addClass,\n  setClass: setClass,\n  getClass: getClass,\n  setOpacity: setOpacity,\n  setTransform: setTransform,\n  setTransformMatrix: setTransformMatrix,\n  removeTransform: removeTransform,\n  isHTML: isHTML,\n  measureDom: measureDom,\n  getDomRuler: getDomRuler,\n  on: on,\n  off: off\n});\nvar Ajax = {\n  jsonp: function jsonp(url, callback) {\n    var name = '_maptalks_jsonp_' + UID();\n    if (url.match(/\\?/)) url += '&callback=' + name;else url += '?callback=' + name;\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    window[name] = function (data) {\n      callback(null, data);\n      document.getElementsByTagName('head')[0].removeChild(script);\n      script = null;\n      delete window[name];\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n    return this;\n  },\n  get: function get(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (IS_NODE && Ajax.get.node) {\n      return Ajax.get.node(url, cb, options);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('GET', url, true);\n\n    if (options) {\n      for (var k in options.headers) {\n        client.setRequestHeader(k, options.headers[k]);\n      }\n\n      client.withCredentials = options.credentials === 'include';\n\n      if (options['responseType']) {\n        client.responseType = options['responseType'];\n      }\n    }\n\n    client.send(null);\n    return client;\n  },\n  post: function post(url, options, cb) {\n    var postData;\n\n    if (!isString(url)) {\n      var t = cb;\n      postData = options;\n      options = url;\n      url = options.url;\n      cb = t;\n    } else {\n      if (isFunction(options)) {\n        var _t = cb;\n        cb = options;\n        options = _t;\n      }\n\n      options = options || {};\n      postData = options.postData;\n    }\n\n    if (IS_NODE && Ajax.post.node) {\n      options.url = url;\n      return Ajax.post.node(options, postData, cb);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('POST', options.url, true);\n\n    if (!options.headers) {\n      options.headers = {};\n    }\n\n    if (!options.headers['Content-Type']) {\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n    }\n\n    if ('setRequestHeader' in client) {\n      for (var p in options.headers) {\n        if (options.headers.hasOwnProperty(p)) {\n          client.setRequestHeader(p, options.headers[p]);\n        }\n      }\n    }\n\n    if (!isString(postData)) {\n      postData = JSON.stringify(postData);\n    }\n\n    client.send(postData);\n    return client;\n  },\n  _wrapCallback: function _wrapCallback(client, cb) {\n    return function () {\n      if (client.readyState === 4) {\n        if (client.status === 200) {\n          if (client.responseType === 'arraybuffer') {\n            var response = client.response;\n\n            if (response.byteLength === 0) {\n              cb(new Error('http status 200 returned without content.'));\n            } else {\n              cb(null, {\n                data: client.response,\n                cacheControl: client.getResponseHeader('Cache-Control'),\n                expires: client.getResponseHeader('Expires'),\n                contentType: client.getResponseHeader('Content-Type')\n              });\n            }\n          } else {\n            cb(null, client.responseText);\n          }\n        } else {\n          cb(new Error(client.statusText + ',' + client.status));\n        }\n      }\n    };\n  },\n  _getClient: function _getClient(cb) {\n    var client;\n\n    try {\n      client = new XMLHttpRequest();\n    } catch (e) {\n      try {\n        client = new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          client = new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e) {}\n      }\n    }\n\n    client.onreadystatechange = Ajax._wrapCallback(client, cb);\n    return client;\n  },\n  getArrayBuffer: function getArrayBuffer(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    options['responseType'] = 'arraybuffer';\n    return Ajax.get(url, options, cb);\n  },\n  getImage: function getImage(img, url, options) {\n    return Ajax.getArrayBuffer(url, options, function (err, imgData) {\n      if (err) {\n        if (img.onerror) {\n          img.onerror(err);\n        }\n      } else if (imgData) {\n        var URL = window.URL || window.webkitURL;\n        var onload = img.onload;\n\n        img.onload = function () {\n          if (onload) {\n            onload();\n          }\n\n          URL.revokeObjectURL(img.src);\n        };\n\n        var blob = new Blob([new Uint8Array(imgData.data)], {\n          type: imgData.contentType\n        });\n        img.cacheControl = imgData.cacheControl;\n        img.expires = imgData.expires;\n        img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n      }\n    });\n  }\n};\n\nAjax.getJSON = function (url, options, cb) {\n  if (isFunction(options)) {\n    var t = cb;\n    cb = options;\n    options = t;\n  }\n\n  var callback = function callback(err, resp) {\n    var data = resp ? parseJSON(resp) : null;\n    cb(err, data);\n  };\n\n  if (options && options['jsonp']) {\n    return Ajax.jsonp(url, callback);\n  }\n\n  return Ajax.get(url, options, callback);\n};\n\nvar DEFAULT_STROKE_COLOR = '#000';\nvar DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nvar DEFAULT_TEXT_COLOR = '#000';\nvar hitTesting = false;\nvar TEMP_CANVAS = null;\nvar RADIAN = Math.PI / 180;\nvar textOffsetY = 1;\nvar Canvas = {\n  setHitTesting: function setHitTesting(testing) {\n    hitTesting = testing;\n  },\n  createCanvas: function createCanvas(width, height, canvasClass) {\n    var canvas;\n\n    if (!IS_NODE) {\n      canvas = createEl('canvas');\n      canvas.width = width;\n      canvas.height = height;\n    } else {\n      canvas = new canvasClass(width, height);\n    }\n\n    return canvas;\n  },\n  prepareCanvasFont: function prepareCanvasFont(ctx, style) {\n    ctx.textBaseline = 'top';\n    ctx.font = getFont(style);\n    var fill = style['textFill'];\n\n    if (!fill) {\n      fill = DEFAULT_TEXT_COLOR;\n    }\n\n    ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n  },\n  prepareCanvas: function prepareCanvas(ctx, style, resources, testing) {\n    if (!style) {\n      return;\n    }\n\n    var strokeWidth = style['lineWidth'];\n\n    if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n      ctx.lineWidth = strokeWidth;\n    }\n\n    var strokePattern = style['linePatternFile'];\n    var strokeColor = style['lineColor'] || DEFAULT_STROKE_COLOR;\n\n    if (testing) {\n      ctx.strokeStyle = '#000';\n    } else if (strokePattern && resources) {\n      var patternOffset;\n\n      if (style['linePatternDx'] || style['linePatternDy']) {\n        patternOffset = [style['linePatternDx'], style['linePatternDy']];\n      }\n\n      Canvas._setStrokePattern(ctx, strokePattern, strokeWidth, patternOffset, resources);\n\n      style['lineDasharray'] = [];\n    } else if (isGradient(strokeColor)) {\n      if (style['lineGradientExtent']) {\n        ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n      } else {\n        ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n      }\n    } else {\n      ctx.strokeStyle = strokeColor;\n    }\n\n    if (style['lineJoin']) {\n      ctx.lineJoin = style['lineJoin'];\n    }\n\n    if (style['lineCap']) {\n      ctx.lineCap = style['lineCap'];\n    }\n\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var polygonPattern = style['polygonPatternFile'];\n    var fill = style['polygonFill'] || DEFAULT_FILL_COLOR;\n\n    if (testing) {\n      ctx.fillStyle = '#000';\n    } else if (polygonPattern && resources) {\n      var fillImgUrl = extractImageUrl(polygonPattern);\n      var fillTexture = resources.getImage([fillImgUrl, null, null]);\n\n      if (!fillTexture) {\n        fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n      }\n\n      if (isSVG(fillImgUrl) && fillTexture instanceof Image && (Browser$1.edge || Browser$1.ie)) {\n        var w = fillTexture.width || 20,\n            h = fillTexture.height || 20;\n        var canvas = Canvas.createCanvas(w, h);\n        Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n        fillTexture = canvas;\n      }\n\n      if (!fillTexture) {\n        if (typeof console !== 'undefined') {\n          console.warn('img not found for', fillImgUrl);\n        }\n      } else {\n        ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n\n        if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n          ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n        }\n      }\n    } else if (isGradient(fill)) {\n      if (style['polygonGradientExtent']) {\n        ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n      } else {\n        ctx.fillStyle = 'rgba(255,255,255,0)';\n      }\n    } else {\n      ctx.fillStyle = fill;\n    }\n  },\n  _createGradient: function _createGradient(ctx, g, extent) {\n    var gradient = null,\n        places = g['places'];\n    var min = extent.getMin(),\n        max = extent.getMax(),\n        width = extent.getWidth(),\n        height = extent.getHeight();\n\n    if (!g['type'] || g['type'] === 'linear') {\n      if (!places) {\n        places = [min.x, min.y, max.x, min.y];\n      } else {\n        if (places.length !== 4) {\n          throw new Error('A linear gradient\\'s places should have 4 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, min.x + places[2] * width, min.y + places[3] * height];\n      }\n\n      gradient = ctx.createLinearGradient.apply(ctx, places);\n    } else if (g['type'] === 'radial') {\n      if (!places) {\n        var c = extent.getCenter()._round();\n\n        places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n      } else {\n        if (places.length !== 6) {\n          throw new Error('A radial gradient\\'s places should have 6 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, width * places[2], min.x + places[3] * width, min.y + places[4] * height, width * places[5]];\n      }\n\n      gradient = ctx.createRadialGradient.apply(ctx, places);\n    }\n\n    g['colorStops'].forEach(function (stop) {\n      gradient.addColorStop.apply(gradient, stop);\n    });\n    return gradient;\n  },\n  _setStrokePattern: function _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n    var imgUrl = extractImageUrl(strokePattern);\n    var imageTexture;\n\n    if (IS_NODE) {\n      imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n    } else {\n      var key = imgUrl + '-texture-' + strokeWidth;\n      imageTexture = resources.getImage(key);\n\n      if (!imageTexture) {\n        var imageRes = resources.getImage([imgUrl, null, null]);\n\n        if (imageRes) {\n          var w;\n\n          if (!imageRes.width || !imageRes.height) {\n            w = strokeWidth;\n          } else {\n            w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n          }\n\n          var patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n          Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n          resources.addResource([key, null, strokeWidth], patternCanvas);\n          imageTexture = patternCanvas;\n        }\n      }\n    }\n\n    if (imageTexture) {\n      ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n      ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n    } else if (typeof console !== 'undefined') {\n      console.warn('img not found for', imgUrl);\n    }\n  },\n  clearRect: function clearRect(ctx, x1, y1, x2, y2) {\n    ctx.canvas._drawn = false;\n    ctx.clearRect(x1, y1, x2, y2);\n  },\n  fillCanvas: function fillCanvas(ctx, fillOpacity, x, y) {\n    if (hitTesting) {\n      fillOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (fillOpacity === 0) {\n      return;\n    }\n\n    var isPattern = Canvas._isPattern(ctx.fillStyle);\n\n    var offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n\n    if (isNil(fillOpacity)) {\n      fillOpacity = 1;\n    }\n\n    var alpha;\n\n    if (fillOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= fillOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.fill();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (fillOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  getRgba: function getRgba(color, op) {\n    if (isNil(op)) {\n      op = 1;\n    }\n\n    if (color[0] !== '#') {\n      return color;\n    }\n\n    var r, g, b;\n\n    if (color.length === 7) {\n      r = parseInt(color.substring(1, 3), 16);\n      g = parseInt(color.substring(3, 5), 16);\n      b = parseInt(color.substring(5, 7), 16);\n    } else {\n      r = parseInt(color.substring(1, 2), 16) * 17;\n      g = parseInt(color.substring(2, 3), 16) * 17;\n      b = parseInt(color.substring(3, 4), 16) * 17;\n    }\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n  },\n  image: function image(ctx, img, x, y, width, height) {\n    ctx.canvas._drawn = true;\n\n    try {\n      if (isNumber(width) && isNumber(height)) {\n        ctx.drawImage(img, x, y, width, height);\n      } else {\n        ctx.drawImage(img, x, y);\n      }\n    } catch (error) {\n      if (console) {\n        console.warn('error when drawing image on canvas:', error);\n        console.warn(img);\n      }\n    }\n  },\n  text: function text(ctx, _text, pt, style, textDesc) {\n    Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n  },\n  _textOnMultiRow: function _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n    var ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n        lineHeight = textSize['height'] + style['textLineSpacing'],\n        basePoint = point.add(0, ptAlign.y),\n        maxHeight = style['textMaxHeight'];\n    var text,\n        rowAlign,\n        height = 0;\n\n    for (var i = 0, len = texts.length; i < len; i++) {\n      text = texts[i]['text'];\n      rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n\n      Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n\n      if (maxHeight > 0) {\n        height += lineHeight;\n\n        if (height + textSize['height'] >= maxHeight) {\n          break;\n        }\n      }\n    }\n  },\n  _textOnLine: function _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n    if (hitTesting) {\n      textHaloAlpha = 1;\n    }\n\n    var drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n    ctx.textBaseline = 'top';\n    var gco, fill;\n    var shadowBlur = ctx.shadowBlur,\n        shadowOffsetX = ctx.shadowOffsetX,\n        shadowOffsetY = ctx.shadowOffsetY;\n\n    if (drawHalo) {\n      var alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= textHaloAlpha;\n      ctx.miterLimit = 2;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = textHaloRadius * 2;\n      ctx.strokeStyle = textHaloFill;\n      ctx.strokeText(text, pt.x, pt.y + textOffsetY);\n      ctx.miterLimit = 10;\n      ctx.globalAlpha = alpha;\n      gco = ctx.globalCompositeOperation;\n      ctx.globalCompositeOperation = 'destination-out';\n      fill = ctx.fillStyle;\n      ctx.fillStyle = '#000';\n    }\n\n    if (shadowBlur && drawHalo) {\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    }\n\n    Canvas.fillText(ctx, text, pt);\n\n    if (gco) {\n      ctx.globalCompositeOperation = gco;\n      Canvas.fillText(ctx, text, pt, fill);\n\n      if (shadowBlur) {\n        ctx.shadowBlur = shadowBlur;\n        ctx.shadowOffsetX = shadowOffsetX;\n        ctx.shadowOffsetY = shadowOffsetY;\n      }\n    }\n  },\n  fillText: function fillText(ctx, text, pt, rgba) {\n    ctx.canvas._drawn = true;\n\n    if (rgba) {\n      ctx.fillStyle = rgba;\n    }\n\n    ctx.fillText(text, pt.x, pt.y + textOffsetY);\n  },\n  _stroke: function _stroke(ctx, strokeOpacity, x, y) {\n    if (hitTesting) {\n      strokeOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (strokeOpacity === 0) {\n      return;\n    }\n\n    var offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n    var isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n    if (isNil(strokeOpacity)) {\n      strokeOpacity = 1;\n    }\n\n    var alpha;\n\n    if (strokeOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= strokeOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.stroke();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (strokeOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  _path: function _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    function fillWithPattern(p1, p2) {\n      var degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n      ctx.save();\n      var cosd = Math.cos(degree);\n\n      if (Math.abs(cosd) < 1E-7) {\n        ctx.translate(p1.x - ctx.lineWidth / 2, p1.y);\n      } else {\n        ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / cosd);\n      }\n\n      ctx.rotate(degree);\n\n      Canvas._stroke(ctx, lineOpacity);\n\n      ctx.restore();\n    }\n\n    var isDashed = isArrayHasData(lineDashArray);\n    var isPatternLine = ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle);\n    var point, prePoint, nextPoint;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      point = points[i];\n\n      if (!isDashed || ctx.setLineDash) {\n        ctx.lineTo(point.x, point.y);\n\n        if (isPatternLine && i > 0) {\n          prePoint = points[i - 1];\n          fillWithPattern(prePoint, point);\n          ctx.beginPath();\n          ctx.moveTo(point.x, point.y);\n        }\n      } else if (isDashed) {\n        if (i === len - 1) {\n          break;\n        }\n\n        nextPoint = points[i + 1];\n        drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n      }\n    }\n  },\n  path: function path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    Canvas._path(ctx, points, lineDashArray, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _multiClip: function _multiClip(ctx, points) {\n    if (!points || points.length === 0) return;\n    points = points[0];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      var x = point.x,\n          y = point.y;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n\n      if (i === len - 1) {\n        x = points[0].x;\n        y = points[0].y;\n        ctx.lineTo(x, y);\n      }\n    }\n  },\n  polygon: function polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n    if (ctx.isMultiClip) {\n      Canvas._multiClip(ctx, points);\n\n      return;\n    }\n\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    var isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n        fillFirst = isArrayHasData(lineDashArray) && !ctx.setLineDash || isPatternLine && !smoothness;\n\n    if (!isArrayHasData(points[0])) {\n      points = [points];\n    }\n\n    var savedCtx = ctx;\n\n    if (points.length > 1 && !IS_NODE) {\n      if (!TEMP_CANVAS) {\n        TEMP_CANVAS = Canvas.createCanvas(1, 1);\n      }\n\n      ctx.canvas._drawn = false;\n      TEMP_CANVAS.width = ctx.canvas.width;\n      TEMP_CANVAS.height = ctx.canvas.height;\n      ctx = TEMP_CANVAS.getContext('2d');\n      copyProperties(ctx, savedCtx);\n    }\n\n    var op, i, len;\n\n    if (fillFirst) {\n      ctx.save();\n\n      for (i = 0, len = points.length; i < len; i++) {\n        if (!isArrayHasData(points[i])) {\n          continue;\n        }\n\n        Canvas._ring(ctx, points[i], null, 0, true);\n\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n\n        Canvas._stroke(ctx, 0);\n      }\n\n      ctx.restore();\n    }\n\n    for (i = 0, len = points.length; i < len; i++) {\n      if (!isArrayHasData(points[i])) {\n        continue;\n      }\n\n      if (smoothness) {\n        Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n        ctx.closePath();\n      } else {\n        Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n      }\n\n      if (!fillFirst) {\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n      }\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n\n    if (points.length > 1 && !IS_NODE) {\n      savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n      savedCtx.canvas._drawn = ctx.canvas._drawn;\n      copyProperties(savedCtx, ctx);\n    }\n  },\n  _ring: function _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n    var isPattern = Canvas._isPattern(ctx.strokeStyle);\n\n    if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n      ring = ring.concat([ring[0]]);\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(ring[0].x, ring[0].y);\n\n    Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n\n    if (!isPattern) {\n      ctx.closePath();\n    }\n  },\n  paintSmoothLine: function paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n    if (!points) {\n      return;\n    }\n\n    if (points.length <= 2 || !smoothValue) {\n      Canvas.path(ctx, points, lineOpacity);\n      return;\n    }\n\n    function interpolate$$1(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n      var u0 = 1.0 - t0;\n      var u1 = 1.0 - t1;\n      var qxa = x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n      var qxb = x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n      var qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 + x2 * t0 * t0;\n      var qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 + x2 * t1 * t1;\n      var qya = y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n      var qyb = y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n      var qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 + y2 * t0 * t0;\n      var qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 + y2 * t1 * t1;\n      var xb = qxa * u1 + qxc * t1;\n      var xc = qxb * u0 + qxd * t0;\n      var xd = qxb * u1 + qxd * t1;\n      var yb = qya * u1 + qyc * t1;\n      var yc = qyb * u0 + qyd * t0;\n      var yd = qyb * u1 + qyd * t1;\n      return [xb, yb, xc, yc, xd, yd];\n    }\n\n    function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n      var xc1 = (x0 + x1) / 2.0,\n          yc1 = (y0 + y1) / 2.0;\n      var xc2 = (x1 + x2) / 2.0,\n          yc2 = (y1 + y2) / 2.0;\n      var xc3 = (x2 + x3) / 2.0,\n          yc3 = (y2 + y3) / 2.0;\n      var len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n      var len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      var len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n      var k1 = len1 / (len1 + len2);\n      var k2 = len2 / (len2 + len3);\n      var xm1 = xc1 + (xc2 - xc1) * k1,\n          ym1 = yc1 + (yc2 - yc1) * k1;\n      var xm2 = xc2 + (xc3 - xc2) * k2,\n          ym2 = yc2 + (yc3 - yc2) * k2;\n      var ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n          ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n          ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n          ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n      var ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n\n      if (t < 1) {\n        return interpolate$$1(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n      } else {\n        return ctrlPoints;\n      }\n    }\n\n    var count = points.length;\n    var l = close ? count : count - 1;\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n    if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n    var preCtrlPoints;\n\n    for (var i = 0; i < l; i++) {\n      var x1 = points[i].x,\n          y1 = points[i].y;\n      var x0 = void 0,\n          y0 = void 0,\n          x2 = void 0,\n          y2 = void 0,\n          x3 = void 0,\n          y3 = void 0;\n\n      if (i - 1 < 0) {\n        if (!close) {\n          x0 = points[i + 1].x;\n          y0 = points[i + 1].y;\n        } else {\n          x0 = points[l - 1].x;\n          y0 = points[l - 1].y;\n        }\n      } else {\n        x0 = points[i - 1].x;\n        y0 = points[i - 1].y;\n      }\n\n      if (i + 1 < count) {\n        x2 = points[i + 1].x;\n        y2 = points[i + 1].y;\n      } else {\n        x2 = points[i + 1 - count].x;\n        y2 = points[i + 1 - count].y;\n      }\n\n      if (i + 2 < count) {\n        x3 = points[i + 2].x;\n        y3 = points[i + 2].y;\n      } else if (!close) {\n        x3 = points[i].x;\n        y3 = points[i].y;\n      } else {\n        x3 = points[i + 2 - count].x;\n        y3 = points[i + 2 - count].y;\n      }\n\n      var ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n\n      if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n        points.splice(l - 1, count - (l - 1) - 1);\n        var lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n        lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n        points.push(lastPoint);\n        count = points.length;\n      } else {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n      }\n\n      points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n      points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n      preCtrlPoints = ctrlPoints;\n    }\n\n    if (!close && points[1].prevCtrlPoint) {\n      points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n      delete points[0].prevCtrlPoint;\n    }\n\n    if (!points[count - 1].prevCtrlPoint) {\n      points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n    }\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _arcBetween: function _arcBetween(ctx, p1, p2, degree) {\n    var a = degree,\n        dist = p1.distanceTo(p2),\n        r = dist / 2 / Math.sin(a / 2);\n    var p1p2 = Math.asin((p2.y - p1.y) / dist);\n\n    if (p1.x > p2.x) {\n      p1p2 = Math.PI - p1p2;\n    }\n\n    var cp2 = 90 * RADIAN - a / 2,\n        da = p1p2 - cp2;\n    var dx = Math.cos(da) * r,\n        dy = Math.sin(da) * r,\n        cx = p1.x + dx,\n        cy = p1.y + dy;\n    var startAngle = Math.asin((p2.y - cy) / r);\n\n    if (cx > p2.x) {\n      startAngle = Math.PI - startAngle;\n    }\n\n    var endAngle = startAngle + a;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r, startAngle, endAngle);\n    return [cx, cy];\n  },\n  _lineTo: function _lineTo(ctx, p) {\n    ctx.lineTo(p.x, p.y);\n  },\n  bezierCurveAndFill: function bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n    ctx.beginPath();\n    var start = points[0];\n    ctx.moveTo(start.x, start.y);\n    var args = [ctx];\n    args.push.apply(args, points.splice(1));\n\n    Canvas._bezierCurveTo.apply(Canvas, args);\n\n    Canvas.fillCanvas(ctx, fillOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _bezierCurveTo: function _bezierCurveTo(ctx, p1, p2, p3) {\n    ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n  },\n  ellipse: function ellipse(ctx, pt, width, heightTop, heightBottom, lineOpacity, fillOpacity) {\n    function bezierEllipse(x, y, a, b, b1) {\n      var k = 0.5522848,\n          ox = a * k,\n          oy = b * k,\n          oy1 = b1 * k;\n      ctx.moveTo(x - a, y);\n      ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n      ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n      ctx.bezierCurveTo(x + a, y + oy1, x + ox, y + b1, x, y + b1);\n      ctx.bezierCurveTo(x - ox, y + b1, x - a, y + oy1, x - a, y);\n      ctx.closePath();\n    }\n\n    ctx.beginPath();\n\n    if (width === heightTop && width === heightBottom) {\n      ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n    } else if (ctx.ellipse) {\n      if (heightTop !== heightBottom) {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, RADIAN * 180, RADIAN * 360, false);\n        ctx.ellipse(pt.x, pt.y, width, heightBottom, 0, 0, RADIAN * 180, false);\n      } else {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, 0, RADIAN * 360, false);\n      }\n    } else {\n      bezierEllipse(pt.x, pt.y, width, heightTop, heightBottom);\n    }\n\n    Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - heightTop);\n\n    Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - heightTop);\n  },\n  rectangle: function rectangle(ctx, pt, size, lineOpacity, fillOpacity) {\n    var x = pt.x,\n        y = pt.y;\n    ctx.beginPath();\n    ctx.rect(x, y, size['width'], size['height']);\n    Canvas.fillCanvas(ctx, fillOpacity, x, y);\n\n    Canvas._stroke(ctx, lineOpacity, x, y);\n  },\n  sector: function sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n    var rad = RADIAN;\n    var startAngle = angles[0],\n        endAngle = angles[1];\n\n    function sector(ctx, x, y, radius, startAngle, endAngle) {\n      var sDeg = rad * -endAngle;\n      var eDeg = rad * -startAngle;\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      ctx.arc(x, y, radius, sDeg, eDeg);\n      ctx.lineTo(x, y);\n      Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n\n      Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n    }\n\n    sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n  },\n  _isPattern: function _isPattern(style) {\n    return !isString(style) && !('addColorStop' in style);\n  },\n  drawCross: function drawCross(ctx, x, y, lineWidth, color) {\n    ctx.canvas._drawn = true;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.moveTo(x - 5, y);\n    ctx.lineTo(x + 5, y);\n    ctx.moveTo(x, y - 5);\n    ctx.lineTo(x, y + 5);\n    ctx.stroke();\n  },\n  copy: function copy(canvas, c) {\n    var target = c || createEl('canvas');\n    target.width = canvas.width;\n    target.height = canvas.height;\n    target.getContext('2d').drawImage(canvas, 0, 0);\n    return target;\n  }\n};\n\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n  var fromX = startPoint.x,\n      fromY = startPoint.y,\n      toX = endPoint.x,\n      toY = endPoint.y;\n  var pattern = dashArray;\n\n  var lt = function lt(a, b) {\n    return a <= b;\n  };\n\n  var gt = function gt(a, b) {\n    return a >= b;\n  };\n\n  var capmin = function capmin(a, b) {\n    return Math.min(a, b);\n  };\n\n  var capmax = function capmax(a, b) {\n    return Math.max(a, b);\n  };\n\n  var checkX = {\n    thereYet: gt,\n    cap: capmin\n  };\n  var checkY = {\n    thereYet: gt,\n    cap: capmin\n  };\n\n  if (fromY - toY > 0) {\n    checkY.thereYet = lt;\n    checkY.cap = capmax;\n  }\n\n  if (fromX - toX > 0) {\n    checkX.thereYet = lt;\n    checkX.cap = capmax;\n  }\n\n  ctx.moveTo(fromX, fromY);\n  var offsetX = fromX;\n  var offsetY = fromY;\n  var idx = 0,\n      dash = true;\n  var ang, len;\n\n  while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n    ang = Math.atan2(toY - fromY, toX - fromX);\n    len = pattern[idx];\n    offsetX = checkX.cap(toX, offsetX + Math.cos(ang) * len);\n    offsetY = checkY.cap(toY, offsetY + Math.sin(ang) * len);\n\n    if (dash) {\n      ctx.lineTo(offsetX, offsetY);\n    } else {\n      ctx.moveTo(offsetX, offsetY);\n    }\n\n    idx = (idx + 1) % pattern.length;\n    dash = !dash;\n  }\n}\n\nvar prefix = 'data:image/';\n\nfunction extractImageUrl(url) {\n  if (url.substring(0, prefix.length) === prefix) {\n    return url;\n  }\n\n  return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n  ctx.filter = savedCtx.filter;\n  ctx.fillStyle = savedCtx.fillStyle;\n  ctx.globalAlpha = savedCtx.globalAlpha;\n  ctx.lineCap = savedCtx.lineCap;\n  ctx.lineDashOffset = savedCtx.lineDashOffset;\n  ctx.lineJoin = savedCtx.lineJoin;\n  ctx.lineWidth = savedCtx.lineWidth;\n  ctx.shadowBlur = savedCtx.shadowBlur;\n  ctx.shadowColor = savedCtx.shadowColor;\n  ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n  ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n  ctx.strokeStyle = savedCtx.strokeStyle;\n}\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar zousanMin = createCommonjsModule(function (module) {\n  !function (t) {\n    function e(t) {\n      if (t) {\n        var e = this;\n        t(function (t) {\n          e.resolve(t);\n        }, function (t) {\n          e.reject(t);\n        });\n      }\n    }\n\n    function n(t, e) {\n      if (\"function\" == typeof t.y) try {\n        var n = t.y.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.resolve(e);\n    }\n\n    function o(t, e) {\n      if (\"function\" == typeof t.n) try {\n        var n = t.n.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.reject(e);\n    }\n\n    var r,\n        i,\n        c = \"fulfilled\",\n        u = \"rejected\",\n        s = \"undefined\",\n        f = function () {\n      function e() {\n        for (; n.length - o;) {\n          try {\n            n[o]();\n          } catch (e) {\n            t.console && t.console.error(e);\n          }\n\n          n[o++] = i, o == r && (n.splice(0, r), o = 0);\n        }\n      }\n\n      var n = [],\n          o = 0,\n          r = 1024,\n          c = function () {\n        if (typeof MutationObserver !== s) {\n          var t = document.createElement(\"div\"),\n              n = new MutationObserver(e);\n          return n.observe(t, {\n            attributes: !0\n          }), function () {\n            t.setAttribute(\"a\", 0);\n          };\n        }\n\n        return typeof setImmediate !== s ? function () {\n          setImmediate(e);\n        } : function () {\n          setTimeout(e, 0);\n        };\n      }();\n\n      return function (t) {\n        n.push(t), n.length - o == 1 && c();\n      };\n    }();\n\n    e.prototype = {\n      resolve: function resolve(t) {\n        if (this.state === r) {\n          if (t === this) return this.reject(new TypeError(\"Attempt to resolve promise with self\"));\n          var e = this;\n          if (t && (\"function\" == typeof t || \"object\" == typeof t)) try {\n            var o = !0,\n                i = t.then;\n            if (\"function\" == typeof i) return void i.call(t, function (t) {\n              o && (o = !1, e.resolve(t));\n            }, function (t) {\n              o && (o = !1, e.reject(t));\n            });\n          } catch (u) {\n            return void (o && this.reject(u));\n          }\n          this.state = c, this.v = t, e.c && f(function () {\n            for (var o = 0, r = e.c.length; r > o; o++) {\n              n(e.c[o], t);\n            }\n          });\n        }\n      },\n      reject: function reject(n) {\n        if (this.state === r) {\n          this.state = u, this.v = n;\n          var i = this.c;\n          i ? f(function () {\n            for (var t = 0, e = i.length; e > t; t++) {\n              o(i[t], n);\n            }\n          }) : !e.suppressUncaughtRejectionError && t.console && t.console.log(\"You upset Zousan. Please catch rejections: \", n, n ? n.stack : null);\n        }\n      },\n      then: function then(t, i) {\n        var u = new e(),\n            s = {\n          y: t,\n          n: i,\n          p: u\n        };\n        if (this.state === r) this.c ? this.c.push(s) : this.c = [s];else {\n          var l = this.state,\n              a = this.v;\n          f(function () {\n            l === c ? n(s, a) : o(s, a);\n          });\n        }\n        return u;\n      },\n      \"catch\": function _catch(t) {\n        return this.then(null, t);\n      },\n      \"finally\": function _finally(t) {\n        return this.then(t, t);\n      },\n      timeout: function timeout(t, n) {\n        n = n || \"Timeout\";\n        var o = this;\n        return new e(function (e, r) {\n          setTimeout(function () {\n            r(Error(n));\n          }, t), o.then(function (t) {\n            e(t);\n          }, function (t) {\n            r(t);\n          });\n        });\n      }\n    }, e.resolve = function (t) {\n      var n = new e();\n      return n.resolve(t), n;\n    }, e.reject = function (t) {\n      var n = new e();\n      return n.reject(t), n;\n    }, e.all = function (t) {\n      function n(n, c) {\n        n && \"function\" == typeof n.then || (n = e.resolve(n)), n.then(function (e) {\n          o[c] = e, r++, r == t.length && i.resolve(o);\n        }, function (t) {\n          i.reject(t);\n        });\n      }\n\n      for (var o = [], r = 0, i = new e(), c = 0; c < t.length; c++) {\n        n(t[c], c);\n      }\n\n      return t.length || i.resolve(o), i;\n    }, module.exports && (module.exports = e), t.define && t.define.amd && t.define([], function () {\n      return e;\n    }), t.Zousan = e, e.soon = f;\n  }(\"undefined\" != typeof commonjsGlobal ? commonjsGlobal : commonjsGlobal);\n});\nvar promise;\n\nif (typeof Promise !== 'undefined') {\n  promise = Promise;\n} else {\n  promise = zousanMin;\n}\n\nvar Promise$1 = promise;\n\nvar Eventable = function Eventable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.on = function on$$1(eventsOn, handler, context) {\n      if (!eventsOn) {\n        return this;\n      }\n\n      if (!isString(eventsOn)) {\n        return this._switch('on', eventsOn, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      if (!this._eventMap) {\n        this._eventMap = {};\n      }\n\n      var eventTypes = eventsOn.toLowerCase().split(' ');\n      var evtType;\n\n      if (!context) {\n        context = this;\n      }\n\n      var handlerChain;\n\n      for (var ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n        evtType = eventTypes[ii];\n        handlerChain = this._eventMap[evtType];\n\n        if (!handlerChain) {\n          handlerChain = [];\n          this._eventMap[evtType] = handlerChain;\n        }\n\n        var l = handlerChain.length;\n\n        if (l > 0) {\n          for (var i = 0; i < l; i++) {\n            if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n              return this;\n            }\n          }\n        }\n\n        handlerChain.push({\n          handler: handler,\n          context: context\n        });\n      }\n\n      return this;\n    };\n\n    _proto.addEventListener = function addEventListener() {\n      return this.on.apply(this, arguments);\n    };\n\n    _proto.once = function once(eventTypes, handler, context) {\n      if (!isString(eventTypes)) {\n        var once = {};\n\n        for (var p in eventTypes) {\n          if (eventTypes.hasOwnProperty(p)) {\n            once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n          }\n        }\n\n        return this._switch('on', once);\n      }\n\n      var evetTypes = eventTypes.split(' ');\n\n      for (var i = 0, l = evetTypes.length; i < l; i++) {\n        this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n      }\n\n      return this;\n    };\n\n    _proto.off = function off$$1(eventsOff, handler, context) {\n      if (!this._eventMap || !eventsOff) {\n        return this;\n      }\n\n      if (!isString(eventsOff)) {\n        return this._switch('off', eventsOff, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      var eventTypes = eventsOff.split(' ');\n      var eventType, listeners, wrapKey;\n\n      if (!context) {\n        context = this;\n      }\n\n      for (var j = 0, jl = eventTypes.length; j < jl; j++) {\n        eventType = eventTypes[j].toLowerCase();\n        wrapKey = 'Z__' + eventType;\n        listeners = this._eventMap[eventType];\n\n        if (!listeners) {\n          return this;\n        }\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n          var listener = listeners[i];\n\n          if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n            delete listener.handler[wrapKey];\n            listeners.splice(i, 1);\n          }\n        }\n\n        if (!listeners.length) {\n          delete this._eventMap[eventType];\n        }\n      }\n\n      return this;\n    };\n\n    _proto.removeEventListener = function removeEventListener() {\n      return this.off.apply(this, arguments);\n    };\n\n    _proto.listens = function listens(eventType, handler, context) {\n      if (!this._eventMap || !isString(eventType)) {\n        return 0;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain || !handlerChain.length) {\n        return 0;\n      }\n\n      if (!handler) {\n        return handlerChain.length;\n      }\n\n      for (var i = 0, len = handlerChain.length; i < len; i++) {\n        if (handler === handlerChain[i].handler && (isNil(context) || handlerChain[i].context === context)) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n\n    _proto.getListeningEvents = function getListeningEvents() {\n      if (!this._eventMap) {\n        return [];\n      }\n\n      return Object.keys(this._eventMap);\n    };\n\n    _proto.copyEventListeners = function copyEventListeners(target) {\n      var eventMap = target._eventMap;\n\n      if (!eventMap) {\n        return this;\n      }\n\n      var handlerChain;\n\n      for (var eventType in eventMap) {\n        handlerChain = eventMap[eventType];\n\n        for (var i = 0, len = handlerChain.length; i < len; i++) {\n          this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto.fire = function fire() {\n      if (this._eventParent) {\n        return this._eventParent.fire.apply(this._eventParent, arguments);\n      }\n\n      return this._fire.apply(this, arguments);\n    };\n\n    _proto._wrapOnceHandler = function _wrapOnceHandler(evtType, handler, context) {\n      var me = this;\n      var key = 'Z__' + evtType;\n      var called = false;\n\n      var fn = function onceHandler() {\n        if (called) {\n          return;\n        }\n\n        delete fn[key];\n        called = true;\n\n        if (context) {\n          handler.apply(context, arguments);\n        } else {\n          handler.apply(this, arguments);\n        }\n\n        me.off(evtType, onceHandler, this);\n      };\n\n      fn[key] = handler;\n      return fn;\n    };\n\n    _proto._switch = function _switch(to, eventKeys, context) {\n      for (var p in eventKeys) {\n        if (eventKeys.hasOwnProperty(p)) {\n          this[to](p, eventKeys[p], context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto._clearListeners = function _clearListeners(eventType) {\n      if (!this._eventMap || !isString(eventType)) {\n        return;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return;\n      }\n\n      this._eventMap[eventType] = null;\n    };\n\n    _proto._clearAllListeners = function _clearAllListeners() {\n      this._eventMap = null;\n    };\n\n    _proto._setEventParent = function _setEventParent(parent) {\n      this._eventParent = parent;\n      return this;\n    };\n\n    _proto._setEventTarget = function _setEventTarget(target) {\n      this._eventTarget = target;\n      return this;\n    };\n\n    _proto._fire = function _fire(eventType, param) {\n      if (!this._eventMap) {\n        return this;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return this;\n      }\n\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventType;\n      param['target'] = this._eventTarget || this;\n      var queue = handlerChain.slice(0);\n      var context, bubble, passed;\n\n      for (var i = 0, len = queue.length; i < len; i++) {\n        if (!queue[i]) {\n          continue;\n        }\n\n        context = queue[i].context;\n        bubble = true;\n        passed = extend({}, param);\n\n        if (context) {\n          bubble = queue[i].handler.call(context, passed);\n        } else {\n          bubble = queue[i].handler(passed);\n        }\n\n        if (bubble === false) {\n          if (param['domEvent']) {\n            stopPropagation(param['domEvent']);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar Handler = function () {\n  function Handler(target) {\n    this.target = target;\n  }\n\n  var _proto = Handler.prototype;\n\n  _proto.enable = function enable() {\n    if (this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n    this.addHooks();\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled) {\n      return this;\n    }\n\n    this._enabled = false;\n    this.removeHooks();\n    return this;\n  };\n\n  _proto.enabled = function enabled() {\n    return !!this._enabled;\n  };\n\n  _proto.remove = function remove() {\n    this.disable();\n    delete this.target;\n    delete this.dom;\n  };\n\n  return Handler;\n}();\n\nvar Handler$1 = Eventable(Handler);\n\nvar Class = function () {\n  function Class(options) {\n    if (!this || !this.setOptions) {\n      throw new Error('Class instance is being created without \"new\" operator.');\n    }\n\n    this.setOptions(options);\n    this.callInitHooks();\n  }\n\n  var _proto = Class.prototype;\n\n  _proto.callInitHooks = function callInitHooks() {\n    var proto = Object.getPrototypeOf(this);\n\n    this._visitInitHooks(proto);\n\n    return this;\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    if (!this.hasOwnProperty('options')) {\n      this.options = this.options ? Object.create(this.options) : {};\n    }\n\n    if (!options) {\n      return this;\n    }\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    return this;\n  };\n\n  _proto.config = function config(conf) {\n    if (!conf) {\n      var config = {};\n\n      for (var p in this.options) {\n        if (this.options.hasOwnProperty(p)) {\n          config[p] = this.options[p];\n        }\n      }\n\n      return config;\n    } else {\n      if (arguments.length === 2) {\n        var t = {};\n        t[conf] = arguments[1];\n        conf = t;\n      }\n\n      for (var i in conf) {\n        this.options[i] = conf[i];\n\n        if (this[i] && this[i] instanceof Handler$1) {\n          if (conf[i]) {\n            this[i].enable();\n          } else {\n            this[i].disable();\n          }\n        }\n      }\n\n      this.onConfig(conf);\n    }\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig() {};\n\n  _proto._visitInitHooks = function _visitInitHooks(proto) {\n    if (this._initHooksCalled) {\n      return;\n    }\n\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (parentProto._visitInitHooks) {\n      parentProto._visitInitHooks.call(this, parentProto);\n    }\n\n    this._initHooksCalled = true;\n    var hooks = proto._initHooks;\n\n    if (hooks && hooks !== parentProto._initHooks) {\n      for (var i = 0; i < hooks.length; i++) {\n        hooks[i].call(this);\n      }\n    }\n  };\n\n  Class.addInitHook = function addInitHook(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var init = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n      proto._initHooks = [];\n    }\n\n    proto._initHooks.push(init);\n\n    return this;\n  };\n\n  Class.include = function include() {\n    for (var i = 0; i < arguments.length; i++) {\n      extend(this.prototype, i < 0 || arguments.length <= i ? undefined : arguments[i]);\n    }\n\n    return this;\n  };\n\n  Class.mergeOptions = function mergeOptions(options) {\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto.options || proto.options === parentProto.options) {\n      proto.options = proto.options ? Object.create(proto.options) : {};\n    }\n\n    extend(proto.options, options);\n    return this;\n  };\n\n  return Class;\n}();\n\nvar registeredTypes = {};\n\nvar JSONAble = function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerJSONType = function registerJSONType(type) {\n      if (!type) {\n        return this;\n      }\n\n      registeredTypes[type] = this;\n      return this;\n    };\n\n    _class.getJSONClass = function getJSONClass(type) {\n      if (!type) {\n        return null;\n      }\n\n      return registeredTypes[type];\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getJSONType = function getJSONType() {\n      if (this._jsonType === undefined) {\n        var clazz = Object.getPrototypeOf(this).constructor;\n\n        for (var p in registeredTypes) {\n          if (registeredTypes[p] === clazz) {\n            this._jsonType = p;\n            break;\n          }\n        }\n      }\n\n      if (!this._jsonType) {\n        throw new Error('Found an unregistered geometry class!');\n      }\n\n      return this._jsonType;\n    };\n\n    return _class;\n  }(Base);\n};\n\nfunction Handlerable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.addHandler = function addHandler(name, handlerClass) {\n      if (!handlerClass) {\n        return this;\n      }\n\n      if (!this._handlers) {\n        this._handlers = [];\n      }\n\n      if (this[name]) {\n        this[name].enable();\n        return this;\n      }\n\n      var handler = this[name] = new handlerClass(this);\n\n      this._handlers.push(handler);\n\n      if (this.options[name]) {\n        handler.enable();\n      }\n\n      return this;\n    };\n\n    _proto.removeHandler = function removeHandler(name) {\n      if (!name) {\n        return this;\n      }\n\n      var handler = this[name];\n\n      if (handler) {\n        var hit = this._handlers.indexOf(handler);\n\n        if (hit >= 0) {\n          this._handlers.splice(hit, 1);\n        }\n\n        this[name].remove();\n        delete this[name];\n      }\n\n      return this;\n    };\n\n    _proto._clearHandlers = function _clearHandlers() {\n      for (var i = 0, len = this._handlers.length; i < len; i++) {\n        this._handlers[i].remove();\n      }\n\n      this._handlers = [];\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar START_EVENTS = 'touchstart mousedown';\nvar MOVE_EVENTS = {\n  mousedown: 'mousemove',\n  touchstart: 'touchmove',\n  pointerdown: 'touchmove',\n  MSPointerDown: 'touchmove'\n};\nvar END_EVENTS = {\n  mousedown: 'mouseup',\n  touchstart: 'touchend',\n  pointerdown: 'touchend',\n  MSPointerDown: 'touchend'\n};\n\nvar DragHandler = function (_Handler) {\n  _inheritsLoose(DragHandler, _Handler);\n\n  function DragHandler(dom, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _Handler.call(this, null) || this;\n    _this.dom = dom;\n    _this.options = options;\n    return _this;\n  }\n\n  var _proto = DragHandler.prototype;\n\n  _proto.enable = function enable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._onMouseDown = function (e) {\n      return this.onMouseDown(e);\n    };\n\n    on(this.dom, START_EVENTS, this._onMouseDown, this);\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._offEvents();\n\n    off(this.dom, START_EVENTS, this._onMouseDown);\n    delete this._onMouseDown;\n    return this;\n  };\n\n  _proto.onMouseDown = function onMouseDown(event) {\n    if (!this.options['rightclick'] && event.button === 2) {\n      return;\n    }\n\n    if (event.touches && event.touches.length > 1) {\n      return;\n    }\n\n    if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n      return;\n    }\n\n    var dom = this.dom;\n\n    if (dom.setCapture) {\n      dom.setCapture();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n\n    dom['ondragstart'] = function () {\n      return false;\n    };\n\n    delete this.moved;\n    var actual = event.touches ? event.touches[0] : event;\n    this.startPos = new Point(actual.clientX, actual.clientY);\n    on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n    on(document, END_EVENTS[event.type], this.onMouseUp, this);\n\n    if (!this.options['ignoreMouseleave']) {\n      on(this.dom, 'mouseleave', this.onMouseUp, this);\n    }\n\n    this.fire('mousedown', {\n      'domEvent': event,\n      'mousePos': new Point(actual.clientX, actual.clientY)\n    });\n  };\n\n  _proto.onMouseMove = function onMouseMove(event) {\n    if (event.touches && event.touches.length > 1) {\n      if (this.moved) {\n        this.interupted = true;\n        this.onMouseUp(event);\n      }\n\n      return;\n    }\n\n    var actual = event.touches ? event.touches[0] : event;\n    var newPos = new Point(actual.clientX, actual.clientY),\n        offset = newPos.sub(this.startPos);\n\n    if (!offset.x && !offset.y) {\n      return;\n    }\n\n    if (!this.moved) {\n      this.fire('dragstart', {\n        'domEvent': event,\n        'mousePos': this.startPos.copy()\n      });\n      this.moved = true;\n    } else {\n      this.fire('dragging', {\n        'domEvent': event,\n        'mousePos': new Point(actual.clientX, actual.clientY)\n      });\n    }\n  };\n\n  _proto.onMouseUp = function onMouseUp(event) {\n    var actual = event.changedTouches ? event.changedTouches[0] : event;\n\n    this._offEvents();\n\n    var param = {\n      'domEvent': event\n    };\n\n    if (isNumber(actual.clientX)) {\n      param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n    }\n\n    if (this.moved) {\n      param.interupted = this.interupted;\n      this.fire('dragend', param);\n      delete this.interupted;\n      delete this.moved;\n    }\n\n    this.fire('mouseup', param);\n  };\n\n  _proto._offEvents = function _offEvents() {\n    var dom = this.dom;\n    off(dom, 'mouseleave', this.onMouseUp, this);\n\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\n      return;\n    }\n\n    for (var i in MOVE_EVENTS) {\n      off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n      off(document, END_EVENTS[i], this.onMouseUp, this);\n    }\n\n    if (dom['releaseCapture']) {\n      dom['releaseCapture']();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n  };\n\n  return DragHandler;\n}(Handler$1);\n\nvar Coordinate = function (_Position) {\n  _inheritsLoose(Coordinate, _Position);\n\n  function Coordinate() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  Coordinate.toNumberArrays = function toNumberArrays(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return [coordinates.x, coordinates.y];\n    }\n\n    return forEachCoord(coordinates, function (coord) {\n      return [coord.x, coord.y];\n    });\n  };\n\n  Coordinate.toCoordinates = function toCoordinates(coordinates) {\n    if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n      return new Coordinate(coordinates);\n    }\n\n    var result = [];\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var child = coordinates[i];\n\n      if (Array.isArray(child)) {\n        if (isNumber(child[0])) {\n          result.push(new Coordinate(child));\n        } else {\n          result.push(Coordinate.toCoordinates(child));\n        }\n      } else {\n        result.push(new Coordinate(child));\n      }\n    }\n\n    return result;\n  };\n\n  return Coordinate;\n}(Position);\n\nvar CRS = function () {\n  function CRS(type, properties) {\n    this.type = type;\n    this.properties = properties;\n  }\n\n  CRS.createProj4 = function createProj4(proj) {\n    return new CRS('proj4', {\n      'proj': proj\n    });\n  };\n\n  CRS.fromProjectionCode = function fromProjectionCode(code) {\n    if (!code) {\n      return null;\n    }\n\n    code = code.toUpperCase().replace(':', '');\n    return CRS[code] || null;\n  };\n\n  return CRS;\n}();\n\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\nCRS.EPSG4326 = CRS.WGS84;\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\nCRS.EPSG4490 = CRS.CGCS2000;\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\nvar TEMP_POINT0 = new Point(0, 0);\nvar TEMP_COORD0 = new Coordinate(0, 0);\nvar TEMP_COORD1 = new Coordinate(0, 0);\nvar TEMP_COORD2 = new Coordinate(0, 0);\nvar TEMP_COORD3 = new Coordinate(0, 0);\nvar TEMP_COORD4 = new Coordinate(0, 0);\nvar TEMP_COORD5 = new Coordinate(0, 0);\nvar TEMP_COORD6 = new Coordinate(0, 0);\nvar TEMP_COORD7 = new Coordinate(0, 0);\nvar MINMAX = [];\nvar TEMP_EXTENT;\nvar TEMP_COMBINE = [];\n\nvar Extent = function () {\n  function Extent(p1, p2, p3, p4) {\n    this._clazz = Coordinate;\n    var l = arguments.length;\n    var proj = l > 0 ? arguments[l - 1] : null;\n\n    if (proj && proj.unproject) {\n      this.projection = arguments[l - 1];\n    }\n\n    this._dirty = true;\n\n    this._initialize(p1, p2, p3, p4);\n  }\n\n  var _proto = Extent.prototype;\n\n  _proto._initialize = function _initialize(p1, p2, p3, p4) {\n    this.xmin = null;\n    this.xmax = null;\n    this.ymin = null;\n    this.ymax = null;\n\n    if (isNil(p1)) {\n      return;\n    }\n\n    var projection = this.projection;\n\n    if (isNumber(p1) && isNumber(p2) && isNumber(p3) && isNumber(p4)) {\n      if (projection) {\n        this.set(p1, p2, p3, p4);\n      } else {\n        this.set(Math.min(p1, p3), Math.min(p2, p4), Math.max(p1, p3), Math.max(p2, p4));\n      }\n\n      return;\n    } else if (Array.isArray(p1)) {\n      if (projection) {\n        this.set(p1[0], p1[1], p1[2], p1[3]);\n      } else {\n        this.set(Math.min(p1[0], p1[2]), Math.min(p1[1], p1[3]), Math.max(p1[0], p1[2]), Math.max(p1[1], p1[3]));\n      }\n    } else if (isNumber(p1.x) && isNumber(p2.x) && isNumber(p1.y) && isNumber(p2.y)) {\n      if (projection) {\n        this.set(p1.x, p1.y, p2.x, p2.y);\n      } else {\n        if (p1.x > p2.x) {\n          this['xmin'] = p2.x;\n          this['xmax'] = p1.x;\n        } else {\n          this['xmin'] = p1.x;\n          this['xmax'] = p2.x;\n        }\n\n        if (p1.y > p2.y) {\n          this['ymin'] = p2.y;\n          this['ymax'] = p1.y;\n        } else {\n          this['ymin'] = p1.y;\n          this['ymax'] = p2.y;\n        }\n      }\n    } else if (isNumber(p1['xmin']) && isNumber(p1['xmax']) && isNumber(p1['ymin']) && isNumber(p1['ymax'])) {\n      this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n    }\n  };\n\n  _proto._add = function _add(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] += p.x;\n      this['ymin'] += p.y;\n      this['xmax'] += p.x;\n      this['ymax'] += p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] += p.xmin;\n      this['ymin'] += p.ymin;\n      this['xmax'] += p.xmax;\n      this['ymax'] += p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] += p[0];\n      this['ymin'] += p[1];\n      this['xmax'] += p[0];\n      this['ymax'] += p[1];\n    }\n\n    return this;\n  };\n\n  _proto.add = function add() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._add.apply(e, arguments);\n  };\n\n  _proto._scale = function _scale(s) {\n    this._dirty = true;\n    this['xmin'] *= s;\n    this['ymin'] *= s;\n    this['xmax'] *= s;\n    this['ymax'] *= s;\n    return this;\n  };\n\n  _proto._sub = function _sub(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] -= p.x;\n      this['ymin'] -= p.y;\n      this['xmax'] -= p.x;\n      this['ymax'] -= p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] -= p.xmin;\n      this['ymin'] -= p.ymin;\n      this['xmax'] -= p.xmax;\n      this['ymax'] -= p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] -= p[0];\n      this['ymin'] -= p[1];\n      this['xmax'] -= p[0];\n      this['ymax'] -= p[1];\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._sub.apply(e, arguments);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']), Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n  };\n\n  _proto._round = function _round() {\n    this._dirty = true;\n    this['xmin'] = Math.round(this['xmin']);\n    this['ymin'] = Math.round(this['ymin']);\n    this['xmax'] = Math.round(this['xmax']);\n    this['ymax'] = Math.round(this['ymax']);\n    return this;\n  };\n\n  _proto.getMin = function getMin(out) {\n    if (out) {\n      out.set(this['xmin'], this['ymin']);\n      return out;\n    }\n\n    return new this._clazz(this['xmin'], this['ymin']);\n  };\n\n  _proto.getMax = function getMax(out) {\n    if (out) {\n      out.set(this['xmax'], this['ymax']);\n      return out;\n    }\n\n    return new this._clazz(this['xmax'], this['ymax']);\n  };\n\n  _proto.getCenter = function getCenter(out) {\n    var x = (this['xmin'] + this['xmax']) / 2;\n    var y = (this['ymin'] + this['ymax']) / 2;\n\n    if (out) {\n      out.set(x, y);\n      return out;\n    }\n\n    return new this._clazz(x, y);\n  };\n\n  _proto.isValid = function isValid() {\n    return !isNil(this['xmin']) && !isNil(this['ymin']) && !isNil(this['xmax']) && !isNil(this['ymax']);\n  };\n\n  _proto.equals = function equals(ext2) {\n    return this['xmin'] === ext2['xmin'] && this['xmax'] === ext2['xmax'] && this['ymin'] === ext2['ymin'] && this['ymax'] === ext2['ymax'];\n  };\n\n  _proto.intersects = function intersects(ext2) {\n    this._project(this);\n\n    this._project(ext2);\n\n    var rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n    var rymin = Math.max(this['pymin'], ext2['pymin']);\n    var rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n    var rymax = Math.min(this['pymax'], ext2['pymax']);\n    var intersects = !(rxmin > rxmax || rymin > rymax);\n    return intersects;\n  };\n\n  _proto.within = function within(extent) {\n    this._project(this);\n\n    this._project(extent);\n\n    return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n  };\n\n  _proto.contains = function contains(c) {\n    if (!c) {\n      return false;\n    }\n\n    this._project(this);\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (c.x !== undefined) {\n        var coord = TEMP_COORD0;\n\n        if (Array.isArray(c)) {\n          coord.x = c[0];\n          coord.y = c[1];\n        } else {\n          coord.x = c.x;\n          coord.y = c.y;\n        }\n\n        c = proj.project(coord, coord);\n      } else if (c.xmin !== undefined) {\n        this._project(c);\n      }\n    }\n\n    return (c.x || c.pxmin || 0) >= this.pxmin && (c.x || c.pxmax || 0) <= this.pxmax && (c.y || c.pymin || 0) >= this.pymin && (c.y || c.pymax || 0) <= this.pymax;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return Math.abs(this['xmax'] - this['xmin']);\n  };\n\n  _proto.getHeight = function getHeight() {\n    return Math.abs(this['ymax'] - this['ymin']);\n  };\n\n  _proto.getSize = function getSize() {\n    return new Size(this.getWidth(), this.getHeight());\n  };\n\n  _proto.set = function set(xmin, ymin, xmax, ymax) {\n    this.xmin = xmin;\n    this.ymin = ymin;\n    this.xmax = xmax;\n    this.ymax = ymax;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.__combine = function __combine(extent) {\n    if (extent.x !== undefined) {\n      TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n      TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n      extent = TEMP_EXTENT;\n    }\n\n    this._project(extent);\n\n    this._project(this);\n\n    var inited = isNumber(this.pxmin);\n    var xmin, ymin, xmax, ymax;\n\n    if (!inited) {\n      xmin = extent['pxmin'];\n      ymin = extent['pymin'];\n      xmax = extent['pxmax'];\n      ymax = extent['pymax'];\n    } else {\n      xmin = Math.min(this['pxmin'], extent['pxmin']);\n      ymin = Math.min(this['pymin'], extent['pymin']);\n      xmax = Math.max(this['pxmax'], extent['pxmax']);\n      ymax = Math.max(this['pymax'], extent['pymax']);\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      TEMP_COORD1.set(xmin, ymin);\n      TEMP_COORD2.set(xmax, ymax);\n      var min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n          max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n      xmin = min.x;\n      ymin = min.y;\n      xmax = max.x;\n      ymax = max.y;\n    }\n\n    TEMP_COMBINE[0] = xmin;\n    TEMP_COMBINE[1] = ymin;\n    TEMP_COMBINE[2] = xmax;\n    TEMP_COMBINE[3] = ymax;\n    return TEMP_COMBINE;\n  };\n\n  _proto._combine = function _combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    this.set(ext[0], ext[1], ext[2], ext[3]);\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.combine = function combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n  };\n\n  _proto.intersection = function intersection(extent) {\n    if (!this.intersects(extent)) {\n      return null;\n    }\n\n    TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n    TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n    TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n    TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n    var min = TEMP_COORD3,\n        max = TEMP_COORD4;\n    var proj = this.projection;\n\n    if (proj) {\n      min = proj.unproject(min, min);\n      max = proj.unproject(max, max);\n    }\n\n    return new this.constructor(min, max, proj);\n  };\n\n  _proto.expand = function expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n  };\n\n  _proto._expand = function _expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    this['xmin'] -= w;\n    this['ymin'] -= h;\n    this['xmax'] += w;\n    this['ymax'] += h;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'xmin': this['xmin'],\n      'ymin': this['ymin'],\n      'xmax': this['xmax'],\n      'ymax': this['ymax']\n    };\n  };\n\n  _proto.toArray = function toArray() {\n    var xmin = this['xmin'],\n        ymin = this['ymin'],\n        xmax = this['xmax'],\n        ymax = this['ymax'];\n    return [new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]), new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]), new this._clazz([xmin, ymax])];\n  };\n\n  _proto.toString = function toString() {\n    return this.xmin + \",\" + this.ymin + \",\" + this.xmax + \",\" + this.ymax;\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n  };\n\n  _proto.convertTo = function convertTo(fn, out) {\n    if (!this.isValid()) {\n      return null;\n    }\n\n    var e = out || new this.constructor();\n\n    if (out) {\n      e.set(null, null, null, null);\n    }\n\n    var coord;\n\n    if (this._clazz === Coordinate) {\n      coord = TEMP_COORD5;\n    } else if (this._clazz === Point) {\n      coord = TEMP_POINT0;\n    }\n\n    coord.x = this.xmin;\n    coord.y = this.ymax;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmax;\n\n    e._combine(fn(coord));\n\n    coord.y = this.ymin;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmin;\n\n    e._combine(fn(coord));\n\n    return e;\n  };\n\n  _proto._project = function _project(ext) {\n    if (!ext || !ext.isValid()) {\n      if (ext) {\n        ext.pxmin = ext.pxmax = ext.pymin = ext.pymax = null;\n      }\n\n      return;\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (ext._dirty) {\n        TEMP_COORD6.set(ext.xmax, ext.ymin);\n        TEMP_COORD7.set(ext.xmin, ext.ymax);\n        MINMAX[0] = TEMP_COORD6;\n        MINMAX[1] = TEMP_COORD7;\n        var minmax = proj.projectCoords(MINMAX);\n        var min = minmax[0],\n            max = minmax[1];\n        ext.pxmin = Math.min(min.x, max.x);\n        ext.pymin = Math.min(min.y, max.y);\n        ext.pxmax = Math.max(min.x, max.x);\n        ext.pymax = Math.max(min.y, max.y);\n      }\n\n      delete ext._dirty;\n    } else {\n      ext.pxmin = ext.xmin;\n      ext.pxmax = ext.xmax;\n      ext.pymin = ext.ymin;\n      ext.pymax = ext.ymax;\n    }\n  };\n\n  return Extent;\n}();\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nvar PointExtent = function (_Extent) {\n  _inheritsLoose(PointExtent, _Extent);\n\n  function PointExtent(p1, p2, p3, p4) {\n    var _this;\n\n    _this = _Extent.call(this, p1, p2, p3, p4) || this;\n    _this._clazz = Point;\n    return _this;\n  }\n\n  return PointExtent;\n}(Extent);\n\nvar Transformation = function () {\n  function Transformation(matrix) {\n    this.matrix = matrix;\n  }\n\n  var _proto = Transformation.prototype;\n\n  _proto.transform = function transform(coordinates, scale, out) {\n    var x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n    var y = -this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.untransform = function untransform(point, scale, out) {\n    var x = point.x * scale / this.matrix[0] + this.matrix[2];\n    var y = point.y * scale / -this.matrix[1] + this.matrix[3];\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  };\n\n  return Transformation;\n}();\n\nvar Common = {\n  project: function project() {},\n  unproject: function unproject() {},\n  projectCoords: function projectCoords(coordinates) {\n    var _this = this;\n\n    if (!coordinates) {\n      return [];\n    }\n\n    if (!Array.isArray(coordinates)) {\n      return this.project(coordinates);\n    }\n\n    if (coordinates.length === 0) {\n      return [];\n    }\n\n    if (!this.isSphere()) {\n      return forEachCoord(coordinates, this.project, this);\n    }\n\n    if (Array.isArray(coordinates[0])) {\n      return coordinates.map(function (coords) {\n        return _this.projectCoords(coords);\n      });\n    } else {\n      var circum = this.getCircum();\n      var extent = this.getSphereExtent(),\n          sx = extent.sx,\n          sy = extent.sy;\n      var wrapX, wrapY;\n      var pre = coordinates[0],\n          current,\n          dx,\n          dy,\n          p;\n      var prj = [this.project(pre)];\n\n      for (var i = 1, l = coordinates.length; i < l; i++) {\n        current = coordinates[i];\n        dx = current.x - pre.x;\n        dy = current.y - pre.y;\n        p = this.project(current);\n\n        if (Math.abs(dx) > 180) {\n          if (wrapX === undefined) {\n            wrapX = current.x > pre.x;\n          }\n\n          if (wrapX) {\n            p._add(-circum.x * sign(dx) * sx, 0);\n\n            current._add(-360 * sign(dx), 0);\n          }\n        }\n\n        if (Math.abs(dy) > 90) {\n          if (wrapY === undefined) {\n            wrapY = current.y < pre.y;\n          }\n\n          if (wrapY) {\n            p._add(0, -circum.y * sign(dy) * sy);\n\n            current._add(0, -180 * sign(dy));\n          }\n        }\n\n        pre = current;\n        prj.push(p);\n      }\n\n      return prj;\n    }\n  },\n  unprojectCoords: function unprojectCoords(projCoords) {\n    if (!projCoords) {\n      return [];\n    }\n\n    if (!Array.isArray(projCoords)) {\n      return this.unproject(projCoords);\n    }\n\n    return forEachCoord(projCoords, this.unproject, this);\n  },\n  isSphere: function isSphere() {\n    return !!this.sphere;\n  },\n  isOutSphere: function isOutSphere(pcoord) {\n    if (!this.isSphere()) {\n      return false;\n    }\n\n    var extent = this.getSphereExtent();\n    return !extent.contains(pcoord);\n  },\n  wrapCoord: function wrapCoord(pcoord) {\n    if (!this.isSphere()) {\n      return pcoord;\n    }\n\n    var extent = this.getSphereExtent();\n    var wrapped = new Coordinate(pcoord);\n\n    if (!extent.contains(wrapped)) {\n      wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n      wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n    }\n\n    return wrapped;\n  },\n  getCircum: function getCircum() {\n    if (!this.circum && this.isSphere()) {\n      var extent = this.getSphereExtent();\n      this.circum = {\n        x: extent.getWidth(),\n        y: extent.getHeight()\n      };\n    }\n\n    return this.circum;\n  },\n  getSphereExtent: function getSphereExtent() {\n    if (!this.extent && this.isSphere()) {\n      var max = this.project(new Coordinate(180, 90)),\n          min = this.project(new Coordinate(-180, -90));\n      this.extent = new Extent(min, max, this);\n      this.extent.sx = max.x > min.x ? 1 : -1;\n      this.extent.sy = max.y > min.y ? 1 : -1;\n    }\n\n    return this.extent;\n  }\n};\nvar Common$1 = {\n  measureLength: function measureLength(c1, c2) {\n    if (!Array.isArray(c1)) {\n      return this.measureLenBetween(c1, c2);\n    }\n\n    var len = 0;\n\n    for (var i = 0, l = c1.length; i < l - 1; i++) {\n      len += this.measureLenBetween(c1[i], c1[i + 1]);\n    }\n\n    return len;\n  }\n};\nvar Identity = extend({\n  'measure': 'IDENTITY',\n  measureLenBetween: function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    try {\n      return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n    } catch (err) {\n      return 0;\n    }\n  },\n  measureArea: function measureArea(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return 0;\n    }\n\n    var area = 0;\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var c1 = coordinates[i];\n      var c2 = null;\n\n      if (i === len - 1) {\n        c2 = coordinates[0];\n      } else {\n        c2 = coordinates[i + 1];\n      }\n\n      area += c1.x * c2.y - c1.y * c2.x;\n    }\n\n    return Math.abs(area / 2);\n  },\n  locate: function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  },\n  _locate: function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    c.x = c.x + xDist;\n    c.y = c.y + yDist;\n    return c;\n  },\n  rotate: function rotate(c, pivot, angle) {\n    c = new Coordinate(c.x, c.y);\n    return this._rotate(c, pivot, angle);\n  },\n  _rotate: function () {\n    var tmp = new Point(0, 0);\n    return function (c, pivot, angle) {\n      tmp.x = c.x - pivot.x;\n      tmp.y = c.y - pivot.y;\n\n      tmp._rotate(angle * Math.PI / 180);\n\n      c.x = pivot.x + tmp.x;\n      c.y = pivot.y + tmp.y;\n      return c;\n    };\n  }()\n}, Common$1);\n\nvar Sphere = function () {\n  function Sphere(radius) {\n    this.radius = radius;\n  }\n\n  var _proto = Sphere.prototype;\n\n  _proto.measureLenBetween = function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    var b = toRadian(c1.y);\n    var d = toRadian(c2.y),\n        e = b - d,\n        f = toRadian(c1.x) - toRadian(c2.x);\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n    b *= this.radius;\n    return Math.round(b * 1E5) / 1E5;\n  };\n\n  _proto.measureArea = function measureArea(coordinates) {\n    var a = toRadian(this.radius);\n    var b = 0,\n        c = coordinates,\n        d = c.length;\n\n    if (d < 3) {\n      return 0;\n    }\n\n    var i;\n\n    for (i = 0; i < d - 1; i++) {\n      var e = c[i],\n          f = c[i + 1];\n      b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n    }\n\n    d = c[i];\n    c = c[0];\n    b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n    return 0.5 * Math.abs(b);\n  };\n\n  _proto.locate = function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  };\n\n  _proto._locate = function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    var x, y;\n    var ry = toRadian(c.y);\n\n    if (yDist !== 0) {\n      var dy = Math.abs(yDist);\n      var sy = Math.sin(dy / (2 * this.radius)) * 2;\n      ry = ry + sy * (yDist > 0 ? 1 : -1);\n      y = wrap(ry * 180 / Math.PI, -90, 90);\n    } else {\n      y = c.y;\n    }\n\n    if (xDist !== 0) {\n      var dx = Math.abs(xDist);\n      var rx = toRadian(c.x);\n      var sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n      rx = rx + sx * (xDist > 0 ? 1 : -1);\n      x = wrap(rx * 180 / Math.PI, -180, 180);\n    } else {\n      x = c.x;\n    }\n\n    c.x = x;\n    c.y = y;\n    return c;\n  };\n\n  _proto.rotate = function rotate(c, pivot, angle) {\n    c = new Coordinate(c);\n    return this._rotate(c, pivot, angle);\n  };\n\n  _proto._rotate = function _rotate(c, pivot, angle) {\n    var initialAngle = rhumbBearing(pivot, c);\n    var finalAngle = initialAngle - angle;\n    var distance = this.measureLenBetween(pivot, c);\n    c.x = pivot.x;\n    c.y = pivot.y;\n    return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n  };\n\n  return Sphere;\n}();\n\nfunction rhumbBearing(start, end, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var bear360;\n  if (options.final) bear360 = calculateRhumbBearing(end, start);else bear360 = calculateRhumbBearing(start, end);\n  var bear180 = bear360 > 180 ? -(360 - bear360) : bear360;\n  return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n  var phi1 = toRadian(from.y);\n  var phi2 = toRadian(to.y);\n  var deltaLambda = toRadian(to.x - from.x);\n  if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n  if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n  var deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var theta = Math.atan2(deltaLambda, deltaPsi);\n  return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n  var delta = distance / radius;\n  var lambda1 = origin.x * Math.PI / 180;\n  var phi1 = toRadian(origin.y);\n  var theta = toRadian(bearing);\n  var DeltaPhi = delta * Math.cos(theta);\n  var phi2 = phi1 + DeltaPhi;\n  if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n  var DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1);\n  var DeltaLambda = delta * Math.sin(theta) / q;\n  var lambda2 = lambda1 + DeltaLambda;\n  origin.x = (lambda2 * 180 / Math.PI + 540) % 360 - 180;\n  origin.y = phi2 * 180 / Math.PI;\n  return origin;\n}\n\nvar WGS84Sphere = extend({\n  'measure': 'EPSG:4326',\n  sphere: new Sphere(6378137),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar BaiduSphere = extend({\n  'measure': 'BAIDU',\n  sphere: new Sphere(6370996.81),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar DEFAULT = WGS84Sphere;\nvar measurers = {};\n\nfunction registerMeasurer(m) {\n  measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\nvar Measurer = {\n  getInstance: function getInstance(name) {\n    if (!name) {\n      return DEFAULT;\n    }\n\n    for (var p in measurers) {\n      if (hasOwn(measurers, p)) {\n        var mName = measurers[p]['measure'];\n\n        if (!mName) {\n          continue;\n        }\n\n        if (name.toLowerCase() === mName.toLowerCase()) {\n          return measurers[p];\n        }\n      }\n    }\n\n    return null;\n  }\n};\nvar index$2 = /*#__PURE__*/Object.freeze({\n  Identity: Identity,\n  DEFAULT: DEFAULT,\n  Measurer: Measurer,\n  WGS84Sphere: WGS84Sphere,\n  BaiduSphere: BaiduSphere\n});\nvar delta = 1E-7;\nvar EPSG3857 = extend({}, Common, {\n  code: 'EPSG:3857',\n  rad: Math.PI / 180,\n  metersPerDegree: 6378137 * Math.PI / 180,\n  maxLatitude: 85.0511287798,\n  project: function project(lnglat, out) {\n    var rad = this.rad,\n        metersPerDegree = this.metersPerDegree,\n        max = this.maxLatitude;\n    var lng = lnglat.x,\n        lat = Math.max(Math.min(max, lnglat.y), -max);\n    var c;\n\n    if (lat === 0) {\n      c = 0;\n    } else {\n      c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n    }\n\n    var x = lng * metersPerDegree;\n    var y = c * metersPerDegree;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  },\n  unproject: function unproject(pLnglat, out) {\n    var rad = this.rad;\n    var metersPerDegree = this.metersPerDegree;\n    var x = pLnglat.x / metersPerDegree;\n    var y = pLnglat.y;\n    var c;\n\n    if (y === 0) {\n      c = 0;\n    } else {\n      c = y / metersPerDegree;\n      c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n    }\n\n    if (Math.abs(Math.abs(x) - 180) < delta) {\n      x = sign(x) * 180;\n    }\n\n    if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n      c = sign(c) * this.maxLatitude;\n    }\n\n    var rx = wrap(x, -180, 180);\n    var ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n\n    if (out) {\n      out.x = rx;\n      out.y = ry;\n      return out;\n    }\n\n    return new Coordinate(rx, ry);\n  }\n}, WGS84Sphere);\nvar PROJ4326 = extend({}, Common, {\n  code: 'EPSG:4326',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  }\n}, WGS84Sphere);\nvar Projection_EPSG4490 = extend({}, PROJ4326, {\n  code: 'EPSG:4490'\n});\nvar Projection_Baidu = extend({}, Common, {\n  code: 'BAIDU',\n  project: function project(p, out) {\n    return this.convertLL2MC(p, out);\n  },\n  unproject: function unproject(p, out) {\n    return this.convertMC2LL(p, out);\n  }\n}, BaiduSphere, {\n  EARTHRADIUS: 6370996.81,\n  MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n  LLBAND: [75, 60, 45, 30, 15, 0],\n  MC2LL: [[1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2], [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86], [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37], [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06], [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4], [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]],\n  LL2MC: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5], [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5], [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],\n  convertMC2LL: function convertMC2LL(cB, out) {\n    var cE;\n\n    for (var cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n      if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n        cE = this.MC2LL[cD];\n        break;\n      }\n    }\n\n    var T = this.convertor(cB, cE, out);\n    return T;\n  },\n  convertLL2MC: function convertLL2MC(T, out) {\n    var cD, cC, len;\n    T.x = this.getLoop(T.x, -180, 180);\n    T.y = this.getRange(T.y, -74, 74);\n    var cB = new Coordinate(T.x, T.y);\n\n    for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n      if (cB.y >= this.LLBAND[cC]) {\n        cD = this.LL2MC[cC];\n        break;\n      }\n    }\n\n    if (!cD) {\n      for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n        if (cB.y <= -this.LLBAND[cC]) {\n          cD = this.LL2MC[cC];\n          break;\n        }\n      }\n    }\n\n    var cE = this.convertor(T, cD, out);\n    return cE;\n  },\n  convertor: function convertor(cC, cD, out) {\n    if (!cC || !cD) {\n      return null;\n    }\n\n    var T = cD[0] + cD[1] * Math.abs(cC.x);\n    var cB = Math.abs(cC.y) / cD[9];\n    var cE = cD[2] + cD[3] * cB + cD[4] * cB * cB + cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB + cD[7] * cB * cB * cB * cB * cB + cD[8] * cB * cB * cB * cB * cB * cB;\n    T *= cC.x < 0 ? -1 : 1;\n    cE *= cC.y < 0 ? -1 : 1;\n\n    if (out) {\n      out.x = T;\n      out.y = cE;\n      return out;\n    }\n\n    return new Coordinate(T, cE);\n  },\n  toRadians: function toRadians(T) {\n    return Math.PI * T / 180;\n  },\n  toDegrees: function toDegrees(T) {\n    return 180 * T / Math.PI;\n  },\n  getRange: function getRange(cC, cB, T) {\n    if (cB != null) {\n      cC = Math.max(cC, cB);\n    }\n\n    if (T != null) {\n      cC = Math.min(cC, T);\n    }\n\n    return cC;\n  },\n  getLoop: function getLoop(cC, cB, T) {\n    if (cC === Infinity) {\n      return T;\n    } else if (cC === -Infinity) {\n      return cB;\n    }\n\n    while (cC > T) {\n      cC -= T - cB;\n    }\n\n    while (cC < cB) {\n      cC += T - cB;\n    }\n\n    return cC;\n  }\n});\nvar Projection_IDENTITY = extend({}, Common, {\n  code: 'IDENTITY',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  }\n}, Identity);\nvar DEFAULT$1 = EPSG3857;\nvar projections = /*#__PURE__*/Object.freeze({\n  EPSG3857: EPSG3857,\n  DEFAULT: DEFAULT$1,\n  EPSG4326: PROJ4326,\n  EPSG4490: Projection_EPSG4490,\n  BAIDU: Projection_Baidu,\n  IDENTITY: Projection_IDENTITY,\n  Common: Common\n});\n\nvar Renderable = function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerRenderer = function registerRenderer(name, clazz) {\n      var proto = this.prototype;\n      var parentProto = Object.getPrototypeOf(proto);\n\n      if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n        proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n      }\n\n      proto._rendererClasses[name.toLowerCase()] = clazz;\n      return this;\n    };\n\n    _class.getRendererClass = function getRendererClass(name) {\n      var proto = this.prototype;\n\n      if (!proto._rendererClasses) {\n        return null;\n      }\n\n      return proto._rendererClasses[name.toLowerCase()];\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar CanvasRenderer = function (_Class) {\n  _inheritsLoose(CanvasRenderer, _Class);\n\n  function CanvasRenderer(layer) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.layer = layer;\n    _this._painted = false;\n    _this._drawTime = 0;\n\n    _this.setToRedraw();\n\n    return _this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.render = function render(framestamp) {\n    this.prepareRender();\n\n    if (!this.getMap() || !this.layer.isVisible()) {\n      return;\n    }\n\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    this.checkAndDraw(this._tryToDraw, framestamp);\n  };\n\n  _proto.checkAndDraw = function checkAndDraw(drawFn) {\n    var _this2 = this;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.checkResources) {\n      var resources = this.checkResources();\n\n      if (resources.length > 0) {\n        this._loadingResource = true;\n        this.loadResources(resources).then(function () {\n          _this2._loadingResource = false;\n\n          if (_this2.layer) {\n            _this2.layer.fire('resourceload');\n\n            _this2.setToRedraw();\n          }\n        });\n      } else {\n        drawFn.call.apply(drawFn, [this].concat(args));\n      }\n    } else {\n      drawFn.call.apply(drawFn, [this].concat(args));\n    }\n  };\n\n  _proto.testIfNeedRedraw = function testIfNeedRedraw() {\n    var map = this.getMap();\n\n    if (this._loadingResource) {\n      return false;\n    }\n\n    if (this._toRedraw) {\n      return true;\n    }\n\n    if (map.isInteracting() && !this.drawOnInteracting) {\n      return false;\n    }\n\n    if (this.needToRedraw()) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() || map.getRenderer().isViewChanged()) {\n      return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n    }\n\n    return false;\n  };\n\n  _proto.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {};\n\n  _proto.isLoadingResource = function isLoadingResource() {\n    return this._loadingResource;\n  };\n\n  _proto.isRenderComplete = function isRenderComplete() {\n    return !!this._renderComplete;\n  };\n\n  _proto.mustRenderOnInteracting = function mustRenderOnInteracting() {\n    return !this._painted;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    this._toRedraw = true;\n    return this;\n  };\n\n  _proto.setCanvasUpdated = function setCanvasUpdated() {\n    this._canvasUpdated = true;\n    return this;\n  };\n\n  _proto.isCanvasUpdated = function isCanvasUpdated() {\n    return !!this._canvasUpdated;\n  };\n\n  _proto.remove = function remove() {\n    this.onRemove();\n    delete this._loadingResource;\n    delete this.southWest;\n    delete this.canvas;\n    delete this.context;\n    delete this.canvasExtent2D;\n    delete this._extent2D;\n    delete this.resources;\n    delete this.layer;\n  };\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.getMap = function getMap() {\n    if (!this.layer) {\n      return null;\n    }\n\n    return this.layer.getMap();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var map = this.getMap();\n    this._canvasUpdated = false;\n\n    if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n      return null;\n    }\n\n    if (this.isBlank()) {\n      return null;\n    }\n\n    if (this.layer.isEmpty && this.layer.isEmpty()) {\n      return null;\n    }\n\n    var containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    return {\n      'image': this.canvas,\n      'layer': this.layer,\n      'point': containerPoint\n    };\n  };\n\n  _proto.clear = function clear() {\n    this.clearCanvas();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this._painted) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.show = function show() {\n    this.setToRedraw();\n  };\n\n  _proto.hide = function hide() {\n    this.clear();\n    this.setToRedraw();\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    this.setToRedraw();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    if (!this.context || this.layer.isEmpty && this.layer.isEmpty() || this.isBlank() || this._errorThrown) {\n      return false;\n    }\n\n    var map = this.getMap();\n    var r = map.getDevicePixelRatio();\n    var size = map.getSize();\n\n    if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n      return false;\n    }\n\n    try {\n      var imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n\n      if (imgData[3] > 0) {\n        return true;\n      }\n    } catch (error) {\n      if (!this._errorThrown) {\n        if (console) {\n          console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n        }\n\n        this._errorThrown = true;\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  _proto.loadResources = function loadResources(resourceUrls) {\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    var resources = this.resources,\n        promises = [];\n\n    if (isArrayHasData(resourceUrls)) {\n      var cache = {};\n\n      for (var i = resourceUrls.length - 1; i >= 0; i--) {\n        var url = resourceUrls[i];\n\n        if (!url || !url.length || cache[url.join('-')]) {\n          continue;\n        }\n\n        cache[url.join('-')] = 1;\n\n        if (!resources.isResourceLoaded(url, true)) {\n          promises.push(new Promise$1(this._promiseResource(url)));\n        }\n      }\n    }\n\n    return Promise$1.all(promises);\n  };\n\n  _proto.prepareRender = function prepareRender() {\n    delete this._renderComplete;\n    var map = this.getMap();\n    this._renderZoom = map.getZoom();\n    this.canvasExtent2D = this._extent2D = map._get2DExtent();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this.canvas) {\n      return;\n    }\n\n    var map = this.getMap();\n    var size = map.getSize();\n    var r = map.getDevicePixelRatio(),\n        w = r * size.width,\n        h = r * size.height;\n\n    if (this.layer._canvas) {\n      var canvas = this.layer._canvas;\n      canvas.width = w;\n      canvas.height = h;\n\n      if (canvas.style) {\n        canvas.style.width = size.width + 'px';\n        canvas.style.height = size.height + 'px';\n      }\n\n      this.canvas = this.layer._canvas;\n    } else {\n      this.canvas = Canvas.createCanvas(w, h, map.CanvasClass);\n    }\n\n    this.onCanvasCreate();\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.createContext = function createContext() {\n    if (this.gl && this.gl.canvas === this.canvas || this.context) {\n      return;\n    }\n\n    this.context = this.canvas.getContext('2d');\n\n    if (!this.context) {\n      return;\n    }\n\n    if (this.layer.options['globalCompositeOperation']) {\n      this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  _proto.resetCanvasTransform = function resetCanvasTransform() {\n    if (!this.context) {\n      return;\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n    this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    var canvas = this.canvas;\n\n    if (!canvas) {\n      return;\n    }\n\n    var size = canvasSize || this.getMap().getSize();\n    var r = this.getMap().getDevicePixelRatio();\n\n    if (canvas.width === r * size.width && canvas.height === r * size.height) {\n      return;\n    }\n\n    canvas.height = r * size.height;\n    canvas.width = r * size.width;\n\n    if (r !== 1 && this.context) {\n      this.context.scale(r, r);\n    }\n\n    if (this.layer._canvas && canvas.style) {\n      canvas.style.width = size.width + 'px';\n      canvas.style.height = size.height + 'px';\n    }\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.context) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto.prepareCanvas = function prepareCanvas() {\n    if (!this.canvas) {\n      this.createCanvas();\n      this.createContext();\n      this.layer.onCanvasCreate();\n      this.layer.fire('canvascreate', {\n        'context': this.context,\n        'gl': this.gl\n      });\n    } else {\n      this.resetCanvasTransform();\n      this.clearCanvas();\n      this.resizeCanvas();\n    }\n\n    delete this._maskExtent;\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return null;\n    }\n\n    var maskExtent2D = this._maskExtent = mask._getMaskPainter().get2DExtent();\n\n    if (!maskExtent2D.intersects(this._extent2D)) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return maskExtent2D;\n    }\n\n    this.layer.fire('renderstart', {\n      'context': this.context,\n      'gl': this.gl\n    });\n    return maskExtent2D;\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      return false;\n    }\n\n    var old = this.southWest;\n    var map = this.getMap();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    context.save();\n    var dpr = map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      context.save();\n      context.scale(dpr, dpr);\n    }\n\n    if (mask.getGeometries) {\n      context.isMultiClip = true;\n      var masks = mask.getGeometries() || [];\n      context.beginPath();\n      masks.forEach(function (_mask) {\n        var painter = _mask._getMaskPainter();\n\n        painter.paint(null, context);\n      });\n      context.stroke();\n      delete context.isMultiClip;\n    } else {\n      var painter = mask._getMaskPainter();\n\n      painter.paint(null, context);\n    }\n\n    if (dpr !== 1) {\n      context.restore();\n    }\n\n    context.clip();\n    this.southWest = old;\n    return true;\n  };\n\n  _proto.getViewExtent = function getViewExtent() {\n    return {\n      'extent': this._extent2D,\n      'maskExtent': this._maskExtent,\n      'zoom': this._renderZoom,\n      'southWest': this.southWest\n    };\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this.getMap()) {\n      this._renderComplete = true;\n      this.layer.fire('renderend', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart': this.onZoomStart,\n      '_zooming': this.onZooming,\n      '_zoomend': this.onZoomEnd,\n      '_resize': this.onResize,\n      '_movestart': this.onMoveStart,\n      '_moving': this.onMoving,\n      '_moveend': this.onMoveEnd,\n      '_dragrotatestart': this.onDragRotateStart,\n      '_dragrotating': this.onDragRotating,\n      '_dragrotateend': this.onDragRotateEnd,\n      '_spatialreferencechange': this.onSpatialReferenceChange\n    };\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onResize = function onResize() {\n    delete this._extent2D;\n    this.resizeCanvas();\n    this.setToRedraw();\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart() {};\n\n  _proto.onDragRotating = function onDragRotating() {};\n\n  _proto.onDragRotateEnd = function onDragRotateEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onSpatialReferenceChange = function onSpatialReferenceChange() {};\n\n  _proto.getDrawTime = function getDrawTime() {\n    return this._drawTime;\n  };\n\n  _proto._tryToDraw = function _tryToDraw(framestamp) {\n    this._toRedraw = false;\n\n    if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n      this._renderComplete = true;\n      return;\n    }\n\n    this._drawAndRecord(framestamp);\n  };\n\n  _proto._drawAndRecord = function _drawAndRecord(framestamp) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var painted = this._painted;\n    this._painted = true;\n    var t = now();\n    this.draw(framestamp);\n    t = now() - t;\n    this._drawTime = painted ? t : t / 2;\n\n    if (painted && this.layer && this.layer.options['logDrawTime']) {\n      console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n    }\n  };\n\n  _proto._promiseResource = function _promiseResource(url) {\n    var me = this,\n        resources = this.resources,\n        crossOrigin = this.layer.options['crossOrigin'];\n    return function (resolve) {\n      if (resources.isResourceLoaded(url, true)) {\n        resolve(url);\n        return;\n      }\n\n      var img = new Image();\n\n      if (!isNil(crossOrigin)) {\n        img['crossOrigin'] = crossOrigin;\n      }\n\n      if (isSVG(url[0]) && !IS_NODE) {\n        if (url[1]) {\n          url[1] *= 2;\n        }\n\n        if (url[2]) {\n          url[2] *= 2;\n        }\n      }\n\n      img.onload = function () {\n        me._cacheResource(url, img);\n\n        resolve(url);\n      };\n\n      img.onabort = function (err) {\n        if (console) {\n          console.warn('image loading aborted: ' + url[0]);\n        }\n\n        if (err) {\n          if (console) {\n            console.warn(err);\n          }\n        }\n\n        resolve(url);\n      };\n\n      img.onerror = function (err) {\n        if (err && typeof console !== 'undefined') {\n          console.warn(err);\n        }\n\n        resources.markErrorResource(url);\n        resolve(url);\n      };\n\n      loadImage(img, url);\n    };\n  };\n\n  _proto._cacheResource = function _cacheResource(url, img) {\n    if (!this.layer || !this.resources) {\n      return;\n    }\n\n    var w = url[1],\n        h = url[2];\n\n    if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser$1.edge || Browser$1.ie)) {\n      if (isNil(w)) {\n        w = img.width || this.layer.options['defaultIconSize'][0];\n      }\n\n      if (isNil(h)) {\n        h = img.height || this.layer.options['defaultIconSize'][1];\n      }\n\n      var canvas = Canvas.createCanvas(w, h);\n      Canvas.image(canvas.getContext('2d'), img, 0, 0, w, h);\n      img = canvas;\n    }\n\n    this.resources.addResource(url, img);\n  };\n\n  return CanvasRenderer;\n}(Class);\n\nvar ResourceCache = function () {\n  function ResourceCache() {\n    this.resources = {};\n    this._errors = {};\n  }\n\n  var _proto2 = ResourceCache.prototype;\n\n  _proto2.addResource = function addResource(url, img) {\n    this.resources[url[0]] = {\n      image: img,\n      width: +url[1],\n      height: +url[2]\n    };\n  };\n\n  _proto2.isResourceLoaded = function isResourceLoaded(url, checkSVG) {\n    if (!url) {\n      return false;\n    }\n\n    var imgUrl = this._getImgUrl(url);\n\n    if (this._errors[imgUrl]) {\n      return true;\n    }\n\n    var img = this.resources[imgUrl];\n\n    if (!img) {\n      return false;\n    }\n\n    if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.getImage = function getImage(url) {\n    var imgUrl = this._getImgUrl(url);\n\n    if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n      return null;\n    }\n\n    return this.resources[imgUrl].image;\n  };\n\n  _proto2.markErrorResource = function markErrorResource(url) {\n    this._errors[this._getImgUrl(url)] = 1;\n  };\n\n  _proto2.merge = function merge(res) {\n    if (!res) {\n      return this;\n    }\n\n    for (var p in res.resources) {\n      var img = res.resources[p];\n      this.addResource([p, img.width, img.height], img.image);\n    }\n\n    return this;\n  };\n\n  _proto2.forEach = function forEach(fn) {\n    if (!this.resources) {\n      return this;\n    }\n\n    for (var p in this.resources) {\n      if (hasOwn(this.resources, p)) {\n        fn(p, this.resources[p]);\n      }\n    }\n\n    return this;\n  };\n\n  _proto2._getImgUrl = function _getImgUrl(url) {\n    if (!Array.isArray(url)) {\n      return url;\n    }\n\n    return url[0];\n  };\n\n  return ResourceCache;\n}();\n\nfunction clipLine(points, bounds, round, noCut) {\n  var parts = [];\n  var k = 0,\n      segment;\n\n  for (var j = 0, l = points.length; j < l - 1; j++) {\n    segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n    if (!segment) {\n      continue;\n    }\n\n    parts[k] = parts[k] || [];\n    parts[k].push({\n      'point': segment[0],\n      'index': j\n    });\n\n    if (segment[1] !== points[j + 1] || j === l - 2) {\n      parts[k].push({\n        'point': segment[1],\n        'index': j + 1\n      });\n      k++;\n    }\n  }\n\n  return parts;\n}\n\nvar _lastCode;\n\nfunction clipSegment(a, b, bounds, useLastCode, round, noCut) {\n  var codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n      codeB = _getBitCode(b, bounds),\n      codeOut,\n      p,\n      newCode;\n\n  _lastCode = codeB;\n\n  while (true) {\n    if (!(codeA | codeB)) {\n      return [a, b];\n    }\n\n    if (codeA & codeB) {\n      return false;\n    }\n\n    if (noCut) {\n      return [a, b];\n    }\n\n    codeOut = codeA || codeB;\n    p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n    newCode = _getBitCode(p, bounds);\n\n    if (codeOut === codeA) {\n      a = p;\n      codeA = newCode;\n    } else {\n      b = p;\n      codeB = newCode;\n    }\n  }\n}\n\nfunction clipPolygon(points, bounds, round) {\n  var edges = [1, 4, 2, 8];\n  var clippedPoints, i, j, k, a, b, len, edge, p;\n\n  for (i = 0, len = points.length; i < len; i++) {\n    points[i]._code = _getBitCode(points[i], bounds);\n  }\n\n  for (k = 0; k < 4; k++) {\n    edge = edges[k];\n    clippedPoints = [];\n\n    for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n      a = points[i];\n      b = points[j];\n\n      if (!(a._code & edge)) {\n        if (b._code & edge) {\n          p = _getEdgeIntersection(b, a, edge, bounds, round);\n          p._code = _getBitCode(p, bounds);\n          clippedPoints.push(p);\n        }\n\n        clippedPoints.push(a);\n      } else if (!(b._code & edge)) {\n        p = _getEdgeIntersection(b, a, edge, bounds, round);\n        p._code = _getBitCode(p, bounds);\n        clippedPoints.push(p);\n      }\n    }\n\n    points = clippedPoints;\n  }\n\n  return points;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      min = bounds.getMin(),\n      max = bounds.getMax();\n  var x, y;\n\n  if (code & 8) {\n    x = a.x + dx * (max.y - a.y) / dy;\n    y = max.y;\n  } else if (code & 4) {\n    x = a.x + dx * (min.y - a.y) / dy;\n    y = min.y;\n  } else if (code & 2) {\n    x = max.x;\n    y = a.y + dy * (max.x - a.x) / dx;\n  } else if (code & 1) {\n    x = min.x;\n    y = a.y + dy * (min.x - a.x) / dx;\n  }\n\n  var p = new Point(x, y);\n\n  if (round) {\n    p._round();\n  }\n\n  return p;\n}\n\nfunction _getBitCode(p, bounds) {\n  var code = 0;\n\n  if (p.x < bounds.getMin().x) {\n    code |= 1;\n  } else if (p.x > bounds.getMax().x) {\n    code |= 2;\n  }\n\n  if (p.y < bounds.getMin().y) {\n    code |= 4;\n  } else if (p.y > bounds.getMax().y) {\n    code |= 8;\n  }\n\n  return code;\n}\n\nfunction withInEllipse(point, center, southeast, tolerance) {\n  point = new Point(point);\n  var a = Math.abs(southeast.x - center.x),\n      b = Math.abs(southeast.y - center.y),\n      c = Math.sqrt(Math.abs(a * a - b * b)),\n      xfocus = a >= b;\n  var f1, f2, d;\n\n  if (xfocus) {\n    f1 = new Point(center.x - c, center.y);\n    f2 = new Point(center.x + c, center.y);\n    d = a * 2;\n  } else {\n    f1 = new Point(center.x, center.y - c);\n    f2 = new Point(center.x, center.y + c);\n    d = b * 2;\n  }\n\n  return point.distanceTo(f1) + point.distanceTo(f2) <= d + 2 * tolerance;\n}\n\nvar Symbolizer = function () {\n  function Symbolizer() {}\n\n  var _proto = Symbolizer.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getPainter = function getPainter() {\n    return this.painter;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    return false;\n  };\n\n  Symbolizer.testColor = function testColor(prop) {\n    if (!prop || !isString(prop)) {\n      return false;\n    }\n\n    if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return Symbolizer;\n}();\n\nvar CanvasSymbolizer = function (_Symbolizer) {\n  _inheritsLoose(CanvasSymbolizer, _Symbolizer);\n\n  function CanvasSymbolizer() {\n    return _Symbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext(ctx) {\n    if (isNumber(this.symbol['opacity'])) {\n      if (ctx.globalAlpha !== this.symbol['opacity']) {\n        ctx.globalAlpha = this.symbol['opacity'];\n      }\n    } else if (ctx.globalAlpha !== 1) {\n      ctx.globalAlpha = 1;\n    }\n  };\n\n  _proto.prepareCanvas = function prepareCanvas(ctx, style, resources) {\n    Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n  };\n\n  _proto.remove = function remove() {};\n\n  _proto.setZIndex = function setZIndex() {};\n\n  _proto.show = function show() {};\n\n  _proto.hide = function hide() {};\n\n  _proto._defineStyle = function _defineStyle(style) {\n    return function () {\n      var _this = this;\n\n      var arr = [],\n          prop = {};\n      return loadFunctionTypes(style, function () {\n        var map = _this.getMap();\n\n        return set$1(arr, map.getZoom(), extend({}, _this.geometry.getProperties(), setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())));\n      });\n    }.bind(this)();\n  };\n\n  return CanvasSymbolizer;\n}(Symbolizer);\n\nfunction set$1(arr, a0, a1) {\n  arr[0] = a0;\n  arr[1] = a1;\n  return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n  prop['{bearing}'] = b;\n  prop['{pitch}'] = p;\n  prop['{zoom}'] = z;\n  return prop;\n}\n\nvar TEMP_POINT0$1 = new Point(0, 0);\nvar TEMP_POINT1 = new Point(0, 0);\n\nvar PointSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(PointSymbolizer, _CanvasSymbolizer);\n\n  function PointSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n    return _this;\n  }\n\n  var _proto = PointSymbolizer.prototype;\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var extent = new PointExtent();\n\n    var renderPoints = this._getRenderPoints()[0];\n\n    for (var i = renderPoints.length - 1; i >= 0; i--) {\n      if (renderPoints[i]) {\n        extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    var symbol = this.symbol;\n    return isFunctionDefinition(symbol['markerWidth']) || isFunctionDefinition(symbol['markerHeight']) || isFunctionDefinition(symbol['textSize']);\n  };\n\n  _proto._rotateExtent = function _rotateExtent(fixedExtent, angle) {\n    return fixedExtent.convertTo(function (p) {\n      return p._rotate(angle);\n    });\n  };\n\n  _proto._getRenderPoints = function _getRenderPoints() {\n    var painter = this.getPainter();\n    var placement = painter.isSpriting() ? 'center' : this.getPlacement();\n    return this.getPainter().getRenderPoints(placement);\n  };\n\n  _proto._getRenderContainerPoints = function _getRenderContainerPoints(ignoreAltitude) {\n    var painter = this.getPainter(),\n        points = this._getRenderPoints()[0];\n\n    if (painter.isSpriting()) {\n      return points;\n    }\n\n    var dxdy = this.getDxDy();\n\n    var cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n\n    if (!cpoints || !Array.isArray(cpoints[0])) {\n      return cpoints;\n    }\n\n    var flat = [];\n\n    for (var i = 0, l = cpoints.length; i < l; i++) {\n      for (var ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n        flat.push(cpoints[i][ii]);\n      }\n    }\n\n    return flat;\n  };\n\n  _proto._getRotationAt = function _getRotationAt(i) {\n    var r = this.getRotation();\n\n    if (!r) {\n      r = 0;\n    }\n\n    var rotations = this._getRenderPoints()[1];\n\n    if (!rotations || !rotations[i]) {\n      return r;\n    }\n\n    var map = this.getMap();\n    var p0 = rotations[i][0],\n        p1 = rotations[i][1];\n\n    if (map.isTransforming()) {\n      var maxZoom = map.getGLZoom();\n      p0 = map._pointToContainerPoint(rotations[i][0], maxZoom, 0, TEMP_POINT0$1);\n      p1 = map._pointToContainerPoint(rotations[i][1], maxZoom, 0, TEMP_POINT1);\n      return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    } else {\n      return r + -computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n  };\n\n  _proto._rotate = function _rotate(ctx, origin, rotation) {\n    if (rotation) {\n      var dxdy = this.getDxDy();\n      var p = origin.sub(dxdy);\n      ctx.save();\n      ctx.translate(p.x, p.y);\n      ctx.rotate(rotation);\n      return this.getDxDy();\n    }\n\n    return null;\n  };\n\n  return PointSymbolizer;\n}(CanvasSymbolizer);\n\nvar VectorMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(VectorMarkerSymbolizer, _PointSymbolizer);\n\n  VectorMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && symbol['markerType'] !== 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n    _this.strokeAndFill = _this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(_this.style));\n    var lineWidth = _this.strokeAndFill['lineWidth'];\n\n    if (lineWidth % 2 === 0) {\n      _this.padding = 2;\n    } else {\n      _this.padding = 1.5;\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['polygonOpacity'] === 0 && style['lineOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    if (this.getPainter().isSpriting() || this.geometry.getLayer().getMask() === this.geometry || this._dynamic || this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n      this._drawMarkers(ctx, cookedPoints, resources);\n    } else {\n      this._drawMarkersWithCache(ctx, cookedPoints, resources);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto._drawMarkers = function _drawMarkers(ctx, cookedPoints, resources) {\n    var strokeAndFill = this.strokeAndFill;\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      this._drawVectorMarker(ctx, point, resources);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._drawMarkersWithCache = function _drawMarkersWithCache(ctx, cookedPoints, resources) {\n    var stamp = this._stampSymbol();\n\n    var image = resources.getImage(stamp);\n\n    if (!image) {\n      image = this._createMarkerImage(ctx, resources);\n      resources.addResource([stamp, image.width, image.height], image);\n    }\n\n    var anchor = this._getAnchor(image.width, image.height);\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._calMarkerSize = function _calMarkerSize() {\n    if (!this._size) {\n      var lineWidth = this.strokeAndFill['lineWidth'],\n          shadow = 2 * (this.symbol['shadowBlur'] || 0),\n          w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n          h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n\n      if (isFunctionDefinition(this.symbol['markerWidth']) || isFunctionDefinition(this.symbol['markerHeight'])) {\n        return [w, h];\n      }\n\n      this._size = [w, h];\n    }\n\n    return this._size;\n  };\n\n  _proto._createMarkerImage = function _createMarkerImage(ctx, resources) {\n    var canvasClass = ctx.canvas.constructor,\n        size = this._calMarkerSize(),\n        canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n        point = this._getCacheImageAnchor(size[0], size[1]);\n\n    var context = canvas.getContext('2d');\n    var gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(context, this.strokeAndFill, resources);\n    }\n\n    this._drawVectorMarker(context, point, resources);\n\n    return canvas;\n  };\n\n  _proto._stampSymbol = function _stampSymbol() {\n    if (!this._stamp) {\n      this._stamp = [this.style['markerType'], isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'], this.style['markerFillOpacity'], this.style['markerFillPatternFile'], isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'], this.style['markerLineWidth'], this.style['markerLineOpacity'], this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '', this.style['markerLinePatternFile'], this.style['markerWidth'], this.style['markerHeight'], this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']].join('_');\n    }\n\n    return this._stamp;\n  };\n\n  _proto._getAnchor = function _getAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n\n    if (p.x !== -w / 2) {\n      p.x -= sign(p.x + w / 2) * margin;\n    }\n\n    if (p.y !== -h / 2) {\n      p.y -= sign(p.y + h / 2) * margin;\n    }\n\n    return p;\n  };\n\n  _proto._getCacheImageAnchor = function _getCacheImageAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var markerType = this.style['markerType'];\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      return new Point(w / 2, h - margin);\n    } else if (markerType === 'rectangle') {\n      return new Point(margin, margin);\n    } else {\n      return new Point(w / 2, h / 2);\n    }\n  };\n\n  _proto._getGraidentExtent = function _getGraidentExtent(points) {\n    var e = new PointExtent(),\n        dxdy = this.getDxDy(),\n        m = this.getFixedExtent();\n\n    if (Array.isArray(points)) {\n      for (var i = points.length - 1; i >= 0; i--) {\n        e._combine(points[i]);\n      }\n    } else {\n      e._combine(points);\n    }\n\n    e['xmin'] += m['xmin'] - dxdy.x;\n    e['ymin'] += m['ymin'] - dxdy.y;\n    e['xmax'] += m['xmax'] - dxdy.x;\n    e['ymax'] += m['ymax'] - dxdy.y;\n    return e;\n  };\n\n  _proto._drawVectorMarker = function _drawVectorMarker(ctx, point, resources) {\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill,\n        markerType = style['markerType'].toLowerCase(),\n        vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n        lineOpacity = strokeAndFill['lineOpacity'],\n        fillOpacity = strokeAndFill['polygonOpacity'];\n\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (gradient) {\n      var gradientExtent;\n\n      if (isGradient(strokeAndFill['lineColor'])) {\n        gradientExtent = this._getGraidentExtent(point);\n        strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n      }\n\n      if (isGradient(strokeAndFill['polygonFill'])) {\n        if (!gradientExtent) {\n          gradientExtent = this._getGraidentExtent(point);\n        }\n\n        strokeAndFill['polygonGradientExtent'] = gradientExtent;\n      }\n\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    var width = style['markerWidth'],\n        height = style['markerHeight'],\n        hLineWidth = style['markerLineWidth'] / 2;\n\n    if (markerType === 'ellipse') {\n      Canvas.ellipse(ctx, point, width / 2, height / 2, height / 2, lineOpacity, fillOpacity);\n    } else if (markerType === 'cross' || markerType === 'x') {\n      for (var j = vectorArray.length - 1; j >= 0; j--) {\n        vectorArray[j]._add(point);\n      }\n\n      Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n      Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n    } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n      if (markerType === 'bar') {\n        point = point.add(0, -hLineWidth);\n      } else if (markerType === 'rectangle') {\n        point = point.add(hLineWidth, hLineWidth);\n      }\n\n      for (var _j = vectorArray.length - 1; _j >= 0; _j--) {\n        vectorArray[_j]._add(point);\n      }\n\n      Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n    } else if (markerType === 'pin') {\n      point = point.add(0, -hLineWidth);\n\n      for (var _j2 = vectorArray.length - 1; _j2 >= 0; _j2--) {\n        vectorArray[_j2]._add(point);\n      }\n\n      var lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n      ctx.lineCap = lineCap;\n    } else if (markerType === 'pie') {\n      point = point.add(0, hLineWidth);\n      var angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n      var _lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n      ctx.lineCap = _lineCap;\n    } else {\n      throw new Error('unsupported markerType: ' + markerType);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        padding = this.padding * 2;\n\n    var size = this._calMarkerSize().map(function (d) {\n      return d - padding;\n    });\n\n    var alignPoint = this._getAnchor(size[0], size[1]);\n\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'markerType': getValueOrDefault(s['markerType'], 'ellipse'),\n      'markerFill': getValueOrDefault(s['markerFill'], '#00f'),\n      'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n      'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n      'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'),\n      'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n      'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n      'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n      'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n      'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0)\n    };\n    var markerType = result['markerType'];\n    var ha, va;\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      ha = 'middle';\n      va = 'top';\n    } else if (markerType === 'rectangle') {\n      ha = 'right';\n      va = 'bottom';\n    } else {\n      ha = 'middle';\n      va = 'middle';\n    }\n\n    result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha);\n    result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va);\n\n    if (isNumber(s['markerOpacity'])) {\n      if (isNumber(s['markerFillOpacity'])) {\n        result['markerFillOpacity'] *= s['markerOpacity'];\n      }\n\n      if (isNumber(s['markerLineOpacity'])) {\n        result['markerLineOpacity'] *= s['markerOpacity'];\n      }\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer.translateLineAndFill = function translateLineAndFill(s) {\n    var result = {\n      'lineColor': s['markerLineColor'],\n      'linePatternFile': s['markerLinePatternFile'],\n      'lineWidth': s['markerLineWidth'],\n      'lineOpacity': s['markerLineOpacity'],\n      'lineDasharray': s['markerLineDasharray'],\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['markerFill'],\n      'polygonPatternFile': s['markerFillPatternFile'],\n      'polygonOpacity': s['markerFillOpacity']\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer._getVectorPoints = function _getVectorPoints(markerType, width, height) {\n    var hh = height / 2,\n        hw = width / 2;\n    var left = 0,\n        top = 0;\n    var v0, v1, v2, v3;\n\n    if (markerType === 'triangle') {\n      v0 = new Point(left, top - hh);\n      v1 = new Point(left - hw, top + hh);\n      v2 = new Point(left + hw, top + hh);\n      return [v0, v1, v2];\n    } else if (markerType === 'cross') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left + hw, top);\n      v2 = new Point(left, top - hh);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'diamond') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left, top - hh);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'square') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top + hh);\n      v2 = new Point(left + hw, top - hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'rectangle') {\n      v0 = new Point(left, top);\n      v1 = v0.add(width, 0);\n      v2 = v0.add(width, height);\n      v3 = v0.add(0, height);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'x') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top - hh);\n      v2 = new Point(left + hw, top + hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'bar') {\n      v0 = new Point(left - hw, top - height);\n      v1 = new Point(left + hw, top - height);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left - hw, top);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'pin') {\n      var extWidth = height * Math.atan(hw / hh);\n      v0 = new Point(left, top);\n      v1 = new Point(left - extWidth, top - height);\n      v2 = new Point(left + extWidth, top - height);\n      v3 = new Point(left, top);\n      return [v0, v1, v2, v3];\n    }\n\n    return [];\n  };\n\n  return VectorMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar DebugSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DebugSymbolizer, _PointSymbolizer);\n\n  function DebugSymbolizer() {\n    return _PointSymbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = DebugSymbolizer.prototype;\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    return new Point(0, 0);\n  };\n\n  _proto.symbolize = function symbolize(ctx) {\n    var geometry = this.geometry,\n        layer = geometry.getLayer();\n\n    if (!geometry.options['debug'] && layer && !layer.options['debug']) {\n      return;\n    }\n\n    var map = this.getMap();\n\n    if (!map || map.isZooming()) {\n      return;\n    }\n\n    var color = layer.options['debugOutline'],\n        op = 1;\n    ctx.strokeStyle = color;\n    ctx.fillStyle = color;\n    var outline = this.getPainter().getContainerExtent().toArray();\n    Canvas.polygon(ctx, [outline], op, 0);\n\n    var points = this._getRenderContainerPoints(),\n        id = this.geometry.getId(),\n        cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n\n      if (!isNil(id)) {\n        Canvas.fillText(ctx, id, p.add(8, -4), color);\n      }\n\n      var c = [];\n\n      for (var ii = 0; ii < cross.length; ii++) {\n        c.push(cross[ii].add(p));\n      }\n\n      Canvas.path(ctx, c.slice(0, 2), op);\n      Canvas.path(ctx, c.slice(2, 4), op);\n    }\n  };\n\n  return DebugSymbolizer;\n}(PointSymbolizer);\n\nvar ImageMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(ImageMarkerSymbolizer, _PointSymbolizer);\n\n  ImageMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['markerFile'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function ImageMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = ImageMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var img = this._getImage(resources);\n\n    if (!img) {\n      if (typeof console !== 'undefined') {\n        console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n      }\n\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var width = style['markerWidth'];\n    var height = style['markerHeight'];\n\n    if (!isNumber(width) || !isNumber(height)) {\n      width = img.width;\n      height = img.height;\n      style['markerWidth'] = width;\n      style['markerHeight'] = height;\n      var imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n\n      if (!resources.isResourceLoaded(imgURL)) {\n        resources.addResource(imgURL, img);\n      }\n\n      var painter = this.getPainter();\n\n      if (!painter.isSpriting()) {\n        painter.removeCache();\n      }\n    }\n\n    var alpha;\n\n    if (this.symbol['markerType'] !== 'path' && isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= style['markerOpacity'];\n    }\n\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.image(ctx, img, p.x + alignPoint.x, p.y + alignPoint.y, width, height);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n\n    if (alpha !== undefined) {\n      ctx.globalAlpha = alpha;\n    }\n  };\n\n  _proto._getImage = function _getImage(resources) {\n    var img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n    return img;\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent(resources) {\n    var style = this.style;\n    var url = style['markerFile'],\n        img = resources ? resources.getImage(url) : null;\n    var width = style['markerWidth'] || (img ? img.width : 0),\n        height = style['markerHeight'] || (img ? img.height : 0);\n    var dxdy = this.getDxDy();\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    return {\n      'markerFile': s['markerFile'],\n      'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n      'markerWidth': getValueOrDefault(s['markerWidth'], null),\n      'markerHeight': getValueOrDefault(s['markerHeight'], null),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'),\n      'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top')\n    };\n  };\n\n  return ImageMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_COORD0$1 = new Coordinate(0, 0);\nvar TEMP_COORD1$1 = new Coordinate(0, 0);\n\nvar StrokeAndFillSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(StrokeAndFillSymbolizer, _CanvasSymbolizer);\n\n  StrokeAndFillSymbolizer.test = function test(symbol, geometry) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (geometry && geometry.type === 'Point') {\n      return false;\n    }\n\n    for (var p in symbol) {\n      var f = p.slice(0, 4);\n\n      if (f === 'line' || f === 'poly') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  function StrokeAndFillSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n\n    if (geometry.type === 'Point') {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = StrokeAndFillSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n      return;\n    }\n\n    var paintParams = this._getPaintParams();\n\n    if (!paintParams) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var isGradient$$1 = isGradient(style['lineColor']),\n        isPath = this.geometry.getJSONType() === 'Polygon' || this.geometry.type === 'LineString';\n\n    if (isGradient$$1 && (style['lineColor']['places'] || !isPath)) {\n      style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n    }\n\n    if (isGradient(style['polygonFill'])) {\n      style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n    }\n\n    var points = paintParams[0],\n        isSplitted = this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0]) || this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this.prepareCanvas(ctx, style, resources);\n\n        if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n          this._createGradient(ctx, points[i], style['lineColor']);\n        }\n\n        var params = [ctx, points[i]];\n\n        if (paintParams.length > 1) {\n          params.push.apply(params, paintParams.slice(1));\n        }\n\n        params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n        this.geometry._paintOn.apply(this.geometry, params);\n      }\n    } else {\n      this.prepareCanvas(ctx, style, resources);\n\n      if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n        this._createGradient(ctx, points, style['lineColor']);\n      }\n\n      var _params = [ctx];\n\n      _params.push.apply(_params, paintParams);\n\n      _params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n      this.geometry._paintOn.apply(this.geometry, _params);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    var extent = this.geometry._getPrjExtent();\n\n    if (!extent) {\n      return null;\n    }\n\n    if (!this._extMin || !this._extMax) {\n      this._extMin = new Coordinate(0, 0);\n      this._extMax = new Coordinate(0, 0);\n    }\n\n    this._extMin.x = extent['xmin'];\n    this._extMin.y = extent['ymin'];\n    this._extMax.x = extent['xmax'];\n    this._extMax.y = extent['ymax'];\n\n    var min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0$1),\n        max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1$1);\n\n    if (!this._pxExtent) {\n      this._pxExtent = new PointExtent(min, max);\n    } else {\n      this._pxExtent.set(Math.min(min.x, max.x), Math.min(min.y, max.y), Math.max(min.x, max.x), Math.max(min.y, max.y));\n    }\n\n    return this._pxExtent;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var t = this.style['lineWidth'] / 2;\n    return new PointExtent(-t, -t, t, t);\n  };\n\n  _proto._getPaintParams = function _getPaintParams() {\n    return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n      'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n      'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n      'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n      'lineCap': getValueOrDefault(s['lineCap'], 'butt'),\n      'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'),\n      'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n      'lineDx': getValueOrDefault(s['lineDx'], 0),\n      'lineDy': getValueOrDefault(s['lineDy'], 0),\n      'polygonFill': getValueOrDefault(s['polygonFill'], null),\n      'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n      'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n      'polygonPatternDx': getValueOrDefault(s['polygonPatternDx'], 0),\n      'polygonPatternDy': getValueOrDefault(s['polygonPatternDy'], 0),\n      'linePatternDx': getValueOrDefault(s['linePatternDx'], 0),\n      'linePatternDy': getValueOrDefault(s['linePatternDy'], 0)\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    if (this.geometry.type === 'LineString' && !result['polygonFill']) {\n      result['polygonFill'] = result['lineColor'];\n    }\n\n    return result;\n  };\n\n  _proto._createGradient = function _createGradient(ctx, points, lineColor) {\n    if (!Array.isArray(points) || !points.length) {\n      return;\n    }\n\n    var len = points.length;\n    var grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n    lineColor['colorStops'].forEach(function (stop) {\n      grad.addColorStop.apply(grad, stop);\n    });\n    ctx.strokeStyle = grad;\n  };\n\n  return StrokeAndFillSymbolizer;\n}(CanvasSymbolizer);\n\nvar CACHE_KEY = '___text_symbol_cache';\n\nvar TextMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(TextMarkerSymbolizer, _PointSymbolizer);\n\n  TextMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['textName'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function TextMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n\n    if (_this.style['textWrapWidth'] === 0) {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.strokeAndFill = _this._defineStyle(_this.translateLineAndFill(_this.style));\n    var textContent = replaceVariable(_this.style['textName'], _this.geometry.getProperties());\n\n    if (!_this._dynamic) {\n      _this._cacheKey = genCacheKey(textContent, _this.style);\n    }\n\n    _this._descText(textContent);\n\n    return _this;\n  }\n\n  var _proto = TextMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 || !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) || this.style['textWrapWidth'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill;\n    var textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n\n    this._descText(textContent);\n\n    this._prepareContext(ctx);\n\n    this.prepareCanvas(ctx, strokeAndFill, resources);\n    Canvas.prepareCanvasFont(ctx, style);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.text(ctx, textContent, p, style, this.textDesc);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['textPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['textRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    return new Point(s['textDx'], s['textDy']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        style = this.style;\n    var size = this.textDesc['size'];\n    var alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n    var alignW = alignPoint.x,\n        alignH = alignPoint.y;\n\n    if (style['textHaloRadius']) {\n      var r = style['textHaloRadius'];\n      size = size.add(r * 2, r * 2);\n    }\n\n    var result = new PointExtent(dxdy.add(alignW, alignH), dxdy.add(alignW + size['width'], alignH + size['height']));\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'textName': s['textName'],\n      'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n      'textWeight': getValueOrDefault(s['textWeight'], 'normal'),\n      'textStyle': getValueOrDefault(s['textStyle'], 'normal'),\n      'textSize': getValueOrDefault(s['textSize'], DEFAULT_TEXT_SIZE),\n      'textFont': getValueOrDefault(s['textFont'], null),\n      'textFill': getValueOrDefault(s['textFill'], '#000'),\n      'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n      'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n      'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n      'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n      'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n      'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n      'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n      'textDx': getValueOrDefault(s['textDx'], 0),\n      'textDy': getValueOrDefault(s['textDy'], 0),\n      'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'),\n      'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'),\n      'textAlign': getValueOrDefault(s['textAlign'], 'center'),\n      'textRotation': getValueOrDefault(s['textRotation'], 0),\n      'textMaxWidth': getValueOrDefault(s['textMaxWidth'], 0),\n      'textMaxHeight': getValueOrDefault(s['textMaxHeight'], 0)\n    };\n\n    if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n      if (!result['textWrapWidth']) {\n        result['textMaxHeight'] = 1;\n      }\n\n      result['textWrapWidth'] = result['textMaxWidth'];\n    }\n\n    return result;\n  };\n\n  _proto.translateLineAndFill = function translateLineAndFill(s) {\n    return {\n      'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n      'lineWidth': s['textHaloRadius'],\n      'lineOpacity': s['textOpacity'],\n      'lineDasharray': null,\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['textFill'],\n      'polygonOpacity': s['textOpacity']\n    };\n  };\n\n  _proto._descText = function _descText(textContent) {\n    if (this._dynamic) {\n      this.textDesc = this._measureText(textContent);\n      return;\n    }\n\n    this.textDesc = this._loadFromCache();\n\n    if (!this.textDesc) {\n      this.textDesc = this._measureText(textContent);\n\n      this._storeToCache(this.textDesc);\n    }\n  };\n\n  _proto._measureText = function _measureText(textContent) {\n    var maxHeight = this.style['textMaxHeight'];\n    var textDesc = splitTextToRow(textContent, this.style);\n\n    if (maxHeight && maxHeight < textDesc.size.height) {\n      textDesc.size.height = maxHeight;\n    }\n\n    return textDesc;\n  };\n\n  _proto._storeToCache = function _storeToCache(textDesc) {\n    if (IS_NODE) {\n      return;\n    }\n\n    if (!this.geometry[CACHE_KEY]) {\n      this.geometry[CACHE_KEY] = {};\n    }\n\n    this.geometry[CACHE_KEY][this._cacheKey] = {\n      'desc': textDesc,\n      'active': true\n    };\n  };\n\n  _proto._loadFromCache = function _loadFromCache() {\n    if (!this.geometry[CACHE_KEY]) {\n      return null;\n    }\n\n    var cache = this.geometry[CACHE_KEY][this._cacheKey];\n\n    if (!cache) {\n      return null;\n    }\n\n    cache.active = true;\n    return cache.desc;\n  };\n\n  return TextMarkerSymbolizer;\n}(PointSymbolizer);\n\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n  var key = [textContent];\n\n  for (var p in style) {\n    if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n      key.push(p + '=' + style[p]);\n    }\n  }\n\n  return key.join('-');\n}\n\nvar VectorPathMarkerSymbolizer = function (_ImageMarkerSymbolize) {\n  _inheritsLoose(VectorPathMarkerSymbolizer, _ImageMarkerSymbolize);\n\n  VectorPathMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorPathMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    if (isNil(symbol['markerWidth'])) {\n      symbol['markerWidth'] = 80;\n    }\n\n    if (isNil(symbol['markerHeight'])) {\n      symbol['markerHeight'] = 80;\n    }\n\n    _this = _ImageMarkerSymbolize.call(this, symbol, geometry, painter) || this;\n    symbol = extend(symbol, _this.translate());\n\n    var style = _this.style = _this._defineStyle(symbol);\n\n    if (Browser$1.gecko) {\n      _this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n    } else {\n      _this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorPathMarkerSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext() {};\n\n  _proto._getImage = function _getImage(resources) {\n    var _this2 = this;\n\n    if (resources && resources.isResourceLoaded(this._url)) {\n      return resources.getImage(this._url);\n    }\n\n    var painter = this.painter;\n    var image = new Image();\n\n    image.onload = function () {\n      var renderer = painter.getLayer() && painter.getLayer().getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    };\n\n    image.onerror = function (err) {\n      if (err && typeof console !== 'undefined') {\n        console.warn(err);\n      }\n\n      resources.markErrorResource(_this2._url);\n    };\n\n    image.src = this._url[0];\n\n    if (resources) {\n      resources.addResource(this._url, image);\n    }\n\n    return image;\n  };\n\n  return VectorPathMarkerSymbolizer;\n}(ImageMarkerSymbolizer);\n\nvar defaultSymbol = {\n  lineWidth: 1,\n  polygonFill: '#fff',\n  polygonOpacity: 0.5\n};\n\nvar DrawAltitudeSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DrawAltitudeSymbolizer, _PointSymbolizer);\n\n  DrawAltitudeSymbolizer.test = function test(symbol, geometry) {\n    var layer = geometry.getLayer();\n\n    if (!layer) {\n      return false;\n    }\n\n    var type = geometry.getJSONType();\n    return type === 'Marker' || type === 'LineString';\n  };\n\n  function DrawAltitudeSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = geometry.getLayer().options['drawAltitude'];\n\n    if (!_this.style || !isObject(_this.style)) {\n      _this.style = {\n        'lineWidth': 2\n      };\n    }\n\n    if (!_this.style['lineWidth']) {\n      _this.style['lineWidth'] = 0;\n    }\n\n    _this.dxdy = _this._defineStyle({\n      'dx': symbol['textDx'] || symbol['markerDx'],\n      'dy': symbol['textDy'] || symbol['markerDy']\n    });\n    return _this;\n  }\n\n  var _proto = DrawAltitudeSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx) {\n    var layer = this.geometry.getLayer();\n\n    if (!layer.options['drawAltitude']) {\n      return;\n    }\n\n    var properties = this.geometry.getProperties();\n\n    if (!properties || !properties[layer.options['altitudeProperty']]) {\n      return;\n    }\n\n    var style = this._getStyle();\n\n    this._prepareContext(ctx);\n\n    if (this.geometry.type === 'LineString') {\n      var paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n\n      if (!paintParams) {\n        return;\n      }\n\n      var groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n\n      this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n    } else {\n      var point = this._getRenderContainerPoints(),\n          groundPoint = this._getRenderContainerPoints(true);\n\n      if (!point || point.length === 0) {\n        return;\n      }\n\n      this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.dxdy;\n    return new Point(s['dx'] || 0, s['dy'] || 0);\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    if (this.geometry.type === 'LineString') {\n      return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n    } else {\n      return _PointSymbolizer.prototype.get2DExtent.call(this);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto._getPaintParams = function _getPaintParams(dx, dy) {\n    return this.getPainter().getPaintParams(dx || 0, dy || 0);\n  };\n\n  _proto._drawMarkerAltitude = function _drawMarkerAltitude(ctx, point, groundPoint) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n    Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n  };\n\n  _proto._drawLineAltitude = function _drawLineAltitude(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this._drawLine(ctx, points[i], groundPoints[i]);\n      }\n    } else {\n      this._drawLine(ctx, points, groundPoints);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto._drawLine = function _drawLine(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n\n    for (var i = 0, l = points.length - 1; i < l; i++) {\n      Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n    }\n  };\n\n  _proto._getStyle = function _getStyle() {\n    var style = this.geometry.getLayer().options['drawAltitude'];\n\n    if (!isObject(style)) {\n      style = defaultSymbol;\n    }\n\n    if (!style['lineWidth']) {\n      style['lineWidth'] = 0;\n      style['lineOpacity'] = 0;\n    }\n\n    return style;\n  };\n\n  return DrawAltitudeSymbolizer;\n}(PointSymbolizer);\n\nvar index$3 = /*#__PURE__*/Object.freeze({\n  Symbolizer: Symbolizer,\n  CanvasSymbolizer: CanvasSymbolizer,\n  DebugSymbolizer: DebugSymbolizer,\n  ImageMarkerSymbolizer: ImageMarkerSymbolizer,\n  PointSymbolizer: PointSymbolizer,\n  StrokeAndFillSymbolizer: StrokeAndFillSymbolizer,\n  TextMarkerSymbolizer: TextMarkerSymbolizer,\n  VectorMarkerSymbolizer: VectorMarkerSymbolizer,\n  VectorPathMarkerSymbolizer: VectorPathMarkerSymbolizer,\n  DrawAltitudeSymbolizer: DrawAltitudeSymbolizer\n});\nvar registerSymbolizers = [DrawAltitudeSymbolizer, StrokeAndFillSymbolizer, ImageMarkerSymbolizer, VectorPathMarkerSymbolizer, VectorMarkerSymbolizer, TextMarkerSymbolizer];\nvar testCanvas;\nvar TEMP_POINT0$2 = new Point(0, 0);\nvar TEMP_PAINT_EXTENT = new PointExtent();\nvar TEMP_EXTENT$1 = new PointExtent();\nvar TEMP_FIXED_EXTENT = new PointExtent();\nvar TEMP_CLIP_EXTENT0 = new PointExtent();\nvar TEMP_CLIP_EXTENT1 = new PointExtent();\n\nvar Painter = function (_Class) {\n  _inheritsLoose(Painter, _Class);\n\n  function Painter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.symbolizers = _this._createSymbolizers();\n    _this._altAtGLZoom = _this._getGeometryAltitude();\n    return _this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getLayer = function getLayer() {\n    return this.geometry.getLayer();\n  };\n\n  _proto._createSymbolizers = function _createSymbolizers() {\n    var geoSymbol = this.getSymbol(),\n        symbolizers = [],\n        regSymbolizers = registerSymbolizers;\n    var symbols = geoSymbol;\n\n    if (!Array.isArray(geoSymbol)) {\n      symbols = [geoSymbol];\n    }\n\n    for (var ii = symbols.length - 1; ii >= 0; ii--) {\n      var symbol = symbols[ii];\n\n      for (var i = regSymbolizers.length - 1; i >= 0; i--) {\n        if (regSymbolizers[i].test(symbol, this.geometry)) {\n          var symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n          symbolizers.push(symbolizer);\n\n          if (symbolizer instanceof PointSymbolizer) {\n            this._hasPoint = true;\n          }\n        }\n      }\n    }\n\n    if (!symbolizers.length) {\n      if (console) {\n        var id = this.geometry.getId();\n        console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n      }\n    }\n\n    this._debugSymbolizer = new DebugSymbolizer(geoSymbol, this.geometry, this);\n    return symbolizers;\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    return !!this._hasPoint;\n  };\n\n  _proto.getRenderPoints = function getRenderPoints(placement) {\n    if (!this._renderPoints) {\n      this._renderPoints = {};\n    }\n\n    if (!placement) {\n      placement = 'center';\n    }\n\n    if (!this._renderPoints[placement]) {\n      this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n    }\n\n    return this._renderPoints[placement];\n  };\n\n  _proto.getPaintParams = function getPaintParams(dx, dy, ignoreAltitude) {\n    var map = this.getMap(),\n        geometry = this.geometry,\n        res = map.getResolution(),\n        pitched = map.getPitch() !== 0,\n        rotated = map.getBearing() !== 0;\n    var params = this._cachedParams;\n\n    var paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n\n    if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n      params = this._unsimpledParams;\n    } else if (!params || params._res !== map.getResolution() || this._pitched !== pitched && geometry._redrawWhenPitch() || this._rotated !== rotated && geometry._redrawWhenRotate()) {\n      params = geometry._getPaintParams();\n\n      if (!params) {\n        return null;\n      }\n\n      params._res = res;\n\n      if (!geometry._simplified && paintAsPath) {\n        if (!this._unsimpledParams) {\n          this._unsimpledParams = params;\n        }\n\n        if (res > this._unsimpledParams._res) {\n          this._unsimpledParams._res = res;\n        }\n      }\n\n      this._cachedParams = params;\n    }\n\n    if (!params) {\n      return null;\n    }\n\n    this._pitched = pitched;\n    this._rotated = rotated;\n    var zoomScale = map.getGLScale(),\n        tr = [],\n        points = params[0];\n    var mapExtent = map.getContainerExtent();\n\n    var cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n\n    if (!cPoints) {\n      return null;\n    }\n\n    tr.push(cPoints);\n\n    for (var i = 1, l = params.length; i < l; i++) {\n      if (isNumber(params[i]) || params[i] instanceof Size) {\n        if (isNumber(params[i])) {\n          tr.push(params[i] / zoomScale);\n        } else {\n          tr.push(params[i].multi(1 / zoomScale));\n        }\n      } else {\n        tr.push(params[i]);\n      }\n    }\n\n    return tr;\n  };\n\n  _proto._pointContainerPoints = function _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    var map = this.getMap(),\n        glZoom = map.getGLZoom(),\n        containerOffset = this.containerOffset;\n    var cPoints;\n\n    function pointContainerPoint(point, alt) {\n      var p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n\n      if (dx || dy) {\n        p._add(dx || 0, dy || 0);\n      }\n\n      return p;\n    }\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(points)) {\n      var geometry = this.geometry;\n      var clipped;\n\n      if (!disableClip && geometry.options['enableClip']) {\n        clipped = this._clip(points, altitude);\n      } else {\n        clipped = {\n          points: points,\n          altitude: altitude\n        };\n      }\n\n      var clipPoints = clipped.points;\n      altitude = clipped.altitude;\n\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      var alt = altitude;\n      cPoints = [];\n\n      for (var i = 0, l = clipPoints.length; i < l; i++) {\n        var c = clipPoints[i];\n\n        if (Array.isArray(c)) {\n          var cring = [];\n\n          for (var ii = 0, ll = c.length; ii < ll; ii++) {\n            var cc = c[ii];\n\n            if (Array.isArray(altitude)) {\n              if (altitude[i]) {\n                alt = altitude[i][ii];\n              } else {\n                alt = 0;\n              }\n            }\n\n            cring.push(pointContainerPoint(cc, alt));\n          }\n\n          cPoints.push(cring);\n        } else {\n          if (Array.isArray(altitude)) {\n            if (pointPlacement === 'vertex-last') {\n              alt = altitude[altitude.length - 1 - i];\n            } else if (pointPlacement === 'line') {\n              alt = (altitude[i] + altitude[i + 1]) / 2;\n            } else {\n              alt = altitude[i];\n            }\n          }\n\n          cPoints.push(pointContainerPoint(c, alt));\n        }\n      }\n    } else if (points instanceof Point) {\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n\n      if (dx || dy) {\n        cPoints._add(dx, dy);\n      }\n    }\n\n    return cPoints;\n  };\n\n  _proto._clip = function _clip(points, altitude) {\n    var map = this.getMap(),\n        geometry = this.geometry;\n    var lineWidth = this.getSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth)) {\n      lineWidth = 4;\n    }\n\n    var extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n\n    if (map.getPitch() > 0 && altitude) {\n      var c = map.cameraLookAt;\n      var pos = map.cameraPosition;\n      TEMP_POINT0$2.set(pos.x, pos.y);\n      extent2D = extent2D._combine(TEMP_POINT0$2._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n    }\n\n    var e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n    var clipPoints = points;\n\n    if (e.within(extent2D)) {\n      return {\n        points: clipPoints,\n        altitude: altitude\n      };\n    }\n\n    var glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth * map._glScale);\n\n    var smoothness = geometry.options['smoothness'];\n\n    if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipPolygon(points, glExtent2D);\n      } else {\n        clipPoints = [];\n\n        for (var i = 0; i < points.length; i++) {\n          var part = clipPolygon(points[i], glExtent2D);\n\n          if (part.length) {\n            clipPoints.push(part);\n          }\n        }\n      }\n    } else if (geometry.getJSONType() === 'LineString' && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n      } else {\n        clipPoints = [];\n\n        for (var _i = 0; _i < points.length; _i++) {\n          pushIn(clipPoints, clipLine(points[_i], glExtent2D, false, !!smoothness));\n        }\n      }\n\n      return this._interpolateSegAlt(clipPoints, points, altitude);\n    }\n\n    return {\n      points: clipPoints,\n      altitude: altitude\n    };\n  };\n\n  _proto._interpolateSegAlt = function _interpolateSegAlt(clipSegs, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n      var fn = function fn(cc) {\n        return cc.point;\n      };\n\n      return {\n        points: clipSegs.map(function (c) {\n          if (Array.isArray(c)) {\n            return c.map(fn);\n          }\n\n          return c.point;\n        }),\n        altitude: altitude\n      };\n    }\n\n    var segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n    altitude = [];\n    var points = segsWithAlt.map(function (p) {\n      if (Array.isArray(p)) {\n        var alt = [];\n        var cp = p.map(function (pp) {\n          alt.push(pp.altitude);\n          return pp.point;\n        });\n        altitude.push(alt);\n        return cp;\n      }\n\n      altitude.push(p.altitude);\n      return p.point;\n    });\n    return {\n      points: points,\n      altitude: altitude\n    };\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    return this.geometry._getInternalSymbol();\n  };\n\n  _proto.paint = function paint(extent, context, offset) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    if (!renderer || !renderer.context && !context) {\n      return;\n    }\n\n    if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n      return;\n    }\n\n    var map = this.getMap();\n    var minAltitude = this.getMinAltitude();\n    var frustumAlt = map.getFrustumAltitude();\n\n    if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n      return;\n    }\n\n    this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n\n    this._beforePaint();\n\n    var ctx = context || renderer.context;\n    var contexts = [ctx, renderer.resources];\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n      this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n    }\n\n    this._afterPaint();\n\n    this._painted = true;\n\n    this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n  };\n\n  _proto.getSprite = function getSprite(resources, canvasClass) {\n    if (this.geometry.type !== 'Point') {\n      return null;\n    }\n\n    this._spriting = true;\n\n    if (!this._sprite && this.symbolizers.length > 0) {\n      var extent = new PointExtent();\n      this.symbolizers.forEach(function (s) {\n        var markerExtent = s.getFixedExtent(resources);\n\n        extent._combine(markerExtent);\n      });\n      var origin = extent.getMin().multi(-1);\n      var clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n      var canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n      var bak;\n\n      if (this._renderPoints) {\n        bak = this._renderPoints;\n      }\n\n      var ctx = canvas.getContext('2d');\n      var contexts = [ctx, resources];\n\n      for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n        var dxdy = this.symbolizers[i].getDxDy();\n        this._renderPoints = {\n          'center': [[origin.add(dxdy)]]\n        };\n\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n        this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n      }\n\n      if (bak) {\n        this._renderPoints = bak;\n      }\n\n      this._sprite = {\n        'canvas': canvas,\n        'offset': extent.getCenter()\n      };\n    }\n\n    this._spriting = false;\n    return this._sprite;\n  };\n\n  _proto.isSpriting = function isSpriting() {\n    return !!this._spriting;\n  };\n\n  _proto.hitTest = function hitTest(cp, tolerance) {\n    if (!tolerance || tolerance < 0.5) {\n      tolerance = 0.5;\n    }\n\n    if (!testCanvas) {\n      testCanvas = Canvas.createCanvas(1, 1);\n    }\n\n    Canvas.setHitTesting(true);\n    testCanvas.width = testCanvas.height = 2 * tolerance;\n    var ctx = testCanvas.getContext('2d');\n    this._hitPoint = cp.sub(tolerance, tolerance);\n\n    try {\n      this.paint(null, ctx, this._hitPoint);\n    } catch (e) {\n      throw e;\n    } finally {\n      Canvas.setHitTesting(false);\n    }\n\n    delete this._hitPoint;\n    var imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n\n    for (var i = 3, l = imgData.length; i < l; i += 4) {\n      if (imgData[i] > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.isHitTesting = function isHitTesting() {\n    return !!this._hitPoint;\n  };\n\n  _proto._prepareShadow = function _prepareShadow(ctx, symbol) {\n    if (symbol['shadowBlur']) {\n      ctx.shadowBlur = this.isHitTesting() ? 0 : symbol['shadowBlur'];\n      ctx.shadowColor = symbol['shadowColor'] || '#000';\n      ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n      ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n    } else if (ctx.shadowBlur) {\n      ctx.shadowBlur = null;\n      ctx.shadowColor = null;\n      ctx.shadowOffsetX = null;\n      ctx.shadowOffsetY = null;\n    }\n  };\n\n  _proto._eachSymbolizer = function _eachSymbolizer(fn, context) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    if (!context) {\n      context = this;\n    }\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      fn.apply(context, [this.symbolizers[i]]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    this._verifyProjection();\n\n    var map = this.getMap();\n    resources = resources || this.getLayer()._getRenderer().resources;\n    var zoom = map.getZoom();\n\n    var isDynamicSize = this._isDynamicSize();\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom || !this._fixedExtent) {\n      if (this._extent2D && this._extent2D._zoom !== zoom) {\n        delete this._extent2D;\n      }\n\n      if (this.symbolizers) {\n        if (!this._extent2D) {\n          this._extent2D = this._computeExtent2D(new PointExtent());\n          this._extent2D._zoom = zoom;\n        }\n\n        if (!this._fixedExtent) {\n          this._fixedExtent = this._computeFixedExtent(resources, new PointExtent());\n        }\n      }\n    }\n\n    if (!this._extent2D) {\n      if (isDynamicSize) {\n        delete this._fixedExtent;\n      }\n\n      return null;\n    }\n\n    var _this$_fixedExtent = this._fixedExtent,\n        xmin = _this$_fixedExtent.xmin,\n        ymin = _this$_fixedExtent.ymin,\n        xmax = _this$_fixedExtent.xmax,\n        ymax = _this$_fixedExtent.ymax;\n\n    if (isDynamicSize) {\n      delete this._fixedExtent;\n    }\n\n    TEMP_FIXED_EXTENT.set(xmin, -ymax, xmax, -ymin);\n\n    if (out) {\n      out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n\n      out._add(TEMP_FIXED_EXTENT);\n\n      return out;\n    }\n\n    return this._extent2D.add(TEMP_FIXED_EXTENT);\n  };\n\n  _proto._computeExtent2D = function _computeExtent2D(extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      extent._combine(symbolizer.get2DExtent());\n    }\n\n    return extent;\n  };\n\n  _proto._computeFixedExtent = function _computeFixedExtent(resources, extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.getFixedExtent) {\n        extent._combine(symbolizer.getFixedExtent(resources));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.isDynamicSize()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    this._verifyProjection();\n\n    var map = this.getMap();\n    var zoom = map.getZoom();\n    var glScale = map._glScale;\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_EXTENT$1);\n    }\n\n    var altitude = this.getMinAltitude();\n\n    var extent = this._extent2D.convertTo(function (c) {\n      return map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0$2);\n    }, out);\n\n    var maxAltitude = this.getMaxAltitude();\n\n    if (maxAltitude !== altitude) {\n      var extent2 = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(extent2);\n    }\n\n    var layer = this.geometry.getLayer();\n\n    if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n      var groundExtent = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(groundExtent);\n    }\n\n    if (extent) {\n      extent._add(this._fixedExtent || this._computeFixedExtent(null, new PointExtent()));\n    }\n\n    var smoothness = this.geometry.options['smoothness'];\n\n    if (smoothness) {\n      extent._expand(extent.getWidth() * 0.15);\n    }\n\n    return extent;\n  };\n\n  _proto._aboveCamera = function _aboveCamera() {\n    var altitude = this.getMinAltitude();\n    var map = this.getMap();\n    var frustumAlt = map.getFrustumAltitude();\n    return altitude && frustumAlt && frustumAlt < altitude;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var map = this.getMap();\n    var zoom = map.getZoom();\n\n    if (this._isDynamicSize()) {\n      return this._computeFixedExtent(null, new PointExtent());\n    }\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_FIXED_EXTENT);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto.setZIndex = function setZIndex(change) {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.setZIndex(change);\n    });\n  };\n\n  _proto.show = function show() {\n    if (!this._painted) {\n      var layer = this.getLayer();\n\n      if (!layer.isCanvasRender()) {\n        this.paint();\n      }\n    } else {\n      this.removeCache();\n\n      this._eachSymbolizer(function (symbolizer) {\n        symbolizer.show();\n      });\n    }\n  };\n\n  _proto.hide = function hide() {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.hide();\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    this._altAtGLZoom = this._getGeometryAltitude();\n    this.removeCache();\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    var renderer = layer.getRenderer();\n\n    if (!renderer || !renderer.setToRedraw()) {\n      return;\n    }\n\n    renderer.setToRedraw();\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n\n    this.symbolizers = this._createSymbolizers();\n  };\n\n  _proto.remove = function remove() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n  };\n\n  _proto._removeSymbolizers = function _removeSymbolizers() {\n    this._eachSymbolizer(function (symbolizer) {\n      delete symbolizer.painter;\n      symbolizer.remove();\n    });\n\n    delete this.symbolizers;\n  };\n\n  _proto.removeCache = function removeCache() {\n    delete this._renderPoints;\n    delete this._paintParams;\n    delete this._sprite;\n    delete this._extent2D;\n    delete this._fixedExtent;\n    delete this._cachedParams;\n    delete this._unsimpledParams;\n\n    if (this.geometry) {\n      delete this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n    }\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var propAlt = this.geometry.getAltitude();\n\n    if (propAlt !== this._propAlt) {\n      this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    if (!this._altAtGLZoom) {\n      return 0;\n    }\n\n    return this._altAtGLZoom;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (!this.minAltitude) {\n      return 0;\n    }\n\n    return this.minAltitude;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (!this.maxAltitude) {\n      return 0;\n    }\n\n    return this.maxAltitude;\n  };\n\n  _proto._getGeometryAltitude = function _getGeometryAltitude() {\n    var _this2 = this;\n\n    var map = this.getMap();\n\n    if (!map) {\n      return 0;\n    }\n\n    var altitude = this.geometry.getAltitude();\n    this._propAlt = altitude;\n\n    if (!altitude) {\n      this.minAltitude = this.maxAltitude = 0;\n      return 0;\n    }\n\n    var center = this.geometry.getCenter();\n\n    if (!center) {\n      return 0;\n    }\n\n    if (Array.isArray(altitude)) {\n      this.minAltitude = Number.MAX_VALUE;\n      this.maxAltitude = Number.MIN_VALUE;\n      return altitude.map(function (alt) {\n        var a = _this2._meterToPoint(center, alt);\n\n        if (a < _this2.minAltitude) {\n          _this2.minAltitude = a;\n        }\n\n        if (a > _this2.maxAltitude) {\n          _this2.maxAltitude = a;\n        }\n\n        return a;\n      });\n    } else {\n      this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n      return this.minAltitude;\n    }\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    var z = map.getGLZoom();\n    return map.distanceToPoint(altitude, 0, z, center).x * sign(altitude);\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this.geometry._getProjection();\n\n    if (this._projCode && this._projCode !== projection.code) {\n      this.removeCache();\n    }\n\n    this._projCode = projection.code;\n  };\n\n  _proto._beforePaint = function _beforePaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        textcache[p].active = false;\n      }\n    }\n  };\n\n  _proto._afterPaint = function _afterPaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        if (!textcache[p].active) {\n          delete textcache[p];\n        }\n      }\n    }\n  };\n\n  return Painter;\n}(Class);\n\nfunction interpolateAlt(points, orig, altitude) {\n  if (!Array.isArray(altitude)) {\n    return points;\n  }\n\n  var parts = [];\n\n  for (var i = 0, l = points.length; i < l; i++) {\n    if (Array.isArray(points[i])) {\n      parts.push(interpolateAlt(points[i], orig, altitude));\n    } else {\n      var p = points[i];\n\n      if (!p.point.equals(orig[p.index])) {\n        var w0 = void 0,\n            w1 = void 0;\n\n        if (p.index === 0) {\n          w0 = p.index;\n          w1 = p.index + 1;\n        } else {\n          w0 = p.index - 1;\n          w1 = p.index;\n        }\n\n        var t0 = p.point.distanceTo(orig[w1]);\n        var t = t0 / (t0 + orig[w0].distanceTo(p.point));\n        var alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n        p.altitude = alt;\n        parts.push(p);\n      } else {\n        p.altitude = altitude[p.index];\n        parts.push(p);\n      }\n    }\n  }\n\n  return parts;\n}\n\nvar TEMP_EXTENT$2 = new PointExtent();\n\nvar CollectionPainter = function (_Class) {\n  _inheritsLoose(CollectionPainter, _Class);\n\n  function CollectionPainter(geometry, isMask) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.isMask = isMask;\n    return _this;\n  }\n\n  var _proto = CollectionPainter.prototype;\n\n  _proto._eachPainter = function _eachPainter(fn) {\n    var geometries = this.geometry.getGeometries();\n    var painter;\n\n    for (var i = 0, len = geometries.length; i < len; i++) {\n      painter = this.isMask ? geometries[i]._getMaskPainter() : geometries[i]._getPainter();\n\n      if (!painter) {\n        continue;\n      }\n\n      if (painter) {\n        if (fn.call(this, painter) === false) {\n          break;\n        }\n      }\n    }\n  };\n\n  _proto.paint = function paint(extent) {\n    if (!this.geometry) {\n      return;\n    }\n\n    this._eachPainter(function (painter) {\n      painter.paint(extent);\n    });\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    if (out) {\n      out.set(null, null, null, null);\n    }\n\n    var extent = out || new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT$2));\n    });\n\n    return extent;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var extent = new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent.combine(painter.getContainerExtent());\n    });\n\n    return extent;\n  };\n\n  _proto.remove = function remove() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.remove.apply(painter, args);\n    });\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.setZIndex.apply(painter, args);\n    });\n  };\n\n  _proto.show = function show() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.show.apply(painter, args);\n    });\n  };\n\n  _proto.hide = function hide() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.hide.apply(painter, args);\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.repaint.apply(painter, args);\n    });\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.refreshSymbol.apply(painter, args);\n    });\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    var result = false;\n\n    this._eachPainter(function (painter) {\n      if (painter.hasPoint()) {\n        result = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    return result;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    var first = true;\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMinAltitude();\n\n      if (first || alt < result) {\n        first = false;\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMaxAltitude();\n\n      if (alt > result) {\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  return CollectionPainter;\n}(Class);\n\nvar DefaultSpatialReference = {\n  'EPSG:3857': {\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 2 * 6378137 * Math.PI;\n\n      for (var i = 0; i < 21; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  },\n  'EPSG:4326': {\n    'fullExtent': {\n      'top': 90,\n      'left': -180,\n      'bottom': -90,\n      'right': 180\n    },\n    'resolutions': function () {\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = 180 / (Math.pow(2, i) * 128);\n      }\n\n      return resolutions;\n    }()\n  },\n  'BAIDU': {\n    'resolutions': function () {\n      var res = Math.pow(2, 18);\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 33554432,\n      'left': -33554432,\n      'bottom': -33554432,\n      'right': 33554432\n    }\n  },\n  'IDENTITY': {\n    'resolutions': function () {\n      var res = Math.pow(2, 8);\n      var resolutions = [];\n\n      for (var i = 0; i < 18; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 200000,\n      'left': -200000,\n      'bottom': -200000,\n      'right': 200000\n    }\n  }\n};\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nvar SpatialReference = function () {\n  function SpatialReference(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.options = options;\n\n    this._initSpatialRef();\n  }\n\n  SpatialReference.getProjectionInstance = function getProjectionInstance(prjName) {\n    if (!prjName) {\n      return null;\n    }\n\n    if (isObject(prjName)) {\n      return prjName;\n    }\n\n    prjName = (prjName + '').toLowerCase();\n\n    for (var p in projections) {\n      if (hasOwn(projections, p)) {\n        var code = projections[p]['code'];\n\n        if (code && code.toLowerCase() === prjName) {\n          return projections[p];\n        }\n      }\n    }\n\n    return null;\n  };\n\n  SpatialReference.equals = function equals(sp1, sp2) {\n    if (!sp1 && !sp2) {\n      return true;\n    } else if (!sp1 || !sp2) {\n      return false;\n    }\n\n    if (sp1.projection !== sp2.projection) {\n      return false;\n    }\n\n    var f1 = sp1.fullExtent,\n        f2 = sp2.fullExtent;\n\n    if (f1 && !f2 || !f1 && f2) {\n      return false;\n    }\n\n    if (f1 && f2) {\n      if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n        return false;\n      }\n    }\n\n    var r1 = sp1.resolutions,\n        r2 = sp2.resolutions;\n\n    if (r1 && r2) {\n      if (r1.length !== r2.length) {\n        return false;\n      }\n\n      for (var i = 0; i < r1.length; i++) {\n        if (r1[i] !== r2[i]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var _proto = SpatialReference.prototype;\n\n  _proto._initSpatialRef = function _initSpatialRef() {\n    var projection = this.options['projection'];\n\n    if (projection) {\n      projection = SpatialReference.getProjectionInstance(projection);\n    } else {\n      projection = DEFAULT$1;\n    }\n\n    if (!projection) {\n      throw new Error('must provide a valid projection in map\\'s spatial reference.');\n    }\n\n    projection = extend({}, Common, projection);\n\n    if (!projection.measureLength) {\n      extend(projection, Measurer.DEFAULT);\n    }\n\n    this._projection = projection;\n    var defaultSpatialRef,\n        resolutions = this.options['resolutions'];\n\n    if (!resolutions) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          resolutions = defaultSpatialRef['resolutions'];\n          this.isEPSG = projection['code'] !== 'IDENTITY';\n        }\n      }\n\n      if (!resolutions) {\n        throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n      }\n    }\n\n    this._resolutions = resolutions;\n    var fullExtent = this.options['fullExtent'];\n\n    if (!fullExtent) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          fullExtent = defaultSpatialRef['fullExtent'];\n        }\n      }\n\n      if (!fullExtent) {\n        throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n      }\n    }\n\n    if (!isNil(fullExtent['left'])) {\n      this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']), new Coordinate(fullExtent['right'], fullExtent['bottom']));\n    } else {\n      this._fullExtent = new Extent(fullExtent);\n      fullExtent['left'] = fullExtent['xmin'];\n      fullExtent['right'] = fullExtent['xmax'];\n      fullExtent['top'] = fullExtent['ymax'];\n      fullExtent['bottom'] = fullExtent['ymin'];\n    }\n\n    if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n      throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n    }\n\n    extend(this._fullExtent, fullExtent);\n    this._projection.fullExtent = fullExtent;\n    var a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n    this._transformation = new Transformation([a, b, 0, 0]);\n  };\n\n  _proto.getResolutions = function getResolutions() {\n    return this._resolutions || [];\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    var z = zoom | 0;\n\n    if (z < 0) {\n      z = 0;\n    } else if (z > this._resolutions.length - 1) {\n      z = this._resolutions.length - 1;\n    }\n\n    var res = this._resolutions[z];\n\n    if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n      var next = this._resolutions[z + 1];\n      return res + (next - res) * (zoom - z);\n    }\n\n    return res;\n  };\n\n  _proto.getProjection = function getProjection() {\n    return this._projection;\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    return this._fullExtent;\n  };\n\n  _proto.getTransformation = function getTransformation() {\n    return this._transformation;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    for (var i = 0; i < this._resolutions.length; i++) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return 0;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    for (var i = this._resolutions.length - 1; i >= 0; i--) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return this._resolutions.length - 1;\n  };\n\n  _proto.getZoomDirection = function getZoomDirection() {\n    return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n  };\n\n  _proto.toJSON = function toJSON() {\n    if (!this.json) {\n      this.json = {\n        'resolutions': this._resolutions,\n        'fullExtent': {\n          'top': this._fullExtent.top,\n          'left': this._fullExtent.left,\n          'bottom': this._fullExtent.bottom,\n          'right': this._fullExtent.right\n        },\n        'projection': this._projection.code\n      };\n    }\n\n    return this.json;\n  };\n\n  return SpatialReference;\n}();\n\nvar options = {\n  'id': null,\n  'visible': true,\n  'interactive': true,\n  'editable': true,\n  'cursor': null,\n  'defaultProjection': 'EPSG:4326'\n};\n\nvar Geometry = function (_JSONAble) {\n  _inheritsLoose(Geometry, _JSONAble);\n\n  function Geometry(options) {\n    var _this;\n\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    _this = _JSONAble.call(this, opts) || this;\n\n    if (symbol) {\n      _this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      _this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      _this.setId(id);\n    }\n\n    return _this;\n  }\n\n  var _proto = Geometry.prototype;\n\n  _proto.getFirstCoordinate = function getFirstCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[0].getFirstCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[0];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.getLastCoordinate = function getLastCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[geometries.length - 1].getLastCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[coordinates.length - 1];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.addTo = function addTo(layer, fitview) {\n    layer.addGeometry(this, fitview);\n    return this;\n  };\n\n  _proto.getLayer = function getLayer() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer.getMap();\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var oldId = this.getId();\n    this._id = id;\n\n    this._fireEvent('idchange', {\n      'old': oldId,\n      'new': id\n    });\n\n    return this;\n  };\n\n  _proto.getProperties = function getProperties() {\n    if (!this.properties) {\n      if (this._getParent()) {\n        return this._getParent().getProperties();\n      }\n\n      return null;\n    }\n\n    return this.properties;\n  };\n\n  _proto.setProperties = function setProperties(properties) {\n    var old = this.properties;\n    this.properties = isObject(properties) ? extend({}, properties) : properties;\n\n    this._repaint();\n\n    this._fireEvent('propertieschange', {\n      'old': old,\n      'new': properties\n    });\n\n    return this;\n  };\n\n  _proto.getType = function getType() {\n    return this.type;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = this._symbol;\n\n    if (s) {\n      if (!Array.isArray(s)) {\n        return extend({}, s);\n      } else {\n        return extendSymbol(s);\n      }\n    }\n\n    return null;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    this._symbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto.updateSymbol = function updateSymbol(props) {\n    if (!props) {\n      return this;\n    }\n\n    var s = this._getSymbol();\n\n    if (s) {\n      s = extendSymbol(s, props);\n    } else {\n      s = extendSymbol(this._getInternalSymbol(), props);\n    }\n\n    this._eventSymbolProperties = props;\n    return this.setSymbol(s);\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this._computeCenter(this._getMeasurer());\n  };\n\n  _proto.getExtent = function getExtent() {\n    var prjExt = this._getPrjExtent();\n\n    var projection = this._getProjection();\n\n    if (prjExt && projection) {\n      var min = projection.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n          max = projection.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n      return new Extent(min, max, projection);\n    } else {\n      return this._computeExtent(this._getMeasurer());\n    }\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var painter = this._getPainter();\n\n    return painter ? painter.getContainerExtent(out) : null;\n  };\n\n  _proto.getSize = function getSize() {\n    var extent = this.getContainerExtent();\n    return extent ? extent.getSize() : null;\n  };\n\n  _proto.containsPoint = function containsPoint(containerPoint, t) {\n    if (!this.getMap()) {\n      throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n    }\n\n    if (containerPoint instanceof Coordinate) {\n      containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n    }\n\n    return this._containsPoint(containerPoint, t);\n  };\n\n  _proto._containsPoint = function _containsPoint(containerPoint, t) {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return false;\n    }\n\n    if (isNil(t) && this._hitTestTolerance) {\n      t = this._hitTestTolerance();\n    }\n\n    return painter.hitTest(containerPoint, t);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n\n    if (this.getMap()) {\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.show();\n      }\n\n      this._fireEvent('show');\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n\n    if (this.getMap()) {\n      this.onHide();\n\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.hide();\n      }\n\n      this._fireEvent('hide');\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      return true;\n    }\n\n    if (Array.isArray(symbol)) {\n      if (!symbol.length) {\n        return true;\n      }\n\n      for (var i = 0, l = symbol.length; i < l; i++) {\n        if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      return isNil(symbol['opacity']) || isNumber(symbol['opacity']) && symbol['opacity'] > 0;\n    }\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this.options['zIndex'] || 0;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    var old = this.options['zIndex'];\n    this.options['zIndex'] = zIndex;\n\n    this._fireEvent('zindexchange', {\n      'old': old,\n      'new': zIndex\n    });\n\n    return this;\n  };\n\n  _proto.setZIndexSilently = function setZIndexSilently(zIndex) {\n    this.options['zIndex'] = zIndex;\n    return this;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMaxZIndex) {\n      return this;\n    }\n\n    var topZ = layer.getGeoMaxZIndex();\n    this.setZIndex(topZ + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMinZIndex) {\n      return this;\n    }\n\n    var bottomZ = layer.getGeoMinZIndex();\n    this.setZIndex(bottomZ - 1);\n    return this;\n  };\n\n  _proto.translate = function translate(x, y) {\n    if (isNil(x)) {\n      return this;\n    }\n\n    var offset = new Coordinate(x, y);\n\n    if (offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates) {\n      if (Array.isArray(coordinates)) {\n        var translated = forEachCoord(coordinates, function (coord) {\n          return coord.add(offset);\n        });\n        this.setCoordinates(translated);\n      } else {\n        this.setCoordinates(coordinates.add(offset));\n      }\n    }\n\n    return this;\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.copy = function copy() {\n    var json = this.toJSON();\n    var ret = Geometry.fromJSON(json);\n    ret.options['visible'] = true;\n    return ret;\n  };\n\n  _proto.remove = function remove() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._unbind();\n\n    this._fireEvent('removeend');\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto.toGeoJSONGeometry = function toGeoJSONGeometry() {\n    var gJson = this._exportGeoJSONGeometry();\n\n    return gJson;\n  };\n\n  _proto.toGeoJSON = function toGeoJSON(opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var feature = {\n      'type': 'Feature',\n      'geometry': null\n    };\n\n    if (isNil(opts['geometry']) || opts['geometry']) {\n      var geoJSON = this._exportGeoJSONGeometry();\n\n      feature['geometry'] = geoJSON;\n    }\n\n    var id = this.getId();\n\n    if (!isNil(id)) {\n      feature['id'] = id;\n    }\n\n    var properties;\n\n    if (isNil(opts['properties']) || opts['properties']) {\n      properties = this._exportProperties();\n    }\n\n    feature['properties'] = properties;\n    return feature;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = this._toJSON(options);\n\n    var other = this._exportGraphicOptions(options);\n\n    extend(json, other);\n    return json;\n  };\n\n  _proto.getLength = function getLength() {\n    return this._computeGeodesicLength(this._getMeasurer());\n  };\n\n  _proto.getArea = function getArea() {\n    return this._computeGeodesicArea(this._getMeasurer());\n  };\n\n  _proto.rotate = function rotate(angle, pivot) {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n      geometries.forEach(function (g) {\n        return g.rotate(angle, pivot);\n      });\n      return this;\n    }\n\n    if (!pivot) {\n      pivot = this.getCenter();\n    } else {\n      pivot = new Coordinate(pivot);\n    }\n\n    var measurer = this._getMeasurer();\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n        var c = measurer._rotate(coordinates, pivot, angle);\n\n        this.setCoordinates(c);\n      }\n\n      return this;\n    }\n\n    forEachCoord(coordinates, function (c) {\n      return measurer._rotate(c, pivot, angle);\n    });\n    this.setCoordinates(coordinates);\n    return this;\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    return [this.getCenter()];\n  };\n\n  _proto._initOptions = function _initOptions(options) {\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    this.setOptions(opts);\n\n    if (symbol) {\n      this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      this.setId(id);\n    }\n  };\n\n  _proto._bindLayer = function _bindLayer(layer) {\n    if (this.getLayer()) {\n      throw new Error('Geometry cannot be added to two or more layers at the same time.');\n    }\n\n    this._layer = layer;\n\n    this._clearCache();\n  };\n\n  _proto._prepareSymbol = function _prepareSymbol(symbol) {\n    if (Array.isArray(symbol)) {\n      var cookedSymbols = [];\n\n      for (var i = 0; i < symbol.length; i++) {\n        cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n      }\n\n      return cookedSymbols;\n    } else if (symbol) {\n      symbol = this._checkAndCopySymbol(symbol);\n      return convertResourceUrl(symbol);\n    }\n\n    return null;\n  };\n\n  _proto._checkAndCopySymbol = function _checkAndCopySymbol(symbol) {\n    var s = {};\n\n    for (var i in symbol) {\n      if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n        s[i] = +symbol[i];\n      } else {\n        s[i] = symbol[i];\n      }\n    }\n\n    return s;\n  };\n\n  _proto._getSymbol = function _getSymbol() {\n    return this._symbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    this._eventSymbolProperties = symbol;\n    this._externSymbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    if (this._symbol) {\n      return this._symbol;\n    } else if (this._externSymbol) {\n      return this._externSymbol;\n    } else if (this.options['symbol']) {\n      return this.options['symbol'];\n    }\n\n    return null;\n  };\n\n  _proto._getPrjExtent = function _getPrjExtent() {\n    var p = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._extent && p) {\n      this._extent = this._computePrjExtent(p);\n    }\n\n    return this._extent;\n  };\n\n  _proto._unbind = function _unbind() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    this._clearHandlers();\n\n    this._unbindMenu();\n\n    this._unbindInfoWindow();\n\n    if (this.isEditing()) {\n      this.endEdit();\n    }\n\n    this._removePainter();\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (layer.onRemoveGeometry) {\n      layer.onRemoveGeometry(this);\n    }\n\n    delete this._layer;\n    delete this._internalId;\n    delete this._extent;\n  };\n\n  _proto._getInternalId = function _getInternalId() {\n    return this._internalId;\n  };\n\n  _proto._setInternalId = function _setInternalId(id) {\n    this._internalId = id;\n  };\n\n  _proto._getMeasurer = function _getMeasurer() {\n    if (this._getProjection()) {\n      return this._getProjection();\n    }\n\n    return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n  };\n\n  _proto._getProjection = function _getProjection() {\n    var map = this.getMap();\n\n    if (map) {\n      return map.getProjection();\n    }\n\n    return null;\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this._getProjection();\n\n    if (this._projCode && projection && this._projCode !== projection.code) {\n      this._clearProjection();\n    }\n\n    this._projCode = projection ? projection.code : this._projCode;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    var symbol = this._getInternalSymbol();\n\n    return getExternalResources(symbol);\n  };\n\n  _proto._getPainter = function _getPainter() {\n    var layer = this.getLayer();\n\n    if (!this._painter && layer) {\n      if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n        if (layer.constructor.getCollectionPainterClass) {\n          var clazz = layer.constructor.getCollectionPainterClass();\n          this._painter = new clazz(this);\n        }\n      } else if (layer.constructor.getPainterClass) {\n        var _clazz = layer.constructor.getPainterClass();\n\n        this._painter = new _clazz(this);\n      }\n    }\n\n    return this._painter;\n  };\n\n  _proto._getMaskPainter = function _getMaskPainter() {\n    if (this._maskPainter) {\n      return this._maskPainter;\n    }\n\n    this._maskPainter = this.getGeometries && this.getGeometries() ? new CollectionPainter(this, true) : new Painter(this);\n    return this._maskPainter;\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n  };\n\n  _proto._paint = function _paint(extent) {\n    if (this._painter) {\n      this._painter.paint(extent);\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._extent;\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    delete this._extent;\n  };\n\n  _proto._repaint = function _repaint() {\n    if (this._painter) {\n      this._painter.repaint();\n    }\n  };\n\n  _proto.onHide = function onHide() {\n    this.closeMenu();\n    this.closeInfoWindow();\n  };\n\n  _proto.onShapeChanged = function onShapeChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('shapechange');\n  };\n\n  _proto.onPositionChanged = function onPositionChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('positionchange');\n  };\n\n  _proto.onSymbolChanged = function onSymbolChanged() {\n    if (this._painter) {\n      this._painter.refreshSymbol();\n    }\n\n    var e = {};\n\n    if (this._eventSymbolProperties) {\n      e.properties = extend({}, this._eventSymbolProperties);\n      delete this._eventSymbolProperties;\n    }\n\n    this._fireEvent('symbolchange', e);\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var properties;\n\n    if (conf['properties']) {\n      properties = conf['properties'];\n      delete conf['properties'];\n    }\n\n    var needRepaint = false;\n\n    for (var p in conf) {\n      if (conf.hasOwnProperty(p)) {\n        var prefix = p.slice(0, 5);\n\n        if (prefix === 'arrow' || prefix === 'smoot') {\n          needRepaint = true;\n          break;\n        }\n      }\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n\n      this._repaint();\n    } else if (needRepaint) {\n      this._repaint();\n    }\n  };\n\n  _proto._setParent = function _setParent(geometry) {\n    if (geometry) {\n      this._parent = geometry;\n    }\n  };\n\n  _proto._getParent = function _getParent() {\n    return this._parent;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventName;\n      param['target'] = this;\n\n      this.getLayer()._onGeometryEvent(param);\n    }\n\n    this.fire(eventName, param);\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options)\n    };\n  };\n\n  _proto._exportGraphicOptions = function _exportGraphicOptions(options) {\n    var json = {};\n\n    if (isNil(options['options']) || options['options']) {\n      json['options'] = this.config();\n    }\n\n    if (isNil(options['symbol']) || options['symbol']) {\n      json['symbol'] = this.getSymbol();\n    }\n\n    if (isNil(options['infoWindow']) || options['infoWindow']) {\n      if (this._infoWinOptions) {\n        json['infoWindow'] = this._infoWinOptions;\n      }\n    }\n\n    return json;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._exportProperties = function _exportProperties() {\n    var properties = null;\n    var geoProperties = this.getProperties();\n\n    if (!isNil(geoProperties)) {\n      if (isObject(geoProperties)) {\n        properties = extend({}, geoProperties);\n      } else {\n        properties = geoProperties;\n      }\n    }\n\n    return properties;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return 0;\n    }\n\n    var layerOpts = layer.options,\n        properties = this.getProperties();\n    var altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n    var layerAltitude = layer.getAltitude ? layer.getAltitude() : 0;\n\n    if (Array.isArray(altitude)) {\n      return altitude.map(function (alt) {\n        return alt + layerAltitude;\n      });\n    }\n\n    return altitude + layerAltitude;\n  };\n\n  return Geometry;\n}(JSONAble(Eventable(Handlerable(Class))));\n\nGeometry.mergeOptions(options);\nvar options$1 = {\n  'attribution': null,\n  'minZoom': null,\n  'maxZoom': null,\n  'visible': true,\n  'opacity': 1,\n  'globalCompositeOperation': null,\n  'renderer': 'canvas',\n  'debugOutline': '#0f0',\n  'cssFilter': null,\n  'forceRenderOnMoving': false,\n  'forceRenderOnZooming': false,\n  'forceRenderOnRotating': false,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }()\n};\n\nvar Layer = function (_JSONAble) {\n  _inheritsLoose(Layer, _JSONAble);\n\n  function Layer(id, options) {\n    var _this;\n\n    var canvas;\n\n    if (options) {\n      canvas = options.canvas;\n      delete options.canvas;\n    }\n\n    _this = _JSONAble.call(this, options) || this;\n    _this._canvas = canvas;\n\n    _this.setId(id);\n\n    if (options) {\n      _this.setZIndex(options.zIndex);\n\n      if (options.mask) {\n        _this.setMask(Geometry.fromJSON(options.mask));\n      }\n    }\n\n    return _this;\n  }\n\n  var _proto = Layer.prototype;\n\n  _proto.load = function load() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (this.onLoad()) {\n      this._initRenderer();\n\n      var zIndex = this.getZIndex();\n\n      if (!isNil(zIndex)) {\n        this._renderer.setZIndex(zIndex);\n\n        if (!this.isCanvasRender()) {\n          this._renderer.render();\n        }\n      }\n\n      this.onLoadEnd();\n    }\n\n    return this;\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var old = this._id;\n\n    if (!isNil(id)) {\n      id = id + '';\n    }\n\n    this._id = id;\n    this.fire('idchange', {\n      'old': old,\n      'new': id\n    });\n    return this;\n  };\n\n  _proto.addTo = function addTo(map) {\n    map.addLayer(this);\n    return this;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    this._zIndex = zIndex;\n\n    if (isNil(zIndex)) {\n      delete this.options['zIndex'];\n    } else {\n      this.options.zIndex = zIndex;\n    }\n\n    if (this.map) {\n      this.map._sortLayersByZIndex();\n    }\n\n    if (this._renderer) {\n      this._renderer.setZIndex(zIndex);\n    }\n\n    return this;\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this._zIndex || 0;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    var map = this.getMap();\n    var minZoom = this.options['minZoom'];\n    return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    var map = this.getMap();\n    var maxZoom = this.options['maxZoom'];\n    return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n  };\n\n  _proto.getOpacity = function getOpacity() {\n    return this.options['opacity'];\n  };\n\n  _proto.setOpacity = function setOpacity(op) {\n    this.config('opacity', op);\n    return this;\n  };\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    var renderer = this._getRenderer();\n\n    return renderer && renderer instanceof CanvasRenderer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (this.map) {\n      return this.map;\n    }\n\n    return null;\n  };\n\n  _proto.getProjection = function getProjection() {\n    var map = this.getMap();\n    return map ? map.getProjection() : null;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var topLayer = layers[layers.length - 1];\n\n    if (layers.length === 1 || topLayer === this) {\n      return this;\n    }\n\n    var max = topLayer.getZIndex();\n    this.setZIndex(max + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var bottomLayer = layers[0];\n\n    if (layers.length === 1 || bottomLayer === this) {\n      return this;\n    }\n\n    var min = bottomLayer.getZIndex();\n    this.setZIndex(min - 1);\n    return this;\n  };\n\n  _proto.show = function show() {\n    var _this2 = this;\n\n    if (!this.options['visible']) {\n      this.options['visible'] = true;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.show();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this2.fire('show');\n        });\n      } else {\n        this.fire('show');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this3 = this;\n\n    if (this.options['visible']) {\n      this.options['visible'] = false;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.hide();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this3.fire('hide');\n        });\n      } else {\n        this.fire('hide');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n      return false;\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      var zoom = map.getZoom();\n\n      if (!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom || !isNil(this.options['minZoom']) && this.options['minZoom'] > zoom) {\n        return false;\n      }\n    }\n\n    if (isNil(this.options['visible'])) {\n      this.options['visible'] = true;\n    }\n\n    return this.options['visible'];\n  };\n\n  _proto.remove = function remove() {\n    if (this.map) {\n      this.map.removeLayer(this);\n    }\n\n    return this;\n  };\n\n  _proto.getMask = function getMask() {\n    return this._mask;\n  };\n\n  _proto.setMask = function setMask(mask) {\n    if (!(mask.type === 'Point' && mask._isVectorMarker() || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n      throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n    }\n\n    mask._bindLayer(this);\n\n    if (mask.type === 'Point') {\n      mask.updateSymbol({\n        'markerLineColor': 'rgba(0, 0, 0, 0)',\n        'markerFillOpacity': 0\n      });\n    } else {\n      mask.setSymbol({\n        'lineColor': 'rgba(0, 0, 0, 0)',\n        'polygonOpacity': 0\n      });\n    }\n\n    this._mask = mask;\n    this.options.mask = mask.toJSON();\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.removeMask = function removeMask() {\n    delete this._mask;\n    delete this.options.mask;\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.onLoad = function onLoad() {\n    return true;\n  };\n\n  _proto.onLoadEnd = function onLoadEnd() {};\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    if (isNumber(conf['opacity']) || conf['cssFilter']) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.onRendererCreate = function onRendererCreate() {};\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto._bindMap = function _bindMap(map, zIndex) {\n    if (!map) {\n      return;\n    }\n\n    this.map = map;\n\n    if (!isNil(zIndex)) {\n      this.setZIndex(zIndex);\n    }\n\n    this._switchEvents('on', this);\n\n    this.onAdd();\n    this.fire('add');\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n\n    if (!this.constructor.getRendererClass) {\n      return;\n    }\n\n    var clazz = this.constructor.getRendererClass(renderer);\n\n    if (!clazz) {\n      throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n    }\n\n    this._renderer = new clazz(this);\n    this._renderer.layer = this;\n\n    this._renderer.setZIndex(this.getZIndex());\n\n    this._switchEvents('on', this._renderer);\n\n    if (this._renderer.onAdd) {\n      this._renderer.onAdd();\n    }\n\n    this.onRendererCreate();\n    this.fire('renderercreate', {\n      'renderer': this._renderer\n    });\n  };\n\n  _proto._doRemove = function _doRemove() {\n    this._loaded = false;\n    this.onRemove();\n\n    this._switchEvents('off', this);\n\n    if (this._renderer) {\n      this._switchEvents('off', this._renderer);\n\n      this._renderer.remove();\n\n      delete this._renderer;\n    }\n\n    delete this.map;\n  };\n\n  _proto._switchEvents = function _switchEvents(to, emitter) {\n    if (emitter && emitter.getEvents) {\n      this.getMap()[to](emitter.getEvents(), emitter);\n    }\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._getLayerList = function _getLayerList() {\n    if (!this.map) {\n      return [];\n    }\n\n    return this.map._layers;\n  };\n\n  _proto._getMask2DExtent = function _getMask2DExtent() {\n    if (!this._mask || !this.getMap()) {\n      return null;\n    }\n\n    var painter = this._mask._getMaskPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    return painter.get2DExtent();\n  };\n\n  return Layer;\n}(JSONAble(Eventable(Renderable(Class))));\n\nLayer.mergeOptions(options$1);\nvar fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n  if (eventType === 'layerload') {\n    this._loaded = true;\n  }\n\n  if (this.map) {\n    if (!param) {\n      param = {};\n    }\n\n    param['type'] = eventType;\n    param['target'] = this;\n\n    this.map._onLayerEvent(param);\n  }\n\n  return fire.apply(this, arguments);\n};\n\nvar options$2 = {\n  'maxVisualPitch': 70,\n  'maxPitch': 80,\n  'centerCross': false,\n  'zoomInCenter': false,\n  'zoomOrigin': null,\n  'zoomAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomAnimationDuration': 330,\n  'panAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'panAnimationDuration': 600,\n  'zoomable': true,\n  'enableInfoWindow': true,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }(),\n  'hitDetectLimit': 5,\n  'fpsOnInteracting': 25,\n  'layerCanvasLimitOnInteracting': -1,\n  'maxZoom': null,\n  'minZoom': null,\n  'maxExtent': null,\n  'fixCenterOnResize': true,\n  'checkSize': true,\n  'checkSizeInterval': 1000,\n  'renderer': 'canvas',\n  'cascadePitches': [10, 60]\n};\n\nvar Map$1 = function (_Handlerable) {\n  _inheritsLoose(Map, _Handlerable);\n\n  function Map(container, options) {\n    var _this;\n\n    if (!options) {\n      throw new Error('Invalid options when creating map.');\n    }\n\n    if (!options['center']) {\n      throw new Error('Invalid center when creating map.');\n    }\n\n    var opts = extend({}, options);\n    var zoom = opts['zoom'];\n    delete opts['zoom'];\n    var center = new Coordinate(opts['center']);\n    delete opts['center'];\n    var baseLayer = opts['baseLayer'];\n    delete opts['baseLayer'];\n    var layers = opts['layers'];\n    delete opts['layers'];\n    _this = _Handlerable.call(this, opts) || this;\n    _this.VERSION = Map.VERSION;\n    Object.defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), 'id', {\n      value: UID(),\n      writable: false\n    });\n    _this._loaded = false;\n\n    _this._initContainer(container);\n\n    _this._panels = {};\n    _this._baseLayer = null;\n    _this._layers = [];\n    _this._zoomLevel = zoom;\n    _this._center = center;\n\n    _this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n    _this.setMaxExtent(opts['maxExtent']);\n\n    _this._mapViewPoint = new Point(0, 0);\n\n    _this._initRenderer();\n\n    _this._updateMapSize(_this._getContainerDomSize());\n\n    if (baseLayer) {\n      _this.setBaseLayer(baseLayer);\n    }\n\n    if (layers) {\n      _this.addLayer(layers);\n    }\n\n    _this._Load();\n\n    return _this;\n  }\n\n  Map.addOnLoadHook = function addOnLoadHook(fn) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var onload = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n\n    this.prototype._onLoadHooks.push(onload);\n\n    return this;\n  };\n\n  var _proto = Map.prototype;\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this._containerDOM;\n  };\n\n  _proto.getSpatialReference = function getSpatialReference() {\n    return this._spatialReference;\n  };\n\n  _proto.setSpatialReference = function setSpatialReference(ref) {\n    var oldRef = this.options['spatialReference'];\n\n    if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n      return this;\n    }\n\n    this._updateSpatialReference(ref, oldRef);\n\n    return this;\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference(ref, oldRef) {\n    ref = extend({}, ref);\n    this._center = this.getCenter();\n    this.options['spatialReference'] = ref;\n    this._spatialReference = new SpatialReference(ref);\n\n    if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n      var projection = this._spatialReference.getProjection();\n\n      this.options['spatialReference']['projection'] = projection['code'];\n    }\n\n    this._resetMapStatus();\n\n    this._fireEvent('spatialreferencechange', {\n      'old': oldRef,\n      'new': extend({}, this.options['spatialReference'])\n    });\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var ref = conf['spatialReference'] || conf['view'];\n\n    if (!isNil(ref)) {\n      this._updateSpatialReference(ref, null);\n    }\n\n    return this;\n  };\n\n  _proto.getProjection = function getProjection() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getProjection();\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getFullExtent();\n  };\n\n  _proto.setCursor = function setCursor(cursor) {\n    delete this._cursor;\n\n    this._trySetCursor(cursor);\n\n    this._cursor = cursor;\n    return this;\n  };\n\n  _proto.resetCursor = function resetCursor() {\n    return this.setCursor(null);\n  };\n\n  _proto.getCenter = function getCenter() {\n    if (!this._loaded || !this._prjCenter) {\n      return this._center;\n    }\n\n    var projection = this.getProjection();\n    return projection.unproject(this._prjCenter);\n  };\n\n  _proto.setCenter = function setCenter(center) {\n    if (!center) {\n      return this;\n    }\n\n    center = new Coordinate(center);\n    var projection = this.getProjection();\n    var pcenter = projection.project(center);\n\n    if (!this._verifyExtent(pcenter)) {\n      return this;\n    }\n\n    if (!this._loaded) {\n      this._center = center;\n      return this;\n    }\n\n    this.onMoveStart();\n\n    this._setPrjCenter(pcenter);\n\n    this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return this._getContainerDomSize();\n    }\n\n    return new Size(this.width, this.height);\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var visualHeight = this.height;\n    var pitch = this.getPitch(),\n        maxVisualPitch = this.options['maxVisualPitch'];\n\n    if (maxVisualPitch && pitch > maxVisualPitch) {\n      visualHeight = this._getVisualHeight(maxVisualPitch);\n    }\n\n    return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n  };\n\n  _proto._getVisualHeight = function _getVisualHeight(visualPitch) {\n    visualPitch = visualPitch || 1E-2;\n    var pitch = (90 - this.getPitch()) * Math.PI / 180;\n    var fov = this.getFov() * Math.PI / 180;\n    visualPitch *= Math.PI / 180;\n    var cameraToCenter = this.cameraCenterDistance / this.getGLScale();\n    var tanB = Math.tan(fov / 2);\n    var tanP = Math.tan(visualPitch);\n    var visualDistance = cameraToCenter * tanB / (1 / tanP - tanB) / Math.sin(visualPitch);\n    var x = cameraToCenter * (Math.sin(pitch) * visualDistance / (cameraToCenter + Math.cos(pitch) * visualDistance));\n    return this.height / 2 + x;\n  };\n\n  _proto.getExtent = function getExtent() {\n    return this._pointToExtent(this._get2DExtent());\n  };\n\n  _proto.getProjExtent = function getProjExtent() {\n    var extent2D = this._get2DExtent();\n\n    return new Extent(this._pointToPrj(extent2D.getMin()), this._pointToPrj(extent2D.getMax()));\n  };\n\n  _proto.getPrjExtent = function getPrjExtent() {\n    return this.getProjExtent();\n  };\n\n  _proto.getMaxExtent = function getMaxExtent() {\n    if (!this.options['maxExtent']) {\n      return null;\n    }\n\n    return new Extent(this.options['maxExtent'], this.getProjection());\n  };\n\n  _proto.setMaxExtent = function setMaxExtent(extent) {\n    if (extent) {\n      var maxExt = new Extent(extent, this.getProjection());\n      this.options['maxExtent'] = maxExt;\n\n      if (!this._verifyExtent(this._getPrjCenter())) {\n        this._panTo(this._prjMaxExtent().getCenter());\n      }\n\n      var projection = this.getProjection();\n      this._prjMaxExtent = maxExt.convertTo(function (c) {\n        return projection.project(c);\n      });\n    } else {\n      delete this.options['maxExtent'];\n      delete this._prjMaxExtent;\n    }\n\n    return this;\n  };\n\n  _proto.getZoom = function getZoom() {\n    return this._zoomLevel;\n  };\n\n  _proto.getZoomForScale = function getZoomForScale(scale, fromZoom, isFraction) {\n    var zoom = this.getZoom();\n\n    if (isNil(fromZoom)) {\n      fromZoom = zoom;\n    }\n\n    if (scale === 1 && fromZoom === zoom) {\n      return zoom;\n    }\n\n    var res = this._getResolution(fromZoom),\n        targetRes = res / scale;\n\n    var scaleZoom = this.getZoomFromRes(targetRes);\n\n    if (isFraction) {\n      return scaleZoom;\n    } else {\n      var delta = 1E-6;\n      return this.getSpatialReference().getZoomDirection() < 0 ? Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n    }\n  };\n\n  _proto.getZoomFromRes = function getZoomFromRes(res) {\n    var resolutions = this._getResolutions(),\n        minRes = this._getResolution(this.getMinZoom()),\n        maxRes = this._getResolution(this.getMaxZoom());\n\n    if (minRes <= maxRes) {\n      if (res <= minRes) {\n        return this.getMinZoom();\n      } else if (res >= maxRes) {\n        return this.getMaxZoom();\n      }\n    } else if (res >= minRes) {\n      return this.getMinZoom();\n    } else if (res <= maxRes) {\n      return this.getMaxZoom();\n    }\n\n    var l = resolutions.length;\n\n    for (var i = 0; i < l - 1; i++) {\n      if (!resolutions[i]) {\n        continue;\n      }\n\n      var gap = resolutions[i + 1] - resolutions[i];\n      var test = res - resolutions[i];\n\n      if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n        return i + test / gap;\n      }\n    }\n\n    return l - 1;\n  };\n\n  _proto.setZoom = function setZoom(zoom, options) {\n    if (options === void 0) {\n      options = {\n        'animation': true\n      };\n    }\n\n    if (isNaN(zoom) || isNil(zoom)) {\n      return this;\n    }\n\n    zoom = +zoom;\n\n    if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n      this._zoomAnimation(zoom);\n    } else {\n      this._zoom(zoom);\n    }\n\n    return this;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    if (!isNil(this.options['maxZoom'])) {\n      return this.options['maxZoom'];\n    }\n\n    return this.getMaxNativeZoom();\n  };\n\n  _proto.setMaxZoom = function setMaxZoom(maxZoom) {\n    var viewMaxZoom = this.getMaxNativeZoom();\n\n    if (maxZoom > viewMaxZoom) {\n      maxZoom = viewMaxZoom;\n    }\n\n    if (maxZoom !== null && maxZoom < this._zoomLevel) {\n      this.setZoom(maxZoom);\n      maxZoom = +maxZoom;\n    }\n\n    this.options['maxZoom'] = maxZoom;\n    return this;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    if (!isNil(this.options['minZoom'])) {\n      return this.options['minZoom'];\n    }\n\n    return this._spatialReference.getMinZoom();\n  };\n\n  _proto.setMinZoom = function setMinZoom(minZoom) {\n    if (minZoom !== null) {\n      minZoom = +minZoom;\n\n      var viewMinZoom = this._spatialReference.getMinZoom();\n\n      if (minZoom < viewMinZoom) {\n        minZoom = viewMinZoom;\n      }\n\n      if (minZoom > this._zoomLevel) {\n        this.setZoom(minZoom);\n      }\n    }\n\n    this.options['minZoom'] = minZoom;\n    return this;\n  };\n\n  _proto.getMaxNativeZoom = function getMaxNativeZoom() {\n    var ref = this.getSpatialReference();\n\n    if (!ref) {\n      return null;\n    }\n\n    return ref.getMaxZoom();\n  };\n\n  _proto.getGLZoom = function getGLZoom() {\n    return this.getMaxNativeZoom() / 2;\n  };\n\n  _proto.getGLScale = function getGLScale(zoom) {\n    if (isNil(zoom)) {\n      zoom = this.getZoom();\n    }\n\n    return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n  };\n\n  _proto.zoomIn = function zoomIn() {\n    return this.setZoom(this.getZoom() + 1);\n  };\n\n  _proto.zoomOut = function zoomOut() {\n    return this.setZoom(this.getZoom() - 1);\n  };\n\n  _proto.isZooming = function isZooming() {\n    return !!this._zooming;\n  };\n\n  _proto.isInteracting = function isInteracting() {\n    return this.isZooming() || this.isMoving() || this.isRotating();\n  };\n\n  _proto.setCenterAndZoom = function setCenterAndZoom(center, zoom) {\n    if (!isNil(zoom) && this._zoomLevel !== zoom) {\n      this.setCenter(center);\n      this.setZoom(zoom, {\n        animation: false\n      });\n    } else {\n      this.setCenter(center);\n    }\n\n    return this;\n  };\n\n  _proto.getFitZoom = function getFitZoom(extent, isFraction) {\n    var _this2 = this;\n\n    if (!extent || !(extent instanceof Extent)) {\n      return this._zoomLevel;\n    }\n\n    if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n      return this.getMaxZoom();\n    }\n\n    var size = this.getSize();\n    var containerExtent = extent.convertTo(function (p) {\n      return _this2.coordToContainerPoint(p);\n    });\n    var w = containerExtent.getWidth(),\n        h = containerExtent.getHeight();\n    var scaleX = size['width'] / w,\n        scaleY = size['height'] / h;\n    var scale = this.getSpatialReference().getZoomDirection() < 0 ? Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n    var zoom = this.getZoomForScale(scale, null, isFraction);\n    return zoom;\n  };\n\n  _proto.getView = function getView() {\n    return {\n      'center': this.getCenter().toArray(),\n      'zoom': this.getZoom(),\n      'pitch': this.getPitch(),\n      'bearing': this.getBearing()\n    };\n  };\n\n  _proto.setView = function setView(view) {\n    if (!view) {\n      return this;\n    }\n\n    if (view['center']) {\n      this.setCenter(view['center']);\n    }\n\n    if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n      this.setZoom(+view['zoom'], {\n        'animation': false\n      });\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n      this.setPitch(+view['pitch']);\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n      this.setBearing(+view['bearing']);\n    }\n\n    return this;\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    return this._getResolution(zoom);\n  };\n\n  _proto.getScale = function getScale(zoom) {\n    var z = isNil(zoom) ? this.getZoom() : zoom;\n\n    var max = this._getResolution(this.getMaxNativeZoom()),\n        res = this._getResolution(z);\n\n    return res / max;\n  };\n\n  _proto.fitExtent = function fitExtent(extent, zoomOffset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!extent) {\n      return this;\n    }\n\n    extent = new Extent(extent, this.getProjection());\n    var zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n    var center = extent.getCenter();\n    if (typeof options['animation'] === 'undefined' || options['animation']) return this._animateTo({\n      center: center,\n      zoom: zoom\n    }, {\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'easing': options['easing'] || 'out'\n    }, step);else return this.setCenterAndZoom(center, zoom);\n  };\n\n  _proto.getBaseLayer = function getBaseLayer() {\n    return this._baseLayer;\n  };\n\n  _proto.setBaseLayer = function setBaseLayer(baseLayer) {\n    var isChange = false;\n\n    if (this._baseLayer) {\n      isChange = true;\n\n      this._fireEvent('baselayerchangestart');\n\n      this._baseLayer.remove();\n    }\n\n    if (!baseLayer) {\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerchangeend');\n\n      this._fireEvent('setbaselayer');\n\n      return this;\n    }\n\n    this._baseLayer = baseLayer;\n\n    baseLayer._bindMap(this, -1);\n\n    function onbaseLayerload() {\n      this._fireEvent('baselayerload');\n\n      if (isChange) {\n        isChange = false;\n\n        this._fireEvent('baselayerchangeend');\n      }\n    }\n\n    this._baseLayer.on('layerload', onbaseLayerload, this);\n\n    if (this._loaded) {\n      this._baseLayer.load();\n    }\n\n    this._fireEvent('setbaselayer');\n\n    return this;\n  };\n\n  _proto.removeBaseLayer = function removeBaseLayer() {\n    if (this._baseLayer) {\n      this._baseLayer.remove();\n\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerremove');\n    }\n\n    return this;\n  };\n\n  _proto.getLayers = function getLayers(filter) {\n    return this._getLayers(function (layer) {\n      if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        return false;\n      }\n\n      if (filter) {\n        return filter(layer);\n      }\n\n      return true;\n    });\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    if (!id) {\n      return null;\n    }\n\n    var layer = this._layerCache ? this._layerCache[id] : null;\n\n    if (layer) {\n      return layer;\n    }\n\n    var baseLayer = this.getBaseLayer();\n\n    if (baseLayer && baseLayer.getId() === id) {\n      return baseLayer;\n    }\n\n    return null;\n  };\n\n  _proto.addLayer = function addLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      layers = Array.prototype.slice.call(arguments, 0);\n      return this.addLayer(layers);\n    }\n\n    if (!this._layerCache) {\n      this._layerCache = {};\n    }\n\n    var mapLayers = this._layers;\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n      var id = layer.getId();\n\n      if (isNil(id)) {\n        throw new Error('Invalid id for the layer: ' + id);\n      }\n\n      if (layer.getMap() === this) {\n        continue;\n      }\n\n      if (this._layerCache[id]) {\n        throw new Error('Duplicate layer id in the map: ' + id);\n      }\n\n      this._layerCache[id] = layer;\n\n      layer._bindMap(this);\n\n      mapLayers.push(layer);\n\n      if (this._loaded) {\n        layer.load();\n      }\n    }\n\n    this._sortLayersByZIndex();\n\n    this._fireEvent('addlayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.removeLayer = function removeLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      return this.removeLayer([layers]);\n    }\n\n    var removed = [];\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n\n      if (!(layer instanceof Layer)) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!layer) {\n        continue;\n      }\n\n      var map = layer.getMap();\n\n      if (!map || map !== this) {\n        continue;\n      }\n\n      removed.push(layer);\n\n      this._removeLayer(layer, this._layers);\n\n      if (this._loaded) {\n        layer._doRemove();\n      }\n\n      var id = layer.getId();\n\n      if (this._layerCache) {\n        delete this._layerCache[id];\n      }\n    }\n\n    if (removed.length > 0) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setLayerCanvasUpdated();\n      }\n\n      this.once('frameend', function () {\n        removed.forEach(function (layer) {\n          layer.fire('remove');\n        });\n      });\n    }\n\n    this._fireEvent('removelayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.sortLayers = function sortLayers(layers) {\n    if (!layers || !Array.isArray(layers)) {\n      return this;\n    }\n\n    var layersToOrder = [];\n    var minZ = Number.MAX_VALUE;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (isString(layers[i])) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n        throw new Error('It must be a layer added to this map to order.');\n      }\n\n      if (layer.getZIndex() < minZ) {\n        minZ = layer.getZIndex();\n      }\n\n      layersToOrder.push(layer);\n    }\n\n    for (var _i = 0, _l = layersToOrder.length; _i < _l; _i++) {\n      layersToOrder[_i].setZIndex(minZ + _i);\n    }\n\n    return this;\n  };\n\n  _proto.toDataURL = function toDataURL(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var mimeType = options['mimeType'];\n\n    if (!mimeType) {\n      mimeType = 'image/png';\n    }\n\n    var save = options['save'];\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.toDataURL) {\n      var file = options['fileName'];\n\n      if (!file) {\n        file = 'export';\n      }\n\n      var dataURL = renderer.toDataURL(mimeType);\n\n      if (save && dataURL) {\n        var imgURL;\n\n        if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n          var blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n          imgURL = URL.createObjectURL(blob);\n        } else {\n          imgURL = dataURL;\n        }\n\n        var dlLink = document.createElement('a');\n        dlLink.download = file;\n        dlLink.href = imgURL;\n        document.body.appendChild(dlLink);\n        dlLink.click();\n        document.body.removeChild(dlLink);\n      }\n\n      return dataURL;\n    }\n\n    return null;\n  };\n\n  _proto.coordToPoint = function coordToPoint(coordinate, zoom, out) {\n    return this.coordinateToPoint(coordinate, zoom, out);\n  };\n\n  _proto.pointToCoord = function pointToCoord(point, zoom, out) {\n    return this.pointToCoordinate(point, zoom, out);\n  };\n\n  _proto.coordToViewPoint = function coordToViewPoint(coordinate, out, altitude) {\n    return this.coordinateToViewPoint(coordinate, out, altitude);\n  };\n\n  _proto.viewPointToCoord = function viewPointToCoord(viewPoint, out) {\n    return this.viewPointToCoordinate(viewPoint, out);\n  };\n\n  _proto.coordToContainerPoint = function coordToContainerPoint(coordinate, zoom, out) {\n    return this.coordinateToContainerPoint(coordinate, zoom, out);\n  };\n\n  _proto.containerPointToCoord = function containerPointToCoord(containerPoint, out) {\n    return this.containerPointToCoordinate(containerPoint, out);\n  };\n\n  _proto.containerPointToViewPoint = function containerPointToViewPoint(containerPoint, out) {\n    if (out) {\n      out.set(containerPoint.x, containerPoint.y);\n    } else {\n      out = containerPoint.copy();\n    }\n\n    return out._sub(this.getViewPoint());\n  };\n\n  _proto.viewPointToContainerPoint = function viewPointToContainerPoint(viewPoint, out) {\n    if (out) {\n      out.set(viewPoint.x, viewPoint.y);\n    } else {\n      out = viewPoint.copy();\n    }\n\n    return out._add(this.getViewPoint());\n  };\n\n  _proto.checkSize = function checkSize() {\n    var justStart = now() - this._initTime < 1500 && this.width === 0 || this.height === 0;\n\n    var watched = this._getContainerDomSize(),\n        oldHeight = this.height,\n        oldWidth = this.width;\n\n    if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n      return this;\n    }\n\n    var center = this.getCenter();\n\n    if (!this.options['fixCenterOnResize']) {\n      var vh = this._getVisualHeight(this.getPitch());\n\n      var nwCP = new Point(0, this.height - vh);\n\n      var nwCoord = this._containerPointToPrj(nwCP);\n\n      this._updateMapSize(watched);\n\n      var vhAfter = this._getVisualHeight(this.getPitch());\n\n      var nwCPAfter = new Point(0, this.height - vhAfter);\n\n      this._setPrjCoordAtContainerPoint(nwCoord, nwCPAfter);\n\n      this._mapViewCoord = this._getPrjCenter();\n    } else {\n      this._updateMapSize(watched);\n    }\n\n    var hided = watched['width'] === 0 || watched['height'] === 0 || oldWidth === 0 || oldHeight === 0;\n\n    if (justStart || hided) {\n      this._eventSilence = true;\n      this.setCenter(center);\n      delete this._eventSilence;\n    }\n\n    this._fireEvent('resize');\n\n    return this;\n  };\n\n  _proto.locate = function locate(coordinate, dx, dy) {\n    return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    return this._getRenderer().getMainPanel();\n  };\n\n  _proto.getPanels = function getPanels() {\n    return this._panels;\n  };\n\n  _proto.remove = function remove() {\n    var _this3 = this;\n\n    if (this.isRemoved()) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._removeDomEvents();\n\n    this._clearHandlers();\n\n    this.removeBaseLayer();\n    var layers = this.getLayers();\n\n    for (var i = 0; i < layers.length; i++) {\n      layers[i].remove();\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().remove();\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      Array.prototype.slice.call(this._containerDOM.childNodes, 0).filter(function (node) {\n        return node.className === 'maptalks-wrapper';\n      }).forEach(function (node) {\n        return _this3._containerDOM.removeChild(node);\n      });\n    }\n\n    delete this._panels;\n    delete this._containerDOM;\n    delete this.renderer;\n\n    this._fireEvent('removeend');\n\n    this._clearAllListeners();\n\n    return this;\n  };\n\n  _proto.isRemoved = function isRemoved() {\n    return !this._containerDOM;\n  };\n\n  _proto.isMoving = function isMoving() {\n    return !!this._moving;\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    var prjCenter = this._getPrjCenter();\n\n    if (!this._originCenter || this._verifyExtent(prjCenter)) {\n      this._originCenter = prjCenter;\n    }\n\n    this._moving = true;\n\n    this._trySetCursor('move');\n\n    this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this._moving = false;\n\n    this._trySetCursor('default');\n\n    this._fireEvent('moveend', param && param['domEvent'] ? this._parseEvent(param['domEvent'], 'moveend') : param);\n\n    if (!this._verifyExtent(this._getPrjCenter()) && this._originCenter) {\n      var moveTo = this._originCenter;\n\n      this._panTo(moveTo);\n    }\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart(param) {\n    this._dragRotating = true;\n\n    this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n  };\n\n  _proto.onDragRotating = function onDragRotating(param) {\n    this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n  };\n\n  _proto.onDragRotateEnd = function onDragRotateEnd(param) {\n    this._dragRotating = false;\n\n    this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n  };\n\n  _proto.isDragRotating = function isDragRotating() {\n    return !!this._dragRotating;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.getDevicePixelRatio = function getDevicePixelRatio() {\n    return this.options['devicePixelRatio'] || Browser$1.devicePixelRatio || 1;\n  };\n\n  _proto._initContainer = function _initContainer(container) {\n    if (isString(container)) {\n      this._containerDOM = document.getElementById(container);\n\n      if (!this._containerDOM) {\n        throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n      }\n    } else {\n      this._containerDOM = container;\n\n      if (IS_NODE) {\n        this.CanvasClass = this._containerDOM.constructor;\n      }\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n        throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n      }\n    }\n  };\n\n  _proto._trySetCursor = function _trySetCursor(cursor) {\n    if (!this._cursor && !this._priorityCursor) {\n      if (!cursor) {\n        cursor = 'default';\n      }\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setPriorityCursor = function _setPriorityCursor(cursor) {\n    if (!cursor) {\n      var hasCursor = false;\n\n      if (this._priorityCursor) {\n        hasCursor = true;\n      }\n\n      delete this._priorityCursor;\n\n      if (hasCursor) {\n        this.setCursor(this._cursor);\n      }\n    } else {\n      this._priorityCursor = cursor;\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setCursorToPanel = function _setCursorToPanel(cursor) {\n    var panel = this.getMainPanel();\n\n    if (panel && panel.style && panel.style.cursor !== cursor) {\n      panel.style.cursor = cursor;\n    }\n  };\n\n  _proto._removeLayer = function _removeLayer(layer, layerList) {\n    if (!layer || !layerList) {\n      return;\n    }\n\n    var index = layerList.indexOf(layer);\n\n    if (index > -1) {\n      layerList.splice(index, 1);\n    }\n  };\n\n  _proto._sortLayersByZIndex = function _sortLayersByZIndex() {\n    if (!this._layers) {\n      return;\n    }\n\n    for (var i = 0, l = this._layers.length; i < l; i++) {\n      this._layers[i]._order = i;\n    }\n\n    this._layers.sort(function (a, b) {\n      var c = a.getZIndex() - b.getZIndex();\n\n      if (c === 0) {\n        return a._order - b._order;\n      }\n\n      return c;\n    });\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._eventSilence) {\n      return;\n    }\n\n    this.fire('_' + eventName, param);\n    this.fire(eventName, param);\n  };\n\n  _proto._Load = function _Load() {\n    this._resetMapStatus();\n\n    if (this.options['pitch']) {\n      this.setPitch(this.options['pitch']);\n      delete this.options['pitch'];\n    }\n\n    if (this.options['bearing']) {\n      this.setBearing(this.options['bearing']);\n      delete this.options['bearing'];\n    }\n\n    this._loadAllLayers();\n\n    this._getRenderer().onLoad();\n\n    this._loaded = true;\n\n    this._callOnLoadHooks();\n\n    this._initTime = now();\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n    var clazz = Map.getRendererClass(renderer);\n    this._renderer = new clazz(this);\n\n    this._renderer.load();\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._loadAllLayers = function _loadAllLayers() {\n    function loadLayer(layer) {\n      if (layer) {\n        layer.load();\n      }\n    }\n\n    if (this._baseLayer) {\n      this._baseLayer.load();\n    }\n\n    this._eachLayer(loadLayer, this.getLayers());\n  };\n\n  _proto._getLayers = function _getLayers(filter) {\n    var layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n    var result = [];\n\n    for (var i = 0; i < layers.length; i++) {\n      if (!filter || filter.call(this, layers[i])) {\n        result.push(layers[i]);\n      }\n    }\n\n    return result;\n  };\n\n  _proto._eachLayer = function _eachLayer(fn) {\n    if (arguments.length < 2) {\n      return;\n    }\n\n    var layerLists = Array.prototype.slice.call(arguments, 1);\n\n    if (layerLists && !Array.isArray(layerLists)) {\n      layerLists = [layerLists];\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = layerLists.length; i < len; i++) {\n      layers = layers.concat(layerLists[i]);\n    }\n\n    for (var j = 0, jlen = layers.length; j < jlen; j++) {\n      fn.call(fn, layers[j]);\n    }\n  };\n\n  _proto._onLayerEvent = function _onLayerEvent(param) {\n    if (!param) {\n      return;\n    }\n\n    if (param['type'] === 'idchange') {\n      delete this._layerCache[param['old']];\n      this._layerCache[param['new']] = param['target'];\n    }\n  };\n\n  _proto._resetMapStatus = function _resetMapStatus() {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    var viewMaxZoom = this._spatialReference.getMaxZoom(),\n        viewMinZoom = this._spatialReference.getMinZoom();\n\n    if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n      this.setMaxZoom(viewMaxZoom);\n    }\n\n    if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n      this.setMinZoom(viewMinZoom);\n    }\n\n    maxZoom = this.getMaxZoom();\n    minZoom = this.getMinZoom();\n\n    if (maxZoom < minZoom) {\n      this.setMaxZoom(minZoom);\n    }\n\n    if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n      this._zoomLevel = maxZoom;\n    }\n\n    if (this._zoomLevel < minZoom) {\n      this._zoomLevel = minZoom;\n    }\n\n    delete this._prjCenter;\n    var projection = this.getProjection();\n    this._prjCenter = projection.project(this._center);\n\n    this._calcMatrices();\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.resetContainer();\n    }\n  };\n\n  _proto._getContainerDomSize = function _getContainerDomSize() {\n    if (!this._containerDOM) {\n      return null;\n    }\n\n    var containerDOM = this._containerDOM;\n    var width, height;\n\n    if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n      width = containerDOM.width;\n      height = containerDOM.height;\n      var dpr = this.getDevicePixelRatio();\n\n      if (dpr !== 1 && containerDOM['layer']) {\n        width /= dpr;\n        height /= dpr;\n      }\n    } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n      width = parseInt(containerDOM.clientWidth, 0);\n      height = parseInt(containerDOM.clientHeight, 0);\n    } else {\n      throw new Error('can not get size of container');\n    }\n\n    return new Size(width, height);\n  };\n\n  _proto._updateMapSize = function _updateMapSize(mSize) {\n    this.width = mSize['width'];\n    this.height = mSize['height'];\n\n    this._getRenderer().updateMapSize(mSize);\n\n    this._calcMatrices();\n\n    return this;\n  };\n\n  _proto._getPrjCenter = function _getPrjCenter() {\n    return this._prjCenter;\n  };\n\n  _proto._setPrjCenter = function _setPrjCenter(pcenter) {\n    this._prjCenter = pcenter;\n\n    if (this.isInteracting() && !this.isMoving()) {\n      this._mapViewCoord = pcenter;\n    }\n\n    this._calcMatrices();\n  };\n\n  _proto._setPrjCoordAtContainerPoint = function _setPrjCoordAtContainerPoint(coordinate, point) {\n    if (point.x === this.width / 2 && point.y === this.height / 2) {\n      return this;\n    }\n\n    var t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n\n    var pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n\n    this._setPrjCenter(pcenter);\n\n    return this;\n  };\n\n  _proto._verifyExtent = function _verifyExtent(prjCenter) {\n    if (!prjCenter) {\n      return false;\n    }\n\n    var maxExt = this._prjMaxExtent;\n\n    if (!maxExt) {\n      return true;\n    }\n\n    return maxExt.contains(prjCenter);\n  };\n\n  _proto._offsetCenterByPixel = function _offsetCenterByPixel(pixel) {\n    var pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n\n    var pCenter = this._containerPointToPrj(pos);\n\n    this._setPrjCenter(pCenter);\n\n    return pCenter;\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset) {\n    if (!offset) {\n      return this._mapViewPoint;\n    } else {\n      this._getRenderer().offsetPlatform(offset);\n\n      this._mapViewCoord = this._getPrjCenter();\n      this._mapViewPoint = this._mapViewPoint.add(offset);\n      return this;\n    }\n  };\n\n  _proto.getViewPoint = function getViewPoint() {\n    var offset = this._getViewPointFrameOffset();\n\n    var panelOffset = this.offsetPlatform();\n\n    if (offset) {\n      panelOffset = panelOffset.add(offset);\n    }\n\n    return panelOffset;\n  };\n\n  _proto._resetMapViewPoint = function _resetMapViewPoint() {\n    this._mapViewPoint = new Point(0, 0);\n    this._mapViewCoord = this._getPrjCenter();\n  };\n\n  _proto._getResolution = function _getResolution(zoom) {\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n      return this._mapRes;\n    } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n      return this._mapGlRes;\n    }\n\n    if (isNil(zoom)) {\n      zoom = this._zoomLevel;\n    }\n\n    return this._spatialReference.getResolution(zoom);\n  };\n\n  _proto._getResolutions = function _getResolutions() {\n    return this._spatialReference.getResolutions();\n  };\n\n  _proto._prjToPoint = function _prjToPoint(pCoord, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPrj = function _pointToPrj(point, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPoint = function _pointToPoint(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution(zoom) / this._getResolution());\n    }\n\n    return out;\n  };\n\n  _proto._pointToPointAtZoom = function _pointToPointAtZoom(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution() / this._getResolution(zoom));\n    }\n\n    return out;\n  };\n\n  _proto._containerPointToPrj = function _containerPointToPrj(containerPoint, out) {\n    return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n  };\n\n  _proto._callOnLoadHooks = function _callOnLoadHooks() {\n    var proto = Map.prototype;\n\n    if (!proto._onLoadHooks) {\n      return;\n    }\n\n    for (var i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n      proto._onLoadHooks[i].call(this);\n    }\n  };\n\n  return Map;\n}(Handlerable(Eventable(Renderable(Class))));\n\nMap$1.include({\n  coordinateToPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var prjCoord = this.getProjection().project(coordinate, COORD);\n      return this._prjToPoint(prjCoord, zoom, out);\n    };\n  }(),\n  pointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      var prjCoord = this._pointToPrj(point, zoom, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  coordinateToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, out, altitude) {\n      return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out, altitude);\n    };\n  }(),\n  viewPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (viewPoint, out) {\n      return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n    };\n  }(),\n  coordinateToContainerPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var pCoordinate = this.getProjection().project(coordinate, COORD);\n      return this._prjToContainerPoint(pCoordinate, zoom, out);\n    };\n  }(),\n  containerPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (containerPoint, out) {\n      var pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n\n      return this.getProjection().unproject(pCoordinate, out);\n    };\n  }(),\n  containerToExtent: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (containerExtent) {\n      var extent2D = new PointExtent(this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0), this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1));\n      return this._pointToExtent(extent2D);\n    };\n  }(),\n  distanceToPixel: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (xDist, yDist, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var scale = this.getScale() / this.getScale(zoom);\n      var center = this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToContainerPoint(center, undefined, POINT0),\n          p1 = this.coordToContainerPoint(target, undefined, POINT1);\n\n      p1._sub(p0)._multi(scale)._abs();\n\n      return new Size(p1.x, p1.y);\n    };\n  }(),\n  distanceToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (xDist, yDist, zoom, paramCenter) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var center = paramCenter || this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToPoint(center, zoom, POINT),\n          p1 = this.coordToPoint(target, zoom);\n\n      p1._sub(p0)._abs();\n\n      return p1;\n    };\n  }(),\n  pixelToDistance: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (width, height) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var fullExt = this.getFullExtent();\n      var d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n      var target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n      var coord = this.containerPointToCoord(target, COORD1);\n      return projection.measureLength(this.getCenter(), coord);\n    };\n  }(),\n  pointToDistance: function () {\n    var POINT = new Point(0, 0);\n    var COORD = new Coordinate(0, 0);\n    return function (dx, dy, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var c = this._prjToPoint(this._getPrjCenter(), zoom, POINT);\n\n      c._add(dx, dy);\n\n      var target = this.pointToCoord(c, zoom, COORD);\n      return projection.measureLength(this.getCenter(), target);\n    };\n  }(),\n  locateByPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (coordinate, px, py) {\n      var point = this.coordToContainerPoint(coordinate, undefined, POINT);\n      return this.containerPointToCoord(point._add(px, py));\n    };\n  }(),\n  _get2DExtent: function () {\n    var POINT = new Point(0, 0);\n    return function (zoom, out) {\n      var _this4 = this;\n\n      var cached;\n\n      if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n        cached = this._mapExtent2D;\n      } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n        cached = this._mapGlExtent2D;\n      }\n\n      if (cached) {\n        if (out) {\n          out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n          return out;\n        }\n\n        return cached.copy();\n      }\n\n      var cExtent = this.getContainerExtent();\n      return cExtent.convertTo(function (c) {\n        return _this4._containerPointToPoint(c, zoom, POINT);\n      }, out);\n    };\n  }(),\n  _pointToExtent: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (extent2D) {\n      var min2d = extent2D.getMin(),\n          max2d = extent2D.getMax();\n      var fullExtent = this.getFullExtent();\n\n      var _ref = !fullExtent || fullExtent.left <= fullExtent.right ? [min2d.x, max2d.x] : [max2d.x, min2d.x],\n          minx = _ref[0],\n          maxx = _ref[1];\n\n      var _ref2 = !fullExtent || fullExtent.top > fullExtent.bottom ? [max2d.y, min2d.y] : [min2d.y, max2d.y],\n          miny = _ref2[0],\n          maxy = _ref2[1];\n\n      var min = min2d.set(minx, maxy);\n      var max = max2d.set(maxx, miny);\n      return new Extent(this.pointToCoord(min, undefined, COORD0), this.pointToCoord(max, undefined, COORD1), this.getProjection());\n    };\n  }(),\n  _getViewPointFrameOffset: function () {\n    var POINT = new Point(0, 0);\n    return function () {\n      if (this.isZooming()) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCenter();\n\n      if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n        return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n      }\n\n      return null;\n    };\n  }(),\n  _viewPointToPrj: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, out) {\n      return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n    };\n  }(),\n  _prjToContainerPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, zoom, out, altitude) {\n      return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom, POINT), zoom, altitude || 0, out);\n    };\n  }(),\n  _prjToViewPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, out, altitude) {\n      var containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT, altitude);\n\n      return this.containerPointToViewPoint(containerPoint, out);\n    };\n  }(),\n  _viewPointToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, zoom, out) {\n      return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n    };\n  }(),\n  _pointToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n    };\n  }()\n});\nMap$1.mergeOptions(options$2);\n\nvar MapDoubleClickZoomHandler = function (_Handler) {\n  _inheritsLoose(MapDoubleClickZoomHandler, _Handler);\n\n  function MapDoubleClickZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDoubleClickZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto._onDoubleClick = function _onDoubleClick(param) {\n    var map = this.target;\n\n    if (map.options['doubleClickZoom']) {\n      var oldZoom = map.getZoom(),\n          zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n      map._zoomAnimation(zoom, param['containerPoint']);\n    }\n  };\n\n  return MapDoubleClickZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'doubleClickZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nvar MapDragHandler = function (_Handler) {\n  _inheritsLoose(MapDragHandler, _Handler);\n\n  function MapDragHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n\n    if (!map) {\n      return;\n    }\n\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    this._dragHandler = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'rightclick': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this).on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this).enable();\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._dragHandler.off('mousedown', this._onMouseDown, this).off('dragstart', this._onDragStart, this).off('dragging', this._onDragging, this).off('dragend', this._onDragEnd, this);\n\n    this._dragHandler.remove();\n\n    delete this._dragHandler;\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    if (this.target.isZooming() || this._ignore(domEvent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._ignore = function _ignore(param) {\n    if (!param) {\n      return false;\n    }\n\n    if (param.domEvent) {\n      param = param.domEvent;\n    }\n\n    return this.target._ignoreEvent(param);\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    delete this.startDragTime;\n    delete this._mode;\n\n    if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n      if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n        this._mode = 'rotatePitch';\n      }\n    } else if (this.target.options['dragPan']) {\n      this._mode = 'move';\n    }\n\n    this.target._stopAnim(this.target._mapAnimPlayer);\n\n    preventDefault(param['domEvent']);\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this.startDragTime = now();\n\n    if (this._mode === 'move') {\n      this._moveStart(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateStart(param);\n    }\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var map = this.target;\n\n    if (map._isEventOutMap(param['domEvent'])) {\n      return;\n    }\n\n    if (this._mode === 'move') {\n      this._moving(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotating(param);\n    }\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    if (this._mode === 'move') {\n      this._moveEnd(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateEnd(param);\n    }\n\n    delete this.startDragTime;\n    delete this.startBearing;\n  };\n\n  _proto._start = function _start(param) {\n    this.preX = param['mousePos'].x;\n    this.preY = param['mousePos'].y;\n    this.startX = this.preX;\n    this.startY = this.preY;\n  };\n\n  _proto._moveStart = function _moveStart(param) {\n    this._start(param);\n\n    var map = this.target;\n    map.onMoveStart(param);\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n    this.startPrjCoord = map._containerPointToPrj(p);\n  };\n\n  _proto._moving = function _moving(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n\n    map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n\n    map.onMoving(param);\n  };\n\n  _proto._moveEnd = function _moveEnd(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var t = now() - this.startDragTime;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var dx = mx - this.startX;\n    var dy = my - this.startY;\n\n    this._clear();\n\n    if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map._getPrjCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n      t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n      map.panBy(new Point(dx, dy), {\n        'duration': t\n      });\n    } else {\n      map.onMoveEnd(param);\n    }\n  };\n\n  _proto._rotateStart = function _rotateStart(param) {\n    this._start(param);\n\n    delete this._rotateMode;\n    this.startBearing = this.target.getBearing();\n    this.target.onDragRotateStart(param);\n    this._db = 0;\n  };\n\n  _proto._rotating = function _rotating(param) {\n    var map = this.target;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var prePitch = map.getPitch(),\n        preBearing = map.getBearing();\n    var dx = Math.abs(mx - this.preX),\n        dy = Math.abs(my - this.preY);\n\n    if (!this._rotateMode) {\n      if (map.options['dragRotatePitch']) {\n        this._rotateMode = 'rotate_pitch';\n      } else if (dx > dy) {\n        this._rotateMode = 'rotate';\n      } else if (dx < dy) {\n        this._rotateMode = 'pitch';\n      } else {\n        this._rotateMode = 'rotate';\n      }\n    }\n\n    if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n      return;\n    }\n\n    if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n      var db = 0;\n\n      if (map.options['dragPitch'] || dx > dy) {\n        db = -0.6 * (this.preX - mx);\n      } else if (mx > map.width / 2) {\n        db = 0.6 * (this.preY - my);\n      } else {\n        db = -0.6 * (this.preY - my);\n      }\n\n      var bearing = map.getBearing() + db;\n      this._db = this._db || 0;\n      this._db += db;\n      map.setBearing(bearing);\n    }\n\n    if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n      map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n    }\n\n    this.preX = mx;\n    this.preY = my;\n\n    if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n      map.onDragRotating(param);\n    }\n  };\n\n  _proto._rotateEnd = function _rotateEnd(param) {\n    var map = this.target;\n    var bearing = map.getBearing();\n\n    this._clear();\n\n    var t = now() - this.startDragTime;\n    map.onDragRotateEnd(param);\n\n    if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n      var _bearing = map.getBearing();\n\n      map._animateTo({\n        'bearing': _bearing + this._db / 2\n      }, {\n        'easing': 'out',\n        'duration': 800\n      });\n    }\n  };\n\n  _proto._clear = function _clear() {\n    delete this.startPrjCoord;\n    delete this.preX;\n    delete this.preY;\n    delete this.startX;\n    delete this.startY;\n  };\n\n  return MapDragHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'draggable': true,\n  'dragPan': true,\n  'dragRotatePitch': true,\n  'dragRotate': true,\n  'dragPitch': true\n});\nMap$1.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\nvar EVENTS = 'mousedown ' + 'mouseup ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar MapGeometryEventsHandler = function (_Handler) {\n  _inheritsLoose(MapGeometryEventsHandler, _Handler);\n\n  function MapGeometryEventsHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapGeometryEventsHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    on(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    off(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto._identifyGeometryEvents = function _identifyGeometryEvents(domEvent, type) {\n    var map = this.target;\n\n    if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n      return;\n    }\n\n    var layers = map._getLayers(function (layer) {\n      if (layer.identify && layer.options['geometryEvents']) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (!layers.length) {\n      return;\n    }\n\n    var oneMoreEvent = null;\n    var eventType = type || domEvent.type;\n\n    if (eventType === 'mousedown' || eventType === 'touchstart' && domEvent.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n      var downTime = this._mouseDownTime;\n      delete this._mouseDownTime;\n      var time = now();\n\n      if (time - downTime > 300) {\n        if (eventType === 'click') {\n          return;\n        }\n      } else if (eventType === 'touchend') {\n        oneMoreEvent = 'click';\n      }\n    }\n\n    var actual = domEvent.touches && domEvent.touches.length > 0 ? domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ? domEvent.changedTouches[0] : domEvent;\n\n    if (!actual) {\n      return;\n    }\n\n    var containerPoint = getEventContainerPoint(actual, map._containerDOM),\n        coordinate = map.containerPointToCoordinate(containerPoint);\n\n    if (eventType === 'touchstart') {\n      preventDefault(domEvent);\n    }\n\n    var geometryCursorStyle = null;\n    var identifyOptions = {\n      'includeInternals': true,\n      'filter': function filter(geometry) {\n        if (!(geometry instanceof Geometry)) {\n          return false;\n        }\n\n        var eventToFire = geometry._getEventTypeToFire(domEvent);\n\n        if (eventType === 'mousemove') {\n          if (!geometryCursorStyle && geometry.options['cursor']) {\n            geometryCursorStyle = geometry.options['cursor'];\n          }\n\n          if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n            return false;\n          }\n        } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n          return false;\n        }\n\n        return true;\n      },\n      'count': 1,\n      'coordinate': coordinate,\n      'onlyVisible': map.options['onlyVisibleGeometryEvents'],\n      'layers': layers\n    };\n    var callback = fireGeometryEvent.bind(this);\n\n    if (eventType === 'mousemove' || eventType === 'touchmove') {\n      this._queryIdentifyTimeout = map.getRenderer().callInNextFrame(function () {\n        if (map.isInteracting()) {\n          return;\n        }\n\n        map.identify(identifyOptions, callback);\n      });\n    } else {\n      map.identify(identifyOptions, callback);\n    }\n\n    function fireGeometryEvent(geometries) {\n      var propagation = true;\n\n      if (eventType === 'mousemove') {\n        var geoMap = {};\n\n        if (geometries.length > 0) {\n          for (var i = geometries.length - 1; i >= 0; i--) {\n            var geo = geometries[i];\n\n            if (!(geo instanceof Geometry)) {\n              continue;\n            }\n\n            var iid = geo._getInternalId();\n\n            geoMap[iid] = geo;\n\n            geo._onEvent(domEvent);\n\n            if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n              geo._onEvent(domEvent, 'mouseenter');\n            }\n\n            propagation = geo._onEvent(domEvent, 'mouseover');\n          }\n        }\n\n        map._setPriorityCursor(geometryCursorStyle);\n\n        var oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n        this._prevOverGeos = {\n          'geos': geometries,\n          'geomap': geoMap\n        };\n\n        if (oldTargets && oldTargets.length > 0) {\n          for (var _i = oldTargets.length - 1; _i >= 0; _i--) {\n            var oldTarget = oldTargets[_i];\n\n            if (!(oldTarget instanceof Geometry)) {\n              continue;\n            }\n\n            var oldTargetId = oldTargets[_i]._getInternalId();\n\n            if (!geoMap[oldTargetId]) {\n              propagation = oldTarget._onEvent(domEvent, 'mouseout');\n            }\n          }\n        }\n      } else {\n        if (!geometries || !geometries.length) {\n          return;\n        }\n\n        for (var _i2 = geometries.length - 1; _i2 >= 0; _i2--) {\n          if (!(geometries[_i2] instanceof Geometry)) {\n            continue;\n          }\n\n          propagation = geometries[_i2]._onEvent(domEvent);\n\n          if (oneMoreEvent) {\n            geometries[_i2]._onEvent(domEvent, oneMoreEvent);\n          }\n\n          break;\n        }\n      }\n\n      if (propagation === false) {\n        stopPropagation(domEvent);\n      }\n    }\n  };\n\n  return MapGeometryEventsHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'geometryEvents': true,\n  'onlyVisibleGeometryEvents': true\n});\nMap$1.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\nvar wheelZoomDelta = 4.000244140625;\nvar defaultZoomRate = 1 / 100;\nvar wheelZoomRate = 1 / 450;\nvar maxScalePerFrame = 2;\n\nvar MapScrollWheelZoomHandler = function (_Handler) {\n  _inheritsLoose(MapScrollWheelZoomHandler, _Handler);\n\n  function MapScrollWheelZoomHandler(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this._thisScrollZoom = _this._scrollZoom.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this._wheelZoomRate = wheelZoomRate;\n    _this._defaultZoomRate = defaultZoomRate;\n    _this._delta = 0;\n    return _this;\n  }\n\n  var _proto = MapScrollWheelZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll);\n  };\n\n  _proto._onWheelScroll = function _onWheelScroll(evt) {\n    preventDefault(evt);\n    stopPropagation(evt);\n    var map = this.target;\n\n    if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n      return false;\n    }\n\n    var container = map._containerDOM;\n\n    var origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n\n    if (map.options['seamlessZoom']) {\n      if (!this._zooming) {\n        this._trackPadSuspect = 0;\n        this._ensureTrackpad = false;\n      }\n\n      return this._seamless(evt, origin);\n    } else {\n      return this._interval(evt, origin);\n    }\n  };\n\n  _proto._seamless = function _seamless(evt, origin) {\n    var value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n\n    if (value % wheelZoomDelta !== 0) {\n      if (!this._ensureTrackpad) {\n        if (Math.abs(value) < 60) {\n          this._trackPadSuspect++;\n        } else {\n          this._trackPadSuspect = 0;\n        }\n\n        if (this._trackPadSuspect >= 2) {\n          this._ensureTrackpad = true;\n        }\n      }\n\n      if (this._ensureTrackpad) {\n        value *= 14;\n      }\n    }\n\n    if (evt.shiftKey && value) value = value / 4;\n    this._lastWheelEvent = evt;\n    this._delta -= value;\n\n    if (!this._zooming && this._delta) {\n      var map = this.target;\n      this._zoomOrigin = origin;\n      map.onZoomStart(null, origin);\n    }\n\n    this._start();\n  };\n\n  _proto._start = function _start() {\n    if (!this._delta) return;\n    this._zooming = true;\n    var map = this.target;\n\n    if (!this._active) {\n      map.getRenderer().callInNextFrame(this._thisScrollZoom);\n      this._active = true;\n    }\n  };\n\n  _proto._scrollZoom = function _scrollZoom() {\n    var _this2 = this;\n\n    this._active = false;\n\n    if (!this._delta) {\n      return;\n    }\n\n    var zoomRate = Math.abs(this._delta) > wheelZoomDelta ? this._wheelZoomRate : this._defaultZoomRate;\n    var scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n\n    if (this._delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    var map = this.target;\n    var zoom = map.getZoom();\n    var targetZoom = map.getZoomForScale(scale, zoom, true);\n    this._delta = 0;\n    map.onZooming(targetZoom, this._zoomOrigin);\n\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n\n    this._timeout = setTimeout(function () {\n      _this2._zooming = false;\n      delete _this2._timeout;\n      map.onZoomEnd(map.getZoom(), _this2._zoomOrigin);\n    }, 210);\n  };\n\n  _proto._interval = function _interval(evt, origin) {\n    var _this3 = this;\n\n    var map = this.target;\n\n    if (this._zooming) {\n      this._requesting++;\n      return false;\n    }\n\n    this._requesting = 0;\n    var levelValue = (evt.deltaY ? evt.deltaY * -1 : evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n\n    if (evt.detail) {\n      levelValue *= -1;\n    }\n\n    var zoom = map.getZoom();\n    var nextZoom = zoom + levelValue;\n    nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n\n    if (nextZoom === zoom) {\n      return false;\n    }\n\n    this._zooming = true;\n\n    if (!this._delta) {\n      map.onZoomStart(null, origin);\n      this._origin = origin;\n      this._delta = levelValue;\n      this._startZoom = map.getZoom();\n    }\n\n    var duration = 90;\n\n    map._animateTo({\n      'zoom': nextZoom - this._delta * 1 / 2,\n      'around': this._origin\n    }, {\n      'continueOnViewChanged': true,\n      'easing': 'linear',\n      'duration': duration,\n      'wheelZoom': true\n    }, function (frame) {\n      if (frame.state.playState !== 'finished') {\n        if (frame.state.playState !== 'running') {\n          delete _this3._zooming;\n          delete _this3._requesting;\n        }\n\n        return;\n      }\n\n      if (_this3._requesting < 1 || Math.abs(nextZoom - _this3._startZoom) > 2 || nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n        map._animateTo({\n          'zoom': nextZoom,\n          'around': _this3._origin\n        }, {\n          'continueOnViewChanged': true,\n          'duration': 100\n        }, function (frame) {\n          if (frame.state.playState !== 'running') {\n            delete _this3._zooming;\n            delete _this3._requesting;\n          }\n        });\n\n        delete _this3._startZoom;\n        delete _this3._origin;\n        delete _this3._delta;\n        _this3._requesting = 0;\n      } else if (!isNil(_this3._requesting)) {\n        delete _this3._zooming;\n\n        _this3._onWheelScroll(evt);\n      }\n    });\n\n    return false;\n  };\n\n  return MapScrollWheelZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'scrollWheelZoom': true,\n  'seamlessZoom': false\n});\nMap$1.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nvar MapTouchZoomHandler = function (_Handler) {\n  _inheritsLoose(MapTouchZoomHandler, _Handler);\n\n  function MapTouchZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTouchZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n  };\n\n  _proto._onTouchStart = function _onTouchStart(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer();\n    var p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container);\n    this.preY = p1.y;\n    this._startP1 = p1;\n    this._startP2 = p2;\n    this._startDist = p1.distanceTo(p2);\n    this._startVector = p1.sub(p2);\n    this._startZoom = map.getZoom();\n    this._startBearing = map.getBearing();\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n    addDomEvent(document, 'touchmove', this._onTouchMove, this);\n    addDomEvent(document, 'touchend', this._onTouchEnd, this);\n    preventDefault(event);\n\n    map._fireEvent('touchactstart');\n  };\n\n  _proto._onTouchMove = function _onTouchMove(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer(),\n        p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container),\n        d1 = p1.sub(this._startP1),\n        d2 = p2.sub(this._startP2),\n        vector = p1.sub(p2),\n        scale = p1.distanceTo(p2) / this._startDist,\n        bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n        preY = this.preY || p1.y,\n        pitch = (preY - p1.y) * 0.4;\n\n    this.preY = p1.y;\n    var param = {\n      'domEvent': event,\n      'mousePos': [p1, p2]\n    };\n\n    if (!this.mode) {\n      if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n        this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n      } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n        this.mode = 'pitch';\n      } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n        this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n      }\n\n      this._startTouching(param);\n    }\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      this._scale = scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZooming(zoom, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.setBearing(this._startBearing + bearing);\n      map.onDragRotating(param);\n    } else if (this.mode === 'pitch') {\n      map.setPitch(map.getPitch() + pitch);\n      map.onDragRotating(param);\n    }\n\n    map._fireEvent('touchactinging');\n  };\n\n  _proto._startTouching = function _startTouching(param) {\n    var map = this.target;\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var size = map.getSize();\n      this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n      map.onZoomStart(null, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n      map.onDragRotateStart(param);\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    delete this.preY;\n    var map = this.target;\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var scale = this._scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZoomEnd(zoom, this._Origin);\n    }\n\n    if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.onDragRotateEnd({\n        'domEvent': event\n      });\n    }\n\n    delete this.mode;\n\n    map._fireEvent('touchactend');\n  };\n\n  return MapTouchZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'touchGesture': true,\n  'touchZoom': true,\n  'touchPitch': true,\n  'touchRotate': true,\n  'touchZoomRotate': false\n});\nMap$1.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\nvar KEY = '__anim_player';\nvar Easing = {\n  in: function _in(t) {\n    return Math.pow(t, 2);\n  },\n  out: function out(t) {\n    return 1 - Easing.in(1 - t);\n  },\n  inAndOut: function inAndOut(t) {\n    return 3 * t * t - 2 * t * t * t;\n  },\n  linear: function linear(t) {\n    return t;\n  },\n  upAndDown: function upAndDown(t) {\n    if (t < 0.5) {\n      return Easing.inAndOut(2 * t);\n    } else {\n      return 1 - Easing.inAndOut(2 * (t - 0.5));\n    }\n  }\n};\n\nvar Frame = function Frame(state, styles) {\n  this.state = state;\n  this.styles = styles;\n};\n\nvar Player = function Player(animation, options, onFrame, target) {\n  this._animation = animation;\n  this.options = options;\n  this._onFrame = onFrame;\n  this.playState = 'idle';\n  this.ready = true;\n  this.finished = false;\n  this.target = target;\n};\n\nvar Animation = {\n  speed: {\n    'slow': 2000,\n    'normal': 1000,\n    'fast': 500\n  },\n  _resolveStyles: function _resolveStyles(styles) {\n    if (!styles) {\n      return null;\n    }\n\n    function resolveChild(child) {\n      if (!Array.isArray(child)) {\n        return Animation._resolveStyles(child);\n      }\n\n      var start = [],\n          d = [],\n          dest = [];\n\n      for (var i = 0; i < child.length; i++) {\n        var _styles = Animation._resolveStyles(child[i]);\n\n        if (_styles) {\n          start.push(_styles[0]);\n          d.push(_styles[1]);\n          dest.push(_styles[2]);\n        }\n      }\n\n      if (!start.length) {\n        return null;\n      } else {\n        return [start, d, dest];\n      }\n    }\n\n    function resolveVal(val) {\n      var values = val;\n      var clazz;\n\n      if (!Array.isArray(val)) {\n        if (isNumber(val)) {\n          values = [0, val];\n        } else if (val instanceof Point || val instanceof Coordinate) {\n          clazz = val.constructor;\n          values = [new clazz(0, 0), val];\n        } else {\n          values = [val, val];\n        }\n      }\n\n      var v1 = values[0],\n          v2 = values[1];\n\n      if (isNumber(v1) && isNumber(v2)) {\n        if (v1 === v2) {\n          return null;\n        }\n\n        return [v1, v2 - v1, v2];\n      } else if (Array.isArray(v1) && isNumber(v1[0]) || v1 instanceof Coordinate || v1 instanceof Point) {\n        if (Array.isArray(v1)) {\n          v1 = new Coordinate(v1);\n          v2 = new Coordinate(v2);\n        } else {\n          clazz = v1.constructor;\n          v1 = new clazz(v1);\n          v2 = new clazz(v2);\n        }\n\n        if (v1.equals(v2)) {\n          return null;\n        }\n\n        return [v1, v2.sub(v1), v2];\n      } else {\n        return [v1, v2, v2];\n      }\n    }\n\n    function isChild(val) {\n      if (!Array.isArray(val) && val.constructor === Object) {\n        return true;\n      } else if (Array.isArray(val) && val[0].constructor === Object) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var d = {},\n        start = {},\n        dest = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var values = styles[p];\n\n        if (!values) {\n          continue;\n        } else if (Array.isArray(values)) {\n          if (isNil(values[0]) || isNil(values[1])) {\n            continue;\n          }\n        }\n\n        var childStyles = void 0;\n\n        if (isChild(values)) {\n          childStyles = resolveChild(values);\n        } else {\n          childStyles = resolveVal(values);\n        }\n\n        if (childStyles) {\n          start[p] = childStyles[0];\n          d[p] = childStyles[1];\n          dest[p] = childStyles[2];\n        }\n      }\n    }\n\n    return [start, d, dest];\n  },\n  framing: function framing(styles, options) {\n    if (!options) {\n      options = {};\n    }\n\n    var easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n\n    if (!easing) {\n      easing = Easing.linear;\n    }\n\n    var dStyles, startStyles, destStyles;\n    styles = Animation._resolveStyles(styles);\n\n    if (styles) {\n      startStyles = styles[0];\n      dStyles = styles[1];\n      destStyles = styles[2];\n    }\n\n    var deltaStyles = function deltaStyles(delta, _startStyles, _dStyles) {\n      if (!_startStyles || !_dStyles) {\n        return null;\n      }\n\n      var result = {};\n\n      for (var p in _dStyles) {\n        if (_dStyles.hasOwnProperty(p)) {\n          if (_startStyles[p] === destStyles[p]) {\n            result[p] = _startStyles[p];\n            continue;\n          }\n\n          var s = _startStyles[p],\n              d = _dStyles[p];\n\n          if (isNumber(d)) {\n            result[p] = s + delta * d;\n          } else if (Array.isArray(d)) {\n            var children = [];\n\n            for (var i = 0; i < d.length; i++) {\n              children.push(deltaStyles(delta, s[i], d[i]));\n            }\n\n            result[p] = children;\n          } else {\n            var clazz = d.constructor;\n\n            if (clazz === Object) {\n              result[p] = deltaStyles(delta, s, d);\n            } else if (s instanceof Point || s instanceof Coordinate) {\n              result[p] = s.add(d.multi(delta));\n            } else {\n              result[p] = d;\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    return function (elapsed, duration) {\n      var state, d;\n\n      if (elapsed < 0) {\n        state = {\n          'playState': 'idle',\n          'delta': 0\n        };\n        d = startStyles;\n      } else if (elapsed < duration) {\n        var delta = easing(elapsed / duration);\n        state = {\n          'playState': 'running',\n          'delta': delta\n        };\n        d = deltaStyles(delta, startStyles, dStyles);\n      } else {\n        state = {\n          'playState': 'finished',\n          'delta': 1\n        };\n        d = destStyles;\n      }\n\n      state['startStyles'] = startStyles;\n      state['destStyles'] = destStyles;\n      state['progress'] = elapsed;\n      state['remainingMs'] = duration - elapsed;\n      return new Frame(state, d);\n    };\n  },\n  _requestAnimFrame: function _requestAnimFrame(fn) {\n    if (!this._frameQueue) {\n      this._frameQueue = [];\n    }\n\n    this._frameQueue.push(fn);\n\n    this._a();\n  },\n  _a: function _a() {\n    if (!this._animationFrameId) {\n      this._animationFrameId = requestAnimFrame(Animation._frameFn);\n    }\n  },\n  _run: function _run() {\n    if (this._frameQueue.length) {\n      var running = this._frameQueue;\n      this._frameQueue = [];\n\n      for (var i = 0, len = running.length; i < len; i++) {\n        running[i]();\n      }\n\n      if (this._frameQueue.length) {\n        this._animationFrameId = requestAnimFrame(Animation._frameFn);\n      } else {\n        delete this._animationFrameId;\n      }\n    }\n  },\n  animate: function animate(styles, options, step, target) {\n    if (!options) {\n      options = {};\n    }\n\n    var animation = Animation.framing(styles, options);\n    var player = new Player(animation, options, step, target);\n    return player;\n  }\n};\nAnimation._frameFn = Animation._run.bind(Animation);\nextend(Player.prototype, {\n  _prepare: function _prepare() {\n    var options = this.options;\n    var duration = options['speed'] || options['duration'];\n\n    if (isString(duration)) {\n      duration = Animation.speed[duration];\n\n      if (!duration) {\n        duration = +duration;\n      }\n    }\n\n    if (!duration) {\n      duration = Animation.speed['normal'];\n    }\n\n    this.duration = duration;\n    this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n  },\n  play: function play() {\n    if (this.playState !== 'idle' && this.playState !== 'paused' || this.target && this.target[KEY]) {\n      return this;\n    }\n\n    if (this.target) {\n      this.target[KEY] = 1;\n    }\n\n    if (this.playState === 'idle') {\n      this.currentTime = 0;\n\n      this._prepare();\n    }\n\n    var t = now();\n\n    if (!this.startTime) {\n      var options = this.options;\n      this.startTime = options['startTime'] ? options['startTime'] : t;\n    }\n\n    this._playStartTime = Math.max(t, this.startTime);\n\n    if (this.playState === 'paused') {\n      this._playStartTime -= this.currentTime;\n    }\n\n    this.playState = 'running';\n\n    this._run();\n\n    return this;\n  },\n  pause: function pause() {\n    if (this.playState === 'paused') {\n      return this;\n    }\n\n    this.playState = 'paused';\n\n    this._run();\n\n    return this;\n  },\n  cancel: function cancel() {\n    if (this.playState === 'idle') {\n      return this;\n    }\n\n    this.playState = 'idle';\n    this.finished = false;\n\n    this._run();\n\n    return this;\n  },\n  finish: function finish() {\n    if (this.playState === 'finished') {\n      return this;\n    }\n\n    this.playState = 'finished';\n    this.finished = true;\n\n    this._run();\n\n    return this;\n  },\n  reverse: function reverse() {},\n  _run: function _run() {\n    var _this = this;\n\n    var onFrame = this._onFrame;\n    var t = now();\n    var elapsed = t - this._playStartTime;\n\n    if (this.options['repeat'] && elapsed >= this.duration) {\n      this._playStartTime = t;\n      elapsed = 0;\n    }\n\n    if (this.playState !== 'running') {\n      if (this.target) {\n        delete this.target[KEY];\n      }\n\n      if (onFrame) {\n        if (this.playState === 'finished') {\n          elapsed = this.duration;\n        } else if (this.playState === 'idle') {\n          elapsed = 0;\n        }\n\n        var _frame = this._animation(elapsed, this.duration);\n\n        _frame.state.playState = this.playState;\n        onFrame(_frame);\n      }\n\n      return;\n    }\n\n    var frame = this._animation(elapsed, this.duration);\n\n    this.playState = frame.state['playState'];\n\n    if (this.playState !== 'running' && this.target) {\n      delete this.target[KEY];\n    }\n\n    if (this.playState === 'idle') {\n      if (this.startTime > t) {\n        setTimeout(this._run.bind(this), this.startTime - t);\n      }\n    } else if (this.playState === 'running') {\n      this._framer(function () {\n        if (_this.playState !== 'running') {\n          return;\n        }\n\n        _this.currentTime = elapsed;\n\n        if (onFrame) {\n          onFrame(frame);\n        }\n\n        _this._run();\n      });\n    } else if (this.playState === 'finished') {\n      this.finished = true;\n\n      if (onFrame) {\n        onFrame(frame);\n      }\n    }\n  }\n});\nvar Animation$1 = /*#__PURE__*/Object.freeze({\n  Animation: Animation,\n  Easing: Easing,\n  Player: Player,\n  Frame: Frame\n});\nvar simplify = createCommonjsModule(function (module) {\n  (function () {\n    function getSqDist(p1, p2) {\n      var dx = p1.x - p2.x,\n          dy = p1.y - p2.y;\n      return dx * dx + dy * dy;\n    }\n\n    function getSqSegDist(p, p1, p2) {\n      var x = p1.x,\n          y = p1.y,\n          dx = p2.x - x,\n          dy = p2.y - y;\n\n      if (dx !== 0 || dy !== 0) {\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n          x = p2.x;\n          y = p2.y;\n        } else if (t > 0) {\n          x += dx * t;\n          y += dy * t;\n        }\n      }\n\n      dx = p.x - x;\n      dy = p.y - y;\n      return dx * dx + dy * dy;\n    }\n\n    function simplifyRadialDist(points, sqTolerance) {\n      var prevPoint = points[0],\n          newPoints = [prevPoint],\n          point;\n\n      for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n          newPoints.push(point);\n          prevPoint = point;\n        }\n      }\n\n      if (prevPoint !== point) newPoints.push(point);\n      return newPoints;\n    }\n\n    function simplifyDPStep(points, first, last, sqTolerance, simplified) {\n      var maxSqDist = sqTolerance,\n          index;\n\n      for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n          index = i;\n          maxSqDist = sqDist;\n        }\n      }\n\n      if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n      }\n    }\n\n    function simplifyDouglasPeucker(points, sqTolerance) {\n      var last = points.length - 1;\n      var simplified = [points[0]];\n      simplifyDPStep(points, 0, last, sqTolerance, simplified);\n      simplified.push(points[last]);\n      return simplified;\n    }\n\n    function simplify(points, tolerance, highestQuality) {\n      if (points.length <= 2) return points;\n      var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n      points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n      points = simplifyDouglasPeucker(points, sqTolerance);\n      return points;\n    }\n\n    {\n      module.exports = simplify;\n      module.exports.default = simplify;\n    }\n  })();\n});\nvar options$3 = {\n  'smoothness': 0,\n  'enableClip': true,\n  'enableSimplify': true,\n  'simplifyTolerance': 2,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 1,\n    'opacity': 1\n  }\n};\n\nvar Path = function (_Geometry) {\n  _inheritsLoose(Path, _Geometry);\n\n  function Path() {\n    return _Geometry.apply(this, arguments) || this;\n  }\n\n  var _proto = Path.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var extent = this.getExtent();\n    return new Polygon(extent.toArray(), {\n      symbol: {\n        'lineWidth': 1,\n        'lineColor': '6b707b'\n      }\n    });\n  };\n\n  _proto.animateShow = function animateShow(options, cb) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._showPlayer) {\n      this._showPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      options = {};\n      cb = options;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates.length === 0) {\n      return this;\n    }\n\n    this._animIdx = 0;\n    this._animLenSoFar = 0;\n    this.show();\n    var isPolygon = !!this.getShell;\n    var animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n\n    var projection = this._getProjection();\n\n    var prjAnimCoords = projection.projectCoords(animCoords);\n    this._prjAniShowCenter = this._getPrjExtent().getCenter();\n    this._aniShowCenter = projection.unproject(this._prjAniShowCenter);\n    var duration = options['duration'] || 1000,\n        easing = options['easing'] || 'out';\n    this.setCoordinates([]);\n    var length = 0;\n\n    for (var i = 1; i < prjAnimCoords.length; i++) {\n      length += prjAnimCoords[i].distanceTo(prjAnimCoords[i - 1]);\n    }\n\n    var player = this._showPlayer = Animation.animate({\n      't': duration\n    }, {\n      'duration': duration,\n      'easing': easing\n    }, function (frame) {\n      if (!_this.getMap()) {\n        if (player.playState !== 'finished') {\n          player.finish();\n\n          if (cb) {\n            var _coordinates = _this.getCoordinates();\n\n            cb(frame, _coordinates[_coordinates.length - 1]);\n          }\n        }\n\n        return;\n      }\n\n      var currentCoord = _this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords, prjAnimCoords);\n\n      if (frame.state.playState === 'finished') {\n        delete _this._showPlayer;\n        delete _this._aniShowCenter;\n        delete _this._prjAniShowCenter;\n        delete _this._animIdx;\n        delete _this._animLenSoFar;\n        delete _this._animTailRatio;\n\n        _this.setCoordinates(coordinates);\n      }\n\n      if (cb) {\n        cb(frame, currentCoord);\n      }\n    }, this);\n    player.play();\n    return player;\n  };\n\n  _proto._drawAnimShowFrame = function _drawAnimShowFrame(t, duration, length, coordinates, prjCoords) {\n    if (t === 0) {\n      return coordinates[0];\n    }\n\n    var projection = this._getProjection();\n\n    var targetLength = t / duration * length;\n    var segLen = 0;\n    var i, l;\n\n    for (i = this._animIdx, l = prjCoords.length; i < l - 1; i++) {\n      segLen = prjCoords[i].distanceTo(prjCoords[i + 1]);\n\n      if (this._animLenSoFar + segLen > targetLength) {\n        break;\n      }\n\n      this._animLenSoFar += segLen;\n    }\n\n    this._animIdx = i;\n\n    if (this._animIdx >= l - 1) {\n      this.setCoordinates(coordinates);\n      return coordinates[coordinates.length - 1];\n    }\n\n    var idx = this._animIdx;\n    var p1 = prjCoords[idx],\n        p2 = prjCoords[idx + 1],\n        span = targetLength - this._animLenSoFar,\n        r = span / segLen;\n    this._animTailRatio = r;\n    var x = p1.x + (p2.x - p1.x) * r,\n        y = p1.y + (p2.y - p1.y) * r,\n        lastCoord = new Coordinate(x, y);\n    var targetCoord = projection.unproject(lastCoord);\n    var isPolygon = !!this.getShell;\n\n    if (!isPolygon && this.options['smoothness'] > 0) {\n      var animCoords = coordinates.slice(0, this._animIdx + 3);\n      this.setCoordinates(animCoords);\n      var prjAnimCoords = prjCoords.slice(0, this._animIdx + 3);\n\n      this._setPrjCoordinates(prjAnimCoords);\n    } else {\n      var _animCoords = coordinates.slice(0, this._animIdx + 1);\n\n      _animCoords.push(targetCoord);\n\n      var _prjAnimCoords = prjCoords.slice(0, this._animIdx + 1);\n\n      _prjAnimCoords.push(lastCoord);\n\n      if (isPolygon) {\n        this.setCoordinates([this._aniShowCenter].concat(_animCoords));\n\n        this._setPrjCoordinates([this._prjAniShowCenter].concat(_prjAnimCoords));\n      } else {\n        this.setCoordinates(_animCoords);\n\n        this._setPrjCoordinates(_prjAnimCoords);\n      }\n    }\n\n    return targetCoord;\n  };\n\n  _proto._getCenterInExtent = function _getCenterInExtent(extent, coordinates, clipFn) {\n    var meExtent = this.getExtent();\n\n    if (!extent.intersects(meExtent)) {\n      return null;\n    }\n\n    var clipped = clipFn(coordinates, extent);\n\n    if (clipped.length === 0) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    clipped.forEach(function (part) {\n      if (Array.isArray(part)) {\n        part.forEach(function (c) {\n          if (c.point) {\n            c = c.point;\n          }\n\n          sumx += c.x;\n          sumy += c.y;\n          counter++;\n        });\n      } else {\n        if (part.point) {\n          part = part.point;\n        }\n\n        sumx += part.x;\n        sumy += part.y;\n        counter++;\n      }\n    });\n\n    var c = new Coordinate(sumx, sumy)._multi(1 / counter);\n\n    c.count = counter;\n    return c;\n  };\n\n  _proto._getPath2DPoints = function _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n    if (!isArrayHasData(prjCoords)) {\n      return [];\n    }\n\n    var map = this.getMap(),\n        isSimplify = !disableSimplify && this._shouldSimplify(),\n        tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n        isMulti = Array.isArray(prjCoords[0]);\n\n    delete this._simplified;\n\n    if (isSimplify && !isMulti) {\n      var count = prjCoords.length;\n      prjCoords = simplify(prjCoords, tolerance, false);\n      this._simplified = prjCoords.length < count;\n    }\n\n    if (isNil(zoom)) {\n      zoom = map.getZoom();\n    }\n\n    return forEachCoord(prjCoords, function (c) {\n      return map._prjToPoint(c, zoom);\n    });\n  };\n\n  _proto._shouldSimplify = function _shouldSimplify() {\n    var layer = this.getLayer(),\n        properties = this.getProperties();\n    var hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n    return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjPoints) {\n    this._prjCoords = prjPoints;\n    this.onShapeChanged();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    this._verifyProjection();\n\n    if (!this._prjCoords && this._getProjection()) {\n      this._prjCoords = this._projectCoords(this._coordinates);\n    }\n\n    return this._prjCoords;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (!projection) {\n      return;\n    }\n\n    if (this._prjCoords) {\n      this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._prjCoords = null;\n\n    _Geometry.prototype._clearProjection.call(this);\n  };\n\n  _proto._projectCoords = function _projectCoords(points) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.projectCoords(points);\n    }\n\n    return [];\n  };\n\n  _proto._unprojectCoords = function _unprojectCoords(prjPoints) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.unprojectCoords(prjPoints);\n    }\n\n    return [];\n  };\n\n  _proto._computeCenter = function _computeCenter() {\n    var ring = this._coordinates;\n\n    if (!isArrayHasData(ring)) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    var size = ring.length;\n\n    for (var i = 0; i < size; i++) {\n      if (ring[i]) {\n        if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n          sumx += ring[i].x;\n          sumy += ring[i].y;\n          counter++;\n        }\n      }\n    }\n\n    return new Coordinate(sumx / counter, sumy / counter);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    var shell = this._coordinates;\n\n    if (!isArrayHasData(shell)) {\n      return null;\n    }\n\n    var rings = [shell];\n\n    if (this.hasHoles && this.hasHoles()) {\n      rings.push.apply(rings, this.getHoles());\n    }\n\n    return this._coords2Extent(rings, this._getProjection());\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    var coords = [this._getPrjCoordinates()];\n\n    if (this.hasHoles && this.hasHoles()) {\n      coords.push.apply(coords, this._getPrjHoles());\n    }\n\n    return this._coords2Extent(coords);\n  };\n\n  _proto._get2DLength = function _get2DLength() {\n    var vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n\n    var len = 0;\n\n    for (var i = 1, l = vertexes.length; i < l; i++) {\n      len += vertexes[i].distanceTo(vertexes[i - 1]);\n    }\n\n    return len;\n  };\n\n  _proto._hitTestTolerance = function _hitTestTolerance() {\n    var symbol = this._getInternalSymbol();\n\n    var w;\n\n    if (Array.isArray(symbol)) {\n      w = 0;\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (isNumber(symbol[i]['lineWidth'])) {\n          if (symbol[i]['lineWidth'] > w) {\n            w = symbol[i]['lineWidth'];\n          }\n        }\n      }\n    } else {\n      w = symbol['lineWidth'];\n    }\n\n    return isNumber(w) ? w / 2 : 1.5;\n  };\n\n  _proto._coords2Extent = function _coords2Extent(coords, proj) {\n    var result = new Extent(proj);\n\n    for (var i = 0, l = coords.length; i < l; i++) {\n      for (var j = 0, ll = coords[i].length; j < ll; j++) {\n        result._combine(coords[i][j]);\n      }\n    }\n\n    return result;\n  };\n\n  return Path;\n}(Geometry);\n\nPath.mergeOptions(options$3);\nvar JSON_TYPE = 'Polygon';\n\nvar Polygon = function (_Path) {\n  _inheritsLoose(Polygon, _Path);\n\n  function Polygon(coordinates, opts) {\n    var _this;\n\n    _this = _Path.call(this, opts) || this;\n    _this.type = 'Polygon';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Polygon.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n      this._holes = null;\n\n      this._projectRings();\n\n      return this;\n    }\n\n    var rings = Coordinate.toCoordinates(coordinates);\n    var len = rings.length;\n\n    if (!Array.isArray(rings[0])) {\n      this._coordinates = this._trimRing(rings);\n    } else {\n      this._coordinates = this._trimRing(rings[0]);\n\n      if (len > 1) {\n        var holes = [];\n\n        for (var i = 1; i < len; i++) {\n          if (!rings[i]) {\n            continue;\n          }\n\n          holes.push(this._trimRing(rings[i]));\n        }\n\n        this._holes = holes;\n      }\n    }\n\n    this._projectRings();\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    if (!this._coordinates) {\n      return [];\n    }\n\n    var holes = this.getHoles();\n    var rings = [this._copyAndCloseRing(this._coordinates)];\n\n    for (var i = 0, l = holes.length; i < l; i++) {\n      rings.push(this._copyAndCloseRing(holes[i]));\n    }\n\n    return rings;\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n  };\n\n  _proto.getShell = function getShell() {\n    return this._coordinates || [];\n  };\n\n  _proto.getHoles = function getHoles() {\n    return this._holes || [];\n  };\n\n  _proto.hasHoles = function hasHoles() {\n    return this.getHoles().length > 0;\n  };\n\n  _proto._projectRings = function _projectRings() {\n    if (!this.getMap()) {\n      this.onShapeChanged();\n      return;\n    }\n\n    this._prjCoords = this._projectCoords(this._coordinates);\n    this._prjHoles = this._projectCoords(this._holes);\n    this.onShapeChanged();\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjCoords) {\n    this._prjCoords = prjCoords;\n    this.onShapeChanged();\n  };\n\n  _proto._cleanRing = function _cleanRing(ring) {\n    for (var i = ring.length - 1; i >= 0; i--) {\n      if (!ring[i]) {\n        ring.splice(i, 1);\n      }\n    }\n  };\n\n  _proto._checkRing = function _checkRing(ring) {\n    this._cleanRing(ring);\n\n    if (!ring || !isArrayHasData(ring)) {\n      return false;\n    }\n\n    var lastPoint = ring[ring.length - 1];\n    var isClose = true;\n\n    if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n      isClose = false;\n    }\n\n    return isClose;\n  };\n\n  _proto._trimRing = function _trimRing(ring) {\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && isClose) {\n      ring.splice(ring.length - 1, 1);\n    }\n\n    return ring;\n  };\n\n  _proto._copyAndCloseRing = function _copyAndCloseRing(ring) {\n    ring = ring.slice(0);\n\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && !isClose) {\n      ring.push(ring[0].copy());\n      return ring;\n    } else {\n      return ring;\n    }\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    if (this.getJSONType() === JSON_TYPE) {\n      return this._getPrjCoordinates();\n    }\n\n    this._verifyProjection();\n\n    if (this._getProjection() && !this._prjShell) {\n      this._prjShell = this._projectCoords(this.getShell());\n    }\n\n    return this._prjShell;\n  };\n\n  _proto._getPrjHoles = function _getPrjHoles() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (projection && !this._prjHoles) {\n      this._prjHoles = this._projectCoords(this.getHoles());\n    }\n\n    return this._prjHoles;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = 0;\n\n    for (var i = 0, len = rings.length; i < len; i++) {\n      result += measurer.measureLength(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = measurer.measureArea(rings[0]);\n\n    for (var i = 1, len = rings.length; i < len; i++) {\n      result -= measurer.measureArea(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    _Path.prototype._updateCache.call(this);\n\n    if (this._prjHoles) {\n      this._holes = this._unprojectCoords(this._getPrjHoles());\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._prjShell;\n    return _Path.prototype._clearCache.call(this);\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this._prjHoles) {\n      this._prjHoles = null;\n    }\n\n    if (this._prjShell) {\n      this._prjShell = null;\n    }\n\n    _Path.prototype._clearProjection.call(this);\n  };\n\n  return Polygon;\n}(Path);\n\nPolygon.registerJSONType(JSON_TYPE);\n\nfunction CenterMixin(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.getCoordinates = function getCoordinates() {\n      return this._coordinates;\n    };\n\n    _proto.setCoordinates = function setCoordinates(coordinates) {\n      var center = coordinates instanceof Coordinate ? coordinates : new Coordinate(coordinates);\n\n      if (center.equals(this._coordinates)) {\n        return this;\n      }\n\n      this._coordinates = center;\n\n      if (!this.getMap()) {\n        this.onPositionChanged();\n        return this;\n      }\n\n      var projection = this._getProjection();\n\n      this._setPrjCoordinates(projection.project(this._coordinates));\n\n      return this;\n    };\n\n    _proto._getCenter2DPoint = function _getCenter2DPoint(zoom) {\n      var map = this.getMap();\n\n      if (!map) {\n        return null;\n      }\n\n      var z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n\n      var pcenter = this._getPrjCoordinates();\n\n      if (!pcenter) {\n        return null;\n      }\n\n      return map._prjToPoint(pcenter, z);\n    };\n\n    _proto._getPrjCoordinates = function _getPrjCoordinates() {\n      var projection = this._getProjection();\n\n      this._verifyProjection();\n\n      if (!this._pcenter && projection) {\n        if (this._coordinates) {\n          this._pcenter = projection.project(this._coordinates);\n        }\n      }\n\n      return this._pcenter;\n    };\n\n    _proto._setPrjCoordinates = function _setPrjCoordinates(pcenter) {\n      this._pcenter = pcenter;\n      this.onPositionChanged();\n    };\n\n    _proto._updateCache = function _updateCache() {\n      this._clearCache();\n\n      var projection = this._getProjection();\n\n      if (this._pcenter && projection) {\n        this._coordinates = projection.unproject(this._pcenter);\n      }\n    };\n\n    _proto._clearProjection = function _clearProjection() {\n      this._pcenter = null;\n\n      _Base.prototype._clearProjection.call(this);\n    };\n\n    _proto._computeCenter = function _computeCenter() {\n      return this._coordinates ? this._coordinates.copy() : null;\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar options$4 = {\n  'symbol': {\n    'markerType': 'path',\n    'markerPath': [{\n      'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n      'fill': '#DE3333'\n    }],\n    'markerPathWidth': 16,\n    'markerPathHeight': 23,\n    'markerWidth': 24,\n    'markerHeight': 34\n  },\n  'hitTestForEvent': false\n};\n\nvar Marker = function (_CenterMixin) {\n  _inheritsLoose(Marker, _CenterMixin);\n\n  function Marker(coordinates, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, opts) || this;\n    _this.type = 'Point';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Marker.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var coord = this.getCoordinates();\n    var extent = painter.getContainerExtent();\n    var anchor = this.getMap().coordToContainerPoint(coord);\n    return new Marker(coord, {\n      'symbol': {\n        'markerType': 'square',\n        'markerWidth': extent.getWidth(),\n        'markerHeight': extent.getHeight(),\n        'markerLineWidth': 1,\n        'markerLineColor': '6b707b',\n        'markerFill': 'rgba(0, 0, 0, 0)',\n        'markerDx': extent.xmin - (anchor.x - extent.getWidth() / 2),\n        'markerDy': extent.ymin - (anchor.y - extent.getHeight() / 2)\n      }\n    });\n  };\n\n  _proto._isVectorMarker = function _isVectorMarker() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._canEdit = function _canEdit() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol) || ImageMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    var extent = this.getContainerExtent();\n\n    if (t) {\n      extent = extent.expand(t);\n    }\n\n    if (extent.contains(point)) {\n      if (this.options['hitTestForEvent']) {\n        return _CenterMixin.prototype._containsPoint.call(this, point, t);\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return computeExtent.call(this, 'getCenter');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return computeExtent.call(this, '_getPrjCoordinates');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    return 0;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  _proto._getSprite = function _getSprite(resources, canvasClass) {\n    if (this._getPainter()) {\n      return this._getPainter().getSprite(resources, canvasClass);\n    }\n\n    return new Painter(this).getSprite(resources, canvasClass);\n  };\n\n  return Marker;\n}(CenterMixin(Geometry));\n\nMarker.mergeOptions(options$4);\nMarker.registerJSONType('Marker');\n\nfunction computeExtent(fn) {\n  var coordinates = this[fn]();\n\n  if (!coordinates) {\n    return null;\n  }\n\n  return new Extent(coordinates, coordinates, this._getProjection());\n}\n\nvar options$5 = {\n  'arrowStyle': null,\n  'arrowPlacement': 'vertex-last'\n};\n\nvar LineString = function (_Path) {\n  _inheritsLoose(LineString, _Path);\n\n  function LineString(coordinates, options) {\n    var _this;\n\n    _this = _Path.call(this, options) || this;\n    _this.type = 'LineString';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = LineString.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n\n      this._setPrjCoordinates(null);\n\n      return this;\n    }\n\n    this._coordinates = Coordinate.toCoordinates(coordinates);\n\n    if (this.getMap()) {\n      this._setPrjCoordinates(this._projectCoords(this._coordinates));\n    } else {\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates || [];\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    return measurer.measureLength(this.getCoordinates());\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  return LineString;\n}(Path);\n\nLineString.mergeOptions(options$5);\nLineString.registerJSONType('LineString');\n\nvar GeometryCollection = function (_Geometry) {\n  _inheritsLoose(GeometryCollection, _Geometry);\n\n  function GeometryCollection(geometries, opts) {\n    var _this;\n\n    _this = _Geometry.call(this, opts) || this;\n    _this.type = 'GeometryCollection';\n\n    _this.setGeometries(geometries);\n\n    return _this;\n  }\n\n  var _proto = GeometryCollection.prototype;\n\n  _proto.setGeometries = function setGeometries(_geometries) {\n    var geometries = this._checkGeometries(_geometries || []);\n\n    var symbol = this._getSymbol();\n\n    var options = this.config();\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      geometries[i]._initOptions(options);\n\n      geometries[i]._setParent(this);\n\n      geometries[i]._setEventParent(this);\n\n      if (symbol) {\n        geometries[i].setSymbol(symbol);\n      }\n    }\n\n    this._geometries = geometries;\n\n    if (this.getLayer()) {\n      this._bindGeometriesToLayer();\n\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getGeometries = function getGeometries() {\n    return this._geometries || [];\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      if (!context) {\n        fn(geometries[i], i);\n      } else {\n        fn.call(context, geometries[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    if (!fn) {\n      return new GeometryCollection();\n    }\n\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return new GeometryCollection(selected);\n  };\n\n  _proto.translate = function translate(offset) {\n    if (!offset) {\n      return this;\n    }\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var args = arguments;\n    this.forEach(function (geometry) {\n      if (geometry && geometry.translate) {\n        geometry.translate.apply(geometry, args);\n      }\n    });\n    return this;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !isArrayHasData(this.getGeometries());\n  };\n\n  _proto.remove = function remove() {\n    this.forEach(function (geometry) {\n      geometry._unbind();\n    });\n    return Geometry.prototype.remove.apply(this, arguments);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n    this.forEach(function (geometry) {\n      geometry.show();\n    });\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n    this.forEach(function (geometry) {\n      geometry.hide();\n    });\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(config) {\n    this.forEach(function (geometry) {\n      geometry.config(config);\n    });\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = _Geometry.prototype.getSymbol.call(this);\n\n    if (!s) {\n      var symbols = [];\n      var is = false;\n      this.forEach(function (g) {\n        var symbol = g.getSymbol();\n\n        if (symbol && !is) {\n          is = true;\n        }\n\n        symbols.push(g.getSymbol());\n      });\n\n      if (is) {\n        s = {\n          'children': symbols\n        };\n      }\n    }\n\n    return s;\n  };\n\n  _proto.setSymbol = function setSymbol(s) {\n    if (s && s['children']) {\n      this._symbol = null;\n      this.forEach(function (g, i) {\n        g.setSymbol(s['children'][i]);\n      });\n    } else {\n      var symbol = this._prepareSymbol(s);\n\n      this._symbol = symbol;\n      this.forEach(function (g) {\n        g.setSymbol(symbol);\n      });\n    }\n\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    symbol = this._prepareSymbol(symbol);\n    this._externSymbol = symbol;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(symbol);\n    });\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._bindLayer = function _bindLayer() {\n    _Geometry.prototype._bindLayer.apply(this, arguments);\n\n    this._bindGeometriesToLayer();\n  };\n\n  _proto._bindGeometriesToLayer = function _bindGeometriesToLayer() {\n    var layer = this.getLayer();\n    this.forEach(function (geometry) {\n      geometry._bindLayer(layer);\n    });\n  };\n\n  _proto._checkGeometries = function _checkGeometries(geometries) {\n    var invalidGeoError = 'The geometry added to collection is invalid.';\n\n    if (geometries && !Array.isArray(geometries)) {\n      if (geometries instanceof Geometry) {\n        return [geometries];\n      } else {\n        throw new Error(invalidGeoError);\n      }\n    } else {\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!this._checkGeo(geometries[i])) {\n          throw new Error(invalidGeoError + ' Index: ' + i);\n        }\n      }\n\n      return geometries;\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof Geometry;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    if (this.isEmpty()) {\n      return;\n    }\n\n    this.forEach(function (geometry) {\n      if (geometry && geometry._updateCache) {\n        geometry._updateCache();\n      }\n    });\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n    this.forEach(function (geometry) {\n      geometry._removePainter();\n    });\n  };\n\n  _proto._computeCenter = function _computeCenter(projection) {\n    if (!projection || this.isEmpty()) {\n      return null;\n    }\n\n    var sumX = 0,\n        sumY = 0,\n        counter = 0;\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      var center = geometries[i]._computeCenter(projection);\n\n      if (center) {\n        sumX += center.x;\n        sumY += center.y;\n        counter++;\n      }\n    }\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumX / counter, sumY / counter);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    if (this.isEmpty()) {\n      return false;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (geometries[i]._containsPoint(point, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._computeExtent = function _computeExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computeExtent');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computePrjExtent');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicLength(projection);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicArea(projection);\n    }\n\n    return result;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var children = [];\n\n    if (!this.isEmpty()) {\n      var geometries = this.getGeometries();\n\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!geometries[i]) {\n          continue;\n        }\n\n        children.push(geometries[i]._exportGeoJSONGeometry());\n      }\n    }\n\n    return {\n      'type': 'GeometryCollection',\n      'geometries': children\n    };\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      geometries[i]._clearProjection();\n    }\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var extent = this.getExtent();\n    var anchors = [new Coordinate(extent.xmin, extent.ymax), new Coordinate(extent.xmax, extent.ymin), new Coordinate(extent.xmin, extent.ymin), new Coordinate(extent.xmax, extent.ymax)];\n    return anchors;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    if (this.isEmpty()) {\n      return [];\n    }\n\n    var geometries = this.getGeometries(),\n        resources = [];\n    var cache = {};\n    var symbol, res, key;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      symbol = geometries[i]._getInternalSymbol();\n      res = getExternalResources(symbol);\n\n      for (var ii = 0, ll = res.length; ii < ll; ii++) {\n        key = res[ii].join();\n\n        if (!cache[key]) {\n          resources.push(res[ii]);\n          cache[key] = 1;\n        }\n      }\n    }\n\n    return resources;\n  };\n\n  _proto.startEdit = function startEdit(opts) {\n    var _this2 = this;\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (opts['symbol']) {\n      this._originalSymbol = this.getSymbol();\n      this.setSymbol(opts['symbol']);\n    }\n\n    this._draggbleBeforeEdit = this.options['draggable'];\n    this.config('draggable', false);\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].startEdit(opts);\n    }\n\n    this._editing = true;\n    this.hide();\n    setTimeout(function () {\n      _this2.fire('editstart');\n    }, 1);\n    return this;\n  };\n\n  _proto.endEdit = function endEdit() {\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].endEdit();\n    }\n\n    if (this._originalSymbol) {\n      this.setSymbol(this._originalSymbol);\n      delete this._originalSymbol;\n    }\n\n    this._editing = false;\n    this.show();\n    this.config('draggable', this._draggbleBeforeEdit);\n    this.fire('editend');\n    return this;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (!this._editing) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return GeometryCollection;\n}(Geometry);\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nfunction computeExtent$1(projection, fn) {\n  if (this.isEmpty()) {\n    return null;\n  }\n\n  var geometries = this.getGeometries();\n  var result = null;\n\n  for (var i = 0, l = geometries.length; i < l; i++) {\n    var geo = geometries[i];\n\n    if (!geo) {\n      continue;\n    }\n\n    var geoExtent = geo[fn](projection);\n\n    if (geoExtent) {\n      result = geoExtent.combine(result);\n    }\n  }\n\n  return result;\n}\n\nvar MultiGeometry = function (_GeometryCollection) {\n  _inheritsLoose(MultiGeometry, _GeometryCollection);\n\n  function MultiGeometry(geoType, type, data, options) {\n    var _this;\n\n    _this = _GeometryCollection.call(this, null, options) || this;\n    _this.GeometryType = geoType;\n    _this.type = type;\n\n    _this._initData(data);\n\n    return _this;\n  }\n\n  var _proto = MultiGeometry.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    var coordinates = [];\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var child = geometries[i];\n      coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n    }\n\n    return coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    coordinates = coordinates || [];\n    var geometries = [];\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var g = new this.GeometryType(coordinates[i], this.config());\n      geometries.push(g);\n    }\n\n    this.setGeometries(geometries);\n    return this;\n  };\n\n  _proto._initData = function _initData(data) {\n    data = data || [];\n\n    if (data.length) {\n      if (data[0] instanceof this.GeometryType) {\n        this.setGeometries(data);\n      } else {\n        this.setCoordinates(data);\n      }\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof this.GeometryType;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  return MultiGeometry;\n}(GeometryCollection);\n\nvar MultiPoint = function (_MultiGeometry) {\n  _inheritsLoose(MultiPoint, _MultiGeometry);\n\n  function MultiPoint(data, opts) {\n    return _MultiGeometry.call(this, Marker, 'MultiPoint', data, opts) || this;\n  }\n\n  var _proto = MultiPoint.prototype;\n\n  _proto.findClosest = function findClosest(coordinate) {\n    if (!coordinate) {\n      return null;\n    }\n\n    var coords = this.getCoordinates();\n    var hit = null;\n    var max = Infinity;\n    coords.forEach(function (c) {\n      var dist = distanceTo(c, coordinate);\n\n      if (dist < max) {\n        hit = c;\n        max = dist;\n      }\n    });\n    return hit;\n  };\n\n  return MultiPoint;\n}(MultiGeometry);\n\nMultiPoint.registerJSONType('MultiPoint');\n\nfunction distanceTo(p0, p1) {\n  var x = p1.x - p0.x,\n      y = p1.y - p0.y;\n  return Math.sqrt(x * x + y * y);\n}\n\nvar MultiPath = function (_MultiGeometry) {\n  _inheritsLoose(MultiPath, _MultiGeometry);\n\n  function MultiPath() {\n    return _MultiGeometry.apply(this, arguments) || this;\n  }\n\n  var _proto = MultiPath.prototype;\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    var children = this.getGeometries();\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    children.forEach(function (l) {\n      var c = l.getCenterInExtent(extent);\n\n      if (c) {\n        sumx += c.x * c.count;\n        sumy += c.y * c.count;\n        counter += c.count;\n      }\n    });\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumx, sumy)._multi(1 / counter);\n  };\n\n  return MultiPath;\n}(MultiGeometry);\n\nvar MultiLineString = function (_MultiPath) {\n  _inheritsLoose(MultiLineString, _MultiPath);\n\n  function MultiLineString(data, options) {\n    return _MultiPath.call(this, LineString, 'MultiLineString', data, options) || this;\n  }\n\n  return MultiLineString;\n}(MultiPath);\n\nMultiLineString.registerJSONType('MultiLineString');\n\nvar MultiPolygon = function (_MultiPath) {\n  _inheritsLoose(MultiPolygon, _MultiPath);\n\n  function MultiPolygon(data, opts) {\n    return _MultiPath.call(this, Polygon, 'MultiPolygon', data, opts) || this;\n  }\n\n  return MultiPolygon;\n}(MultiPath);\n\nMultiPolygon.registerJSONType('MultiPolygon');\nvar types$1 = {\n  'Marker': Marker,\n  'LineString': LineString,\n  'Polygon': Polygon,\n  'MultiPoint': MultiPoint,\n  'MultiLineString': MultiLineString,\n  'MultiPolygon': MultiPolygon\n};\nvar GeoJSON = {\n  toGeometry: function toGeometry(geoJSON, foreachFn) {\n    if (isString(geoJSON)) {\n      geoJSON = parseJSON(geoJSON);\n    }\n\n    if (Array.isArray(geoJSON)) {\n      var resultGeos = [];\n\n      for (var i = 0, len = geoJSON.length; i < len; i++) {\n        var geo = GeoJSON._convert(geoJSON[i], foreachFn);\n\n        if (Array.isArray(geo)) {\n          pushIn(resultGeos, geo);\n        } else {\n          resultGeos.push(geo);\n        }\n      }\n\n      return resultGeos;\n    } else {\n      var resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n\n      return resultGeo;\n    }\n  },\n  _convert: function _convert(json, foreachFn) {\n    if (!json || isNil(json['type'])) {\n      return null;\n    }\n\n    var type = json['type'];\n\n    if (type === 'Feature') {\n      var g = json['geometry'];\n\n      var geometry = GeoJSON._convert(g);\n\n      if (!geometry) {\n        return null;\n      }\n\n      geometry.setId(json['id']);\n      geometry.setProperties(json['properties']);\n\n      if (foreachFn) {\n        foreachFn(geometry);\n      }\n\n      return geometry;\n    } else if (type === 'FeatureCollection') {\n      var features = json['features'];\n\n      if (!features) {\n        return null;\n      }\n\n      return GeoJSON.toGeometry(features, foreachFn);\n    } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n      var clazz = type === 'Point' ? 'Marker' : type;\n      var result = new types$1[clazz](json['coordinates']);\n\n      if (foreachFn) {\n        foreachFn(result);\n      }\n\n      return result;\n    } else if (type === 'GeometryCollection') {\n      var geometries = json['geometries'];\n\n      if (!isArrayHasData(geometries)) {\n        var _result2 = new GeometryCollection();\n\n        if (foreachFn) {\n          foreachFn(_result2);\n        }\n\n        return _result2;\n      }\n\n      var mGeos = [];\n      var size = geometries.length;\n\n      for (var i = 0; i < size; i++) {\n        mGeos.push(GeoJSON._convert(geometries[i]));\n      }\n\n      var _result = new GeometryCollection(mGeos);\n\n      if (foreachFn) {\n        foreachFn(_result);\n      }\n\n      return _result;\n    }\n\n    return null;\n  }\n};\nvar options$6 = {\n  'numberOfShellPoints': 60\n};\n\nvar Circle = function (_CenterMixin) {\n  _inheritsLoose(Circle, _CenterMixin);\n\n  Circle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var circle = new Circle(json['coordinates'], json['radius'], json['options']);\n    circle.setProperties(feature['properties']);\n    return circle;\n  };\n\n  function Circle(coordinates, radius, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._radius = radius;\n    return _this;\n  }\n\n  var _proto = Circle.prototype;\n\n  _proto.getRadius = function getRadius() {\n    return this._radius;\n  };\n\n  _proto.setRadius = function setRadius(radius) {\n    this._radius = radius;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        radius = this.getRadius();\n\n    var shell = [];\n    var rad, dx, dy;\n\n    for (var i = 0, len = numberOfPoints - 1; i < len; i++) {\n      rad = 360 * i / len * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(shell[0]);\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        size = this.getSize(),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        se = center.add(size.width / 2, size.height / 2);\n\n    return withInEllipse(point, center, se, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var minmax = this._getMinMax(projection);\n\n    if (!minmax) {\n      return null;\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pminmax = minmax.map(function (c) {\n      return projection.project(c);\n    });\n    var leftx = pminmax[0].x - pcenter.x;\n    var rightx = pminmax[1].x - pcenter.x;\n    var topy = pminmax[2].y - pcenter.y;\n    var bottomy = pminmax[3].y - pcenter.y;\n    return new Extent(pcenter.add(leftx, topy), pcenter.add(rightx, bottomy));\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var minmax = this._getMinMax(measurer);\n\n    if (!minmax) {\n      return null;\n    }\n\n    return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._radius)) {\n      return null;\n    }\n\n    var radius = this._radius;\n    var p1 = measurer.locate(this._coordinates, -radius, 0),\n        p2 = measurer.locate(this._coordinates, radius, 0),\n        p3 = measurer.locate(this._coordinates, 0, radius),\n        p4 = measurer.locate(this._coordinates, 0, -radius);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2);\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var center = this.getCenter();\n    var opts = extend({}, options);\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Circle',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius()\n    };\n  };\n\n  return Circle;\n}(CenterMixin(Polygon));\n\nCircle.mergeOptions(options$6);\nCircle.registerJSONType('Circle');\nvar options$7 = {\n  'numberOfShellPoints': 80\n};\n\nvar Ellipse = function (_CenterMixin) {\n  _inheritsLoose(Ellipse, _CenterMixin);\n\n  Ellipse.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n    ellipse.setProperties(feature['properties']);\n    return ellipse;\n  };\n\n  function Ellipse(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this.width = width;\n    _this.height = height;\n    return _this;\n  }\n\n  var _proto = Ellipse.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this.width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this.width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this.height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this.height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        width = this.getWidth(),\n        height = this.getHeight();\n\n    var shell = [];\n    var s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n        sx = Math.pow(width / 2, 2),\n        sy = Math.pow(height / 2, 2);\n    var deg, rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      deg = 360 * i / numberOfPoints;\n      rad = deg * Math.PI / 180;\n      dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n      dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n\n      if (deg > 90 && deg < 270) {\n        dx *= -1;\n      }\n\n      if (deg > 180 && deg < 360) {\n        dy *= -1;\n      }\n\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var projection = map.getProjection();\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n        p0 = map._prjToContainerPoint(pps[0]),\n        p1 = map._prjToContainerPoint(pps[1]);\n\n    return withInEllipse(point, p0, p1, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return Circle.prototype._computePrjExtent.apply(this, arguments);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return Circle.prototype._computeExtent.apply(this, arguments);\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var p1 = measurer.locate(this._coordinates, -width / 2, 0),\n        p2 = measurer.locate(this._coordinates, width / 2, 0),\n        p3 = measurer.locate(this._coordinates, 0, -height / 2),\n        p4 = measurer.locate(this._coordinates, 0, height / 2);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    var longer = this.width > this.height ? this.width : this.height;\n    return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    return Math.PI * this.width * this.height / 4;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Ellipse',\n      'coordinates': [center.x, center.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Ellipse;\n}(CenterMixin(Polygon));\n\nEllipse.mergeOptions(options$7);\nEllipse.registerJSONType('Ellipse');\n\nvar Rectangle = function (_Polygon) {\n  _inheritsLoose(Rectangle, _Polygon);\n\n  Rectangle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n    rect.setProperties(feature['properties']);\n    return rect;\n  };\n\n  function Rectangle(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _Polygon.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._width = width;\n    _this._height = height;\n    return _this;\n  }\n\n  var _proto = Rectangle.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(nw) {\n    this._coordinates = nw instanceof Coordinate ? nw : new Coordinate(nw);\n\n    if (!this._coordinates || !this.getMap()) {\n      this.onPositionChanged();\n      return this;\n    }\n\n    var projection = this._getProjection();\n\n    this._setPrjCoordinates(projection.project(this._coordinates));\n\n    return this;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer();\n\n    var nw = this._coordinates;\n    var map = this.getMap();\n    var sx = 1,\n        sy = -1;\n\n    if (map) {\n      var fExt = map.getFullExtent();\n\n      if (fExt['left'] > fExt['right']) {\n        sx = -1;\n      }\n\n      if (fExt['bottom'] > fExt['top']) {\n        sy = 1;\n      }\n    }\n\n    var points = [];\n    points.push(nw);\n    points.push(measurer.locate(nw, sx * this._width, 0));\n    points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n    points.push(measurer.locate(nw, 0, sy * this._height));\n    points.push(nw);\n    return points;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._pnw && projection) {\n      if (this._coordinates) {\n        this._pnw = projection.project(this._coordinates);\n      }\n    }\n\n    return this._pnw;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(pnw) {\n    this._pnw = pnw;\n    this.onPositionChanged();\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    var shell = _Polygon.prototype._getPrjShell.call(this);\n\n    var projection = this._getProjection();\n\n    if (!projection.isSphere()) {\n      return shell;\n    }\n\n    var sphereExtent = projection.getSphereExtent(),\n        sx = sphereExtent.sx,\n        sy = sphereExtent.sy;\n\n    var circum = this._getProjection().getCircum();\n\n    var nw = shell[0];\n\n    for (var i = 1, l = shell.length; i < l; i++) {\n      var p = shell[i];\n      var dx = 0,\n          dy = 0;\n\n      if (sx * (nw.x - p.x) > 0) {\n        dx = circum.x * sx;\n      }\n\n      if (sy * (nw.y - p.y) < 0) {\n        dy = circum.y * sy;\n      }\n\n      shell[i]._add(dx, dy);\n    }\n\n    return shell;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (this._pnw && projection) {\n      this._coordinates = projection.unproject(this._pnw);\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._pnw = null;\n\n    _Polygon.prototype._clearProjection.call(this);\n  };\n\n  _proto._computeCenter = function _computeCenter(measurer) {\n    return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Polygon.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        r = map._getResolution() * t;\n\n    var extent = this._getPrjExtent().expand(r);\n\n    var p = map._containerPointToPrj(point);\n\n    return extent.contains(p);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var se = this._getSouthEast(projection);\n\n    if (!se) {\n      return null;\n    }\n\n    var prjs = projection.projectCoords([new Coordinate(this._coordinates.x, se.y), new Coordinate(se.x, this._coordinates.y)]);\n    return new Extent(prjs[0], prjs[1]);\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var se = this._getSouthEast(measurer);\n\n    if (!se) {\n      return null;\n    }\n\n    return new Extent(this._coordinates, se, this._getProjection());\n  };\n\n  _proto._getSouthEast = function _getSouthEast(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var w = width,\n        h = -height;\n\n    if (measurer.fullExtent) {\n      var fullExtent = measurer.fullExtent,\n          sx = fullExtent.right > fullExtent.left ? 1 : -1,\n          sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n      w *= sx;\n      h *= sy;\n    }\n\n    var se = measurer.locate(this._coordinates, w, h);\n    return se;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return 2 * (this._width + this._height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return this._width * this._height;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var nw = this.getCoordinates();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Rectangle',\n      'coordinates': [nw.x, nw.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Rectangle;\n}(Polygon);\n\nRectangle.registerJSONType('Rectangle');\nvar options$8 = {\n  'numberOfShellPoints': 60\n};\n\nvar Sector = function (_Circle) {\n  _inheritsLoose(Sector, _Circle);\n\n  Sector.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n    sector.setProperties(feature['properties']);\n    return sector;\n  };\n\n  function Sector(coordinates, radius, startAngle, endAngle, opts) {\n    var _this;\n\n    _this = _Circle.call(this, coordinates, radius, opts) || this;\n    _this.startAngle = startAngle;\n    _this.endAngle = endAngle;\n    return _this;\n  }\n\n  var _proto = Sector.prototype;\n\n  _proto.getStartAngle = function getStartAngle() {\n    return this.startAngle;\n  };\n\n  _proto.setStartAngle = function setStartAngle(startAngle) {\n    this.startAngle = startAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getEndAngle = function getEndAngle() {\n    return this.endAngle;\n  };\n\n  _proto.setEndAngle = function setEndAngle(endAngle) {\n    this.endAngle = endAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'] - 2,\n        radius = this.getRadius(),\n        shell = [center.copy()],\n        startAngle = this.getStartAngle(),\n        angle = this.getEndAngle() - startAngle;\n\n    var rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(center.copy());\n    return shell;\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Circle.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        size = this.getSize(),\n        pc = center,\n        pp = point,\n        x = pp.x - pc.x,\n        y = pc.y - pp.y,\n        atan2 = Math.atan2(y, x),\n        angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) : atan2 * 360 / (2 * Math.PI);\n\n    var sAngle = this.startAngle % 360,\n        eAngle = this.endAngle % 360;\n    var between = false;\n\n    if (sAngle > eAngle) {\n      between = !(angle > eAngle && angle < sAngle);\n    } else {\n      between = angle >= sAngle && angle <= eAngle;\n    }\n\n    return pp.distanceTo(pc) <= size.width / 2 + t && between;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Sector',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius(),\n      'startAngle': this.getStartAngle(),\n      'endAngle': this.getEndAngle()\n    };\n  };\n\n  return Sector;\n}(Circle);\n\nSector.mergeOptions(options$8);\nSector.registerJSONType('Sector');\nvar options$9 = {\n  'enableSimplify': false,\n  'enableClip': false\n};\n\nvar Curve = function (_LineString) {\n  _inheritsLoose(Curve, _LineString);\n\n  function Curve() {\n    return _LineString.apply(this, arguments) || this;\n  }\n\n  var _proto = Curve.prototype;\n\n  _proto._arc = function _arc(ctx, points, lineOpacity) {\n    var degree = this.options['arcDegree'] * Math.PI / 180;\n\n    for (var i = 1, l = points.length; i < l; i++) {\n      var c = Canvas._arcBetween(ctx, points[i - 1], points[i], degree);\n\n      var ctrlPoint = [points[i - 1].x + points[i].x - c[0], points[i - 1].y + points[i].y - c[1]];\n      points[i - 1].nextCtrlPoint = ctrlPoint;\n      points[i].prevCtrlPoint = ctrlPoint;\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n  };\n\n  _proto._quadraticCurve = function _quadraticCurve(ctx, points) {\n    if (points.length <= 2) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 2, l = points.length; i < l; i += 2) {\n      ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n    }\n\n    i -= 1;\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._bezierCurve = function _bezierCurve(ctx, points) {\n    if (points.length <= 3) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 1, l = points.length; i + 2 < l; i += 3) {\n      ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n    }\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._getCurveArrowPoints = function _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n    var l = segments.length;\n    var i;\n\n    for (i = step; i < l; i += step) {\n      var arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n\n    i -= step;\n\n    if (i < l - 1) {\n      for (i += 1; i < l; i++) {\n        var _arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      }\n    }\n  };\n\n  return Curve;\n}(LineString);\n\nCurve.mergeOptions(options$9);\nvar options$a = {\n  'arcDegree': 90\n};\n\nvar ArcCurve = function (_Curve) {\n  _inheritsLoose(ArcCurve, _Curve);\n\n  function ArcCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  var _proto = ArcCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'ArcCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n\n    this._arc(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  ArcCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n    arc.setProperties(feature['properties']);\n    return arc;\n  };\n\n  return ArcCurve;\n}(Curve);\n\nArcCurve.registerJSONType('ArcCurve');\nArcCurve.mergeOptions(options$a);\n\nvar CubicBezierCurve = function (_Curve) {\n  _inheritsLoose(CubicBezierCurve, _Curve);\n\n  function CubicBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  CubicBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = CubicBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'CubicBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._bezierCurve(ctx, points);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n  };\n\n  return CubicBezierCurve;\n}(Curve);\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nvar QuadBezierCurve = function (_Curve) {\n  _inheritsLoose(QuadBezierCurve, _Curve);\n\n  function QuadBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  QuadBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = QuadBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'QuadBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._quadraticCurve(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n  };\n\n  return QuadBezierCurve;\n}(Curve);\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\nvar defaultSymbol$1 = {\n  'textFaceName': 'monospace',\n  'textSize': 12,\n  'textLineSpacing': 8,\n  'textWrapCharacter': '\\n',\n  'textHorizontalAlignment': 'middle',\n  'textVerticalAlignment': 'middle'\n};\nvar defaultBoxSymbol = {\n  'markerType': 'square',\n  'markerLineColor': '#000',\n  'markerLineWidth': 2,\n  'markerLineOpacity': 1,\n  'markerFill': '#fff',\n  'markerOpacity': 1\n};\n\nvar TextMarker = function (_Marker) {\n  _inheritsLoose(TextMarker, _Marker);\n\n  function TextMarker() {\n    return _Marker.apply(this, arguments) || this;\n  }\n\n  var _proto = TextMarker.prototype;\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this._content;\n    this._content = escapeSpecialChars(content);\n\n    this._refresh();\n\n    this._fireEvent('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    return this;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._refresh();\n  };\n\n  _proto.toJSON = function toJSON() {\n    var json = _Marker.prototype.toJSON.call(this);\n\n    delete json['symbol'];\n    return json;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (this._refreshing || !symbol) {\n      return _Marker.prototype.setSymbol.call(this, symbol);\n    }\n\n    var s = this._parseSymbol(symbol);\n\n    if (this.setTextStyle) {\n      var style = this.getTextStyle() || {};\n      style.symbol = s[0];\n      this.setTextStyle(style);\n    } else if (this.setTextSymbol) {\n      this.setTextSymbol(s[0]);\n    }\n\n    if (this.setBoxStyle) {\n      var _style = this.getBoxStyle() || {};\n\n      _style.symbol = s[1];\n      this.setBoxStyle(_style);\n    } else if (this.setBoxSymbol) {\n      this.setBoxSymbol(s[1]);\n    }\n\n    return this;\n  };\n\n  _proto._parseSymbol = function _parseSymbol(symbol) {\n    var t = {};\n    var b = {};\n\n    for (var p in symbol) {\n      if (hasOwn(symbol, p)) {\n        if (p.indexOf('text') === 0) {\n          t[p] = symbol[p];\n        } else {\n          b[p] = symbol[p];\n        }\n      }\n    }\n\n    return [t, b];\n  };\n\n  _proto._getTextSize = function _getTextSize(symbol) {\n    return splitTextToRow(this._content, symbol)['size'];\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    return this._symbol;\n  };\n\n  _proto._getDefaultTextSymbol = function _getDefaultTextSymbol() {\n    return extend({}, defaultSymbol$1);\n  };\n\n  _proto._getDefaultBoxSymbol = function _getDefaultBoxSymbol() {\n    return extend({}, defaultBoxSymbol);\n  };\n\n  _proto._getDefaultPadding = function _getDefaultPadding() {\n    return [12, 8];\n  };\n\n  return TextMarker;\n}(Marker);\n\nvar options$b = {\n  'textStyle': {\n    'wrap': true,\n    'padding': [12, 8],\n    'verticalAlignment': 'middle',\n    'horizontalAlignment': 'middle'\n  },\n  'boxSymbol': null\n};\n\nvar TextBox = function (_TextMarker) {\n  _inheritsLoose(TextBox, _TextMarker);\n\n  function TextBox(content, coordinates, width, height, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n    _this._content = escapeSpecialChars(content);\n    _this._width = isNil(width) ? 100 : width;\n    _this._height = isNil(height) ? 40 : height;\n\n    if (options.boxSymbol) {\n      _this.setBoxSymbol(options.boxSymbol);\n    }\n\n    if (options.textStyle) {\n      _this.setTextStyle(options.textStyle);\n    }\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = TextBox.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getBoxSymbol = function getBoxSymbol() {\n    return extend({}, this.options.boxSymbol);\n  };\n\n  _proto.setBoxSymbol = function setBoxSymbol(symbol) {\n    this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  _proto.getTextStyle = function getTextStyle() {\n    if (!this.options.textStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.textStyle);\n  };\n\n  _proto.setTextStyle = function setTextStyle(style) {\n    this.options.textStyle = style ? extend({}, style) : style;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  TextBox.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n    textBox.setProperties(feature['properties']);\n    textBox.setId(feature['id']);\n\n    if (json['symbol']) {\n      textBox.setSymbol(json['symbol']);\n    }\n\n    return textBox;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'width': this.getWidth(),\n      'height': this.getHeight(),\n      'subType': 'TextBox',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var textStyle = this.getTextStyle() || {},\n        padding = textStyle['padding'] || [12, 8],\n        maxWidth = this._width - 2 * padding[0],\n        maxHeight = this._height - 2 * padding[1];\n    var symbol = extend({}, textStyle.symbol || this._getDefaultTextSymbol(), this.options.boxSymbol || this._getDefaultBoxSymbol(), {\n      'textName': this._content,\n      'markerWidth': this._width,\n      'markerHeight': this._height,\n      'textHorizontalAlignment': 'middle',\n      'textVerticalAlignment': 'middle',\n      'textMaxWidth': maxWidth,\n      'textMaxHeight': maxHeight\n    });\n\n    if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n      symbol['textWrapWidth'] = maxWidth;\n    }\n\n    var hAlign = textStyle['horizontalAlignment'];\n    symbol['textDx'] = symbol['markerDx'] || 0;\n    var offsetX = symbol['markerWidth'] / 2 - padding[0];\n\n    if (hAlign === 'left') {\n      symbol['textHorizontalAlignment'] = 'right';\n      symbol['textDx'] = symbol['textDx'] - offsetX;\n    } else if (hAlign === 'right') {\n      symbol['textHorizontalAlignment'] = 'left';\n      symbol['textDx'] = symbol['textDx'] + offsetX;\n    }\n\n    var vAlign = textStyle['verticalAlignment'];\n    symbol['textDy'] = symbol['markerDy'] || 0;\n    var offsetY = symbol['markerHeight'] / 2 - padding[1];\n\n    if (vAlign === 'top') {\n      symbol['textVerticalAlignment'] = 'bottom';\n      symbol['textDy'] -= offsetY;\n    } else if (vAlign === 'bottom') {\n      symbol['textVerticalAlignment'] = 'top';\n      symbol['textDy'] += offsetY;\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  return TextBox;\n}(TextMarker);\n\nTextBox.mergeOptions(options$b);\nTextBox.registerJSONType('TextBox');\nvar options$c = {\n  'boxStyle': null,\n  textSymbol: null\n};\n\nvar Label = function (_TextMarker) {\n  _inheritsLoose(Label, _TextMarker);\n\n  function Label(content, coordinates, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n\n    if (options.textSymbol) {\n      _this.setTextSymbol(options.textSymbol);\n    }\n\n    if (options.boxStyle) {\n      _this.setBoxStyle(options.boxStyle);\n    }\n\n    _this._content = escapeSpecialChars(content);\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getBoxStyle = function getBoxStyle() {\n    if (!this.options.boxStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.boxStyle);\n  };\n\n  _proto.setBoxStyle = function setBoxStyle(style) {\n    this.options.boxStyle = style ? extend({}, style) : style;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getTextSymbol = function getTextSymbol() {\n    return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n  };\n\n  _proto.setTextSymbol = function setTextSymbol(symbol) {\n    this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n\n    this._refresh();\n\n    return this;\n  };\n\n  Label.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n    label.setProperties(feature['properties']);\n    label.setId(feature['id']);\n\n    if (json['symbol']) {\n      label.setSymbol(json['symbol']);\n    }\n\n    return label;\n  };\n\n  _proto._canEdit = function _canEdit() {\n    return false;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'Label',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var symbol = extend({}, this.getTextSymbol(), {\n      'textName': this._content\n    });\n    var boxStyle = this.getBoxStyle();\n\n    if (boxStyle) {\n      extend(symbol, boxStyle.symbol);\n\n      var sizes = this._getBoxSize(symbol),\n          textSize = sizes[1],\n          padding = boxStyle['padding'] || this._getDefaultPadding();\n\n      var boxSize = sizes[0];\n      symbol['markerWidth'] = boxSize['width'];\n      symbol['markerHeight'] = boxSize['height'];\n\n      var dx = symbol['textDx'] || 0,\n          dy = symbol['textDy'] || 0,\n          textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])._add(dx, dy);\n\n      var hAlign = boxStyle['horizontalAlignment'] || 'middle';\n      symbol['markerDx'] = textAlignPoint.x;\n\n      if (hAlign === 'left') {\n        symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n      } else if (hAlign === 'right') {\n        symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n      } else {\n        symbol['markerDx'] += textSize['width'] / 2;\n      }\n\n      var vAlign = boxStyle['verticalAlignment'] || 'middle';\n      symbol['markerDy'] = textAlignPoint.y;\n\n      if (vAlign === 'top') {\n        symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n      } else if (vAlign === 'bottom') {\n        symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1];\n      } else {\n        symbol['markerDy'] += textSize['height'] / 2;\n      }\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  _proto._getBoxSize = function _getBoxSize(symbol) {\n    if (!symbol['markerType']) {\n      symbol['markerType'] = 'square';\n    }\n\n    var boxStyle = this.getBoxStyle();\n\n    var size = this._getTextSize(symbol);\n\n    var width, height;\n\n    var padding = boxStyle['padding'] || this._getDefaultPadding();\n\n    width = size['width'] + padding[0] * 2;\n    height = size['height'] + padding[1] * 2;\n\n    if (boxStyle['minWidth']) {\n      if (!width || width < boxStyle['minWidth']) {\n        width = boxStyle['minWidth'];\n      }\n    }\n\n    if (boxStyle['minHeight']) {\n      if (!height || height < boxStyle['minHeight']) {\n        height = boxStyle['minHeight'];\n      }\n    }\n\n    return [new Size(width, height), size];\n  };\n\n  return Label;\n}(TextMarker);\n\nLabel.mergeOptions(options$c);\nLabel.registerJSONType('Label');\n\nvar Connectable = function Connectable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class._hasConnectors = function _hasConnectors(geometry) {\n      return !isNil(geometry.__connectors) && geometry.__connectors.length > 0;\n    };\n\n    _class._getConnectors = function _getConnectors(geometry) {\n      return geometry.__connectors;\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getConnectSource = function getConnectSource() {\n      return this._connSource;\n    };\n\n    _proto.setConnectSource = function setConnectSource(src) {\n      var target = this._connTarget;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n      this.onAdd();\n      return this;\n    };\n\n    _proto.getConnectTarget = function getConnectTarget() {\n      return this._connTarget;\n    };\n\n    _proto.setConnectTarget = function setConnectTarget(target) {\n      var src = this._connSource;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n\n      this._updateCoordinates();\n\n      this._registerEvents();\n\n      return this;\n    };\n\n    _proto._updateCoordinates = function _updateCoordinates() {\n      var map = this.getMap();\n\n      if (!map && this._connSource) {\n        map = this._connSource.getMap();\n      }\n\n      if (!map && this._connTarget) {\n        map = this._connTarget.getMap();\n      }\n\n      if (!map) {\n        return;\n      }\n\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      var srcPoints = this._connSource._getConnectPoints();\n\n      var targetPoints = this._connTarget._getConnectPoints();\n\n      var minDist = 0;\n      var oldCoordinates = this.getCoordinates();\n      var c1, c2;\n\n      for (var i = 0, len = srcPoints.length; i < len; i++) {\n        var p1 = srcPoints[i];\n\n        for (var j = 0, length = targetPoints.length; j < length; j++) {\n          var p2 = targetPoints[j];\n          var dist = map.computeLength(p1, p2);\n\n          if (i === 0 && j === 0) {\n            c1 = p1;\n            c2 = p2;\n            minDist = dist;\n          } else if (dist < minDist) {\n            c1 = p1;\n            c2 = p2;\n          }\n        }\n      }\n\n      if (!isArrayHasData(oldCoordinates) || !oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2)) {\n        this.setCoordinates([c1, c2]);\n      }\n    };\n\n    _proto.onAdd = function onAdd() {\n      this._registerEvents();\n\n      this._updateCoordinates();\n    };\n\n    _proto.onRemove = function onRemove() {\n      if (this._connSource) {\n        if (this._connSource.__connectors) {\n          removeFromArray(this, this._connSource.__connectors);\n        }\n\n        this._connSource.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n\n        this._connSource.off('dragend mouseup mouseout', this.hide, this);\n\n        this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connSource;\n      }\n\n      if (this._connTarget) {\n        removeFromArray(this, this._connTarget.__connectors);\n\n        this._connTarget.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connTarget;\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    _proto._showConnect = function _showConnect() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n        this._updateCoordinates();\n\n        this.show();\n      }\n    };\n\n    _proto._registerEvents = function _registerEvents() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (!this._connSource.__connectors) {\n        this._connSource.__connectors = [];\n      }\n\n      if (!this._connTarget.__connectors) {\n        this._connTarget.__connectors = [];\n      }\n\n      this._connSource.__connectors.push(this);\n\n      this._connTarget.__connectors.push(this);\n\n      this._connSource.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connTarget.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      var trigger = this.options['showOn'];\n      this.hide();\n\n      if (trigger === 'moving') {\n        this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n\n        this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n      } else if (trigger === 'click') {\n        this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n\n        this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n      } else if (trigger === 'mouseover') {\n        this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n\n        this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n      } else {\n        this._showConnect();\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar options$d = {\n  showOn: 'always'\n};\n\nvar ConnectorLine = function (_Connectable) {\n  _inheritsLoose(ConnectorLine, _Connectable);\n\n  function ConnectorLine(src, target, options) {\n    var _this;\n\n    _this = _Connectable.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this._connSource = src;\n    _this._connTarget = target;\n    return _this;\n  }\n\n  return ConnectorLine;\n}(Connectable(LineString));\n\nConnectorLine.mergeOptions(options$d);\nConnectorLine.registerJSONType('ConnectorLine');\n\nvar ArcConnectorLine = function (_Connectable2) {\n  _inheritsLoose(ArcConnectorLine, _Connectable2);\n\n  function ArcConnectorLine(src, target, options) {\n    var _this2;\n\n    _this2 = _Connectable2.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this2._connSource = src;\n    _this2._connTarget = target;\n    return _this2;\n  }\n\n  return ArcConnectorLine;\n}(Connectable(ArcCurve));\n\nArcConnectorLine.mergeOptions(options$d);\nArcConnectorLine.registerJSONType('ArcConnectorLine');\nvar options$e = {\n  'drawImmediate': false\n};\n\nvar OverlayLayer = function (_Layer) {\n  _inheritsLoose(OverlayLayer, _Layer);\n\n  function OverlayLayer(id, geometries, options) {\n    var _this;\n\n    if (geometries && !(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0) {\n      options = geometries;\n      geometries = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._maxZIndex = 0;\n    _this._minZIndex = 0;\n\n    _this._initCache();\n\n    if (geometries) {\n      _this.addGeometry(geometries);\n    }\n\n    var style = _this.options['style'];\n\n    if (style) {\n      _this.setStyle(style);\n    }\n\n    return _this;\n  }\n\n  var _proto = OverlayLayer.prototype;\n\n  _proto.getGeometryById = function getGeometryById(id) {\n    if (isNil(id) || id === '') {\n      return null;\n    }\n\n    if (!this._geoMap[id]) {\n      return null;\n    }\n\n    return this._geoMap[id];\n  };\n\n  _proto.getGeometries = function getGeometries(filter, context) {\n    if (!filter) {\n      return this._geoList.slice(0);\n    }\n\n    var result = [];\n    var geometry, filtered;\n\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      geometry = this._geoList[i];\n\n      if (context) {\n        filtered = filter.call(context, geometry);\n      } else {\n        filtered = filter(geometry);\n      }\n\n      if (filtered) {\n        result.push(geometry);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getFirstGeometry = function getFirstGeometry() {\n    if (!this._geoList.length) {\n      return null;\n    }\n\n    return this._geoList[0];\n  };\n\n  _proto.getLastGeometry = function getLastGeometry() {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return null;\n    }\n\n    return this._geoList[len - 1];\n  };\n\n  _proto.getCount = function getCount() {\n    return this._geoList.length;\n  };\n\n  _proto.getExtent = function getExtent() {\n    if (this.getCount() === 0) {\n      return null;\n    }\n\n    var extent = new Extent(this.getProjection());\n    this.forEach(function (g) {\n      extent._combine(g.getExtent());\n    });\n    return extent;\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var copyOnWrite = this._geoList.slice(0);\n\n    for (var i = 0, l = copyOnWrite.length; i < l; i++) {\n      if (!context) {\n        fn(copyOnWrite[i], i);\n      } else {\n        fn.call(context, copyOnWrite[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return selected;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !this._geoList.length;\n  };\n\n  _proto.addGeometry = function addGeometry(geometries, fitView) {\n    if (!geometries) {\n      return this;\n    }\n\n    if (geometries.type === 'FeatureCollection') {\n      return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n    } else if (!Array.isArray(geometries)) {\n      var count = arguments.length;\n      var last = arguments[count - 1];\n      geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n      fitView = last;\n\n      if (last && isObject(last) && ('type' in last || last instanceof Geometry)) {\n        geometries.push(last);\n        fitView = false;\n      }\n\n      return this.addGeometry(geometries, fitView);\n    } else if (geometries.length === 0) {\n      return this;\n    }\n\n    this._initCache();\n\n    var extent;\n\n    if (fitView) {\n      extent = new Extent();\n    }\n\n    this._toSort = this._maxZIndex > 0;\n    var geos = [];\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var geo = geometries[i];\n\n      if (!geo) {\n        throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n      }\n\n      if (!(geo instanceof Geometry)) {\n        geo = Geometry.fromJSON(geo);\n\n        if (Array.isArray(geo)) {\n          for (var ii = 0, ll = geo.length; ii < ll; ii++) {\n            this._add(geo[ii], extent, i);\n\n            geos.push(geo[ii]);\n          }\n        }\n      }\n\n      if (!Array.isArray(geo)) {\n        this._add(geo, extent, i);\n\n        geos.push(geo);\n      }\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      this._getRenderer().onGeometryAdd(geos);\n\n      if (extent && !isNil(extent.xmin)) {\n        var center = extent.getCenter();\n        var z = map.getFitZoom(extent);\n\n        if (isObject(fitView)) {\n          var step = isFunction(fitView.step) ? fitView.step : function () {\n            return undefined;\n          };\n          map.animateTo({\n            center: center,\n            zoom: z\n          }, extend({\n            duration: map.options.zoomAnimationDuration,\n            easing: 'out'\n          }, fitView), step);\n        } else if (fitView === true) {\n          map.setCenterAndZoom(center, z);\n        }\n      }\n    }\n\n    this.fire('addgeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.getGeoMinZIndex = function getGeoMinZIndex() {\n    return this._minZIndex;\n  };\n\n  _proto.getGeoMaxZIndex = function getGeoMaxZIndex() {\n    return this._maxZIndex;\n  };\n\n  _proto._add = function _add(geo, extent, i) {\n    if (!this._toSort) {\n      this._toSort = geo.getZIndex() !== 0;\n    }\n\n    this._updateZIndex(geo.getZIndex());\n\n    var geoId = geo.getId();\n\n    if (!isNil(geoId)) {\n      if (!isNil(this._geoMap[geoId])) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n      }\n\n      this._geoMap[geoId] = geo;\n    }\n\n    var internalId = UID();\n\n    geo._setInternalId(internalId);\n\n    this._geoList.push(geo);\n\n    this.onAddGeometry(geo);\n\n    geo._bindLayer(this);\n\n    if (geo.onAdd) {\n      geo.onAdd();\n    }\n\n    if (extent) {\n      extent._combine(geo.getExtent());\n    }\n\n    geo._fireEvent('add', {\n      'layer': this\n    });\n\n    if (this._cookedStyles) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.removeGeometry = function removeGeometry(geometries) {\n    if (!Array.isArray(geometries)) {\n      return this.removeGeometry([geometries]);\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      if (!(geometries[i] instanceof Geometry)) {\n        geometries[i] = this.getGeometryById(geometries[i]);\n      }\n\n      if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n      geometries[i].remove();\n    }\n\n    this.fire('removegeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._clearing = true;\n    this.forEach(function (geo) {\n      geo.remove();\n    });\n    this._geoMap = {};\n    var old = this._geoList;\n    this._geoList = [];\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove(old);\n    }\n\n    this._clearing = false;\n    this.fire('clear');\n    return this;\n  };\n\n  _proto.onRemoveGeometry = function onRemoveGeometry(geometry) {\n    if (!geometry || this._clearing) {\n      return;\n    }\n\n    if (this !== geometry.getLayer()) {\n      return;\n    }\n\n    var internalId = geometry._getInternalId();\n\n    if (isNil(internalId)) {\n      return;\n    }\n\n    var geoId = geometry.getId();\n\n    if (!isNil(geoId)) {\n      delete this._geoMap[geoId];\n    }\n\n    var idx = this._findInList(geometry);\n\n    if (idx >= 0) {\n      this._geoList.splice(idx, 1);\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove([geometry]);\n    }\n  };\n\n  _proto.getStyle = function getStyle() {\n    if (!this.options['style']) {\n      return null;\n    }\n\n    return this.options['style'];\n  };\n\n  _proto.setStyle = function setStyle(style) {\n    this.options.style = style;\n    style = parseStyleRootPath(style);\n    this._cookedStyles = compileStyle(style);\n    this.forEach(function (geometry) {\n      this._styleGeometry(geometry);\n    }, this);\n    this.fire('setstyle', {\n      'style': style\n    });\n    return this;\n  };\n\n  _proto._styleGeometry = function _styleGeometry(geometry) {\n    if (!this._cookedStyles) {\n      return false;\n    }\n\n    var g = getFilterFeature(geometry);\n\n    for (var i = 0, len = this._cookedStyles.length; i < len; i++) {\n      if (this._cookedStyles[i]['filter'](g) === true) {\n        geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.removeStyle = function removeStyle() {\n    if (!this.options.style) {\n      return this;\n    }\n\n    delete this.options.style;\n    delete this._cookedStyles;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(null);\n    }, this);\n    this.fire('removestyle');\n    return this;\n  };\n\n  _proto.onAddGeometry = function onAddGeometry(geo) {\n    var style = this.getStyle();\n\n    if (style) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.hide = function hide() {\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      this._geoList[i].onHide();\n    }\n\n    return Layer.prototype.hide.call(this);\n  };\n\n  _proto._initCache = function _initCache() {\n    if (!this._geoList) {\n      this._geoList = [];\n      this._geoMap = {};\n    }\n  };\n\n  _proto._updateZIndex = function _updateZIndex() {\n    for (var _len = arguments.length, zIndex = new Array(_len), _key = 0; _key < _len; _key++) {\n      zIndex[_key] = arguments[_key];\n    }\n\n    this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n    this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n  };\n\n  _proto._sortGeometries = function _sortGeometries() {\n    var _this2 = this;\n\n    if (!this._toSort) {\n      return;\n    }\n\n    this._maxZIndex = 0;\n    this._minZIndex = 0;\n\n    this._geoList.sort(function (a, b) {\n      _this2._updateZIndex(a.getZIndex(), b.getZIndex());\n\n      return _this2._compare(a, b);\n    });\n\n    this._toSort = false;\n  };\n\n  _proto._compare = function _compare(a, b) {\n    if (a.getZIndex() === b.getZIndex()) {\n      return a._getInternalId() - b._getInternalId();\n    }\n\n    return a.getZIndex() - b.getZIndex();\n  };\n\n  _proto._findInList = function _findInList(geo) {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return -1;\n    }\n\n    var low = 0,\n        high = len - 1,\n        middle;\n\n    while (low <= high) {\n      middle = Math.floor((low + high) / 2);\n\n      if (this._geoList[middle] === geo) {\n        return middle;\n      } else if (this._compare(this._geoList[middle], geo) > 0) {\n        high = middle - 1;\n      } else {\n        low = middle + 1;\n      }\n    }\n\n    return -1;\n  };\n\n  _proto._onGeometryEvent = function _onGeometryEvent(param) {\n    if (!param || !param['target']) {\n      return;\n    }\n\n    var type = param['type'];\n\n    if (type === 'idchange') {\n      this._onGeometryIdChange(param);\n    } else if (type === 'zindexchange') {\n      this._onGeometryZIndexChange(param);\n    } else if (type === 'positionchange') {\n      this._onGeometryPositionChange(param);\n    } else if (type === 'shapechange') {\n      this._onGeometryShapeChange(param);\n    } else if (type === 'symbolchange') {\n      this._onGeometrySymbolChange(param);\n    } else if (type === 'show') {\n      this._onGeometryShow(param);\n    } else if (type === 'hide') {\n      this._onGeometryHide(param);\n    } else if (type === 'propertieschange') {\n      this._onGeometryPropertiesChange(param);\n    }\n  };\n\n  _proto._onGeometryIdChange = function _onGeometryIdChange(param) {\n    if (param['new'] === param['old']) {\n      if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n        return;\n      }\n    }\n\n    if (!isNil(param['new'])) {\n      if (this._geoMap[param['new']]) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n      }\n\n      this._geoMap[param['new']] = param['target'];\n    }\n\n    if (!isNil(param['old']) && param['new'] !== param['old']) {\n      delete this._geoMap[param['old']];\n    }\n  };\n\n  _proto._onGeometryZIndexChange = function _onGeometryZIndexChange(param) {\n    if (param['old'] !== param['new']) {\n      this._updateZIndex(param['new']);\n\n      this._toSort = true;\n\n      if (this._getRenderer()) {\n        this._getRenderer().onGeometryZIndexChange(param);\n      }\n    }\n  };\n\n  _proto._onGeometryPositionChange = function _onGeometryPositionChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPositionChange(param);\n    }\n  };\n\n  _proto._onGeometryShapeChange = function _onGeometryShapeChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShapeChange(param);\n    }\n  };\n\n  _proto._onGeometrySymbolChange = function _onGeometrySymbolChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometrySymbolChange(param);\n    }\n  };\n\n  _proto._onGeometryShow = function _onGeometryShow(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShow(param);\n    }\n  };\n\n  _proto._onGeometryHide = function _onGeometryHide(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryHide(param);\n    }\n  };\n\n  _proto._onGeometryPropertiesChange = function _onGeometryPropertiesChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPropertiesChange(param);\n    }\n  };\n\n  return OverlayLayer;\n}(Layer);\n\nOverlayLayer.mergeOptions(options$e);\nvar TEMP_EXTENT$3 = new PointExtent();\nvar options$f = {\n  'debug': false,\n  'enableSimplify': true,\n  'geometryEvents': true,\n  'defaultIconSize': [20, 20],\n  'cacheVectorOnCanvas': true,\n  'cacheSvgOnCanvas': Browser$1.gecko,\n  'enableAltitude': false,\n  'altitudeProperty': 'altitude',\n  'drawAltitude': false,\n  'altitude': 0\n};\n\nvar VectorLayer = function (_OverlayLayer) {\n  _inheritsLoose(VectorLayer, _OverlayLayer);\n\n  function VectorLayer(id, geometries, options) {\n    return _OverlayLayer.call(this, id, geometries, options) || this;\n  }\n\n  var _proto = VectorLayer.prototype;\n\n  _proto.onConfig = function onConfig(conf) {\n    _OverlayLayer.prototype.onConfig.call(this, conf);\n\n    if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n      var renderer = this.getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (options['onlyVisible'] && renderer && renderer.identify) {\n      return renderer.identify(coordinate, options);\n    }\n\n    if (!(coordinate instanceof Coordinate)) {\n      coordinate = new Coordinate(coordinate);\n    }\n\n    return this._hitGeos(this._geoList, coordinate, options);\n  };\n\n  _proto._hitGeos = function _hitGeos(geometries, coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var filter = options['filter'],\n        tolerance = options['tolerance'],\n        hits = [];\n    var map = this.getMap();\n    var point = map.coordToPoint(coordinate);\n\n    var cp = map._pointToContainerPoint(point, undefined, 0, point);\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n        continue;\n      }\n\n      if (!(geo instanceof LineString) || !geo._getArrowStyle() && !(geo instanceof Curve)) {\n        var extent = geo.getContainerExtent(TEMP_EXTENT$3);\n\n        if (tolerance) {\n          extent = extent._expand(tolerance);\n        }\n\n        if (!extent || !extent.contains(cp)) {\n          continue;\n        }\n      }\n\n      if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n        hits.push(geo);\n\n        if (options['count']) {\n          if (hits.length >= options['count']) {\n            break;\n          }\n        }\n      }\n    }\n\n    return hits;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    return this.options['altitude'] || 0;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n\n    if (isNil(options['geometries']) || options['geometries']) {\n      var clipExtent;\n\n      if (options['clipExtent']) {\n        var map = this.getMap();\n        var projection = map ? map.getProjection() : null;\n        clipExtent = new Extent(options['clipExtent'], projection);\n      }\n\n      var geoJSONs = [];\n      var geometries = this.getGeometries();\n\n      for (var i = 0, len = geometries.length; i < len; i++) {\n        var geo = geometries[i];\n        var geoExt = geo.getExtent();\n\n        if (!geoExt || clipExtent && !clipExtent.intersects(geoExt)) {\n          continue;\n        }\n\n        var json = geo.toJSON(options['geometries']);\n        geoJSONs.push(json);\n      }\n\n      profile['geometries'] = geoJSONs;\n    }\n\n    return profile;\n  };\n\n  VectorLayer.fromJSON = function fromJSON(json) {\n    if (!json || json['type'] !== 'VectorLayer') {\n      return null;\n    }\n\n    var layer = new VectorLayer(json['id'], json['options']);\n    var geoJSONs = json['geometries'];\n    var geometries = [];\n\n    for (var i = 0; i < geoJSONs.length; i++) {\n      var geo = Geometry.fromJSON(geoJSONs[i]);\n\n      if (geo) {\n        geometries.push(geo);\n      }\n    }\n\n    layer.addGeometry(geometries);\n    return layer;\n  };\n\n  VectorLayer.getPainterClass = function getPainterClass() {\n    return Painter;\n  };\n\n  VectorLayer.getCollectionPainterClass = function getCollectionPainterClass() {\n    return CollectionPainter;\n  };\n\n  return VectorLayer;\n}(OverlayLayer);\n\nVectorLayer.mergeOptions(options$f);\nVectorLayer.registerJSONType('VectorLayer');\nvar key = '_map_tool';\n\nvar MapTool = function (_Eventable) {\n  _inheritsLoose(MapTool, _Eventable);\n\n  function MapTool() {\n    return _Eventable.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTool.prototype;\n\n  _proto.addTo = function addTo(map) {\n    if (!map) {\n      return this;\n    }\n\n    this._map = map;\n\n    if (map[key]) {\n      map[key].disable();\n    }\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.enable();\n    map[key] = this;\n\n    this._fireEvent('add');\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.enable = function enable() {\n    var map = this._map;\n\n    if (!map || this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n\n    this._switchEvents('off');\n\n    this._registerEvents();\n\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this._fireEvent('enable');\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled || !this._map) {\n      return this;\n    }\n\n    this._enabled = false;\n\n    this._switchEvents('off');\n\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this._fireEvent('disable');\n\n    return this;\n  };\n\n  _proto.isEnabled = function isEnabled() {\n    if (!this._enabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    this.disable();\n\n    if (this._map) {\n      delete this._map[key];\n      delete this._map;\n    }\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    this._switchEvents('on');\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var events = this.getEvents();\n\n    if (events) {\n      this._map[to](events, this);\n    }\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    this.fire(eventName, param);\n  };\n\n  return MapTool;\n}(Eventable(Class));\n\nvar options$g = {\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 0.3\n  },\n  'doubleClickZoom': false,\n  'mode': null,\n  'once': false,\n  'autoPanAtEdge': false,\n  'ignoreMouseleave': true\n};\nvar registeredMode = {};\n\nvar DrawTool = function (_MapTool) {\n  _inheritsLoose(DrawTool, _MapTool);\n\n  DrawTool.registerMode = function registerMode(name, modeAction) {\n    registeredMode[name.toLowerCase()] = modeAction;\n  };\n\n  DrawTool.getRegisterMode = function getRegisterMode(name) {\n    return registeredMode[name.toLowerCase()];\n  };\n\n  function DrawTool(options) {\n    var _this;\n\n    _this = _MapTool.call(this, options) || this;\n\n    _this._checkMode();\n\n    _this._events = {\n      'click': _this._clickHandler,\n      'mousemove': _this._mouseMoveHandler,\n      'dblclick': _this._doubleClickHandler,\n      'mousedown': _this._mouseDownHandler,\n      'mouseup': _this._mouseUpHandler\n    };\n    return _this;\n  }\n\n  var _proto = DrawTool.prototype;\n\n  _proto.getMode = function getMode() {\n    if (this.options['mode']) {\n      return this.options['mode'].toLowerCase();\n    }\n\n    return null;\n  };\n\n  _proto.setMode = function setMode(mode) {\n    if (this._geometry) {\n      this._geometry.remove();\n\n      delete this._geometry;\n    }\n\n    this._clearStage();\n\n    this._switchEvents('off');\n\n    this.options['mode'] = mode;\n\n    this._checkMode();\n\n    if (this.isEnabled()) {\n      this._switchEvents('on');\n\n      this._restoreMapCfg();\n\n      this._saveMapCfg();\n    }\n\n    return this;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var symbol = this.options['symbol'];\n\n    if (symbol) {\n      return extendSymbol(symbol);\n    } else {\n      return extendSymbol(this.options['symbol']);\n    }\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (!symbol) {\n      return this;\n    }\n\n    this.options['symbol'] = symbol;\n\n    if (this._geometry) {\n      this._geometry.setSymbol(symbol);\n    }\n\n    return this;\n  };\n\n  _proto.getCurrentGeometry = function getCurrentGeometry() {\n    return this._geometry;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._checkMode();\n  };\n\n  _proto.onEnable = function onEnable() {\n    this._saveMapCfg();\n\n    this._drawToolLayer = this._getDrawLayer();\n\n    this._clearStage();\n\n    this._loadResources();\n\n    if (this.options['autoPanAtEdge']) {\n      var map = this.getMap();\n      this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n\n      if (!this._mapAutoPanAtEdge) {\n        map.config({\n          autoPanAtEdge: true\n        });\n      }\n    }\n\n    return this;\n  };\n\n  _proto.onDisable = function onDisable() {\n    var map = this.getMap();\n\n    this._restoreMapCfg();\n\n    this.endDraw();\n\n    if (this._map) {\n      map.removeLayer(this._getDrawLayer());\n\n      if (this.options['autoPanAtEdge']) {\n        if (!this._mapAutoPanAtEdge) {\n          map.config({\n            autoPanAtEdge: false\n          });\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, --this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, ++this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto._shouldRecordHistory = function _shouldRecordHistory(actions) {\n    return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n  };\n\n  _proto._checkMode = function _checkMode() {\n    this._getRegisterMode();\n  };\n\n  _proto._saveMapCfg = function _saveMapCfg() {\n    var map = this.getMap();\n    this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n    map.config({\n      'doubleClickZoom': this.options['doubleClickZoom']\n    });\n\n    var actions = this._getRegisterMode()['action'];\n\n    if (actions.indexOf('mousedown') > -1) {\n      var _map = this.getMap();\n\n      this._mapDraggable = _map.options['draggable'];\n\n      _map.config({\n        'draggable': false\n      });\n    }\n  };\n\n  _proto._restoreMapCfg = function _restoreMapCfg() {\n    var map = this.getMap();\n    map.config({\n      'doubleClickZoom': this._mapDoubleClickZoom\n    });\n\n    if (!isNil(this._mapDraggable)) {\n      map.config('draggable', this._mapDraggable);\n    }\n\n    delete this._mapDraggable;\n    delete this._mapDoubleClickZoom;\n  };\n\n  _proto._loadResources = function _loadResources() {\n    var symbol = this.getSymbol();\n    var resources = getExternalResources(symbol);\n\n    if (resources.length > 0) {\n      this._drawToolLayer._getRenderer().loadResources(resources);\n    }\n  };\n\n  _proto._getProjection = function _getProjection() {\n    return this._map.getProjection();\n  };\n\n  _proto._getRegisterMode = function _getRegisterMode() {\n    var mode = this.getMode();\n    var registerMode = DrawTool.getRegisterMode(mode);\n\n    if (!registerMode) {\n      throw new Error(mode + ' is not a valid mode of DrawTool.');\n    }\n\n    return registerMode;\n  };\n\n  _proto.getEvents = function getEvents() {\n    var action = this._getRegisterMode()['action'];\n\n    var _events = {};\n\n    if (Array.isArray(action)) {\n      for (var i = 0; i < action.length; i++) {\n        _events[action[i]] = this._events[action[i]];\n      }\n\n      return _events;\n    }\n\n    return null;\n  };\n\n  _proto._mouseDownHandler = function _mouseDownHandler(event) {\n    this._createGeometry(event);\n  };\n\n  _proto._mouseUpHandler = function _mouseUpHandler(event) {\n    this.endDraw(event);\n  };\n\n  _proto._clickHandler = function _clickHandler(event) {\n    var registerMode = this._getRegisterMode();\n\n    if (!this._geometry) {\n      this._createGeometry(event);\n    } else {\n      var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (!isNil(this._historyPointer)) {\n        this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n      }\n\n      this._clickCoords.push(prjCoord);\n\n      this._historyPointer = this._clickCoords.length;\n      event.drawTool = this;\n      registerMode['update'](this.getMap().getProjection(), this._clickCoords, this._geometry, event);\n\n      this._fireEvent('drawvertex', event);\n\n      if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n        this.endDraw(event);\n      }\n    }\n  };\n\n  _proto._createGeometry = function _createGeometry(event) {\n    var mode = this.getMode();\n\n    var registerMode = this._getRegisterMode();\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var symbol = this.getSymbol();\n\n    if (!this._geometry) {\n      this._clickCoords = [prjCoord];\n      event.drawTool = this;\n      this._geometry = registerMode['create'](this.getMap().getProjection(), this._clickCoords, event);\n\n      if (symbol && mode !== 'point') {\n        this._geometry.setSymbol(symbol);\n      } else if (this.options.hasOwnProperty('symbol')) {\n        this._geometry.setSymbol(this.options['symbol']);\n      }\n\n      this._addGeometryToStage(this._geometry);\n\n      this._fireEvent('drawstart', event);\n    }\n\n    if (mode === 'point') {\n      this.endDraw(event);\n    }\n  };\n\n  _proto._mouseMoveHandler = function _mouseMoveHandler(event) {\n    var map = this.getMap();\n\n    if (!this._geometry || !map || map.isInteracting()) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var projection = map.getProjection();\n    event.drawTool = this;\n\n    var registerMode = this._getRegisterMode();\n\n    if (this._shouldRecordHistory(registerMode.action)) {\n      var path = this._clickCoords.slice(0, this._historyPointer);\n\n      if (path && path.length > 0 && prjCoord.equals(path[path.length - 1])) {\n        return;\n      }\n\n      registerMode['update'](projection, path.concat([prjCoord]), this._geometry, event);\n    } else {\n      registerMode['update'](projection, prjCoord, this._geometry, event);\n    }\n\n    this._fireEvent('mousemove', event);\n  };\n\n  _proto._doubleClickHandler = function _doubleClickHandler(event) {\n    if (!this._geometry) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var registerMode = this._getRegisterMode();\n\n    var clickCoords = this._clickCoords;\n\n    if (clickCoords.length < 2) {\n      return;\n    }\n\n    var projection = this.getMap().getProjection();\n    var path = [clickCoords[0]];\n\n    for (var i = 1, len = clickCoords.length; i < len; i++) {\n      if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n        path.push(clickCoords[i]);\n      }\n    }\n\n    if (path.length < 2 || this._geometry && this._geometry instanceof Polygon && path.length < 3) {\n      return;\n    }\n\n    event.drawTool = this;\n    registerMode['update'](projection, path, this._geometry, event);\n    this.endDraw(event);\n  };\n\n  _proto._addGeometryToStage = function _addGeometryToStage(geometry) {\n    var drawLayer = this._getDrawLayer();\n\n    drawLayer.addGeometry(geometry);\n  };\n\n  _proto.endDraw = function endDraw(param) {\n    if (!this._geometry || this._ending) {\n      return this;\n    }\n\n    this._ending = true;\n    var geometry = this._geometry;\n\n    this._clearStage();\n\n    param = param || {};\n    this._geometry = geometry;\n\n    this._fireEvent('drawend', param);\n\n    delete this._geometry;\n\n    if (this.options['once']) {\n      this.disable();\n    }\n\n    delete this._ending;\n    delete this._historyPointer;\n    return this;\n  };\n\n  _proto._clearStage = function _clearStage() {\n    this._getDrawLayer().clear();\n\n    delete this._geometry;\n    delete this._clickCoords;\n  };\n\n  _proto._getMouseContainerPoint = function _getMouseContainerPoint(event) {\n    var action = this._getRegisterMode()['action'];\n\n    if (action === 'mousedown') {\n      stopPropagation(event['domEvent']);\n    }\n\n    return event['containerPoint'];\n  };\n\n  _proto._isValidContainerPoint = function _isValidContainerPoint(containerPoint) {\n    var mapSize = this._map.getSize();\n\n    var w = mapSize['width'],\n        h = mapSize['height'];\n\n    if (containerPoint.x < 0 || containerPoint.y < 0) {\n      return false;\n    } else if (containerPoint.x > w || containerPoint.y > h) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._getDrawLayer = function _getDrawLayer() {\n    var drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n\n    var drawToolLayer = this._map.getLayer(drawLayerId);\n\n    if (!drawToolLayer) {\n      drawToolLayer = new VectorLayer(drawLayerId, {\n        'enableSimplify': false\n      });\n\n      this._map.addLayer(drawToolLayer);\n    }\n\n    return drawToolLayer;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    if (this._geometry) {\n      param['geometry'] = this._getRegisterMode()['generate'](this._geometry, {\n        drawTool: this\n      });\n    }\n\n    MapTool.prototype._fireEvent.call(this, eventName, param);\n  };\n\n  return DrawTool;\n}(MapTool);\n\nDrawTool.mergeOptions(options$g);\n\nvar MapBoxZoomHander = function (_Handler) {\n  _inheritsLoose(MapBoxZoomHander, _Handler);\n\n  function MapBoxZoomHander(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this.drawTool = new DrawTool({\n      'mode': 'boxZoom',\n      'ignoreMouseleave': false\n    });\n    return _this;\n  }\n\n  var _proto = MapBoxZoomHander.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on('_mousedown', this._onMouseDown, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this.target.off('_mousedown', this._onMouseDown, this);\n\n    if (this.drawTool.isEnabled()) {\n      this.drawTool.remove();\n    }\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    if (!this.target.options['boxZoom']) {\n      return;\n    }\n\n    if (param.domEvent.shiftKey) {\n      this.drawTool.setSymbol(this.target.options['boxZoomSymbol']).on('drawend', this._boxZoom, this).addTo(this.target);\n    }\n  };\n\n  _proto._boxZoom = function _boxZoom(param) {\n    var map = this.target;\n    this.drawTool.remove();\n    var geometry = param.geometry,\n        center = geometry.getCenter(),\n        symbol = geometry.getSymbol(),\n        w = symbol.markerWidth,\n        h = symbol.markerHeight;\n    var extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n    var zoom = map.getFitZoom(extent);\n\n    map._animateTo({\n      center: extent.getCenter(),\n      zoom: zoom\n    });\n  };\n\n  return MapBoxZoomHander;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'boxZoom': true,\n  'boxZoomSymbol': {\n    'markerType': 'rectangle',\n    'markerLineWidth': 3,\n    'markerLineColor': '#1bbc9b',\n    'markerLineDasharray': [10, 5],\n    'markerFillOpacity': 0.1,\n    'markerFill': '#1bbc9b',\n    'markerWidth': 1,\n    'markerHeight': 1\n  }\n});\nMap$1.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\nvar PANOFFSET = 30;\n\nvar MapAutoPanAtEdgeHandler = function (_Handler) {\n  _inheritsLoose(MapAutoPanAtEdgeHandler, _Handler);\n\n  function MapAutoPanAtEdgeHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapAutoPanAtEdgeHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto._onMouseMove = function _onMouseMove(event) {\n    var map = this.target;\n\n    if (map.options['autoPanAtEdge']) {\n      var containerPoint = event.containerPoint;\n      var containerExtent = map.getContainerExtent();\n\n      if (containerExtent) {\n        var x = containerPoint.x,\n            y = containerPoint.y;\n        var xmax = containerExtent.xmax,\n            ymax = containerExtent.ymax;\n        var p;\n\n        if (x < PANOFFSET) {\n          p = [Math.abs(x - PANOFFSET), 0];\n        }\n\n        if (y < PANOFFSET) {\n          p = [0, Math.abs(y - PANOFFSET)];\n        }\n\n        if (x + PANOFFSET > xmax) {\n          p = [-Math.abs(x + PANOFFSET - xmax), 0];\n        }\n\n        if (y + PANOFFSET > ymax) {\n          p = [0, -Math.abs(y + PANOFFSET - ymax)];\n        }\n\n        if (p) {\n          map.panBy(p, {\n            duration: 1\n          });\n        }\n      }\n    }\n  };\n\n  return MapAutoPanAtEdgeHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'autoPanAtEdge': false\n});\nMap$1.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\nMap$1.include({\n  animateTo: function animateTo(view, options, step) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    var projection = this.getProjection(),\n        currView = this.getView(),\n        props = {};\n    var empty = true;\n\n    for (var p in view) {\n      if (hasOwn(view, p) && !isNil(view[p]) && (p === 'prjCenter' || !isNil(currView[p]))) {\n        empty = false;\n\n        if (p === 'center') {\n          var from = new Coordinate(currView[p]).toFixed(7),\n              to = new Coordinate(view[p]).toFixed(7);\n\n          if (!from.equals(to)) {\n            props['center'] = [from, to];\n          }\n        } else if (p === 'prjCenter') {\n          var _from = new Coordinate(this._getPrjCenter());\n\n          var _to = new Coordinate(view[p]);\n\n          if (!_from.equals(_to)) {\n            props['prjCenter'] = [_from, _to];\n          }\n        } else if (currView[p] !== view[p] && p !== 'around') {\n          props[p] = [currView[p], view[p]];\n        }\n      }\n    }\n\n    if (empty) {\n      return null;\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n\n    var renderer = this._getRenderer(),\n        framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate(props, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'framer': framer\n    }, function (frame) {\n      if (_this.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (player.playState === 'running') {\n        if (frame.styles['center']) {\n          var center = frame.styles['center'];\n\n          _this._setPrjCenter(projection.project(center));\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        } else if (frame.styles['prjCenter']) {\n          var _center = frame.styles['prjCenter'];\n\n          _this._setPrjCenter(_center);\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        }\n\n        if (!isNil(frame.styles['zoom'])) {\n          _this.onZooming(frame.styles['zoom'], zoomOrigin);\n        }\n\n        if (!isNil(frame.styles['pitch'])) {\n          _this.setPitch(frame.styles['pitch']);\n        }\n\n        if (!isNil(frame.styles['bearing'])) {\n          _this.setBearing(frame.styles['bearing']);\n        }\n\n        _this._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['center']) {\n            _this._setPrjCenter(projection.project(props['center'][1]));\n          } else if (props['prjCenter']) {\n            _this._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (!isNil(props['pitch'])) {\n            _this.setPitch(props['pitch'][1]);\n          }\n\n          if (!isNil(props['bearing'])) {\n            _this.setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n\n    this._startAnim(props, zoomOrigin);\n\n    return player;\n  },\n  _animateTo: function _animateTo(view, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._isInternalAnimation = true;\n    this._mapAnimPlayer = this.animateTo(view, options, step);\n    delete this._isInternalAnimation;\n    return this._mapAnimPlayer;\n  },\n  isAnimating: function isAnimating() {\n    return !!this._animPlayer;\n  },\n  isRotating: function isRotating() {\n    return this.isDragRotating() || !!this._animRotating;\n  },\n  _endAnim: function _endAnim(player, props, zoomOrigin, options) {\n    delete this._animRotating;\n    var evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n\n    if (props['center']) {\n      var endCoord;\n\n      if (player._interupted) {\n        endCoord = this.getCenter();\n      } else {\n        endCoord = props['center'][1];\n      }\n\n      this.onMoveEnd(this._parseEventFromCoord(endCoord));\n    } else if (props['prjCenter']) {\n      var _endCoord;\n\n      if (player._interupted) {\n        _endCoord = this._getPrjCenter();\n      } else {\n        _endCoord = props['prjCenter'][1];\n      }\n\n      var event = this._parseEventFromCoord(this.getProjection().unproject(_endCoord));\n\n      event['point2d'] = this._prjToPoint(_endCoord);\n      this.onMoveEnd(event);\n    }\n\n    if (!isNil(props['zoom'])) {\n      if (player._interupted) {\n        this.onZoomEnd(this.getZoom(), zoomOrigin);\n      } else if (!options['wheelZoom']) {\n        this.onZoomEnd(props['zoom'][1], zoomOrigin);\n      } else {\n        this.onZooming(props['zoom'][1], zoomOrigin);\n      }\n    }\n\n    if (evtType) {\n      this._fireEvent(evtType);\n    }\n\n    if (!isNil(props['pitch']) && !this.getPitch()) {\n      this.getRenderer().setToRedraw();\n    }\n\n    this._resumePrev(player);\n  },\n  _startAnim: function _startAnim(props, zoomOrigin) {\n    if (!this._animPlayer) {\n      return;\n    }\n\n    if (props['center']) {\n      this.onMoveStart();\n    }\n\n    if (props['zoom'] && !this.isZooming()) {\n      this.onZoomStart(props['zoom'][1], zoomOrigin);\n    }\n\n    if (props['pitch'] || props['bearing']) {\n      this._animRotating = true;\n    }\n\n    this._fireEvent('animatestart');\n\n    this._animPlayer.play();\n  },\n  _stopAnim: function _stopAnim(player) {\n    if (!player) {\n      return;\n    }\n\n    delete this._animRotating;\n\n    if (player.playState !== 'finished') {\n      player._interupted = true;\n      player.cancel();\n    }\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n  },\n  _resumePrev: function _resumePrev(player) {\n    if (!this._prevAnimPlayer) {\n      return;\n    }\n\n    var prevPlayer = this._prevAnimPlayer;\n\n    if (prevPlayer.playState !== 'paused') {\n      delete this._prevAnimPlayer;\n    }\n\n    if (player !== prevPlayer) {\n      this._animPlayer = prevPlayer;\n      prevPlayer.play();\n    }\n  }\n});\nvar events = 'mousedown ' + 'mouseup ' + 'mouseover ' + 'mouseout ' + 'mouseenter ' + 'mouseleave ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend ';\nMap$1.include({\n  _registerDomEvents: function _registerDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    addDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _removeDomEvents: function _removeDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    removeDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _handleDOMEvent: function _handleDOMEvent(e) {\n    var type = e.type;\n\n    if (type === 'contextmenu') {\n      preventDefault(e);\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    var mimicClick = false;\n\n    if (type === 'mousedown' || type === 'touchstart' && e.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if (type === 'click' || type === 'touchend' || type === 'contextmenu') {\n      if (!this._mouseDownTime) {\n        return;\n      } else {\n        var downTime = this._mouseDownTime;\n        delete this._mouseDownTime;\n        var time = now();\n\n        if (time - downTime > 300) {\n          if (type === 'click' || type === 'contextmenu') {\n            return;\n          }\n        } else if (type === 'touchend') {\n          mimicClick = true;\n        }\n      }\n    }\n\n    this._fireDOMEvent(this, e, type);\n\n    if (mimicClick) {\n      if (this._clickTime && now() - this._clickTime <= 300) {\n        delete this._clickTime;\n\n        this._fireDOMEvent(this, e, 'dblclick');\n      } else {\n        this._clickTime = now();\n\n        this._fireDOMEvent(this, e, 'click');\n      }\n    }\n  },\n  _ignoreEvent: function _ignoreEvent(domEvent) {\n    if (!domEvent || !this._panels.control) {\n      return false;\n    }\n\n    if (this._isEventOutMap(domEvent)) {\n      return true;\n    }\n\n    var target = domEvent.srcElement || domEvent.target;\n    var preTarget;\n\n    if (target) {\n      while (target && target !== this._containerDOM) {\n        if (target.className && target.className.indexOf && (target.className.indexOf('maptalks-control') >= 0 || target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation'])) {\n          return true;\n        }\n\n        preTarget = target;\n        target = target.parentNode;\n      }\n    }\n\n    return false;\n  },\n  _isEventOutMap: function _isEventOutMap(domEvent) {\n    if (this.getPitch() > this.options['maxVisualPitch']) {\n      var actualEvent = this._getActualEvent(domEvent);\n\n      var eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n\n      if (!this.getContainerExtent().contains(eventPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _parseEvent: function _parseEvent(e, type) {\n    if (!e) {\n      return null;\n    }\n\n    var eventParam = {\n      'domEvent': e\n    };\n\n    if (type !== 'keypress') {\n      var actual = this._getActualEvent(e);\n\n      if (actual) {\n        var containerPoint = getEventContainerPoint(actual, this._containerDOM);\n        eventParam = extend(eventParam, {\n          'coordinate': this.containerPointToCoord(containerPoint),\n          'containerPoint': containerPoint,\n          'viewPoint': this.containerPointToViewPoint(containerPoint),\n          'point2d': this._containerPointToPoint(containerPoint)\n        });\n      }\n    }\n\n    return eventParam;\n  },\n  _parseEventFromCoord: function _parseEventFromCoord(coord) {\n    var containerPoint = this.coordToContainerPoint(coord),\n        viewPoint = this.containerPointToViewPoint(containerPoint);\n    var e = {\n      'coordinate': coord,\n      'containerPoint': containerPoint,\n      'viewPoint': viewPoint,\n      'point2d': this.coordToPoint(coord)\n    };\n    return e;\n  },\n  _getActualEvent: function _getActualEvent(e) {\n    return e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n  },\n  _fireDOMEvent: function _fireDOMEvent(target, e, type) {\n    if (this.isRemoved()) {\n      return;\n    }\n\n    var eventParam = this._parseEvent(e, type);\n\n    this._fireEvent(type, eventParam);\n  }\n});\nMap$1.addOnLoadHook('_registerDomEvents');\nMap$1.include({\n  isFullScreen: function isFullScreen() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\n  },\n  requestFullScreen: function requestFullScreen(dom) {\n    this._fireEvent('fullscreenstart');\n\n    this._requestFullScreen(dom || this._containerDOM);\n\n    this._fireEvent('fullscreenend');\n\n    return this;\n  },\n  cancelFullScreen: function cancelFullScreen() {\n    this._cancelFullScreen();\n\n    this._fireEvent('cancelfullscreen');\n\n    return this;\n  },\n  _requestFullScreen: function _requestFullScreen(dom) {\n    if (dom.requestFullscreen) {\n      dom.requestFullscreen();\n    } else if (dom.mozRequestFullScreen) {\n      dom.mozRequestFullScreen();\n    } else if (dom.webkitRequestFullScreen) {\n      dom.webkitRequestFullScreen();\n    } else if (dom.msRequestFullScreen) {\n      dom.msRequestFullScreen();\n    } else {\n      var features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' + 'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' + 'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  },\n  _cancelFullScreen: function _cancelFullScreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitCancelFullScreen) {\n      document.webkitCancelFullScreen();\n    } else {\n      var features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' + 'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  }\n});\nMap$1.include({\n  panTo: function panTo(coordinate, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!coordinate) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    coordinate = new Coordinate(coordinate);\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      var prjCoord = this.getProjection().project(coordinate);\n      return this._panAnimation(prjCoord, options['duration'], step);\n    } else {\n      this.setCenter(coordinate);\n    }\n\n    return this;\n  },\n  _panTo: function _panTo(prjCoord, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      return this._panAnimation(prjCoord, options['duration']);\n    } else {\n      this.onMoveStart();\n\n      this._setPrjCenter(prjCoord);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n      return this;\n    }\n  },\n  panBy: function panBy(offset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!offset) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    offset = new Point(offset);\n    var containerExtent = this.getContainerExtent();\n    var ymin = containerExtent.ymin;\n\n    if (ymin > 0 && offset.y > 30) {\n      var y = offset.y;\n      offset.y = 30;\n      offset.x = offset.x * 30 / y;\n      console.warn('offset is limited to panBy when pitch is above maxPitch');\n    }\n\n    this.onMoveStart();\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      offset = offset.multi(-1);\n\n      var target = this._containerPointToPrj(new Point(this.width / 2 + offset.x, this.height / 2 + offset.y));\n\n      this._panAnimation(target, options['duration'], step);\n    } else {\n      this._offsetCenterByPixel(offset);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    }\n\n    return this;\n  },\n  _panAnimation: function _panAnimation(target, t, cb) {\n    return this._animateTo({\n      'prjCenter': target\n    }, {\n      'duration': t || this.options['panAnimationDuration']\n    }, cb);\n  }\n});\n\nGeometry.fromJSON = function (json) {\n  if (Array.isArray(json)) {\n    var result = [];\n\n    for (var i = 0, len = json.length; i < len; i++) {\n      var c = Geometry.fromJSON(json[i]);\n\n      if (Array.isArray(json)) {\n        result = result.concat(c);\n      } else {\n        result.push(c);\n      }\n    }\n\n    return result;\n  }\n\n  if (json && !json['feature']) {\n    return GeoJSON.toGeometry(json);\n  }\n\n  var geometry;\n\n  if (json['subType']) {\n    geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n\n    if (!isNil(json['feature']['id'])) {\n      geometry.setId(json['feature']['id']);\n    }\n  } else {\n    geometry = GeoJSON.toGeometry(json['feature']);\n\n    if (json['options']) {\n      geometry.config(json['options']);\n    }\n  }\n\n  if (json['symbol']) {\n    geometry.setSymbol(json['symbol']);\n  }\n\n  if (json['infoWindow']) {\n    geometry.setInfoWindow(json['infoWindow']);\n  }\n\n  return geometry;\n};\n\nLayer.fromJSON = function (layerJSON) {\n  if (!layerJSON) {\n    return null;\n  }\n\n  var layerType = layerJSON['type'];\n  var clazz = Layer.getJSONClass(layerType);\n\n  if (!clazz || !clazz.fromJSON) {\n    throw new Error('unsupported layer type:' + layerType);\n  }\n\n  return clazz.fromJSON(layerJSON);\n};\n\nMap$1.include({\n  'JSON_VERSION': '1.0',\n  toJSON: function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = {\n      'jsonVersion': this['JSON_VERSION'],\n      'version': this.VERSION,\n      'extent': this.getExtent().toJSON()\n    };\n    json['options'] = this.config();\n    json['options']['center'] = this.getCenter();\n    json['options']['zoom'] = this.getZoom();\n    json['options']['bearing'] = this.getBearing();\n    json['options']['pitch'] = this.getPitch();\n    var baseLayer = this.getBaseLayer();\n\n    if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n      json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n    }\n\n    var extraLayerOptions = {};\n\n    if (options['clipExtent']) {\n      if (options['clipExtent'] === true) {\n        extraLayerOptions['clipExtent'] = this.getExtent();\n      } else {\n        extraLayerOptions['clipExtent'] = options['clipExtent'];\n      }\n    }\n\n    var layersJSON = [];\n\n    if (isNil(options['layers']) || options['layers'] && !Array.isArray(options['layers'])) {\n      var layers = this.getLayers();\n\n      for (var i = 0, len = layers.length; i < len; i++) {\n        if (!layers[i].toJSON) {\n          continue;\n        }\n\n        var opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n        layersJSON.push(layers[i].toJSON(opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else if (isArrayHasData(options['layers'])) {\n      var _layers = options['layers'];\n\n      for (var _i = 0; _i < _layers.length; _i++) {\n        var exportOption = _layers[_i];\n        var layer = this.getLayer(exportOption['id']);\n\n        if (!layer.toJSON) {\n          continue;\n        }\n\n        var _opts = extend({}, exportOption['options'], extraLayerOptions);\n\n        layersJSON.push(layer.toJSON(_opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else {\n      json['layers'] = [];\n    }\n\n    return json;\n  }\n});\n\nMap$1.fromJSON = function (container, profile, options) {\n  if (!container || !profile) {\n    return null;\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  var map = new Map$1(container, profile['options']);\n\n  if (isNil(options['baseLayer']) || options['baseLayer']) {\n    var baseLayer = Layer.fromJSON(profile['baseLayer']);\n\n    if (baseLayer) {\n      map.setBaseLayer(baseLayer);\n    }\n  }\n\n  if (isNil(options['layers']) || options['layers']) {\n    var layers = [];\n    var layerJSONs = profile['layers'];\n\n    for (var i = 0; i < layerJSONs.length; i++) {\n      var layer = Layer.fromJSON(layerJSONs[i]);\n      layers.push(layer);\n    }\n\n    map.addLayer(layers);\n  }\n\n  return map;\n};\n\nMap$1.include({\n  computeLength: function computeLength(coord1, coord2) {\n    if (!this.getProjection()) {\n      return null;\n    }\n\n    var p1 = new Coordinate(coord1),\n        p2 = new Coordinate(coord2);\n\n    if (p1.equals(p2)) {\n      return 0;\n    }\n\n    return this.getProjection().measureLength(p1, p2);\n  },\n  computeGeometryLength: function computeGeometryLength(geometry) {\n    return geometry._computeGeodesicLength(this.getProjection());\n  },\n  computeGeometryArea: function computeGeometryArea(geometry) {\n    return geometry._computeGeodesicArea(this.getProjection());\n  },\n  identify: function identify(opts, callback) {\n    if (!opts) {\n      return this;\n    }\n\n    var reqLayers = opts['layers'];\n\n    if (!isArrayHasData(reqLayers)) {\n      return this;\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = reqLayers.length; i < len; i++) {\n      if (isString(reqLayers[i])) {\n        layers.push(this.getLayer(reqLayers[i]));\n      } else {\n        layers.push(reqLayers[i]);\n      }\n    }\n\n    var coordinate = new Coordinate(opts['coordinate']);\n    var options = extend({}, opts);\n    var hits = [];\n\n    for (var _i = layers.length - 1; _i >= 0; _i--) {\n      if (opts['count'] && hits.length >= opts['count']) {\n        break;\n      }\n\n      var layer = layers[_i];\n\n      if (!layer || !layer.getMap() || !opts['includeInvisible'] && !layer.isVisible() || !opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        continue;\n      }\n\n      var layerHits = layer.identify(coordinate, options);\n\n      if (layerHits) {\n        if (Array.isArray(layerHits)) {\n          pushIn(hits, layerHits);\n        } else {\n          hits.push(layerHits);\n        }\n      }\n    }\n\n    callback.call(this, hits);\n    return this;\n  }\n});\nMap$1.include({\n  _zoom: function _zoom(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n    nextZoom = this._checkZoom(nextZoom);\n    this.onZoomStart(nextZoom, origin);\n    this._frameZoom = this.getZoom();\n    this.onZoomEnd(nextZoom, origin);\n  },\n  _zoomAnimation: function _zoomAnimation(nextZoom, origin, startScale) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    nextZoom = this._checkZoom(nextZoom);\n\n    if (this.getZoom() === nextZoom) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n\n    this._startZoomAnim(nextZoom, origin, startScale);\n  },\n  _checkZoomOrigin: function _checkZoomOrigin(origin) {\n    if (!origin || this.options['zoomInCenter']) {\n      origin = new Point(this.width / 2, this.height / 2);\n    }\n\n    if (this.options['zoomOrigin']) {\n      origin = new Point(this.options['zoomOrigin']);\n    }\n\n    return origin;\n  },\n  _startZoomAnim: function _startZoomAnim(nextZoom, origin, startScale) {\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    var endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n\n    var duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n    this._frameZoom = this._startZoomVal;\n\n    this._animateTo({\n      'zoom': nextZoom,\n      'around': origin\n    }, {\n      'continueOnViewChanged': true,\n      'duration': duration\n    });\n  },\n  onZoomStart: function onZoomStart(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._zooming = true;\n    this._startZoomVal = this.getZoom();\n    this._startZoomCoord = this._containerPointToPrj(origin);\n\n    this._fireEvent('zoomstart', {\n      'from': this._startZoomVal,\n      'to': nextZoom\n    });\n  },\n  onZooming: function onZooming(nextZoom, origin, startScale) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var frameZoom = this._frameZoom;\n\n    if (frameZoom === nextZoom) {\n      return;\n    }\n\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    this._zoomTo(nextZoom, origin);\n\n    var res = this.getResolution(nextZoom),\n        fromRes = this.getResolution(this._startZoomVal),\n        scale = fromRes / res / startScale,\n        startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n\n    var offset = this.getViewPoint();\n\n    if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n      var pitch = this.getPitch();\n\n      var originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n\n      if (pitch) {\n        originOffset.y /= Math.cos(pitch * Math.PI / 180);\n      }\n\n      origin = origin.add(originOffset);\n    }\n\n    var matrix = {\n      'view': [scale, 0, 0, scale, (origin.x - offset.x) * (1 - scale), (origin.y - offset.y) * (1 - scale)]\n    };\n    var dpr = this.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      origin = origin.multi(dpr);\n    }\n\n    matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y * (1 - scale)];\n\n    this._fireEvent('zooming', {\n      'from': this._startZoomVal,\n      'to': nextZoom,\n      'origin': origin,\n      'matrix': matrix\n    });\n\n    this._frameZoom = nextZoom;\n  },\n  onZoomEnd: function onZoomEnd(nextZoom, origin) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var startZoomVal = this._startZoomVal;\n\n    this._zoomTo(nextZoom, origin);\n\n    this._zooming = false;\n\n    this._getRenderer().onZoomEnd();\n\n    this._fireEvent('zoomend', {\n      'from': startZoomVal,\n      'to': nextZoom\n    });\n\n    if (!this._verifyExtent(this._getPrjCenter())) {\n      this._panTo(this._prjMaxExtent.getCenter());\n    }\n  },\n  _zoomTo: function _zoomTo(nextZoom, origin) {\n    this._zoomLevel = nextZoom;\n\n    this._calcMatrices();\n\n    if (origin) {\n      this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n    }\n  },\n  _checkZoom: function _checkZoom(nextZoom) {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    if (nextZoom < minZoom) {\n      nextZoom = minZoom;\n    }\n\n    if (nextZoom > maxZoom) {\n      nextZoom = maxZoom;\n    }\n\n    return nextZoom;\n  }\n});\n\nfunction perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 2 * far * near * nf;\n  out[15] = 0;\n  return out;\n}\n\nfunction translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2],\n      a00,\n      a01,\n      a02,\n      a03,\n      a10,\n      a11,\n      a12,\n      a13,\n      a20,\n      a21,\n      a22,\n      a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n\nfunction scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction rotateX(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n\n  if (a !== out) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\nfunction rotateZ(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n\n  if (a !== out) {\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\nfunction multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\nfunction invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15],\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction set$2(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\nfunction length(a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n\n  return out;\n}\n\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\nfunction distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot ? Math.hypot(x, y, z) : hypot(x, y, z);\n}\n\nfunction transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\nfunction hypot() {\n  var y = 0;\n  var i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n}\n\nfunction applyMatrix(out, v, e) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n  out[0] = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n  out[1] = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n  out[2] = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n  return out;\n}\n\nfunction matrixToQuaternion(out, te) {\n  var m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n  var s;\n\n  if (trace > 0) {\n    s = 0.5 / Math.sqrt(trace + 1.0);\n    out.w = 0.25 / s;\n    out.x = (m32 - m23) * s;\n    out.y = (m13 - m31) * s;\n    out.z = (m21 - m12) * s;\n  } else if (m11 > m22 && m11 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n    out.w = (m32 - m23) / s;\n    out.x = 0.25 * s;\n    out.y = (m12 + m21) / s;\n    out.z = (m13 + m31) / s;\n  } else if (m22 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n    out.w = (m13 - m31) / s;\n    out.x = (m12 + m21) / s;\n    out.y = 0.25 * s;\n    out.z = (m23 + m32) / s;\n  } else {\n    s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n    out.w = (m21 - m12) / s;\n    out.x = (m13 + m31) / s;\n    out.y = (m23 + m32) / s;\n    out.z = 0.25 * s;\n  }\n\n  return this;\n}\n\nfunction quaternionToMatrix(out, q) {\n  var te = out;\n  var x = q.x,\n      y = q.y,\n      z = q.z,\n      w = q.w;\n  var x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n  var xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n  var yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n  var wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  te[0] = 1 - (yy + zz);\n  te[4] = xy - wz;\n  te[8] = xz + wy;\n  te[1] = xy + wz;\n  te[5] = 1 - (xx + zz);\n  te[9] = yz - wx;\n  te[2] = xz - wy;\n  te[6] = yz + wx;\n  te[10] = 1 - (xx + yy);\n  te[3] = 0;\n  te[7] = 0;\n  te[11] = 0;\n  te[12] = 0;\n  te[13] = 0;\n  te[14] = 0;\n  te[15] = 1;\n  return te;\n}\n\nfunction setPosition(out, v) {\n  var te = out;\n  te[12] = v[0];\n  te[13] = v[1];\n  te[14] = v[2];\n  return out;\n}\n\nfunction lookAt(te, eye, target, up) {\n  var x = [0, 0, 0];\n  var y = [0, 0, 0];\n  var z = [0, 0, 0];\n  subtract(z, eye, target);\n\n  if (length(z) === 0) {\n    z[2] = 1;\n  }\n\n  normalize(z, z);\n  cross(x, up, z);\n\n  if (length(z) === 0) {\n    if (Math.abs(up[2]) === 1) {\n      z[0] += 0.0001;\n    } else {\n      z[2] += 0.0001;\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n  }\n\n  normalize(x, x);\n  cross(y, z, x);\n  te[0] = x[0];\n  te[4] = y[0];\n  te[8] = z[0];\n  te[1] = x[1];\n  te[5] = y[1];\n  te[9] = z[1];\n  te[2] = x[2];\n  te[6] = y[2];\n  te[10] = z[2];\n  return te;\n}\n\nvar RADIAN$1 = Math.PI / 180;\nvar DEFAULT_FOV = 0.6435011087932844;\nvar TEMP_COORD = new Coordinate(0, 0);\nMap$1.include({\n  getFov: function getFov() {\n    if (!this._fov) {\n      this._fov = DEFAULT_FOV;\n    }\n\n    return this._fov / RADIAN$1;\n  },\n  setFov: function setFov(fov) {\n    if (this.isZooming()) {\n      return this;\n    }\n\n    fov = Math.max(0.01, Math.min(60, fov));\n    if (this._fov === fov) return this;\n    var from = this.getFov();\n    this._fov = fov * RADIAN$1;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('fovchange', {\n      'from': from,\n      'to': this.getFov()\n    });\n\n    return this;\n  },\n  getBearing: function getBearing() {\n    if (!this._angle) {\n      return 0;\n    }\n\n    return -this._angle / RADIAN$1;\n  },\n  setBearing: function setBearing(bearing) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t rotate in IE9.');\n    }\n\n    var b = -wrap(bearing, -180, 180) * RADIAN$1;\n    if (this._angle === b) return this;\n    var from = this.getBearing();\n\n    this._fireEvent('rotatestart', {\n      'from': from,\n      'to': b\n    });\n\n    this._angle = b;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('rotate', {\n      'from': from,\n      'to': b\n    });\n\n    this._fireEvent('rotateend', {\n      'from': from,\n      'to': b\n    });\n\n    return this;\n  },\n  getPitch: function getPitch() {\n    if (!this._pitch) {\n      return 0;\n    }\n\n    return this._pitch / Math.PI * 180;\n  },\n  setPitch: function setPitch(pitch) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t tilt in IE9.');\n    }\n\n    var p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN$1;\n    if (this._pitch === p) return this;\n    var from = this.getPitch();\n\n    this._fireEvent('pitchstart', {\n      'from': from,\n      'to': p\n    });\n\n    this._pitch = p;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('pitch', {\n      'from': from,\n      'to': p\n    });\n\n    this._fireEvent('pitchend', {\n      'from': from,\n      'to': p\n    });\n\n    return this;\n  },\n  isTransforming: function isTransforming() {\n    return !!(this._pitch || this._angle);\n  },\n  getFrustumAltitude: function getFrustumAltitude() {\n    return this._frustumAltitude;\n  },\n  _calcFrustumAltitude: function _calcFrustumAltitude() {\n    var pitch = 90 - this.getPitch();\n    var fov = this.getFov() / 2;\n    var cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n\n    if (fov <= pitch) {\n      return cameraAlt;\n    }\n\n    fov = Math.PI * fov / 180;\n    var d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n        d2 = cameraAlt * Math.tan(fov * 2);\n    var d = Math.tan(fov) * (d1 + d2);\n    return cameraAlt + d;\n  },\n  _pointToContainerPoint: function () {\n    var a = [0, 0, 0];\n    return function (point, zoom, altitude, out) {\n      if (altitude === void 0) {\n        altitude = 0;\n      }\n\n      point = this._pointToPoint(point, zoom, out);\n\n      if (this.isTransforming() || altitude) {\n        altitude *= this._getResolution(zoom) / this._getResolution();\n        var _scale = this._glScale;\n        set$2(a, point.x * _scale, point.y * _scale, altitude * _scale);\n\n        var t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n\n        applyMatrix(t, t, this.projViewMatrix);\n        var w2 = this.width / 2,\n            h2 = this.height / 2;\n        t[0] = t[0] * w2 + w2;\n        t[1] = -(t[1] * h2) + h2;\n\n        if (out) {\n          out.x = t[0];\n          out.y = t[1];\n          return out;\n        }\n\n        return new Point(t[0], t[1]);\n      } else {\n        var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n\n        if (out) {\n          out.x = point.x;\n          out.y = point.y;\n        } else {\n          out = point;\n        }\n\n        out._sub(centerPoint.x, centerPoint.y);\n\n        out.set(out.x, -out.y);\n        return out._add(this.width / 2, this.height / 2);\n      }\n    };\n  }(),\n  _projIfBehindCamera: function () {\n    var vectorFromCam = new Array(3);\n    var proj = new Array(3);\n    var sub = new Array(3);\n    return function (position, cameraPos, camForward) {\n      subtract(vectorFromCam, position, cameraPos);\n      var camNormDot = dot(camForward, vectorFromCam);\n\n      if (camNormDot <= 0) {\n        scale$1(proj, camForward, camNormDot * 1.01);\n        add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n      }\n\n      return position;\n    };\n  }(),\n  _containerPointToPoint: function () {\n    var cp = [0, 0, 0],\n        coord0 = [0, 0, 0, 1],\n        coord1 = [0, 0, 0, 1];\n    return function (p, zoom, out) {\n      if (this.isTransforming()) {\n        var w2 = this.width / 2 || 1,\n            h2 = this.height / 2 || 1;\n        set$2(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n        set$2(coord0, cp[0], cp[1], 0);\n        set$2(coord1, cp[0], cp[1], 1);\n        coord0[3] = coord1[3] = 1;\n        applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n        applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n        var x0 = coord0[0];\n        var x1 = coord1[0];\n        var y0 = coord0[1];\n        var y1 = coord1[1];\n        var z0 = coord0[2];\n        var z1 = coord1[2];\n        var t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n\n        var _x = interpolate(x0, x1, t);\n\n        var _y = interpolate(y0, y1, t);\n\n        if (out) {\n          out.x = _x;\n          out.y = _y;\n        } else {\n          out = new Point(_x, _y);\n        }\n\n        out._multi(1 / this._glScale);\n\n        return zoom === undefined || this.getZoom() === zoom ? out : this._pointToPointAtZoom(out, zoom, out);\n      }\n\n      var centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n          scale$$1 = zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1;\n\n      var x = scale$$1 * (p.x - this.width / 2),\n          y = scale$$1 * (p.y - this.height / 2);\n      return centerPoint._add(x, -y);\n    };\n  }(),\n  _calcMatrices: function () {\n    var m0 = createMat4(),\n        m1 = createMat4();\n    return function () {\n      delete this._mapRes;\n      delete this._mapGlRes;\n      delete this._mapExtent2D;\n      delete this._mapGlExtent2D;\n      var size = this.getSize();\n      var w = size.width || 1,\n          h = size.height || 1;\n      this._glScale = this.getGLScale();\n      var pitch = this.getPitch() * Math.PI / 180;\n\n      var worldMatrix = this._getCameraWorldMatrix();\n\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, this.getPitch());\n\n      this.cameraFar = farZ;\n      this.cameraNear = Math.max(this._glScale * this.getResolution(this.getGLZoom()) * Math.cos(pitch), 0.1);\n      var projMatrix = this.projMatrix || createMat4();\n      perspective(projMatrix, fov, w / h, this.cameraNear, farZ);\n      this.projMatrix = projMatrix;\n      this.viewMatrix = invert(m0, worldMatrix);\n      this.projViewMatrix = multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n\n      this._calcCascadeMatrixes();\n\n      this.projViewMatrixInverse = multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, invert(m1, projMatrix));\n      this.domCssMatrix = this._calcDomMatrix();\n      this._frustumAltitude = this._calcFrustumAltitude();\n      this._mapRes = this._getResolution();\n      this._mapGlRes = this._getResolution(this.getGLZoom());\n      this._mapExtent2D = this._get2DExtent();\n      this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n    };\n  }(),\n  _getCameraFar: function _getCameraFar(fov, pitch) {\n    var cameraCenterDistance = this.cameraCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n    var farZ = cameraCenterDistance;\n\n    if (pitch > 0) {\n      pitch = pitch * Math.PI / 180;\n      var y;\n\n      if (2 / Math.PI - pitch <= fov / 2) {\n        y = 4 * cameraCenterDistance;\n      } else {\n        var tanFov = Math.tan(fov / 2);\n        var tanP = Math.tan(pitch);\n        y = cameraCenterDistance * tanFov / (1 / tanP - tanFov);\n      }\n\n      farZ += y;\n    }\n\n    return farZ + 1.0;\n  },\n  _calcCascadeMatrixes: function () {\n    var projMatrix = createMat4();\n\n    function cal(curPitch, pitch, out) {\n      var w = this.width;\n      var h = this.height;\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, pitch);\n\n      var cameraCenterDistance = this.cameraCenterDistance;\n      farZ = cameraCenterDistance + (farZ - cameraCenterDistance) / Math.cos((90 - pitch) * Math.PI / 180) * Math.cos((90 - curPitch) * Math.PI / 180);\n      perspective(projMatrix, fov, w / h, 0.1, farZ);\n      var viewMatrix = this.viewMatrix;\n      return multiply(out, projMatrix, viewMatrix);\n    }\n\n    return function () {\n      var pitch = this.getPitch();\n      var cascadePitch0 = this.options['cascadePitches'][0];\n      var cascadePitch1 = this.options['cascadePitches'][1];\n      var projViewMatrix0 = this.cascadeFrustumMatrix0 = this.cascadeFrustumMatrix0 || createMat4();\n      var projViewMatrix1 = this.cascadeFrustumMatrix1 = this.cascadeFrustumMatrix1 || createMat4();\n\n      if (pitch > cascadePitch0) {\n        cal.call(this, pitch, cascadePitch0, projViewMatrix0);\n      } else {\n        copy(this.cascadeFrustumMatrix0, this.projViewMatrix);\n      }\n\n      if (pitch > cascadePitch1) {\n        cal.call(this, pitch, cascadePitch1, projViewMatrix1);\n      } else {\n        copy(this.cascadeFrustumMatrix1, this.cascadeFrustumMatrix0);\n      }\n    };\n  }(),\n  _calcDomMatrix: function () {\n    var m = createMat4(),\n        m1 = createMat4(),\n        minusY = [1, -1, 1],\n        arr = [0, 0, 0];\n    return function () {\n      var width = this.width || 1;\n      var height = this.height || 1;\n      var cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * height;\n      scale(m, this.projMatrix, minusY);\n      translate(m, m, set$2(arr, 0, 0, -cameraToCenterDistance));\n\n      if (this._pitch) {\n        rotateX(m, m, this._pitch);\n      }\n\n      if (this._angle) {\n        rotateZ(m, m, this._angle);\n      }\n\n      identity(m1);\n      scale(m1, m1, set$2(arr, width / 2, -height / 2, 1));\n      return multiply(this.domCssMatrix || createMat4(), m1, m);\n    };\n  }(),\n  _getCameraWorldMatrix: function () {\n    var q = {};\n    return function () {\n      var targetZ = this.getGLZoom();\n      var size = this.getSize(),\n          scale$$1 = this.getGLScale();\n\n      var center2D = this._prjToPoint(this._prjCenter, targetZ);\n\n      this.cameraLookAt = set$2(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n      var pitch = this.getPitch() * RADIAN$1;\n      var bearing = this.getBearing() * RADIAN$1;\n\n      var ratio = this._getFovRatio();\n\n      var z = scale$$1 * (size.height || 1) / 2 / ratio;\n      var cz = z * Math.cos(pitch);\n      var dist = Math.sin(pitch) * z;\n      var cx = center2D.x - dist * Math.sin(bearing);\n      var cy = center2D.y - dist * Math.cos(bearing);\n      this.cameraPosition = set$2(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n      var d = dist || 1;\n      var up = this.cameraUp = set$2(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n      var m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n      lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n      var cameraForward = this.cameraForward || [0, 0, 0];\n      subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n      this.cameraForward = normalize(cameraForward, cameraForward);\n      matrixToQuaternion(q, m);\n      quaternionToMatrix(m, q);\n      setPosition(m, this.cameraPosition);\n      return m;\n    };\n  }(),\n  _getFovRatio: function _getFovRatio() {\n    var fov = this.getFov();\n    return Math.tan(fov / 2 * RADIAN$1);\n  },\n  _renderLayers: function _renderLayers() {\n    if (this.isInteracting()) {\n      return;\n    }\n\n    var layers = this._getLayers();\n\n    layers.forEach(function (layer) {\n      if (!layer) {\n        return;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    });\n  }\n});\n\nfunction createMat4() {\n  return identity(new Array(16));\n}\n\nMap$1.include({\n  _onViewChange: function _onViewChange(view) {\n    if (!this._viewHistory) {\n      this._viewHistory = [];\n      this._viewHistoryPointer = 0;\n    }\n\n    var old = this._getCurrentView();\n\n    for (var i = this._viewHistory.length - 1; i >= 0; i--) {\n      if (equalMapView(view, this._viewHistory[i])) {\n        this._viewHistoryPointer = i;\n\n        this._fireViewChange(old, view);\n\n        return;\n      }\n    }\n\n    if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n      this._viewHistory.splice(this._viewHistoryPointer + 1);\n    }\n\n    this._viewHistory.push(view);\n\n    var count = this.options['viewHistoryCount'];\n\n    if (count > 0 && this._viewHistory.length > count) {\n      this._viewHistory.splice(0, this._viewHistory.length - count);\n    }\n\n    this._viewHistoryPointer = this._viewHistory.length - 1;\n\n    this._fireViewChange(old, view);\n  },\n  zoomToPreviousView: function zoomToPreviousView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasPreviousView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[--this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasPreviousView: function hasPreviousView() {\n    if (!this._viewHistory || this._viewHistoryPointer === 0) {\n      return false;\n    }\n\n    return true;\n  },\n  zoomToNextView: function zoomToNextView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasNextView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[++this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasNextView: function hasNextView() {\n    if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _zoomToView: function _zoomToView(view, options) {\n    var _this = this;\n\n    var old = this.getView();\n\n    if (options['animation']) {\n      this._animateTo(view, {\n        'duration': options['duration']\n      }, function (frame) {\n        if (frame.state.playState === 'finished') {\n          _this._fireViewChange(old, view);\n        }\n      });\n    } else {\n      this.setView(view);\n\n      this._fireViewChange(old, view);\n    }\n  },\n  getViewHistory: function getViewHistory() {\n    return this._viewHistory;\n  },\n  _fireViewChange: function _fireViewChange(old, view) {\n    this._fireEvent('viewchange', {\n      'old': old,\n      'new': view\n    });\n  },\n  _getCurrentView: function _getCurrentView() {\n    if (!this._viewHistory) {\n      return null;\n    }\n\n    return this._viewHistory[this._viewHistoryPointer];\n  }\n});\nMap$1.mergeOptions({\n  'viewHistory': true,\n  'viewHistoryCount': 10\n});\nvar options$h = {\n  'mode': 'LineString',\n  'language': 'zh-CN',\n  'metric': true,\n  'imperial': false,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 3,\n    'lineOpacity': 1\n  },\n  'vertexSymbol': {\n    'markerType': 'ellipse',\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 3,\n    'markerWidth': 11,\n    'markerHeight': 11\n  },\n  'labelOptions': {\n    'textSymbol': {\n      'textFaceName': 'monospace',\n      'textLineSpacing': 1,\n      'textHorizontalAlignment': 'right',\n      'textDx': 15\n    },\n    'boxStyle': {\n      'padding': [6, 2],\n      'symbol': {\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerFillOpacity': 0.9,\n        'markerLineColor': '#b4b3b3'\n      }\n    }\n  },\n  'clearButtonSymbol': [{\n    'markerType': 'square',\n    'markerFill': '#fff',\n    'markerLineColor': '#b4b3b3',\n    'markerLineWidth': 2,\n    'markerWidth': 15,\n    'markerHeight': 15,\n    'markerDx': 20\n  }, {\n    'markerType': 'x',\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'markerDx': 20\n  }]\n};\n\nvar DistanceTool = function (_DrawTool) {\n  _inheritsLoose(DistanceTool, _DrawTool);\n\n  function DistanceTool(options) {\n    var _this;\n\n    _this = _DrawTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = DistanceTool.prototype;\n\n  _proto.clear = function clear() {\n    if (isArrayHasData(this._measureLayers)) {\n      for (var i = 0; i < this._measureLayers.length; i++) {\n        this._measureLayers[i].remove();\n      }\n    }\n\n    delete this._lastMeasure;\n    delete this._lastVertex;\n    this._measureLayers = [];\n    return this;\n  };\n\n  _proto.getMeasureLayers = function getMeasureLayers() {\n    return this._measureLayers;\n  };\n\n  _proto.getLastMeasure = function getLastMeasure() {\n    if (!this._lastMeasure) {\n      return 0;\n    }\n\n    return this._lastMeasure;\n  };\n\n  _proto.undo = function undo() {\n    _DrawTool.prototype.undo.call(this);\n\n    var pointer = this._historyPointer;\n\n    if (pointer !== this._vertexes.length) {\n      for (var i = pointer; i < this._vertexes.length; i++) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.remove();\n        }\n\n        this._vertexes[i].marker.remove();\n      }\n    }\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    _DrawTool.prototype.redo.call(this);\n\n    var i = this._historyPointer - 1;\n\n    if (this._vertexes[i]) {\n      if (!this._vertexes[i].marker.getLayer()) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.addTo(this._measureMarkerLayer);\n        }\n\n        this._vertexes[i].marker.addTo(this._measureMarkerLayer);\n      }\n    }\n\n    return this;\n  };\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var length;\n\n    if (toMeasure instanceof Geometry) {\n      length = map.computeGeometryLength(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      length = map.getProjection().measureLength(toMeasure);\n    }\n\n    this._lastMeasure = length;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 米', ' 公里', ' 英尺', ' 英里'];\n    } else {\n      units = [' m', ' km', ' feet', ' mile'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      length *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._registerMeasureEvents = function _registerMeasureEvents() {\n    this.on('drawstart', this._msOnDrawStart, this).on('drawvertex', this._msOnDrawVertex, this).on('mousemove', this._msOnMouseMove, this).on('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._afterEnable = function _afterEnable() {\n    this._registerMeasureEvents();\n  };\n\n  _proto._afterDisable = function _afterDisable() {\n    this.off('drawstart', this._msOnDrawStart, this).off('drawvertex', this._msOnDrawVertex, this).off('mousemove', this._msOnMouseMove, this).off('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._msOnDrawStart = function _msOnDrawStart(param) {\n    var map = this.getMap();\n\n    var prjCoord = map._pointToPrj(param['point2d']);\n\n    var uid = UID();\n    var layerId = 'distancetool_' + uid;\n    var markerLayerId = 'distancetool_markers_' + uid;\n\n    if (!map.getLayer(layerId)) {\n      this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n      this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n    } else {\n      this._measureLineLayer = map.getLayer(layerId);\n      this._measureMarkerLayer = map.getLayer(markerLayerId);\n    }\n\n    this._measureLayers.push(this._measureLineLayer);\n\n    this._measureLayers.push(this._measureMarkerLayer);\n\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    marker._setPrjCoordinates(prjCoord);\n\n    var content = this.options['language'] === 'zh-CN' ? '起点' : 'start';\n    var startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n\n    startLabel._setPrjCoordinates(prjCoord);\n\n    this._lastVertex = startLabel;\n\n    this._addVertexMarker(marker, startLabel);\n  };\n\n  _proto._msOnMouseMove = function _msOnMouseMove(param) {\n    var ms = this._measure(this._msGetCoordsToMeasure(param));\n\n    if (!this._tailMarker) {\n      var symbol = extendSymbol(this.options['vertexSymbol']);\n      symbol['markerWidth'] /= 2;\n      symbol['markerHeight'] /= 2;\n      this._tailMarker = new Marker(param['coordinate'], {\n        'symbol': symbol\n      }).addTo(this._measureMarkerLayer);\n      this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n    }\n\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n\n    this._tailMarker.setCoordinates(param['coordinate']);\n\n    this._tailMarker._setPrjCoordinates(lastCoord);\n\n    this._tailLabel.setContent(ms);\n\n    this._tailLabel.setCoordinates(param['coordinate']);\n\n    this._tailLabel._setPrjCoordinates(lastCoord);\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getCoordinates().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n    var geometry = param['geometry'];\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    var length = this._measure(geometry);\n\n    var vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n\n    this._addVertexMarker(marker, vertexLabel);\n\n    vertexLabel._setPrjCoordinates(lastCoord);\n\n    marker._setPrjCoordinates(lastCoord);\n\n    this._lastVertex = vertexLabel;\n  };\n\n  _proto._addVertexMarker = function _addVertexMarker(marker, vertexLabel) {\n    if (!this._vertexes) {\n      this._vertexes = [];\n    }\n\n    this._vertexes.push({\n      label: vertexLabel,\n      marker: marker\n    });\n\n    if (this._historyPointer !== undefined) {\n      this._vertexes.length = this._historyPointer;\n    }\n\n    this._measureMarkerLayer.addGeometry(marker);\n\n    if (vertexLabel) {\n      this._measureMarkerLayer.addGeometry(vertexLabel);\n    }\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var size = this._lastVertex.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(this._lastVertex.getCoordinates(), this._lastVertex._getPrjCoordinates(), size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getLength();\n  };\n\n  _proto._addClearMarker = function _addClearMarker(coordinates, prjCoord, dx) {\n    var symbol = this.options['clearButtonSymbol'];\n    var dxSymbol = {\n      'markerDx': (symbol['markerDx'] || 0) + dx,\n      'textDx': (symbol['textDx'] || 0) + dx\n    };\n\n    if (Array.isArray(symbol)) {\n      dxSymbol = symbol.map(function (s) {\n        if (s) {\n          return {\n            'markerDx': (s['markerDx'] || 0) + dx,\n            'textDx': (s['textDx'] || 0) + dx\n          };\n        }\n\n        return null;\n      });\n    }\n\n    symbol = extendSymbol(symbol, dxSymbol);\n    var endMarker = new Marker(coordinates, {\n      'symbol': symbol\n    });\n    var measureLineLayer = this._measureLineLayer,\n        measureMarkerLayer = this._measureMarkerLayer;\n    endMarker.on('click', function () {\n      measureLineLayer.remove();\n      measureMarkerLayer.remove();\n      return false;\n    }, this);\n    endMarker.addTo(this._measureMarkerLayer);\n\n    endMarker._setPrjCoordinates(prjCoord);\n  };\n\n  _proto._clearTailMarker = function _clearTailMarker() {\n    if (this._tailMarker) {\n      this._tailMarker.remove();\n\n      delete this._tailMarker;\n    }\n\n    if (this._tailLabel) {\n      this._tailLabel.remove();\n\n      delete this._tailLabel;\n    }\n  };\n\n  return DistanceTool;\n}(DrawTool);\n\nDistanceTool.mergeOptions(options$h);\nvar options$i = {\n  'mode': 'Polygon',\n  'symbol': {\n    'lineColor': '#000000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'lineDasharray': '',\n    'polygonFill': '#ffffff',\n    'polygonOpacity': 0.5\n  }\n};\n\nvar AreaTool = function (_DistanceTool) {\n  _inheritsLoose(AreaTool, _DistanceTool);\n\n  function AreaTool(options) {\n    var _this;\n\n    _this = _DistanceTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = AreaTool.prototype;\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var area;\n\n    if (toMeasure instanceof Geometry) {\n      area = map.computeGeometryArea(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      area = map.getProjection().measureArea(toMeasure);\n    }\n\n    this._lastMeasure = area;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n    } else {\n      units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      area *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      var sqmi = 5280 * 5280;\n      content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getShell().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var vertexMarker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    vertexMarker._setPrjCoordinates(prjCoord);\n\n    this._measure(param['geometry']);\n\n    this._lastVertex = vertexMarker;\n\n    this._addVertexMarker(vertexMarker);\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var ms = this._measure(param['geometry']);\n\n    var endLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n\n    endLabel._setPrjCoordinates(prjCoord);\n\n    var size = endLabel.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(param['coordinate'], prjCoord, size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getArea();\n  };\n\n  return AreaTool;\n}(DistanceTool);\n\nAreaTool.mergeOptions(options$i);\nvar circleHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var circle = new Circle(center, 0);\n\n    circle._setPrjCoordinates(prjCoord[0]);\n\n    return circle;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var radius = map.computeLength(geometry.getCenter(), nextCoord);\n    geometry.setRadius(radius);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('circle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, circleHooks));\nDrawTool.registerMode('freeHandCircle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, circleHooks));\nvar ellipseHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var ellipse = new Ellipse(center, 0, 0);\n\n    ellipse._setPrjCoordinates(prjCoord[0]);\n\n    return ellipse;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var center = geometry.getCenter();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var rx = map.computeLength(center, new Coordinate({\n      x: nextCoord.x,\n      y: center.y\n    }));\n    var ry = map.computeLength(center, new Coordinate({\n      x: center.x,\n      y: nextCoord.y\n    }));\n    geometry.setWidth(rx * 2);\n    geometry.setHeight(ry * 2);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('ellipse', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, ellipseHooks));\nDrawTool.registerMode('freeHandEllipse', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, ellipseHooks));\nvar rectangleHooks = {\n  'create': function create(projection, prjCoords) {\n    var rect = new Polygon([]);\n    rect._firstClick = prjCoords[0];\n    return rect;\n  },\n  'update': function update(projection, prjCoords, geometry, param) {\n    var map = geometry.getMap();\n    var containerPoint = param['containerPoint'];\n\n    var firstClick = map._prjToContainerPoint(geometry._firstClick);\n\n    var ring = [[firstClick.x, firstClick.y], [containerPoint.x, firstClick.y], [containerPoint.x, containerPoint.y], [firstClick.x, containerPoint.y]];\n    geometry.setCoordinates(ring.map(function (c) {\n      return map.containerPointToCoord(new Point(c));\n    }));\n\n    geometry._setPrjCoordinates(ring.map(function (c) {\n      return map._containerPointToPrj(new Point(c));\n    }));\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('rectangle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, rectangleHooks));\nDrawTool.registerMode('freeHandRectangle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, rectangleHooks));\nDrawTool.registerMode('point', {\n  'clickLimit': 1,\n  'action': ['click'],\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var marker = new Marker(center);\n\n    marker._setPrjCoordinates(prjCoord[0]);\n\n    return marker;\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nvar polygonHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, path, geometry) {\n    var symbol = geometry.getSymbol();\n    var prjCoords;\n\n    if (Array.isArray(path)) {\n      prjCoords = path;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(path);\n    }\n\n    var coordinates = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(coordinates);\n\n    geometry._setPrjCoordinates(prjCoords);\n\n    var layer = geometry.getLayer();\n\n    if (layer) {\n      var polygon = layer.getGeometryById('polygon');\n\n      if (!polygon && prjCoords.length >= 3) {\n        polygon = new Polygon([coordinates], {\n          'id': 'polygon'\n        });\n\n        if (symbol) {\n          var pSymbol = extendSymbol(symbol, {\n            'lineOpacity': 0\n          });\n          polygon.setSymbol(pSymbol);\n        }\n\n        polygon.addTo(layer);\n      }\n\n      if (polygon) {\n        polygon._setPrjCoordinates(prjCoords);\n      }\n    }\n  },\n  'generate': function generate(geometry) {\n    var polygon = new Polygon(geometry.getCoordinates(), {\n      'symbol': geometry.getSymbol()\n    });\n\n    polygon._setPrjCoordinates(geometry._getPrjCoordinates());\n\n    polygon._projCode = geometry._projCode;\n    return polygon;\n  }\n};\nDrawTool.registerMode('polygon', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, polygonHooks));\nDrawTool.registerMode('freeHandPolygon', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, polygonHooks));\nvar lineStringHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var prjCoords;\n\n    if (Array.isArray(prjPath)) {\n      prjCoords = prjPath;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(prjPath);\n    }\n\n    var path = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(path);\n\n    geometry._setPrjCoordinates(prjCoords);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('linestring', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, lineStringHooks));\nDrawTool.registerMode('freeHandLinestring', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, lineStringHooks));\nDrawTool.registerMode('arccurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var arc = new ArcCurve(path);\n\n    arc._setPrjCoordinates(prjPath);\n\n    return arc;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('quadbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new QuadBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('cubicbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new CubicBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('boxZoom', {\n  'action': ['mousedown', 'mousemove', 'mouseup'],\n  'create': function create(projection, prjCoord) {\n    prjCoord = prjCoord[0];\n    var center = projection.unproject(prjCoord);\n    var marker = new Marker(center);\n    marker._firstClick = prjCoord;\n    return marker;\n  },\n  'update': function update(projection, prjCoord, geometry, param) {\n    var map = geometry.getMap();\n\n    var p1 = map._prjToContainerPoint(geometry._firstClick),\n        p2 = param['containerPoint'];\n\n    prjCoord = map._containerPointToPrj(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n    var center = projection.unproject(prjCoord);\n\n    geometry.setCoordinates(center)._setPrjCoordinates(prjCoord);\n\n    geometry.updateSymbol({\n      markerWidth: Math.abs(p1.x - p2.x),\n      markerHeight: Math.abs(p1.y - p2.y)\n    });\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\n\nfunction parse(arcConf) {\n  var tileInfo = arcConf['tileInfo'],\n      tileSize = [tileInfo['cols'], tileInfo['rows']],\n      resolutions = [],\n      lods = tileInfo['lods'];\n\n  for (var i = 0, len = lods.length; i < len; i++) {\n    resolutions.push(lods[i]['resolution']);\n  }\n\n  var fullExtent = arcConf['fullExtent'],\n      origin = tileInfo['origin'],\n      tileSystem = [1, -1, origin['x'], origin['y']];\n  delete fullExtent['spatialReference'];\n  return {\n    'spatialReference': {\n      'resolutions': resolutions,\n      'fullExtent': fullExtent\n    },\n    'tileSystem': tileSystem,\n    'tileSize': tileSize\n  };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url) && url.substring(0, 1) !== '{') {\n    Ajax.getJSON(url, function (err, json) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var spatialRef = parse(json);\n      cb(null, spatialRef);\n    }, options);\n  } else {\n    if (isString(url)) {\n      url = parseJSON(url);\n    }\n\n    var spatialRef = parse(url);\n    cb(null, spatialRef);\n  }\n\n  return this;\n};\n\nfunction getProjection(projection) {\n  var prj = projection.indexOf('EPSG') > -1 ? projection : 'EPSG:' + projection;\n  prj = strReplace(prj, [['4490', '4326'], ['102100', '3857'], ['900913', '3857']]);\n  return prj;\n}\n\nfunction strReplace(str, repArray) {\n  if (repArray === void 0) {\n    repArray = [];\n  }\n\n  repArray.forEach(function (rep) {\n    var template = rep[0],\n        value = rep[1];\n    str = str.replace(template, value);\n  });\n  return str;\n}\n\nfunction parseWMTSXML(str, requestUrl, options) {\n  var parser = new DOMParser();\n  var xmlDoc = parser.parseFromString(str, 'text/xml');\n  var content = xmlDoc.querySelectorAll('Contents')[0];\n\n  if (!content) {\n    return [];\n  }\n\n  var layers = content.getElementsByTagName('Layer');\n\n  if (!layers.length) {\n    return [];\n  }\n\n  var TileMatrixSets = [];\n\n  for (var i = 0, len = content.childNodes.length; i < len; i++) {\n    if (content.childNodes[i].nodeName === 'TileMatrixSet') {\n      TileMatrixSets.push(content.childNodes[i]);\n    }\n  }\n\n  if (!TileMatrixSets.length) {\n    return [];\n  }\n\n  var result = [];\n\n  for (var _i = 0, _len = layers.length; _i < _len; _i++) {\n    var layer = layers[_i];\n    var style = layer.querySelectorAll('Style')[0];\n\n    if (style) {\n      style = style.getElementsByTagName('ows:Identifier')[0];\n\n      if (style) {\n        style = style.textContent;\n      }\n    }\n\n    var layerName = layer.getElementsByTagName('ows:Identifier')[0];\n\n    if (layerName) {\n      layerName = layerName.textContent;\n    }\n\n    var resourceURL = layer.querySelectorAll('ResourceURL')[0];\n    var url = '';\n\n    if (resourceURL) {\n      url = resourceURL.attributes.template.value;\n    }\n\n    var _parseTileMatrixSet = parseTileMatrixSet(TileMatrixSets, _i, options),\n        resolutions = _parseTileMatrixSet.resolutions,\n        tileSize = _parseTileMatrixSet.tileSize,\n        tileSystem = _parseTileMatrixSet.tileSystem,\n        projection = _parseTileMatrixSet.projection,\n        TileMatrixSet = _parseTileMatrixSet.TileMatrixSet;\n\n    if (!url.length) {\n      url = requestUrl.substr(0, requestUrl.lastIndexOf('?'));\n      url += '?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT=tiles&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}';\n    }\n\n    var urlTemplate = strReplace(url, [['{LAYER}', layerName], ['{Layer}', layerName], ['{layer}', layerName], ['{STYLE}', style], ['{Style}', style], ['{style}', style], ['{TileMatrixSet}', TileMatrixSet], ['{TileMatrix}', '{z}'], ['{TileRow}', '{y}'], ['{TileCol}', '{x}']]);\n    result.push({\n      tileSize: tileSize,\n      tileSystem: tileSystem,\n      spatialReference: {\n        resolutions: resolutions,\n        projection: projection\n      },\n      urlTemplate: urlTemplate,\n      info: {\n        layerName: layerName,\n        TileMatrixSet: TileMatrixSet,\n        style: style,\n        tileSize: tileSize,\n        tileSystem: tileSystem,\n        resolutions: resolutions,\n        projection: projection,\n        urlTemplate: urlTemplate\n      }\n    });\n  }\n\n  return result;\n}\n\nfunction parseTileMatrixSet(TileMatrixSets, index, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var TileMatrixSet = TileMatrixSets[index];\n  var TileMatrixs = TileMatrixSet.getElementsByTagName('TileMatrix');\n  var resolutions = [],\n      tileSystem = [],\n      tileSize = [];\n  var projection, tset;\n\n  if (!projection) {\n    var supportedCRS = TileMatrixSet.getElementsByTagName('ows:SupportedCRS')[0];\n\n    if (supportedCRS) {\n      projection = supportedCRS.textContent;\n      projection = projection.split('EPSG')[1];\n\n      while (projection.indexOf(':') > -1) {\n        projection = projection.replace(':', '');\n      }\n\n      projection = getProjection(projection);\n    }\n  }\n\n  if (!tset) {\n    tset = TileMatrixSet.getElementsByTagName('ows:Identifier')[0];\n\n    if (tset) {\n      tset = tset.textContent;\n    }\n  }\n\n  var transformValue = 0.0002645833333333333;\n\n  if (options.isArcgis) {\n    transformValue = 0.00028;\n  }\n\n  if (projection && projection.indexOf('4326') > -1) {\n    transformValue = 2.3767925226029154e-9;\n\n    if (options.isArcgis) {\n      transformValue = 2.518101729011901e-9;\n    }\n  }\n\n  var minLevel = Infinity;\n\n  for (var _index = 0; _index < TileMatrixs.length; _index++) {\n    var TileMatrix = TileMatrixs[_index];\n    var level = TileMatrix.getElementsByTagName('ows:Identifier')[0].textContent;\n    level = parseInt(level);\n    minLevel = Math.min(minLevel, level);\n    var ScaleDenominator = TileMatrix.getElementsByTagName('ScaleDenominator')[0].textContent;\n    var TopLeftCorner = TileMatrix.getElementsByTagName('TopLeftCorner')[0].textContent;\n    var TileWidth = TileMatrix.getElementsByTagName('TileWidth')[0].textContent;\n    var TileHeight = TileMatrix.getElementsByTagName('TileHeight')[0].textContent;\n\n    if (tileSize.length === 0) {\n      tileSize.push(parseInt(TileWidth), parseInt(TileHeight));\n    }\n\n    if (tileSystem.length === 0) {\n      var _TopLeftCorner$split$ = TopLeftCorner.split(' ').filter(function (s) {\n        return s !== '';\n      }).map(function (v) {\n        return parseFloat(v);\n      }),\n          x = _TopLeftCorner$split$[0],\n          y = _TopLeftCorner$split$[1];\n\n      if (x > 0) {\n        tileSystem.push(1, -1, y, x);\n      } else {\n        tileSystem.push(1, -1, x, y);\n      }\n    }\n\n    var res = parseFloat(ScaleDenominator) * transformValue;\n    resolutions.push(res);\n  }\n\n  if (minLevel > 0) {\n    var _res = resolutions[0];\n\n    for (var i = minLevel - 1; i >= 0; i--) {\n      _res = _res * 2;\n      resolutions.splice(0, 0, _res);\n    }\n  }\n\n  return {\n    resolutions: resolutions,\n    tileSize: tileSize,\n    tileSystem: tileSystem,\n    projection: projection,\n    TileMatrixSet: tset\n  };\n}\n\nSpatialReference.loadWMTS = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url)) {\n    Ajax.get(url, function (err, xml) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var layers = parseWMTSXML(xml, url, options);\n      cb(null, layers);\n    }, options);\n  }\n\n  return this;\n};\n\nvar options$j = {\n  'eventsPropagation': false,\n  'eventsToStop': null,\n  'dx': 0,\n  'dy': 0,\n  'autoPan': false,\n  'autoPanDuration': 600,\n  'single': true,\n  'animation': 'scale',\n  'animationOnHide': true,\n  'animationDuration': 500,\n  'pitchWithMap': false,\n  'rotateWithMap': false\n};\n\nvar UIComponent = function (_Eventable) {\n  _inheritsLoose(UIComponent, _Eventable);\n\n  function UIComponent(options) {\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = UIComponent.prototype;\n\n  _proto.addTo = function addTo(owner) {\n    this._owner = owner;\n\n    this._switchEvents('on');\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add');\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._owner) {\n      return null;\n    }\n\n    if (this._owner.getBaseLayer) {\n      return this._owner;\n    }\n\n    return this._owner.getMap();\n  };\n\n  _proto.show = function show(coordinate) {\n    var map = this.getMap();\n\n    if (!map) {\n      return this;\n    }\n\n    if (!this._mapEventsOn) {\n      this._switchMapEvents('on');\n    }\n\n    coordinate = coordinate || this._coordinate || this._owner.getCenter();\n    var visible = this.isVisible();\n    this.fire('showstart');\n\n    var container = this._getUIContainer();\n\n    this._coordinate = coordinate;\n\n    this._removePrevDOM();\n\n    var dom = this.__uiDOM = this.buildOn(map);\n    dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n    if (!dom) {\n      this.fire('showend');\n      return this;\n    }\n\n    this._measureSize(dom);\n\n    if (this._singleton()) {\n      map[this._uiDomKey()] = dom;\n    }\n\n    this._setPosition();\n\n    dom.style[TRANSITION] = null;\n    container.appendChild(dom);\n\n    var anim = this._getAnimation();\n\n    if (visible) {\n      anim.ok = false;\n    }\n\n    if (anim.ok) {\n      if (anim.fade) {\n        dom.style.opacity = 0;\n      }\n\n      if (anim.scale) {\n        if (this.getTransformOrigin) {\n          var origin = this.getTransformOrigin();\n          dom.style[TRANSFORMORIGIN] = origin;\n        }\n\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n      }\n    }\n\n    dom.style.display = '';\n\n    if (this.options['eventsToStop']) {\n      on(dom, this.options['eventsToStop'], stopPropagation);\n    }\n\n    if (this.options['autoPan']) {\n      this._autoPan();\n    }\n\n    var transition = anim.transition;\n\n    if (anim.ok && transition) {\n      dom.offsetHeight;\n\n      if (transition) {\n        dom.style[TRANSITION] = transition;\n      }\n\n      if (anim.fade) {\n        dom.style.opacity = 1;\n      }\n\n      if (anim.scale) {\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n      }\n    }\n\n    this.fire('showend');\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this = this;\n\n    if (!this.getDOM() || !this.getMap()) {\n      return this;\n    }\n\n    var anim = this._getAnimation(),\n        dom = this.getDOM();\n\n    if (!this.options['animationOnHide']) {\n      anim.ok = false;\n    }\n\n    if (!anim.ok) {\n      dom.style.display = 'none';\n      this.fire('hide');\n    } else {\n      dom.offsetHeight;\n      dom.style[TRANSITION] = anim.transition;\n      setTimeout(function () {\n        dom.style.display = 'none';\n\n        _this.fire('hide');\n      }, this.options['animationDuration']);\n    }\n\n    if (anim.fade) {\n      dom.style.opacity = 0;\n    }\n\n    if (anim.scale) {\n      dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    var dom = this.getDOM();\n    return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n  };\n\n  _proto.remove = function remove() {\n    delete this._mapEventsOn;\n\n    if (!this._owner) {\n      return this;\n    }\n\n    this.hide();\n\n    this._switchEvents('off');\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (!this._singleton() && this.__uiDOM) {\n      this._removePrevDOM();\n    }\n\n    delete this._owner;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (this._size) {\n      return this._size.copy();\n    } else {\n      return null;\n    }\n  };\n\n  _proto.getOwner = function getOwner() {\n    return this._owner;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this.__uiDOM;\n  };\n\n  _proto.getPosition = function getPosition() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var p = this._getViewPoint()._round();\n\n    if (this.getOffset) {\n      var o = this.getOffset()._round();\n\n      if (o) {\n        p._add(o);\n      }\n    }\n\n    return p;\n  };\n\n  _proto._getAnimation = function _getAnimation() {\n    var anim = {\n      'fade': false,\n      'scale': false\n    };\n    var animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n\n    for (var i = 0; i < animations.length; i++) {\n      var trimed = trim(animations[i]);\n\n      if (trimed === 'fade') {\n        anim.fade = true;\n      } else if (trimed === 'scale') {\n        anim.scale = true;\n      }\n    }\n\n    var transition = null;\n\n    if (anim.fade) {\n      transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n    }\n\n    if (anim.scale) {\n      transition = transition ? transition + ',' : '';\n      transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n    }\n\n    anim.transition = transition;\n    anim.ok = transition !== null;\n    return anim;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner && this._owner.getAltitude) {\n      var altitude = this._owner.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    return map.distanceToPoint(altitude, 0, undefined, center).x * sign(altitude);\n  };\n\n  _proto._autoPan = function _autoPan() {\n    var map = this.getMap(),\n        dom = this.getDOM();\n\n    if (map.isMoving()) {\n      return;\n    }\n\n    var point = this._pos;\n    var mapSize = map.getSize(),\n        mapWidth = mapSize['width'],\n        mapHeight = mapSize['height'];\n    var containerPoint = map.viewPointToContainerPoint(point);\n    var clientWidth = parseInt(dom.clientWidth),\n        clientHeight = parseInt(dom.clientHeight);\n    var left = 0,\n        top = 0;\n\n    if (containerPoint.x < 0) {\n      left = -(containerPoint.x - clientWidth / 2);\n    } else if (containerPoint.x + clientWidth - 35 > mapWidth) {\n      left = mapWidth - (containerPoint.x + clientWidth * 3 / 2);\n    }\n\n    if (containerPoint.y - clientHeight < 0) {\n      top = -(containerPoint.y - clientHeight) + 50;\n    } else if (containerPoint.y > mapHeight) {\n      top = mapHeight - containerPoint.y - clientHeight - 30;\n    }\n\n    if (top !== 0 || left !== 0) {\n      map.panBy(new Point(left, top), {\n        'duration': this.options['autoPanDuration']\n      });\n    }\n  };\n\n  _proto._measureSize = function _measureSize(dom) {\n    var container = this._getUIContainer();\n\n    dom.style.position = 'absolute';\n    dom.style.left = -99999 + 'px';\n    var anchor = dom.style.bottom ? 'bottom' : 'top';\n    dom.style[anchor] = -99999 + 'px';\n    dom.style.display = '';\n    container.appendChild(dom);\n    this._size = new Size(dom.clientWidth, dom.clientHeight);\n    dom.style.display = 'none';\n    dom.style.left = '0px';\n    dom.style[anchor] = '0px';\n    return this._size;\n  };\n\n  _proto._removePrevDOM = function _removePrevDOM() {\n    if (this.onDomRemove) {\n      this.onDomRemove();\n    }\n\n    var eventsToStop = this.options['eventsToStop'];\n\n    if (this._singleton()) {\n      var map = this.getMap(),\n          key = this._uiDomKey();\n\n      if (map[key]) {\n        if (eventsToStop) {\n          off(map[key], eventsToStop, stopPropagation);\n        }\n\n        removeDomNode(map[key]);\n        delete map[key];\n      }\n\n      delete this.__uiDOM;\n    } else if (this.__uiDOM) {\n      if (eventsToStop) {\n        off(this.__uiDOM, eventsToStop, stopPropagation);\n      }\n\n      removeDomNode(this.__uiDOM);\n      delete this.__uiDOM;\n    }\n  };\n\n  _proto._uiDomKey = function _uiDomKey() {\n    return '__ui_' + this._getClassName();\n  };\n\n  _proto._singleton = function _singleton() {\n    return this.options['single'];\n  };\n\n  _proto._getUIContainer = function _getUIContainer() {\n    return this.getMap()._panels['ui'];\n  };\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIComponent';\n  };\n\n  _proto._switchMapEvents = function _switchMapEvents(to) {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this._mapEventsOn = to === 'on';\n\n    var events = this._getDefaultEvents();\n\n    if (this.getEvents) {\n      extend(events, this.getEvents());\n    }\n\n    if (events) {\n      for (var p in events) {\n        if (events.hasOwnProperty(p)) {\n          map[to](p, events[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    this._switchMapEvents(to);\n\n    var ownerEvents = this._getOwnerEvents();\n\n    if (this._owner) {\n      for (var p in ownerEvents) {\n        if (ownerEvents.hasOwnProperty(p)) {\n          this._owner[to](p, ownerEvents[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return {\n      'zooming rotate pitch': this.onEvent,\n      'zoomend': this.onZoomEnd,\n      'moving': this.onMoving,\n      'resize': this.onResize\n    };\n  };\n\n  _proto._getOwnerEvents = function _getOwnerEvents() {\n    var events = {};\n\n    if (this._owner && this._owner instanceof Geometry) {\n      events.positionchange = this.onGeometryPositionChange;\n    }\n\n    if (this.getOwnerEvents) {\n      extend(events, this.getOwnerEvents());\n    }\n\n    return events;\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange(param) {\n    if (this._owner && this.isVisible()) {\n      this.show(param['target'].getCenter());\n    }\n  };\n\n  _proto.onMoving = function onMoving() {\n    if (this.isVisible() && this.getMap().isTransforming()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onEvent = function onEvent() {\n    if (this.isVisible()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto.onResize = function onResize() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var renderer = this.getMap()._getRenderer();\n\n    renderer.callInNextFrame(this._setPosition.bind(this));\n  };\n\n  _proto._setPosition = function _setPosition() {\n    var dom = this.getDOM();\n    if (!dom) return;\n    dom.style[TRANSITION] = null;\n    var p = this.getPosition();\n    this._pos = p;\n    dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n  };\n\n  _proto._toCSSTranslate = function _toCSSTranslate(p) {\n    if (!p) {\n      return '';\n    }\n\n    if (Browser$1.any3d) {\n      var map = this.getMap(),\n          bearing = map ? map.getBearing() : 0,\n          pitch = map ? map.getPitch() : 0;\n      var r = '';\n\n      if (this.options['pitchWithMap'] && pitch) {\n        r += \" rotateX(\" + Math.round(pitch) + \"deg)\";\n      }\n\n      if (this.options['rotateWithMap'] && bearing) {\n        r += \" rotateZ(\" + Math.round(-bearing) + \"deg)\";\n      }\n\n      return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n    } else {\n      return 'translate(' + p.x + 'px,' + p.y + 'px)';\n    }\n  };\n\n  UIComponent.isSupport = function isSupport(owner) {\n    if (owner && isFunction(owner.on) && isFunction(owner.off) && isFunction(owner.getCenter)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return UIComponent;\n}(Eventable(Class));\n\nUIComponent.mergeOptions(options$j);\nvar options$k = {\n  'containerClass': null,\n  'eventsPropagation': true,\n  'draggable': false,\n  'single': false,\n  'content': null\n};\nvar domEvents = 'mousedown ' + 'mouseup ' + 'mouseenter ' + 'mouseover ' + 'mouseout ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar UIMarker = function (_Handlerable) {\n  _inheritsLoose(UIMarker, _Handlerable);\n\n  function UIMarker(coordinate, options) {\n    var _this;\n\n    _this = _Handlerable.call(this, options) || this;\n    _this._markerCoord = new Coordinate(coordinate);\n    return _this;\n  }\n\n  var _proto = UIMarker.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIMarker';\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    this._markerCoord = coordinates;\n    this.fire('positionchange');\n\n    if (this.isVisible()) {\n      this._coordinate = this._markerCoord;\n\n      this._setPosition();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._markerCoord;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.show();\n  };\n\n  _proto.show = function show() {\n    return _Handlerable.prototype.show.call(this, this._markerCoord);\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (isString(this.options['content'])) {\n      dom = createEl('div');\n      dom.innerHTML = this.options['content'];\n    } else {\n      dom = this.options['content'];\n    }\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    this._registerDOMEvents(dom);\n\n    return dom;\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    return new Point(-size.width / 2, -size.height / 2);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    return 'center center';\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    var dom = this.getDOM();\n\n    this._removeDOMEvents(dom);\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  };\n\n  _proto._registerDOMEvents = function _registerDOMEvents(dom) {\n    on(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._onDomEvents = function _onDomEvents(e) {\n    var event = this.getMap()._parseEvent(e, e.type);\n\n    this.fire(e.type, event);\n  };\n\n  _proto._removeDOMEvents = function _removeDOMEvents(dom) {\n    off(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = map.coordToContainerPoint(this.getCoordinates());\n    var size = this.getSize(),\n        width = size.width,\n        height = size.height;\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(-width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(0, height / 2)), map.containerPointToCoordinate(containerPoint.add(0, -height / 2))];\n    return anchors;\n  };\n\n  return UIMarker;\n}(Handlerable(UIComponent));\n\nUIMarker.mergeOptions(options$k);\nvar EVENTS$1 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar UIMarkerDragHandler = function (_Handler) {\n  _inheritsLoose(UIMarkerDragHandler, _Handler);\n\n  function UIMarkerDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto2 = UIMarkerDragHandler.prototype;\n\n  _proto2.addHooks = function addHooks() {\n    this.target.on(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2.removeHooks = function removeHooks() {\n    this.target.off(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2._startDrag = function _startDrag(param) {\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = param['coordinate'];\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    this.target.fire('dragstart', param);\n  };\n\n  _proto2._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.target.getDOM(), {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this);\n\n    this._dragHandler.on('dragging', this._dragging, this);\n\n    this._dragHandler.on('mouseup', this._endDrag, this);\n\n    this._dragHandler.enable();\n  };\n\n  _proto2._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2._onMouseDown = function _onMouseDown(param) {\n    stopPropagation(param['domEvent']);\n  };\n\n  _proto2._dragging = function _dragging(param) {\n    var target = this.target,\n        map = target.getMap(),\n        eventParam = map._parseEvent(param['domEvent']),\n        domEvent = eventParam['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._isDragging) {\n      this._isDragging = true;\n      return;\n    }\n\n    var coord = eventParam['coordinate'],\n        point = eventParam['containerPoint'];\n\n    if (!this._lastCoord) {\n      this._lastCoord = coord;\n    }\n\n    if (!this._lastPoint) {\n      this._lastPoint = point;\n    }\n\n    var coordOffset = coord.sub(this._lastCoord),\n        pointOffset = point.sub(this._lastPoint);\n    this._lastCoord = coord;\n    this._lastPoint = point;\n    this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n    eventParam['coordOffset'] = coordOffset;\n    eventParam['pointOffset'] = pointOffset;\n    target.fire('dragging', eventParam);\n  };\n\n  _proto2._endDrag = function _endDrag(param) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (this._dragHandler) {\n      target.off('click', this._endDrag, this);\n\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n\n    if (!map) {\n      return;\n    }\n\n    var eventParam = map._parseEvent(param['domEvent']);\n\n    target.fire('dragend', eventParam);\n  };\n\n  _proto2.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return UIMarkerDragHandler;\n}(Handler$1);\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\nvar options$l = {\n  'containerClass': 'maptalks-msgBox',\n  'autoPan': true,\n  'autoCloseOn': null,\n  'autoOpenOn': 'click',\n  'width': 300,\n  'minHeight': 120,\n  'custom': false,\n  'title': null,\n  'content': null\n};\n\nvar InfoWindow = function (_UIComponent) {\n  _inheritsLoose(InfoWindow, _UIComponent);\n\n  function InfoWindow() {\n    return _UIComponent.apply(this, arguments) || this;\n  }\n\n  var _proto = InfoWindow.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'InfoWindow';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner instanceof Geometry) {\n      if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n        owner.removeInfoWindow();\n      }\n\n      owner._infoWindow = this;\n    }\n\n    return _UIComponent.prototype.addTo.call(this, owner);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.setTitle = function setTitle(title) {\n    var old = title;\n    this.options['title'] = title;\n    this.fire('contentchange', {\n      'old': old,\n      'new': title\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getTitle = function getTitle() {\n    return this.options['title'];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        var _dom = createEl('div');\n\n        _dom.innerHTML = this.options['content'];\n        return _dom;\n      } else {\n        return this.options['content'];\n      }\n    }\n\n    var dom = createEl('div');\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    dom.style.width = this._getWindowWidth() + 'px';\n    dom.style.bottom = '0px';\n    var content = '<em class=\"maptalks-ico\"></em>';\n\n    if (this.options['title']) {\n      content += '<h2>' + this.options['title'] + '</h2>';\n    }\n\n    content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n    dom.innerHTML = content;\n    var msgContent = dom.querySelector('.maptalks-msgContent');\n\n    if (isString(this.options['content'])) {\n      msgContent.innerHTML = this.options['content'];\n    } else {\n      msgContent.appendChild(this.options['content']);\n    }\n\n    this._onCloseBtnClick = this.hide.bind(this);\n    var closeBtn = dom.querySelector('.maptalks-close');\n    addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n    return dom;\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var size = this.getSize();\n    return size.width / 2 + 'px bottom';\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    var o = new Point(-size['width'] / 2, 0);\n\n    if (!this.options['custom']) {\n      o._sub(4, 12);\n    } else {\n      o._sub(0, size['height']);\n    }\n\n    var owner = this.getOwner();\n\n    if (owner instanceof Marker || owner instanceof MultiPoint) {\n      var painter, markerSize;\n\n      if (owner instanceof Marker) {\n        painter = owner._getPainter();\n        markerSize = owner.getSize();\n      } else {\n        var children = owner.getGeometries();\n\n        if (!children || !children.length) {\n          return o;\n        }\n\n        painter = children[0]._getPainter();\n        markerSize = children[0].getSize();\n      }\n\n      if (painter) {\n        var fixExtent = painter.getFixedExtent();\n\n        o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n      } else {\n        o._add(0, -markerSize.height);\n      }\n    }\n\n    return o;\n  };\n\n  _proto.show = function show(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!this.getMap().options['enableInfoWindow']) {\n      return this;\n    }\n\n    return _UIComponent.prototype.show.call(this, coordinate);\n  };\n\n  _proto.getEvents = function getEvents() {\n    if (!this.options['autoCloseOn']) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoCloseOn']] = this.hide;\n    return events;\n  };\n\n  _proto.getOwnerEvents = function getOwnerEvents() {\n    var owner = this.getOwner();\n\n    if (!this.options['autoOpenOn'] || !owner) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoOpenOn']] = this._onAutoOpen;\n    return events;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.onDomRemove();\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    if (this._onCloseBtnClick) {\n      var dom = this.getDOM();\n      var closeBtn = dom.childNodes[2];\n      removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n      delete this._onCloseBtnClick;\n    }\n  };\n\n  _proto._onAutoOpen = function _onAutoOpen(e) {\n    var _this = this;\n\n    var owner = this.getOwner();\n    setTimeout(function () {\n      if (owner instanceof Marker || owner instanceof UIComponent) {\n        _this.show(owner.getCoordinates());\n      } else if (owner instanceof MultiPoint) {\n        _this.show(owner.findClosest(e.coordinate));\n      } else if (owner instanceof LineString || owner instanceof MultiLineString) {\n        if (_this.getMap().getScale() >= 8) {\n          e.coordinate = _this._rectifyMouseCoordinte(owner, e.coordinate);\n        }\n\n        _this.show(e.coordinate);\n      } else {\n        _this.show(e.coordinate);\n      }\n    }, 1);\n  };\n\n  _proto._rectifyMouseCoordinte = function _rectifyMouseCoordinte(owner, mouseCoordinate) {\n    var _this2 = this;\n\n    if (owner instanceof LineString) {\n      return this._rectifyLineStringMouseCoordinate(owner, mouseCoordinate).coordinate;\n    } else if (owner instanceof MultiLineString) {\n      return owner.getGeometries().map(function (lineString) {\n        return _this2._rectifyLineStringMouseCoordinate(lineString, mouseCoordinate);\n      }).sort(function (a, b) {\n        return a.dis - b.dis;\n      })[0].coordinate;\n    }\n\n    return mouseCoordinate;\n  };\n\n  _proto._rectifyLineStringMouseCoordinate = function _rectifyLineStringMouseCoordinate(lineString, mouseCoordinate) {\n    var _this3 = this;\n\n    var pts = lineString.getCoordinates().map(function (coordinate) {\n      return _this3.getMap().coordToContainerPoint(coordinate);\n    });\n    var mousePt = this.getMap().coordToContainerPoint(mouseCoordinate);\n    var minDis = Infinity,\n        coordinateIndex = -1;\n\n    for (var i = 0, len = pts.length; i < len; i++) {\n      var pt = pts[i];\n      var dis = mousePt.distanceTo(pt);\n\n      if (dis < minDis) {\n        minDis = dis;\n        coordinateIndex = i;\n      }\n    }\n\n    var filterPts = [];\n\n    if (coordinateIndex === 0) {\n      filterPts.push(pts[0], pts[1]);\n    } else if (coordinateIndex === pts.length - 1) {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex]);\n    } else {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex], pts[coordinateIndex + 1]);\n    }\n\n    var xys = [];\n\n    var _this$getMap$getSize = this.getMap().getSize(),\n        width = _this$getMap$getSize.width,\n        height = _this$getMap$getSize.height;\n\n    for (var _i = 0, _len = filterPts.length - 1; _i < _len; _i++) {\n      var pt1 = filterPts[_i],\n          pt2 = filterPts[_i + 1];\n\n      if (pt1.x === pt2.x) {\n        var miny = Math.max(0, Math.min(pt1.y, pt2.y));\n        var maxy = Math.min(height, Math.max(pt1.y, pt2.y));\n\n        for (var y = miny; y <= maxy; y++) {\n          xys.push(new Point(pt1.x, y));\n        }\n      } else {\n        var k = (pt2.y - pt1.y) / (pt2.x - pt1.x);\n        var minx = Math.max(0, Math.min(pt1.x, pt2.x));\n        var maxx = Math.min(width, Math.max(pt1.x, pt2.x));\n\n        for (var x = minx; x <= maxx; x++) {\n          var _y = k * (x - pt1.x) + pt1.y;\n\n          xys.push(new Point(x, _y));\n        }\n      }\n    }\n\n    var minPtDis = Infinity,\n        ptIndex = -1;\n\n    for (var _i2 = 0, _len2 = xys.length; _i2 < _len2; _i2++) {\n      var _pt = xys[_i2];\n\n      var _dis = mousePt.distanceTo(_pt);\n\n      if (_dis < minPtDis) {\n        minPtDis = _dis;\n        ptIndex = _i2;\n      }\n    }\n\n    return {\n      dis: minPtDis,\n      coordinate: ptIndex < 0 ? mouseCoordinate : this.getMap().containerPointToCoord(xys[ptIndex])\n    };\n  };\n\n  _proto._getWindowWidth = function _getWindowWidth() {\n    var defaultWidth = 300;\n    var width = this.options['width'];\n\n    if (!width) {\n      width = defaultWidth;\n    }\n\n    return width;\n  };\n\n  return InfoWindow;\n}(UIComponent);\n\nInfoWindow.mergeOptions(options$l);\nvar options$m = {\n  'width': 0,\n  'height': 0,\n  'animation': 'fade',\n  'containerClass': 'maptalks-tooltip',\n  'showTimeout': 400\n};\n\nvar ToolTip = function (_UIComponent) {\n  _inheritsLoose(ToolTip, _UIComponent);\n\n  var _proto = ToolTip.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'ToolTip';\n  };\n\n  function ToolTip(content, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _UIComponent.call(this, options) || this;\n    _this._content = content;\n    return _this;\n  }\n\n  _proto.addTo = function addTo(owner) {\n    if (ToolTip.isSupport(owner)) {\n      owner.on('mousemove', this.onMouseMove, this);\n      owner.on('mouseout', this.onMouseOut, this);\n      return _UIComponent.prototype.addTo.call(this, owner);\n    } else {\n      throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n    }\n  };\n\n  _proto.setStyle = function setStyle$$1(cssName) {\n    this.options.containerClass = cssName;\n    return this;\n  };\n\n  _proto.getStyle = function getStyle() {\n    return this.options.containerClass;\n  };\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom = createEl('div');\n    var options = this.options || {};\n\n    if (options.height) {\n      dom.style.height = options.height + 'px';\n    }\n\n    if (options.width) {\n      dom.style.width = options.width + 'px';\n    }\n\n    var cssName = options.containerClass || options.cssName;\n\n    if (!cssName && options.height) {\n      dom.style.lineHeight = options.height + 'px';\n    }\n\n    dom.innerHTML = \"<div class=\\\"\" + cssName + \"\\\">\" + this._content + \"</div>\";\n    return dom;\n  };\n\n  _proto.onMouseOut = function onMouseOut() {\n    clearTimeout(this._timeout);\n\n    if (this.isVisible()) {\n      this._removePrevDOM();\n    }\n  };\n\n  _proto.onMouseMove = function onMouseMove(e) {\n    var _this2 = this;\n\n    clearTimeout(this._timeout);\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var coord = map.locateByPoint(e.coordinate, -5, 25);\n\n    if (this.options['showTimeout'] === 0) {\n      this.show(coord);\n    } else {\n      this._timeout = setTimeout(function () {\n        if (map) {\n          _this2.show(coord);\n        }\n      }, this.options['showTimeout']);\n    }\n  };\n\n  _proto.onRemove = function onRemove() {\n    clearTimeout(this._timeout);\n\n    if (this._owner) {\n      this._owner.off('mouseover', this.onMouseOver, this);\n\n      this._owner.off('mouseout', this.onMouseOut, this);\n    }\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, 0)._add(this.options['dx'], this.options['dy']);\n  };\n\n  return ToolTip;\n}(UIComponent);\n\nToolTip.mergeOptions(options$m);\nvar defaultOptions = {\n  'containerClass': 'maptalks-menu',\n  'animation': null,\n  'animationDelay': 10,\n  'animationOnHide': false,\n  'autoPan': false,\n  'width': 160,\n  'maxHeight': 0,\n  'custom': false,\n  'items': []\n};\n\nvar Menu = function (_UIComponent) {\n  _inheritsLoose(Menu, _UIComponent);\n\n  function Menu(options) {\n    return _UIComponent.call(this, options) || this;\n  }\n\n  var _proto = Menu.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'Menu';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner._menu && owner._menu !== this) {\n      owner.removeMenu();\n    }\n\n    owner._menu = this;\n    return UIComponent.prototype.addTo.apply(this, arguments);\n  };\n\n  _proto.setItems = function setItems(items) {\n    this.options['items'] = items;\n    return this;\n  };\n\n  _proto.getItems = function getItems() {\n    return this.options['items'] || [];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['items'])) {\n        var container = createEl('div');\n        container.innerHTML = this.options['items'];\n        return container;\n      } else {\n        return this.options['items'];\n      }\n    } else {\n      var dom = createEl('div');\n\n      if (this.options['containerClass']) {\n        addClass(dom, this.options['containerClass']);\n      }\n\n      dom.style.width = this._getMenuWidth() + 'px';\n\n      var menuItems = this._createMenuItemDom();\n\n      dom.appendChild(menuItems);\n      on(dom, 'contextmenu', preventDefault);\n      return dom;\n    }\n  };\n\n  _proto.getOffset = function getOffset() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var mapSize = this.getMap().getSize(),\n        p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n        size = this.getSize();\n    var dx = 0,\n        dy = 0;\n\n    if (p.x + size['width'] > mapSize['width']) {\n      dx = -size['width'];\n    }\n\n    if (p.y + size['height'] > mapSize['height']) {\n      dy = -size['height'];\n    }\n\n    return new Point(dx, dy);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var p = this.getOffset()._multi(-1);\n\n    return p.x + 'px ' + p.y + 'px';\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart _zoomend _movestart _dblclick _click': this._removePrevDOM\n    };\n  };\n\n  _proto._createMenuItemDom = function _createMenuItemDom() {\n    var me = this;\n    var map = this.getMap();\n    var ul = createEl('ul');\n    addClass(ul, 'maptalks-menu-items');\n    var items = this.getItems();\n\n    function onMenuClick(index) {\n      return function (e) {\n        var param = map._parseEvent(e, 'click');\n\n        param['target'] = me;\n        param['owner'] = me._owner;\n        param['index'] = index;\n\n        var result = this._callback(param);\n\n        if (result === false) {\n          return;\n        }\n\n        me.hide();\n      };\n    }\n\n    var item, itemDOM;\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      item = items[i];\n\n      if (item === '-' || item === '_') {\n        itemDOM = createEl('li');\n        addClass(itemDOM, 'maptalks-menu-splitter');\n      } else {\n        itemDOM = createEl('li');\n        var itemTitle = item['item'];\n\n        if (isFunction(itemTitle)) {\n          itemTitle = itemTitle({\n            'owner': this._owner,\n            'index': i\n          });\n        }\n\n        itemDOM.innerHTML = itemTitle;\n        itemDOM._callback = item['click'];\n        on(itemDOM, 'click', onMenuClick(i));\n      }\n\n      ul.appendChild(itemDOM);\n    }\n\n    var maxHeight = this.options['maxHeight'] || 0;\n\n    if (maxHeight > 0) {\n      setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n    }\n\n    return ul;\n  };\n\n  _proto._getMenuWidth = function _getMenuWidth() {\n    var defaultWidth = 160;\n    var width = this.options['width'] || defaultWidth;\n    return width;\n  };\n\n  return Menu;\n}(UIComponent);\n\nMenu.mergeOptions(defaultOptions);\nvar Menuable = {\n  setMenu: function setMenu(options) {\n    this._menuOptions = options;\n\n    if (this._menu) {\n      this._menu.setOptions(options);\n    } else {\n      this.on('contextmenu', this._defaultOpenMenu, this);\n    }\n\n    return this;\n  },\n  openMenu: function openMenu(coordinate) {\n    var map = this instanceof Map$1 ? this : this.getMap();\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._menu) {\n      if (this._menuOptions && map) {\n        this._bindMenu(this._menuOptions);\n\n        this._menu.show(coordinate);\n      }\n    } else {\n      this._menu.show(coordinate);\n    }\n\n    return this;\n  },\n  setMenuItems: function setMenuItems(items) {\n    if (!this._menuOptions) {\n      this._menuOptions = {};\n    }\n\n    if (Array.isArray(items)) {\n      this._menuOptions['custom'] = false;\n    }\n\n    this._menuOptions['items'] = items;\n    this.setMenu(this._menuOptions);\n    return this;\n  },\n  getMenuItems: function getMenuItems() {\n    if (this._menu) {\n      return this._menu.getItems();\n    } else if (this._menuOptions) {\n      return this._menuOptions['items'] || [];\n    }\n\n    return [];\n  },\n  closeMenu: function closeMenu() {\n    if (this._menu) {\n      this._menu.hide();\n    }\n\n    return this;\n  },\n  removeMenu: function removeMenu() {\n    this.off('contextmenu', this._defaultOpenMenu, this);\n\n    this._unbindMenu();\n\n    delete this._menuOptions;\n    return this;\n  },\n  _bindMenu: function _bindMenu(options) {\n    this._menu = new Menu(options);\n\n    this._menu.addTo(this);\n\n    return this;\n  },\n  _unbindMenu: function _unbindMenu() {\n    if (this._menu) {\n      this.closeMenu();\n\n      this._menu.remove();\n\n      delete this._menu;\n    }\n\n    return this;\n  },\n  _defaultOpenMenu: function _defaultOpenMenu(param) {\n    if (this.listens('contextmenu') > 1) {\n      return true;\n    } else {\n      this.openMenu(param['coordinate']);\n      return false;\n    }\n  }\n};\nMap$1.include(Menuable);\nGeometry.include(Menuable);\nvar index$4 = /*#__PURE__*/Object.freeze({\n  UIComponent: UIComponent,\n  UIMarker: UIMarker,\n  InfoWindow: InfoWindow,\n  ToolTip: ToolTip,\n  Menuable: Menuable,\n  Menu: Menu\n});\n\nvar Control = function (_Eventable) {\n  _inheritsLoose(Control, _Eventable);\n\n  function Control(options) {\n    if (options && options['position'] && !isString(options['position'])) {\n      options['position'] = extend({}, options['position']);\n    }\n\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = Control.prototype;\n\n  _proto.addTo = function addTo(map) {\n    this.remove();\n\n    if (!map.options['control']) {\n      return this;\n    }\n\n    this._map = map;\n    var controlContainer = map._panels.control;\n    this.__ctrlContainer = createEl('div');\n    setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n    this.update();\n    controlContainer.appendChild(this.__ctrlContainer);\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add', {\n      'dom': controlContainer\n    });\n    return this;\n  };\n\n  _proto.update = function update() {\n    this.__ctrlContainer.innerHTML = '';\n    this._controlDom = this.buildOn(this.getMap());\n\n    if (this._controlDom) {\n      this._updatePosition();\n\n      this.__ctrlContainer.appendChild(this._controlDom);\n    }\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.getPosition = function getPosition() {\n    return extend({}, this._parse(this.options['position']));\n  };\n\n  _proto.setPosition = function setPosition(position) {\n    if (isString(position)) {\n      this.options['position'] = position;\n    } else {\n      this.options['position'] = extend({}, position);\n    }\n\n    this._updatePosition();\n\n    return this;\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    var position = this.getPosition();\n    var size = this.getMap().getSize();\n    var x, y;\n\n    if (!isNil(position['left'])) {\n      x = parseInt(position['left']);\n    } else if (!isNil(position['right'])) {\n      x = size['width'] - parseInt(position['right']);\n    }\n\n    if (!isNil(position['top'])) {\n      y = parseInt(position['top']);\n    } else if (!isNil(position['bottom'])) {\n      y = size['height'] - parseInt(position['bottom']);\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this.__ctrlContainer;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this._controlDom;\n  };\n\n  _proto.show = function show() {\n    this.__ctrlContainer.style.display = '';\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.__ctrlContainer.style.display = 'none';\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    return this.__ctrlContainer && this.__ctrlContainer.style.display === '';\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    removeDomNode(this.__ctrlContainer);\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    delete this._map;\n    delete this.__ctrlContainer;\n    delete this._controlDom;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto._parse = function _parse(position) {\n    var p = position;\n\n    if (isString(position)) {\n      p = Control['positions'][p];\n    }\n\n    return p;\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var position = this.getPosition();\n\n    if (!position) {\n      position = {\n        'top': 20,\n        'left': 20\n      };\n    }\n\n    for (var p in position) {\n      if (position.hasOwnProperty(p)) {\n        position[p] = parseInt(position[p]);\n        this.__ctrlContainer.style[p] = position[p] + 'px';\n      }\n    }\n\n    this.fire('positionchange', {\n      'position': extend({}, position)\n    });\n  };\n\n  return Control;\n}(Eventable(Class));\n\nControl.positions = {\n  'top-left': {\n    'top': 20,\n    'left': 20\n  },\n  'top-right': {\n    'top': 20,\n    'right': 20\n  },\n  'bottom-left': {\n    'bottom': 20,\n    'left': 20\n  },\n  'bottom-right': {\n    'bottom': 20,\n    'right': 20\n  }\n};\nMap$1.mergeOptions({\n  'control': true\n});\nMap$1.include({\n  addControl: function addControl(control) {\n    if (this._containerDOM.getContext) {\n      return this;\n    }\n\n    control.addTo(this);\n    return this;\n  },\n  removeControl: function removeControl(control) {\n    if (!control || control.getMap() !== this) {\n      return this;\n    }\n\n    control.remove();\n    return this;\n  }\n});\nvar options$n = {\n  'position': {\n    'bottom': 0,\n    'left': 0\n  },\n  'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\nvar layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\nvar Attribution = function (_Control) {\n  _inheritsLoose(Attribution, _Control);\n\n  function Attribution() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Attribution.prototype;\n\n  _proto.buildOn = function buildOn() {\n    this._attributionContainer = createEl('div');\n    this._attributionContainer.className = 'maptalks-attribution';\n\n    this._update();\n\n    return this._attributionContainer;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.getMap().on(layerEvents, this._update, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off(layerEvents, this._update, this);\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var attributions = map._getLayers(function (layer) {\n      return layer.options['attribution'];\n    }).reverse().map(function (layer) {\n      return layer.options['attribution'];\n    });\n\n    var content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n    this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n  };\n\n  return Attribution;\n}(Control);\n\nAttribution.mergeOptions(options$n);\nMap$1.mergeOptions({\n  'attribution': true\n});\nMap$1.addOnLoadHook(function () {\n  var a = this.options['attribution'] || this.options['attributionControl'];\n\n  if (a) {\n    this.attributionControl = new Attribution(a);\n    this.addControl(this.attributionControl);\n  }\n});\nvar options$o = {\n  'position': 'top-right',\n  'baseTitle': 'Base Layers',\n  'overlayTitle': 'Layers',\n  'excludeLayers': [],\n  'containerClass': 'maptalks-layer-switcher'\n};\n\nvar LayerSwitcher = function (_Control) {\n  _inheritsLoose(LayerSwitcher, _Control);\n\n  function LayerSwitcher() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = LayerSwitcher.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var container = this.container = createEl('div', this.options['containerClass']),\n        panel = this.panel = createEl('div', 'panel'),\n        button = this.button = createEl('button');\n    container.appendChild(button);\n    container.appendChild(panel);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    on(this.button, 'mouseover', this._show, this);\n    on(this.panel, 'mouseleave', this._hide, this);\n    on(this.getMap(), 'click', this._hide, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    if (this.panel) {\n      off(this.button, 'mouseover', this._show, this);\n      off(this.panel, 'mouseleave', this._hide, this);\n      off(this.getMap(), 'click', this._hide, this);\n      removeDomNode(this.panel);\n      removeDomNode(this.button);\n      delete this.panel;\n      delete this.button;\n      delete this.container;\n    }\n  };\n\n  _proto._show = function _show() {\n    if (!hasClass(this.container, 'shown')) {\n      addClass(this.container, 'shown');\n\n      this._createPanel();\n    }\n  };\n\n  _proto._hide = function _hide(e) {\n    if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n      setClass(this.container, this.options['containerClass']);\n    }\n  };\n\n  _proto._createPanel = function _createPanel() {\n    this.panel.innerHTML = '';\n    var ul = createEl('ul');\n    this.panel.appendChild(ul);\n\n    this._renderLayers(this.getMap(), ul);\n  };\n\n  _proto._renderLayers = function _renderLayers(map, elm) {\n    var base = map.getBaseLayer(),\n        layers = map.getLayers(),\n        len = layers.length;\n\n    if (base) {\n      var baseLayers = base.layers || [base],\n          li = createEl('li', 'group'),\n          ul = createEl('ul'),\n          label = createEl('label');\n      label.innerHTML = this.options['baseTitle'];\n      li.appendChild(label);\n\n      for (var i = 0, _len = baseLayers.length; i < _len; i++) {\n        var layer = baseLayers[i];\n\n        if (this._isExcluded(layer)) {\n          ul.appendChild(this._renderLayer(baseLayers[i], true));\n          li.appendChild(ul);\n          elm.appendChild(li);\n        }\n      }\n    }\n\n    if (len) {\n      var _li = createEl('li', 'group'),\n          _ul = createEl('ul'),\n          _label = createEl('label');\n\n      _label.innerHTML = this.options['overlayTitle'];\n\n      _li.appendChild(_label);\n\n      for (var _i = 0; _i < len; _i++) {\n        var _layer = layers[_i];\n\n        if (this._isExcluded(_layer)) {\n          _ul.appendChild(this._renderLayer(_layer));\n        }\n      }\n\n      _li.appendChild(_ul);\n\n      elm.appendChild(_li);\n    }\n  };\n\n  _proto._isExcluded = function _isExcluded(layer) {\n    var id = layer.getId(),\n        excludeLayers = this.options['excludeLayers'];\n    return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n  };\n\n  _proto._renderLayer = function _renderLayer(layer, isBase) {\n    var _this = this;\n\n    var li = createEl('li', 'layer'),\n        label = createEl('label'),\n        input = createEl('input'),\n        map = this.getMap();\n    var visible = layer.options['visible'];\n    layer.options['visible'] = true;\n    var enabled = layer.isVisible();\n    layer.options['visible'] = visible;\n    li.className = 'layer';\n\n    if (isBase) {\n      input.type = 'radio';\n      input.name = 'base';\n    } else {\n      input.type = 'checkbox';\n    }\n\n    input.checked = visible && enabled;\n\n    if (!enabled) {\n      input.setAttribute('disabled', 'disabled');\n    }\n\n    input.onchange = function (e) {\n      if (e.target.type === 'radio') {\n        var baseLayer = map.getBaseLayer(),\n            baseLayers = baseLayer.layers;\n\n        if (baseLayers) {\n          for (var i = 0, len = baseLayers.length; i < len; i++) {\n            var _baseLayer = baseLayers[i];\n\n            _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n          }\n        } else if (!baseLayer.isVisible()) {\n          baseLayer.show();\n        }\n\n        map._fireEvent('setbaselayer');\n      } else {\n        layer[e.target.checked ? 'show' : 'hide']();\n      }\n\n      _this.fire('layerchange', {\n        target: layer\n      });\n    };\n\n    li.appendChild(input);\n    label.innerHTML = layer.getId();\n    li.appendChild(label);\n    return li;\n  };\n\n  return LayerSwitcher;\n}(Control);\n\nLayerSwitcher.mergeOptions(options$o);\nMap$1.mergeOptions({\n  'layerSwitcherControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['layerSwitcherControl']) {\n    this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n    this.addControl(this.layerSwitcherControl);\n  }\n});\nvar options$p = {\n  'level': 4,\n  'position': {\n    'right': 1,\n    'bottom': 1\n  },\n  'size': [300, 200],\n  'maximize': true,\n  'symbol': {\n    'lineWidth': 3,\n    'lineColor': '#1bbc9b',\n    'polygonFill': '#1bbc9b',\n    'polygonOpacity': 0.4\n  },\n  'containerClass': 'maptalks-overview',\n  'buttonClass': 'maptalks-overview-button'\n};\n\nvar Overview = function (_Control) {\n  _inheritsLoose(Overview, _Control);\n\n  function Overview() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Overview.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var size = this.options['size'];\n\n    if (!this.options['maximize']) {\n      size = [0, 0];\n    }\n\n    var container = createEl('div');\n    var mapContainer = this.mapContainer = createEl('div');\n    mapContainer.style.width = size[0] + 'px';\n    mapContainer.style.height = size[1] + 'px';\n    mapContainer.className = this.options['containerClass'];\n    var button = this.button = createEl('div');\n    button.className = this.options['buttonClass'];\n    container.appendChild(mapContainer);\n    container.appendChild(button);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    if (this.options['maximize']) {\n      this._createOverview();\n    }\n\n    this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this).on('setbaselayer', this._updateBaseLayer, this).on('spatialreferencechange', this._updateSpatialReference, this);\n    on(this.button, 'click', this._onButtonClick, this);\n\n    this._updateButtonText();\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('resize moving zooming rotate dragrotating viewchange', this._update, this).off('setbaselayer', this._updateBaseLayer, this).off('spatialreferencechange', this._updateSpatialReference, this);\n\n    if (this._overview) {\n      this._overview.remove();\n\n      delete this._overview;\n      delete this._perspective;\n    }\n\n    off(this.button, 'click', this._onButtonClick, this);\n  };\n\n  _proto.maxmize = function maxmize() {\n    var size = this.options['size'];\n    var dom = this.mapContainer;\n    dom.style.width = size[0] + 'px';\n    dom.style.height = size[1] + 'px';\n\n    this._createOverview();\n\n    return this;\n  };\n\n  _proto.minimize = function minimize() {\n    if (this._overview) {\n      this._overview.remove();\n    }\n\n    delete this._overview;\n    delete this._perspective;\n    var dom = this.mapContainer;\n    dom.style.width = 0 + 'px';\n    dom.style.height = 0 + 'px';\n    return this;\n  };\n\n  _proto.getOverviewMap = function getOverviewMap() {\n    return this._overview;\n  };\n\n  _proto._onButtonClick = function _onButtonClick() {\n    if (!this._overview) {\n      this.maxmize();\n    } else {\n      this.minimize();\n    }\n\n    this._updateButtonText();\n  };\n\n  _proto._updateButtonText = function _updateButtonText() {\n    if (this._overview) {\n      this.button.innerHTML = '-';\n    } else {\n      this.button.innerHTML = '+';\n    }\n  };\n\n  _proto._createOverview = function _createOverview() {\n    var map = this.getMap(),\n        dom = this.mapContainer;\n    var options = map.config();\n    extend(options, {\n      'center': map.getCenter(),\n      'zoom': this._getOverviewZoom(),\n      'zoomAnimationDuration': 150,\n      'pitch': 0,\n      'bearing': 0,\n      'scrollWheelZoom': false,\n      'checkSize': false,\n      'doubleClickZoom': false,\n      'touchZoom': false,\n      'control': false,\n      'draggable': false,\n      'maxExtent': null\n    });\n    this._overview = new Map$1(dom, options);\n\n    this._updateBaseLayer();\n\n    this._perspective = new Polygon(this._getPerspectiveCoords(), {\n      'draggable': true,\n      'cursor': 'move',\n      'symbol': this.options['symbol']\n    }).on('dragend', this._onDragEnd, this);\n    new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n    this.fire('load');\n  };\n\n  _proto._getOverviewZoom = function _getOverviewZoom() {\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        minZoom = map.getMinZoom(),\n        level = this.options['level'];\n\n    if (level > 0) {\n      for (var i = level; i > 0; i--) {\n        if (zoom - i >= minZoom) {\n          return zoom - i;\n        }\n      }\n    } else {\n      for (var _i = level; _i < 0; _i++) {\n        if (zoom - _i >= minZoom) {\n          return zoom - _i;\n        }\n      }\n    }\n\n    return zoom;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    var center = this._perspective.getCenter();\n\n    this._overview.setCenter(center);\n\n    this.getMap().panTo(center);\n  };\n\n  _proto._getPerspectiveCoords = function _getPerspectiveCoords() {\n    var map = this.getMap();\n    return map.getContainerExtent().toArray().map(function (c) {\n      return map.containerPointToCoordinate(c);\n    });\n  };\n\n  _proto._update = function _update() {\n    if (!this._overview) {\n      return;\n    }\n\n    computeDomPosition(this._overview._containerDOM);\n\n    var coords = this._getPerspectiveCoords();\n\n    this._perspective.setCoordinates(coords);\n\n    this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap();\n    var spatialRef = map.options['spatialReference'];\n\n    this._overview.setSpatialReference(spatialRef);\n  };\n\n  _proto._updateBaseLayer = function _updateBaseLayer() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap(),\n        baseLayer = map.getBaseLayer();\n\n    if (!baseLayer) {\n      this._overview.setBaseLayer(null);\n\n      return;\n    }\n\n    var layers = baseLayer.layers;\n    var showIndex = 0;\n\n    if (layers) {\n      for (var i = 0, l = layers.length; i < l; i++) {\n        var _layer = layers[i];\n\n        if (_layer.isVisible()) {\n          showIndex = i;\n          break;\n        }\n      }\n    }\n\n    var json = baseLayer.toJSON();\n    var options = null;\n\n    if (layers) {\n      options = json.layers[showIndex].options;\n      options.visible = true;\n    } else {\n      options = json.options;\n    }\n\n    this._overview.setMinZoom(options.minZoom || null).setMaxZoom(options.maxZoom || null);\n\n    delete options.minZoom;\n    delete options.maxZoom;\n    delete json.options.canvas;\n    json.options.visible = true;\n    json.options.renderer = 'canvas';\n    var layer = Layer.fromJSON(json);\n\n    for (var p in baseLayer) {\n      if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n        layer[p] = baseLayer[p];\n      }\n    }\n\n    this._overview.setBaseLayer(layer);\n  };\n\n  return Overview;\n}(Control);\n\nOverview.mergeOptions(options$p);\nMap$1.mergeOptions({\n  'overviewControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['overviewControl']) {\n    this.overviewControl = new Overview(this.options['overviewControl']);\n    this.addControl(this.overviewControl);\n  }\n});\nvar options$q = {\n  'position': 'top-right',\n  'draggable': true,\n  'custom': false,\n  'content': '',\n  'closeButton': true\n};\n\nvar Panel = function (_Control) {\n  _inheritsLoose(Panel, _Control);\n\n  function Panel() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Panel.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        dom = createEl('div');\n        dom.innerHTML = this.options['content'];\n      } else {\n        dom = this.options['content'];\n      }\n    } else {\n      dom = createEl('div', 'maptalks-panel');\n\n      if (this.options['closeButton']) {\n        var closeButton = createEl('a', 'maptalks-close');\n        closeButton.href = 'javascript:;';\n\n        closeButton.onclick = function () {\n          dom.style.display = 'none';\n        };\n\n        dom.appendChild(closeButton);\n      }\n\n      var panelContent = createEl('div', 'maptalks-panel-content');\n      panelContent.innerHTML = this.options['content'];\n      dom.appendChild(panelContent);\n    }\n\n    this.draggable = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n    this.draggable.on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this);\n\n    if (this.options['draggable']) {\n      this.draggable.enable();\n    }\n\n    return dom;\n  };\n\n  _proto.update = function update() {\n    if (this.draggable) {\n      this.draggable.disable();\n      delete this.draggable;\n    }\n\n    return Control.prototype.update.call(this);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.update();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this._startPos = param['mousePos'];\n    this._startPosition = extend({}, this.getPosition());\n    this.fire('dragstart', param);\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var pos = param['mousePos'];\n    var offset = pos.sub(this._startPos);\n    var startPosition = this._startPosition;\n    var position = this.getPosition();\n\n    if (!isNil(position['top'])) {\n      position['top'] = parseInt(startPosition['top']) + offset.y;\n    }\n\n    if (!isNil(position['bottom'])) {\n      position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n    }\n\n    if (!isNil(position['left'])) {\n      position['left'] = parseInt(startPosition['left']) + offset.x;\n    }\n\n    if (!isNil(position['right'])) {\n      position['right'] = parseInt(startPosition['right']) - offset.x;\n    }\n\n    this.setPosition(position);\n    this.fire('dragging', param);\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    delete this._startPos;\n    delete this._startPosition;\n    this.fire('dragend', param);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = this.getContainerPoint();\n    var dom = this.getDOM(),\n        width = parseInt(dom.clientWidth),\n        height = parseInt(dom.clientHeight);\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width, height / 2)), map.containerPointToCoordinate(containerPoint.add(width / 2, height)), map.containerPointToCoordinate(containerPoint.add(0, height / 2))];\n    return anchors;\n  };\n\n  return Panel;\n}(Control);\n\nPanel.mergeOptions(options$q);\nvar options$r = {\n  'position': 'bottom-left',\n  'maxWidth': 100,\n  'metric': true,\n  'imperial': false,\n  'containerClass': null\n};\n\nvar Scale = function (_Control) {\n  _inheritsLoose(Scale, _Control);\n\n  function Scale() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Scale.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    this._scaleContainer = createEl('div', this.options['containerClass']);\n\n    this._addScales();\n\n    map.on('zoomend', this._update, this);\n\n    if (this._map._loaded) {\n      this._update();\n    }\n\n    return this._scaleContainer;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('zoomend', this._update, this);\n  };\n\n  _proto._addScales = function _addScales() {\n    var css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' + 'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' + ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n\n    if (this.options['metric']) {\n      this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n\n    if (this.options['imperial']) {\n      this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this._map;\n    var maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n\n    this._updateScales(maxMeters);\n  };\n\n  _proto._updateScales = function _updateScales(maxMeters) {\n    if (this.options['metric'] && maxMeters) {\n      this._updateMetric(maxMeters);\n    }\n\n    if (this.options['imperial'] && maxMeters) {\n      this._updateImperial(maxMeters);\n    }\n  };\n\n  _proto._updateMetric = function _updateMetric(maxMeters) {\n    var meters = this._getRoundNum(maxMeters),\n        label = meters < 1000 ? meters + ' m' : meters / 1000 + ' km';\n\n    this._updateScale(this._mScale, label, meters / maxMeters);\n  };\n\n  _proto._updateImperial = function _updateImperial(maxMeters) {\n    var maxFeet = maxMeters * 3.2808399;\n    var maxMiles, miles, feet;\n\n    if (maxFeet > 5280) {\n      maxMiles = maxFeet / 5280;\n      miles = this._getRoundNum(maxMiles);\n\n      this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n    } else {\n      feet = this._getRoundNum(maxFeet);\n\n      this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n    }\n  };\n\n  _proto._updateScale = function _updateScale(scale, text, ratio) {\n    scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n    scale['innerHTML'] = text;\n  };\n\n  _proto._getRoundNum = function _getRoundNum(num) {\n    var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n    var d = num / pow10;\n    d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n    return pow10 * d;\n  };\n\n  return Scale;\n}(Control);\n\nScale.mergeOptions(options$r);\nMap$1.mergeOptions({\n  'scaleControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['scaleControl']) {\n    this.scaleControl = new Scale(this.options['scaleControl']);\n    this.addControl(this.scaleControl);\n  }\n});\nvar options$s = {\n  'height': 28,\n  'vertical': false,\n  'position': 'top-right',\n  'reverseMenu': false,\n  'items': {}\n};\n\nvar Toolbar = function (_Control) {\n  _inheritsLoose(Toolbar, _Control);\n\n  function Toolbar() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Toolbar.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    var dom = createEl('div');\n    var ul = createEl('ul', 'maptalks-toolbar-hx');\n    dom.appendChild(ul);\n\n    if (this.options['vertical']) {\n      addClass(dom, 'maptalks-toolbar-vertical');\n    } else {\n      addClass(dom, 'maptalks-toolbar-horizonal');\n    }\n\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex, targetDom) {\n      var item = me._getItems()[index];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex,\n          'dom': targetDom\n        });\n      };\n    }\n\n    var items = this.options['items'];\n\n    if (isArrayHasData(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var li = createEl('li');\n\n        if (this.options['height'] !== 28) {\n          li.style.lineHeight = this.options['height'] + 'px';\n        }\n\n        li.style.height = this.options['height'] + 'px';\n        li.style.cursor = 'pointer';\n\n        if (isHTML(item['item'])) {\n          li.style.textAlign = 'center';\n          var itemSize = measureDom('div', item['item']);\n          li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n        } else {\n          li.innerHTML = item['item'];\n        }\n\n        if (item['click']) {\n          on(li, 'click', onButtonClick(item['click'], i, null, li));\n        }\n\n        if (isArrayHasData(item['children'])) {\n          var dropMenu = this._createDropMenu(i);\n\n          li.appendChild(dropMenu);\n          li._menu = dropMenu;\n          on(li, 'mouseover', function () {\n            this._menu.style.display = '';\n          });\n          on(li, 'mouseout', function () {\n            this._menu.style.display = 'none';\n          });\n        }\n\n        ul.appendChild(li);\n      }\n    }\n\n    return dom;\n  };\n\n  _proto._createDropMenu = function _createDropMenu(index) {\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex) {\n      var item = me._getItems()[index]['children'][childIndex];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex\n        });\n      };\n    }\n\n    var menuDom = createEl('div', 'maptalks-dropMenu'),\n        items = this._getItems(),\n        len = items.length,\n        menuUL = createEl('ul'),\n        children = items[index]['children'];\n\n    if (index === len - 1 && children) {\n      menuDom.style.cssText = 'right: 0px;';\n      menuUL.style.cssText = 'right: 0px;position: absolute;';\n\n      if (this.options['reverseMenu']) {\n        menuUL.style.bottom = 0;\n      }\n    }\n\n    menuDom.appendChild(createEl('em', 'maptalks-ico'));\n    var liWidth = 0;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var size = stringLength(children[i]['item'], '12px');\n\n      if (size.width > liWidth) {\n        liWidth = size.width;\n      }\n    }\n\n    for (var _i = 0, _l = children.length; _i < _l; _i++) {\n      var child = children[_i];\n      var li = createEl('li');\n      li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n      li.style.cursor = 'pointer';\n      li.style.width = liWidth + 24 + 'px';\n      on(li.childNodes[0], 'click', onButtonClick(child['click'], index, _i));\n      menuUL.appendChild(li);\n    }\n\n    if (this.options['vertical']) {\n      var width = liWidth < 95 ? 95 : liWidth;\n\n      if (this.options['reverseMenu']) {\n        menuDom.style.right = -(width + 10 * 2) + 'px';\n      } else {\n        menuDom.style.left = -(width + 10 * 2) + 'px';\n      }\n    } else if (this.options['reverseMenu']) {\n      menuDom.style.bottom = '28px';\n    } else {\n      menuDom.style.top = '28px';\n    }\n\n    menuDom.appendChild(menuUL);\n    menuDom.style.display = 'none';\n    return menuDom;\n  };\n\n  _proto._getItems = function _getItems() {\n    return this.options['items'] || [];\n  };\n\n  return Toolbar;\n}(Control);\n\nToolbar.mergeOptions(options$s);\nvar options$t = {\n  'position': 'top-left',\n  'slider': true,\n  'zoomLevel': true,\n  'seamless': false\n};\nvar UNIT = 10;\n\nvar Zoom = function (_Control) {\n  _inheritsLoose(Zoom, _Control);\n\n  function Zoom() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Zoom.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    var options = this.options;\n    var dom = createEl('div', 'maptalks-zoom');\n\n    if (options['zoomLevel']) {\n      var levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n      dom.appendChild(levelDOM);\n      this._levelDOM = levelDOM;\n    }\n\n    var zoomDOM = createEl('div', 'maptalks-zoom-slider');\n    var zoomInButton = createEl('a', 'maptalks-zoom-zoomin');\n    zoomInButton.href = 'javascript:;';\n    zoomInButton.innerHTML = '+';\n    zoomDOM.appendChild(zoomInButton);\n    this._zoomInButton = zoomInButton;\n\n    if (options['slider']) {\n      var box = createEl('div', 'maptalks-zoom-slider-box');\n      var ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n      var reading = createEl('span', 'maptalks-zoom-slider-reading');\n      var dot = createEl('span', 'maptalks-zoom-slider-dot');\n      ruler.appendChild(reading);\n      box.appendChild(ruler);\n      box.appendChild(dot);\n      zoomDOM.appendChild(box);\n      this._sliderBox = box;\n      this._sliderRuler = ruler;\n      this._sliderReading = reading;\n      this._sliderDot = dot;\n    }\n\n    var zoomOutButton = createEl('a', 'maptalks-zoom-zoomout');\n    zoomOutButton.href = 'javascript:;';\n    zoomOutButton.innerHTML = '-';\n    zoomDOM.appendChild(zoomOutButton);\n    this._zoomOutButton = zoomOutButton;\n    dom.appendChild(zoomDOM);\n    map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    this._update();\n\n    this._registerDomEvents();\n\n    return dom;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    if (this._zoomInButton) {\n      off(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      off(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger.disable();\n      delete this.dotDragger;\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (this._sliderBox) {\n      var totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n      this._sliderBox.style.height = totalRange + 16 + 'px';\n      this._sliderRuler.style.height = totalRange + 8 + 'px';\n      this._sliderRuler.style.cursor = 'pointer';\n      var zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n      this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n      this._sliderDot.style.top = zoomRange + 'px';\n    }\n\n    this._updateText();\n  };\n\n  _proto._updateText = function _updateText() {\n    if (this._levelDOM) {\n      var map = this.getMap();\n      var zoom = map.getZoom();\n\n      if (!isInteger(zoom)) {\n        zoom = Math.floor(zoom * 10) / 10;\n      }\n\n      this._levelDOM.innerHTML = zoom;\n    }\n  };\n\n  _proto._registerDomEvents = function _registerDomEvents() {\n    if (this._zoomInButton) {\n      on(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      on(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger = new DragHandler(this._sliderDot, {\n        'ignoreMouseleave': true\n      });\n      this.dotDragger.on('dragstart', this._onDotDragstart, this).on('dragging dragend', this._onDotDrag, this).enable();\n    }\n  };\n\n  _proto._onZoomInClick = function _onZoomInClick(e) {\n    preventDefault(e);\n    this.getMap().zoomIn();\n  };\n\n  _proto._onZoomOutClick = function _onZoomOutClick(e) {\n    preventDefault(e);\n    this.getMap().zoomOut();\n  };\n\n  _proto._onClickRuler = function _onClickRuler(e) {\n    preventDefault(e);\n    var map = this.getMap(),\n        point = getEventContainerPoint(e, this._sliderRuler),\n        h = point.y;\n    var maxZoom = map.getMaxZoom(),\n        zoom = Math.floor(maxZoom - h / UNIT);\n    map.setZoom(zoom);\n  };\n\n  _proto._onDotDragstart = function _onDotDragstart(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2);\n\n    map.onZoomStart(map.getZoom(), origin);\n  };\n\n  _proto._onDotDrag = function _onDotDrag(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2),\n        point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n        maxZoom = map.getMaxZoom(),\n        minZoom = map.getMinZoom();\n\n    var top = point.y,\n        z = maxZoom - top / UNIT;\n\n    if (maxZoom < z) {\n      z = maxZoom;\n      top = 0;\n    } else if (minZoom > z) {\n      z = minZoom;\n      top = (maxZoom - minZoom) * UNIT;\n    }\n\n    if (e.type === 'dragging') {\n      map.onZooming(z, origin, 1);\n    } else if (e.type === 'dragend') {\n      if (this.options['seamless']) {\n        map.onZoomEnd(z, origin);\n      } else {\n        map.onZoomEnd(Math.round(z), origin);\n      }\n    }\n\n    this._sliderDot.style.top = top + 'px';\n    this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n\n    this._updateText();\n  };\n\n  return Zoom;\n}(Control);\n\nZoom.mergeOptions(options$t);\nMap$1.mergeOptions({\n  'zoomControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['zoomControl']) {\n    this.zoomControl = new Zoom(this.options['zoomControl']);\n    this.addControl(this.zoomControl);\n  }\n});\nvar index$5 = /*#__PURE__*/Object.freeze({\n  Control: Control,\n  Attribution: Attribution,\n  LayerSwitcher: LayerSwitcher,\n  Overview: Overview,\n  Panel: Panel,\n  Scale: Scale,\n  Toolbar: Toolbar,\n  Zoom: Zoom\n});\n\nvar TileSystem = function () {\n  function TileSystem(sx, sy, ox, oy) {\n    if (Array.isArray(sx)) {\n      this.scale = {\n        x: sx[0],\n        y: sx[1]\n      };\n      this.origin = {\n        x: sx[2],\n        y: sx[3]\n      };\n    } else {\n      this.scale = {\n        x: sx,\n        y: sy\n      };\n      this.origin = {\n        x: ox,\n        y: oy\n      };\n    }\n  }\n\n  TileSystem.getDefault = function getDefault(projection) {\n    if (projection['code'].toLowerCase() === 'baidu') {\n      return 'baidu';\n    } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n      return 'tms-global-geodetic';\n    } else if (projection['code'].toLowerCase() === 'identity') {\n      return [1, -1, 0, 0];\n    } else {\n      return 'web-mercator';\n    }\n  };\n\n  return TileSystem;\n}();\n\nvar semiCircum = 6378137 * Math.PI;\nextend(TileSystem, {\n  'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n  'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n  'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n  'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nvar TileConfig = function () {\n  function TileConfig(map, tileSystem, fullExtent, tileSize) {\n    this.map = map;\n    this.tileSize = tileSize;\n    this.fullExtent = fullExtent;\n    this.prepareTileInfo(tileSystem, fullExtent);\n    this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n    this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    this._pointOrigin = map._prjToPoint(new Point(this.tileSystem['origin']), map.getGLZoom());\n    this._glRes = map.getResolution(map.getGLZoom());\n  }\n\n  var _proto = TileConfig.prototype;\n\n  _proto.prepareTileInfo = function prepareTileInfo(tileSystem, fullExtent) {\n    if (isString(tileSystem)) {\n      tileSystem = TileSystem[tileSystem.toLowerCase()];\n    } else if (Array.isArray(tileSystem)) {\n      tileSystem = new TileSystem(tileSystem);\n    }\n\n    if (!tileSystem) {\n      throw new Error('Invalid TileSystem');\n    }\n\n    this.tileSystem = tileSystem;\n    var a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n        c = tileSystem['origin']['x'],\n        d = tileSystem['origin']['y'];\n    this.transformation = new Transformation([a, b, c, d]);\n  };\n\n  _proto._getTileNum = function _getTileNum(point, res) {\n    var tileSystem = this.tileSystem,\n        tileSize = this['tileSize'],\n        delta = 1E-7;\n    var tileX = Math.floor(delta * tileSystem['scale']['x'] + point.x / (tileSize['width'] * res));\n    var tileY = Math.ceil(delta * tileSystem['scale']['y'] + point.y / (tileSize['height'] * res));\n    return {\n      'x': tileSystem['scale']['x'] * tileX,\n      'y': tileSystem['scale']['y'] * tileY\n    };\n  };\n\n  _proto.getTileIndex = function getTileIndex(pCoord, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var point = this.transformation.transform(pCoord, 1);\n\n    var tileIndex = this._getTileNum(point, res);\n\n    if (tileSystem['scale']['x'] < 0) {\n      tileIndex['x'] -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      tileIndex['y'] -= 1;\n    }\n\n    return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res, repeatWorld);\n  };\n\n  _proto.getNeighorTileIndex = function getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var x = tileX + tileSystem['scale']['x'] * offsetX;\n    var y = tileY - tileSystem['scale']['y'] * offsetY;\n    var out = false;\n    var idx = x;\n    var idy = y;\n\n    var ext = this._getTileFullIndex(res);\n\n    if (repeatWorld) {\n      if (repeatWorld === true || repeatWorld === 'x') {\n        if (ext['xmax'] === ext['xmin']) {\n          x = ext['xmin'];\n        } else if (x < ext['xmin']) {\n          x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n\n          if (x === ext['xmax']) {\n            x = ext['xmin'];\n          }\n        } else if (x >= ext['xmax']) {\n          x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n        }\n      }\n\n      if (repeatWorld === true || repeatWorld === 'y') {\n        if (ext['ymax'] === ext['ymin']) {\n          y = ext['ymin'];\n        } else if (y >= ext['ymax']) {\n          y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n        } else if (y < ext['ymin']) {\n          y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n\n          if (y === ext['ymax']) {\n            y = ext['ymin'];\n          }\n        }\n      }\n    }\n\n    if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n      out = true;\n    }\n\n    return {\n      'x': x,\n      'y': y,\n      'idx': idx,\n      'idy': idy,\n      out: out\n    };\n  };\n\n  _proto._getTileFullIndex = function _getTileFullIndex(res) {\n    if (!this._tileFullIndex) {\n      this._tileFullIndex = {};\n    }\n\n    if (this._tileFullIndex[res]) {\n      return this._tileFullIndex[res];\n    }\n\n    var ext = this.fullExtent;\n    var transformation = this.transformation;\n\n    var nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n\n    var seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n    var tileSystem = this.tileSystem;\n\n    if (tileSystem['scale']['x'] < 0) {\n      nwIndex.x -= 1;\n      seIndex.x -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      nwIndex.y -= 1;\n      seIndex.y -= 1;\n    }\n\n    this._tileFullIndex[res] = new Extent(nwIndex, seIndex);\n    return this._tileFullIndex[res];\n  };\n\n  _proto.getTilePrjNW = function getTilePrjNW(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointNW = function getTilePointNW(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjSE = function getTilePrjSE(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointSE = function getTilePointSE(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjExtent = function getTilePrjExtent(tileX, tileY, res) {\n    var nw = this.getTilePrjNW(tileX, tileY, res),\n        se = this.getTilePrjSE(tileX, tileY, res);\n    return new Extent(nw, se);\n  };\n\n  return TileConfig;\n}();\n\nvar planes = [];\n\nfor (var i = 0; i < 6; i++) {\n  planes[i] = [];\n}\n\nvar p = [];\n\nfunction intersectsBox(matrix, box, mask) {\n  setPlanes(matrix);\n\n  for (var i = 0; i < 6; i++) {\n    if (mask && mask.charAt(i) === '0') {\n      continue;\n    }\n\n    var plane = planes[i];\n    p[0] = plane[0] > 0 ? box[1][0] : box[0][0];\n    p[1] = plane[1] > 0 ? box[1][1] : box[0][1];\n    p[2] = plane[2] > 0 ? box[1][2] : box[0][2];\n\n    if (distanceToPoint(plane, p) < 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction setPlanes(m) {\n  var me = m;\n  var me0 = me[0],\n      me1 = me[1],\n      me2 = me[2],\n      me3 = me[3];\n  var me4 = me[4],\n      me5 = me[5],\n      me6 = me[6],\n      me7 = me[7];\n  var me8 = me[8],\n      me9 = me[9],\n      me10 = me[10],\n      me11 = me[11];\n  var me12 = me[12],\n      me13 = me[13],\n      me14 = me[14],\n      me15 = me[15];\n  setComponents(planes[0], me3 - me0, me7 - me4, me11 - me8, me15 - me12);\n  setComponents(planes[1], me3 + me0, me7 + me4, me11 + me8, me15 + me12);\n  setComponents(planes[2], me3 + me1, me7 + me5, me11 + me9, me15 + me13);\n  setComponents(planes[3], me3 - me1, me7 - me5, me11 - me9, me15 - me13);\n  setComponents(planes[4], me3 - me2, me7 - me6, me11 - me10, me15 - me14);\n  setComponents(planes[5], me3 + me2, me7 + me6, me11 + me10, me15 + me14);\n}\n\nfunction setComponents(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  var length = distance$1(out);\n  out[0] /= length;\n  out[1] /= length;\n  out[2] /= length;\n  out[3] /= length;\n  return out;\n}\n\nfunction distanceToPoint(plane, p) {\n  return plane[0] * p[0] + plane[1] * p[1] + plane[2] * p[2] + plane[3];\n}\n\nfunction distance$1(v3) {\n  return Math.sqrt(v3[0] * v3[0] + v3[1] * v3[1] + v3[2] * v3[2]);\n}\n\nvar isSetAvailable = typeof Set !== 'undefined';\n\nvar TileHashset = function () {\n  function TileHashset() {\n    this._table = isSetAvailable ? new Set() : {};\n  }\n\n  var _proto = TileHashset.prototype;\n\n  _proto.add = function add$$1(key) {\n    if (isSetAvailable) {\n      this._table.add(key);\n    } else {\n      this._table[key] = true;\n    }\n  };\n\n  _proto.has = function has(key) {\n    if (isSetAvailable) {\n      return this._table.has(key);\n    } else {\n      return this._table[key];\n    }\n  };\n\n  _proto.reset = function reset() {\n    if (isSetAvailable) {\n      this._table.clear();\n    } else {\n      this._table = {};\n    }\n  };\n\n  return TileHashset;\n}();\n\nvar options$u = {\n  'urlTemplate': null,\n  'subdomains': null,\n  'repeatWorld': true,\n  'background': true,\n  'backgroundZoomDiff': 6,\n  'loadingLimitOnInteracting': 3,\n  'tileRetryCount': 0,\n  'placeholder': false,\n  'crossOrigin': null,\n  'tileSize': [256, 256],\n  'offset': [0, 0],\n  'tileSystem': null,\n  'fadeAnimation': !IS_NODE,\n  'debug': false,\n  'spatialReference': null,\n  'maxCacheSize': 256,\n  'renderer': function () {\n    return Browser$1.webgl ? 'gl' : 'canvas';\n  }(),\n  'clipByPitch': true,\n  'maxAvailableZoom': null,\n  'cascadeTiles': true,\n  'zoomOffset': 0\n};\nvar URL_PATTERN$1 = /\\{ *([\\w_]+) *\\}/g;\nvar TEMP_POINT = new Point(0, 0);\nvar TEMP_POINT0$3 = new Point(0, 0);\nvar TEMP_POINT1$1 = new Point(0, 0);\nvar TEMP_POINT2 = new Point(0, 0);\nvar TEMP_POINT3 = new Point(0, 0);\nvar TEMP_POINT4 = new Point(0, 0);\nvar TEMP_POINT5 = new Point(0, 0);\nvar TEMP_POINT6 = new Point(0, 0);\nvar TILE_BOX = [[0, 0, 0], [0, 0, 0]];\nvar ARR3 = [];\n\nvar TileLayer = function (_Layer) {\n  _inheritsLoose(TileLayer, _Layer);\n\n  function TileLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  TileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n      return null;\n    }\n\n    return new TileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  var _proto2 = TileLayer.prototype;\n\n  _proto2.getTileSize = function getTileSize() {\n    var size = this.options['tileSize'];\n\n    if (isNumber(size)) {\n      size = [size, size];\n    }\n\n    return new Size(size);\n  };\n\n  _proto2.getTiles = function getTiles(z, parentLayer) {\n    var map = this.getMap();\n    var pitch = map.getPitch();\n    var parentRenderer = parentLayer && parentLayer.getRenderer();\n    var mapExtent = map.getContainerExtent();\n    var tileGrids = [];\n    var count = 0;\n    var minZoom = this.getMinZoom();\n    var cascadePitch0 = map.options['cascadePitches'][0];\n    var cascadePitch1 = map.options['cascadePitches'][1];\n    var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n    var tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n    this._visitedTiles = new TileHashset();\n    this._coordCache = {};\n\n    if (!isNil(z) || !this.options['cascadeTiles'] || pitch <= cascadePitch0 || !isNil(minZoom) && tileZoom <= minZoom) {\n      var containerExtent = pitch <= cascadePitch1 ? mapExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n\n      var _currentTiles = this._getTiles(tileZoom, containerExtent, 2, parentRenderer);\n\n      if (_currentTiles) {\n        count += _currentTiles.tiles.length;\n        tileGrids.push(_currentTiles);\n      }\n\n      return {\n        tileGrids: tileGrids,\n        count: count\n      };\n    }\n\n    var visualHeight0 = Math.floor(map._getVisualHeight(cascadePitch0));\n    var extent0 = new PointExtent(0, map.height - visualHeight0, map.width, map.height);\n\n    var currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n\n    count += currentTiles ? currentTiles.tiles.length : 0;\n    tileGrids.push(currentTiles);\n    var cascadeHeight = extent0.ymin;\n    var d = map.getSpatialReference().getZoomDirection();\n    var cascadeLevels = d;\n    var cascadeTiles1;\n\n    if (pitch > cascadePitch1) {\n      if (tileZoom - cascadeLevels <= minZoom) {\n        cascadeLevels = 0;\n      }\n\n      var extent1 = new PointExtent(0, map.height - visualHeight1, map.width, cascadeHeight);\n      cascadeTiles1 = this._getTiles(tileZoom - cascadeLevels, extent1, 1, parentRenderer);\n      count += cascadeTiles1 ? cascadeTiles1.tiles.length : 0;\n      cascadeHeight = extent1.ymin;\n      cascadeLevels += 4 * d;\n    }\n\n    var cascadeTiles2;\n\n    if (tileZoom - cascadeLevels >= minZoom) {\n      var extent2 = new PointExtent(0, mapExtent.ymin, map.width, cascadeHeight);\n      cascadeTiles2 = this._getTiles(tileZoom - cascadeLevels, extent2, 2, parentRenderer);\n      count += cascadeTiles2 ? cascadeTiles2.tiles.length : 0;\n      tileGrids.push(cascadeTiles2);\n    }\n\n    if (cascadeTiles1 && cascadeTiles2) {\n      tileGrids[1] = cascadeTiles2;\n      tileGrids[2] = cascadeTiles1;\n    }\n\n    return {\n      tileGrids: tileGrids,\n      count: count\n    };\n  };\n\n  _proto2.getTileUrl = function getTileUrl(x, y, z) {\n    var urlTemplate = this.options['urlTemplate'];\n    var domain = '';\n\n    if (this.options['subdomains']) {\n      var subdomains = this.options['subdomains'];\n\n      if (isArrayHasData(subdomains)) {\n        var length$$1 = subdomains.length;\n        var s = (x + y) % length$$1;\n\n        if (s < 0) {\n          s = 0;\n        }\n\n        domain = subdomains[s];\n      }\n    }\n\n    if (isFunction(urlTemplate)) {\n      return urlTemplate(x, y, z, domain);\n    }\n\n    var data = {\n      'x': x,\n      'y': y,\n      'z': z,\n      's': domain\n    };\n    return urlTemplate.replace(URL_PATTERN$1, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        throw new Error('No value provided for variable ' + str);\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return value;\n    });\n  };\n\n  _proto2.clear = function clear() {\n    if (this._renderer) {\n      this._renderer.clear();\n    }\n\n    this.fire('clear');\n    return this;\n  };\n\n  _proto2.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto2.getSpatialReference = function getSpatialReference() {\n    var map = this.getMap();\n\n    if (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n      return map.getSpatialReference();\n    }\n\n    this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n\n    if (this._srMinZoom === undefined) {\n      this._srMinZoom = this._sr.getMinZoom();\n      this._srMaxZoom = this._sr.getMaxZoom();\n    }\n\n    return this._sr;\n  };\n\n  _proto2.getMinZoom = function getMinZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.max(_Layer.prototype.getMinZoom.call(this), this._srMinZoom);\n    }\n\n    return _Layer.prototype.getMinZoom.call(this);\n  };\n\n  _proto2.getMaxZoom = function getMaxZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.min(_Layer.prototype.getMaxZoom.call(this), this._srMaxZoom);\n    }\n\n    return _Layer.prototype.getMaxZoom.call(this);\n  };\n\n  _proto2._getTileZoom = function _getTileZoom(zoom) {\n    if (!isInteger(zoom)) {\n      zoom = Math.round(zoom);\n    }\n\n    var maxZoom = this.options['maxAvailableZoom'];\n\n    if (!isNil(maxZoom) && zoom > maxZoom) {\n      zoom = maxZoom;\n    }\n\n    return zoom;\n  };\n\n  _proto2._getTiles = function _getTiles(tileZoom, containerExtent, cascadeLevel, parentRenderer) {\n    var _this = this;\n\n    var map = this.getMap();\n    var z = tileZoom;\n    var frustumMatrix = map.projViewMatrix;\n\n    if (cascadeLevel < 2) {\n      if (cascadeLevel === 0) {\n        z -= 1;\n      }\n\n      frustumMatrix = cascadeLevel === 0 ? map.cascadeFrustumMatrix0 : cascadeLevel === 1 ? map.cascadeFrustumMatrix1 : map.projViewMatrix;\n    }\n\n    var zoom = z + this.options['zoomOffset'];\n\n    var offset = this._getTileOffset(zoom),\n        hasOffset = offset[0] || offset[1];\n\n    var emptyGrid = {\n      'zoom': z,\n      'extent': null,\n      'offset': offset,\n      'tiles': []\n    };\n\n    if (zoom < 0) {\n      return emptyGrid;\n    }\n\n    var minZoom = this.getMinZoom(),\n        maxZoom = this.getMaxZoom();\n\n    if (!map || !this.isVisible() || !map.width || !map.height) {\n      return emptyGrid;\n    }\n\n    if (!isNil(minZoom) && z < minZoom || !isNil(maxZoom) && z > maxZoom) {\n      return emptyGrid;\n    }\n\n    var tileConfig = this._getTileConfig();\n\n    if (!tileConfig) {\n      return emptyGrid;\n    }\n\n    var sr = this.getSpatialReference();\n    var mapSR = map.getSpatialReference();\n    var res = sr.getResolution(zoom);\n    var glScale = map.getGLScale(z);\n    var repeatWorld = sr === mapSR && this.options['repeatWorld'];\n    var extent2d = containerExtent.convertTo(function (c) {\n      var result;\n\n      if (c.y > 0 && c.y < map.height) {\n        var key = (c.x === 0 ? 0 : 1) + c.y;\n\n        if (!_this._coordCache[key]) {\n          _this._coordCache[key] = map._containerPointToPoint(c);\n        }\n\n        result = _this._coordCache[key];\n      }\n\n      result = map._containerPointToPoint(c, undefined, TEMP_POINT);\n      return result;\n    });\n\n    extent2d._add(offset);\n\n    var maskExtent = this._getMask2DExtent();\n\n    if (maskExtent) {\n      var intersection = maskExtent.intersection(extent2d);\n\n      if (!intersection) {\n        return emptyGrid;\n      }\n\n      containerExtent = intersection.convertTo(function (c) {\n        return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT);\n      });\n    }\n\n    var prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0$3);\n\n    var centerPoint = map._prjToPoint(prjCenter, undefined, TEMP_POINT1$1);\n\n    var c;\n\n    if (hasOffset) {\n      c = this._project(map._pointToPrj(centerPoint._add(offset), undefined, TEMP_POINT1$1), TEMP_POINT1$1);\n    } else {\n      c = this._project(prjCenter, TEMP_POINT1$1);\n    }\n\n    TEMP_POINT2.x = extent2d.xmin;\n    TEMP_POINT2.y = extent2d.ymax;\n    TEMP_POINT3.x = extent2d.xmax;\n    TEMP_POINT3.y = extent2d.ymin;\n\n    var pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n\n    var pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n    var centerTile = tileConfig.getTileIndex(c, res, repeatWorld);\n    var ltTile = tileConfig.getTileIndex(pmin, res, repeatWorld);\n    var rbTile = tileConfig.getTileIndex(pmax, res, repeatWorld);\n    var top = Math.ceil(Math.abs(centerTile.idy - ltTile.idy)),\n        left = Math.ceil(Math.abs(centerTile.idx - ltTile.idx)),\n        bottom = Math.ceil(Math.abs(centerTile.idy - rbTile.idy)),\n        right = Math.ceil(Math.abs(centerTile.idx - rbTile.idx));\n    var allCount = (top + bottom + 1) * (left + right + 1);\n    var tileSize = this.getTileSize();\n\n    var renderer = this.getRenderer() || parentRenderer,\n        scale = this._getTileConfig().tileSystem.scale;\n\n    var tiles = [],\n        extent = new PointExtent();\n\n    for (var i = -top; i <= bottom; i++) {\n      var j = -left;\n      var leftVisitEnd = -Infinity;\n      var rightVisitEnd = false;\n\n      while (j >= leftVisitEnd && j <= right) {\n        var idx = tileConfig.getNeighorTileIndex(centerTile.idx, centerTile.idy, j, i, res, repeatWorld);\n\n        if (leftVisitEnd === -Infinity) {\n          j++;\n        } else {\n          j--;\n        }\n\n        var tileId = this._getTileId(idx.idx, idx.idy, z);\n\n        if (idx.out || this._visitedTiles && this._visitedTiles.has(tileId)) {\n          continue;\n        }\n\n        var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n        if (tileInfo) {\n          tileInfo = tileInfo.info;\n        }\n\n        var p = void 0;\n\n        if (tileInfo) {\n          var _tileInfo = tileInfo,\n              point0 = _tileInfo.point0;\n          p = tileInfo.point.set(point0.x, point0.y);\n        } else if (!this._hasOwnSR) {\n          p = tileConfig.getTilePointNW(idx.x, idx.y, res);\n        } else {\n          var pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n          p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n        }\n\n        var width = void 0,\n            height = void 0;\n\n        if (sr === mapSR) {\n          width = tileSize.width;\n          height = tileSize.height;\n        } else {\n          var pp = void 0;\n\n          if (!this._hasOwnSR) {\n            pp = tileConfig.getTilePointSE(idx.x, idx.y, res);\n          } else {\n            var pse = tileConfig.getTilePrjSE(idx.x, idx.y, res);\n            pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3);\n          }\n\n          width = Math.ceil(Math.abs(pp.x - p.x));\n          height = Math.ceil(Math.abs(pp.y - p.y));\n        }\n\n        var dx = scale.x * (idx.idx - idx.x) * width,\n            dy = scale.y * (idx.idy - idx.y) * height;\n\n        if (dx || dy) {\n          p._add(dx, dy);\n        }\n\n        if (hasOffset) {\n          p._sub(offset);\n        }\n\n        var tileExtent = tileInfo && tileInfo.extent2d || new PointExtent(p.x, p.y, p.x + width, p.y - height);\n\n        if (allCount <= 4 || rightVisitEnd || this._isTileInExtent(frustumMatrix, tileExtent, glScale)) {\n          if (this._visitedTiles && cascadeLevel === 0) {\n            this._visitedTiles.add(tileId);\n          }\n\n          if (cascadeLevel === 0) {\n            this._splitTiles(frustumMatrix, tiles, renderer, idx, z + 1, tileExtent, offset, dx, dy);\n\n            extent._combine(tileExtent);\n          } else {\n            if (!tileInfo) {\n              tileInfo = {\n                'point0': p.add(offset)._sub(dx, dy),\n                'point': p,\n                'z': z,\n                'x': idx.x,\n                'y': idx.y,\n                'extent2d': tileExtent,\n                'mask': cascadeLevel,\n                'size': [width, height],\n                'id': tileId,\n                'dupKey': tileId,\n                'layer': this.getId(),\n                'url': this.getTileUrl(idx.x, idx.y, zoom)\n              };\n            }\n\n            if (hasOffset) {\n              tileExtent.set(p.x, p.y, p.x + width, p.y - height);\n              tileInfo.point = p._add(offset);\n\n              tileExtent._add(offset);\n            }\n\n            tiles.push(tileInfo);\n\n            extent._combine(tileExtent);\n          }\n\n          if (leftVisitEnd === -Infinity) {\n            leftVisitEnd = j;\n            j = right;\n          } else if (!rightVisitEnd) {\n            rightVisitEnd = true;\n          }\n        }\n      }\n    }\n\n    if (tiles.length) {\n      var center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n\n      tiles.sort(function (a, b) {\n        return a.point.distanceTo(center) - b.point.distanceTo(center);\n      });\n    }\n\n    return {\n      'offset': offset,\n      'zoom': tileZoom,\n      'extent': extent,\n      'tiles': tiles\n    };\n  };\n\n  _proto2._splitTiles = function _splitTiles(frustumMatrix, tiles, renderer, tileIdx, z, tileExtent, offset, dx, dy) {\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var glScale = this.getMap().getGLScale(z);\n    var corner = TEMP_POINT4.set(tileExtent.xmin * 2, yOrder < 0 ? tileExtent.ymax * 2 : tileExtent.ymin * 2);\n\n    var corner0 = TEMP_POINT5.set(tileExtent.xmin, yOrder < 0 ? tileExtent.ymax : tileExtent.ymin)._add(offset)._sub(dx, dy)._multi(2);\n\n    var w = tileExtent.getWidth();\n    var h = tileExtent.getHeight();\n    var idx = tileIdx.idx * 2;\n    var idy = tileIdx.idy * 2;\n    var x = tileIdx.x * 2;\n    var y = tileIdx.y * 2;\n\n    var tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 0, w, h, corner, corner0, offset, glScale);\n\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 0, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n  };\n\n  _proto2._checkAndAddTile = function _checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, i, j, w, h, corner, corner0, offset, glScale) {\n    var tileId = this._getTileId(idx + i, idy + j, z);\n\n    if (this._visitedTiles && this._visitedTiles.has(tileId)) {\n      return null;\n    }\n\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var childExtent = new PointExtent(corner.x + i * w, corner.y + yOrder * j * h, corner.x + (i + 1) * w, corner.y + yOrder * (j + 1) * h);\n\n    if (!this._isSplittedTileInExtent(frustumMatrix, childExtent, glScale)) {\n      return null;\n    }\n\n    var hasOffset = offset[0] || offset[1];\n    var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n    if (!tileInfo) {\n      tileInfo = {\n        'point0': corner0.add(i * w, Math.max(yOrder * j * h, yOrder * (j + 1) * h)),\n        'point': new Point(childExtent.xmin, childExtent.ymax),\n        'z': z,\n        'x': x + i,\n        'y': y + j,\n        'extent2d': childExtent,\n        'size': [w, h],\n        'id': tileId,\n        'dupKey': tileId,\n        'layer': this.getId(),\n        'url': this.getTileUrl(x + i, y + j, z + this.options['zoomOffset'])\n      };\n    } else {\n      tileInfo = tileInfo.info;\n    }\n\n    if (hasOffset) {\n      tileInfo.extent2d = childExtent;\n\n      tileInfo.extent2d._add(offset);\n\n      tileInfo.point.set(childExtent.xmin, childExtent.ymax)._add(offset);\n    }\n\n    return tileInfo;\n  };\n\n  _proto2._getTileOffset = function _getTileOffset(z) {\n    var map = this.getMap();\n\n    var scale = map._getResolution() / map._getResolution(z);\n\n    var offset = this.options['offset'];\n\n    if (isFunction(offset)) {\n      offset = offset(this);\n    }\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n    return offset;\n  };\n\n  _proto2._getTileId = function _getTileId(x, y, zoom, id) {\n    return (id || this.getId()) + \"_\" + y + \"_\" + x + \"_\" + zoom;\n  };\n\n  _proto2._project = function _project(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var mapProjection = map.getProjection();\n      var projection = this.getSpatialReference().getProjection();\n      return projection.project(mapProjection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._unproject = function _unproject(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var sr = this.getSpatialReference();\n      var mapProjection = map.getProjection();\n      var projection = sr.getProjection();\n      return mapProjection.project(projection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._initTileConfig = function _initTileConfig() {\n    var map = this.getMap(),\n        tileSize = this.getTileSize();\n    var sr = this.getSpatialReference();\n    var projection = sr.getProjection(),\n        fullExtent = sr.getFullExtent();\n    this._defaultTileConfig = new TileConfig(map, TileSystem.getDefault(projection), fullExtent, tileSize);\n\n    if (this.options['tileSystem']) {\n      this._tileConfig = new TileConfig(map, this.options['tileSystem'], fullExtent, tileSize);\n    }\n\n    if (map && !this._tileConfig && map.getSpatialReference() === sr && map.getBaseLayer() && map.getBaseLayer() !== this && map.getBaseLayer()._getTileConfig) {\n      var base = map.getBaseLayer()._getTileConfig();\n\n      this._tileConfig = new TileConfig(map, base.tileSystem, base.fullExtent, tileSize);\n    }\n\n    this._hasOwnSR = sr !== map.getSpatialReference();\n  };\n\n  _proto2._getTileConfig = function _getTileConfig() {\n    if (!this._defaultTileConfig) {\n      this._initTileConfig();\n    }\n\n    return this._tileConfig || this._defaultTileConfig;\n  };\n\n  _proto2._bindMap = function _bindMap(map) {\n    var baseLayer = map.getBaseLayer();\n\n    if (baseLayer === this) {\n      if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n        this.config({\n          'forceRenderOnMoving': true\n        });\n      }\n    }\n\n    return _Layer.prototype._bindMap.apply(this, arguments);\n  };\n\n  _proto2._isTileInExtent = function _isTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    var matrix;\n\n    if (frustumMatrix !== map.projViewMatrix) {\n      var tileCenter = tileExtent.getCenter(TEMP_POINT6)._multi(glScale);\n\n      set$2(ARR3, tileCenter.x, tileCenter.y, 0);\n      var ndc = transformMat4(ARR3, ARR3, map.projViewMatrix);\n      matrix = ndc[1] < 0 ? map.projViewMatrix : frustumMatrix;\n    } else {\n      matrix = map.projViewMatrix;\n    }\n\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(matrix, TILE_BOX);\n  };\n\n  _proto2._isSplittedTileInExtent = function _isSplittedTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(map.projViewMatrix, TILE_BOX);\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      'spatialreferencechange': this._onSpatialReferenceChange\n    };\n  };\n\n  _proto2._onSpatialReferenceChange = function _onSpatialReferenceChange() {\n    delete this._tileConfig;\n    delete this._defaultTileConfig;\n    delete this._sr;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.clear();\n    }\n  };\n\n  return TileLayer;\n}(Layer);\n\nTileLayer.registerJSONType('TileLayer');\nTileLayer.mergeOptions(options$u);\n\nvar GroupTileLayer = function (_TileLayer) {\n  _inheritsLoose(GroupTileLayer, _TileLayer);\n\n  GroupTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n      return null;\n    }\n\n    var layers = layerJSON['layers'].map(function (json) {\n      return Layer.fromJSON(json);\n    });\n    return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n  };\n\n  function GroupTileLayer(id, layers, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n    _this.layers = layers || [];\n\n    _this._checkChildren();\n\n    _this.layerMap = {};\n    _this._groupChildren = [];\n    return _this;\n  }\n\n  var _proto = GroupTileLayer.prototype;\n\n  _proto.getLayers = function getLayers() {\n    return this.layers;\n  };\n\n  _proto.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'layers': this.layers.map(function (layer) {\n        return layer.toJSON();\n      }),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto.getTiles = function getTiles(z) {\n    var layers = this.layers;\n    var tiles = [];\n    var count = 0;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.options['visible']) {\n        continue;\n      }\n\n      var childGrid = layer.getTiles(z, this);\n\n      if (!childGrid || childGrid.count === 0) {\n        continue;\n      }\n\n      count += childGrid.count;\n      pushIn(tiles, childGrid.tileGrids);\n    }\n\n    return {\n      count: count,\n      tileGrids: tiles\n    };\n  };\n\n  _proto.onAdd = function onAdd() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    this.layers.forEach(function (layer) {\n      _this2.layerMap[layer.getId()] = layer;\n\n      if (layer.getChildLayer) {\n        _this2._groupChildren.push(layer);\n      }\n\n      layer._bindMap(map);\n\n      layer.on('show hide', _this2._onLayerShowHide, _this2);\n    });\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    var _this3 = this;\n\n    this.layers.forEach(function (layer) {\n      layer._doRemove();\n\n      layer.off('show hide', _this3._onLayerShowHide, _this3);\n    });\n    this.layerMap = {};\n    this._groupChildren = [];\n\n    _TileLayer.prototype.onRemove.call(this);\n  };\n\n  _proto.getChildLayer = function getChildLayer(id) {\n    var layer = this.layerMap[id];\n\n    if (layer) {\n      return layer;\n    }\n\n    for (var i = 0; i < this._groupChildren.length; i++) {\n      var child = this._groupChildren[i].getChildLayer(id);\n\n      if (child) {\n        return child;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._onLayerShowHide = function _onLayerShowHide() {\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.setToRedraw();\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!_TileLayer.prototype.isVisible.call(this)) {\n      return false;\n    }\n\n    var children = this.layers;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      if (children[i].isVisible()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._checkChildren = function _checkChildren() {\n    var _this4 = this;\n\n    var ids = {};\n    this.layers.forEach(function (layer) {\n      var layerId = layer.getId();\n\n      if (ids[layerId]) {\n        throw new Error(\"Duplicate child layer id (\" + layerId + \") in the GroupTileLayer (\" + _this4.getId() + \")\");\n      } else {\n        ids[layerId] = 1;\n      }\n    });\n  };\n\n  return GroupTileLayer;\n}(TileLayer);\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\nvar options$v = {\n  crs: null,\n  uppercase: false,\n  detectRetina: false\n};\nvar defaultWmsParams = {\n  service: 'WMS',\n  request: 'GetMap',\n  layers: '',\n  styles: '',\n  format: 'image/jpeg',\n  transparent: false,\n  version: '1.1.1'\n};\n\nvar WMSTileLayer = function (_TileLayer) {\n  _inheritsLoose(WMSTileLayer, _TileLayer);\n\n  function WMSTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id) || this;\n    var wmsParams = extend({}, defaultWmsParams);\n\n    for (var p in options) {\n      if (!(p in _this.options)) {\n        wmsParams[p] = options[p];\n      }\n    }\n\n    _this.setOptions(options);\n\n    _this.setZIndex(options.zIndex);\n\n    var tileSize = _this.getTileSize();\n\n    wmsParams.width = tileSize.width;\n    wmsParams.height = tileSize.height;\n    _this.wmsParams = wmsParams;\n    _this._wmsVersion = parseFloat(wmsParams.version);\n    return _this;\n  }\n\n  var _proto = WMSTileLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    var dpr = this.getMap().getDevicePixelRatio();\n    var r = options$v.detectRetina ? dpr : 1;\n    this.wmsParams.width *= r;\n    this.wmsParams.height *= r;\n    var crs = this.options.crs || this.getMap().getProjection().code;\n    var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n    this.wmsParams[projectionKey] = crs;\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.getTileUrl = function getTileUrl(x, y, z) {\n    var res = this.getSpatialReference().getResolution(z),\n        tileConfig = this._getTileConfig(),\n        tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n\n    var max = tileExtent.getMax(),\n        min = tileExtent.getMin();\n    var bbox = (this._wmsVersion >= 1.3 && this.wmsParams.crs === 'EPSG:4326' ? [min.y, min.x, max.y, max.x] : [min.x, min.y, max.x, max.y]).join(',');\n\n    var url = _TileLayer.prototype.getTileUrl.call(this, x, y, z);\n\n    return url + getParamString(this.wmsParams, url, this.options.uppercase) + (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'WMSTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  WMSTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n      return null;\n    }\n\n    return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return WMSTileLayer;\n}(TileLayer);\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\nWMSTileLayer.mergeOptions(options$v);\n\nfunction getParamString(obj, existingUrl, uppercase) {\n  var params = [];\n\n  for (var i in obj) {\n    params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n  }\n\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n\nvar CanvasTileLayer = function (_TileLayer) {\n  _inheritsLoose(CanvasTileLayer, _TileLayer);\n\n  function CanvasTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n\n    if (!_this.options.hasOwnProperty('forceRenderOnMoving')) {\n      _this.options['forceRenderOnMoving'] = false;\n    }\n\n    return _this;\n  }\n\n  var _proto = CanvasTileLayer.prototype;\n\n  _proto.drawTile = function drawTile() {};\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'CanvasTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  CanvasTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n      return null;\n    }\n\n    return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return CanvasTileLayer;\n}(TileLayer);\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nfunction createGLContext(canvas, options) {\n  var attributes = {\n    'alpha': true,\n    'stencil': true,\n    'preserveDrawingBuffer': true,\n    'antialias': false\n  };\n  var names = ['webgl', 'experimental-webgl'];\n  var context = null;\n\n  for (var i = 0; i < names.length; ++i) {\n    try {\n      context = canvas.getContext(names[i], options || attributes);\n    } catch (e) {}\n\n    if (context) {\n      break;\n    }\n  }\n\n  return context;\n}\n\nfunction compileShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n  if (!compiled) {\n    var error = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error('Failed to compile shader: ' + error);\n  }\n\n  return shader;\n}\n\nfunction createProgram(gl, vert, frag) {\n  var vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n  var fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n\n  if (!vertexShader || !fragmentShader) {\n    return null;\n  }\n\n  var program = gl.createProgram();\n\n  if (!program) {\n    return null;\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  return {\n    program: program,\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader\n  };\n}\n\nfunction enableVertexAttrib(gl, program, attributes) {\n  if (Array.isArray(attributes[0])) {\n    var FSIZE = Float32Array.BYTES_PER_ELEMENT;\n    var STRIDE = 0;\n\n    for (var i = 0; i < attributes.length; i++) {\n      STRIDE += attributes[i][1] || 0;\n    }\n\n    var offset = 0;\n\n    for (var _i = 0; _i < attributes.length; _i++) {\n      var attr = gl.getAttribLocation(program, attributes[_i][0]);\n\n      if (attr < 0) {\n        throw new Error('Failed to get the storage location of ' + attributes[_i][0]);\n      }\n\n      gl.vertexAttribPointer(attr, attributes[_i][1], gl[attributes[_i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n      offset += attributes[_i][1] || 0;\n      gl.enableVertexAttribArray(attr);\n    }\n  } else {\n    var _attr = gl.getAttribLocation(program, attributes[0]);\n\n    gl.vertexAttribPointer(_attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n    gl.enableVertexAttribArray(_attr);\n  }\n}\n\nvar shaders = {\n  'vertexShader': \"\\n        attribute vec2 a_position;\\n\\n        attribute vec2 a_texCoord;\\n\\n        uniform mat4 u_matrix;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\\n\\n            v_texCoord = a_texCoord;\\n        }\\n    \",\n  'fragmentShader': \"\\n        precision mediump float;\\n\\n        uniform sampler2D u_image;\\n\\n        uniform float u_opacity;\\n        uniform float u_debug_line;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            if (u_debug_line == 1.) {\\n                gl_FragColor = vec4(0., 1., 0., 1.);\\n            } else {\\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\\n            }\\n        }\\n    \"\n};\nvar v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\nvar DEBUG_POINT = new Point(20, 20);\n\nvar ImageGLRenderable = function ImageGLRenderable(Base) {\n  var renderable = function (_Base) {\n    _inheritsLoose(renderable, _Base);\n\n    function renderable() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = renderable.prototype;\n\n    _proto.drawGLImage = function drawGLImage(image, x, y, w, h, scale$$1, opacity, debug) {\n      if (this.gl.program !== this.program) {\n        this.useProgram(this.program);\n      }\n\n      var gl = this.gl;\n      this.loadTexture(image);\n      v3[0] = x || 0;\n      v3[1] = y || 0;\n      var uMatrix = identity(arr16);\n      translate(uMatrix, uMatrix, v3);\n      scale(uMatrix, uMatrix, [scale$$1, scale$$1, 1]);\n      multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      var glBuffer = image.glBuffer;\n\n      if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n        this.saveImageBuffer(glBuffer);\n        delete image.glBuffer;\n      }\n\n      if (!image.glBuffer) {\n        image.glBuffer = this.bufferTileData(0, 0, w, h);\n      } else {\n        gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n      }\n\n      v2[0] = 'a_position';\n      v2[1] = 2;\n      v2[2] = image.glBuffer.type;\n      this.enableVertexAttrib(v2);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      if (debug) {\n        this.drawDebug(uMatrix, v2, 0, 0, w, h, debug);\n      }\n    };\n\n    _proto.drawDebug = function drawDebug(uMatrix, attrib, x, y, w, h, debugInfo) {\n      var gl = this.gl;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._debugBuffer);\n      this.enableVertexAttrib(['a_position', 2, 'FLOAT']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([x, y, x + w, y, x + w, y - h, x, y - h, x, y]), gl.DYNAMIC_DRAW);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_debug_line'], 1);\n      gl.drawArrays(gl.LINE_STRIP, 0, 5);\n      var canvas = this._debugInfoCanvas;\n\n      if (!canvas) {\n        var dpr = this.getMap().getDevicePixelRatio() > 1 ? 2 : 1;\n        canvas = this._debugInfoCanvas = document.createElement('canvas');\n        canvas.width = 256 * dpr;\n        canvas.height = 32 * dpr;\n\n        var _ctx = canvas.getContext('2d');\n\n        _ctx.font = '20px monospace';\n\n        _ctx.scale(dpr, dpr);\n      }\n\n      var ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      var color = this.layer.options['debugOutline'];\n      Canvas.fillText(ctx, debugInfo, DEBUG_POINT, color);\n      this.loadTexture(canvas);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n      w = 256;\n      h = 32;\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      gl.bufferData(gl.ARRAY_BUFFER, this.set8(x1, y1, x1, y2, x2, y1, x2, y2), gl.DYNAMIC_DRAW);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    _proto.bufferTileData = function bufferTileData(x, y, w, h, buffer) {\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      var data;\n\n      if (isInteger(x1) && isInteger(x2) && isInteger(y1) && isInteger(y2)) {\n        data = this.set8Int(x1, y1, x1, y2, x2, y1, x2, y2);\n      } else {\n        data = this.set8(x1, y1, x1, y2, x2, y1, x2, y2);\n      }\n\n      var glBuffer = this.loadImageBuffer(data, buffer);\n      glBuffer.width = w;\n      glBuffer.height = h;\n      glBuffer.type = data instanceof Int16Array ? 'SHORT' : 'FLOAT';\n      return glBuffer;\n    };\n\n    _proto.drawTinImage = function drawTinImage(image, vertices, texCoords, indices, opacity) {\n      var gl = this.gl;\n      this.loadTexture(image);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n      this.enableVertexAttrib(['a_position', 3]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n      gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n    };\n\n    _proto.createCanvas2 = function createCanvas2() {\n      this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n    };\n\n    _proto.createGLContext = function createGLContext$$1() {\n      if (this.canvas.gl && this.canvas.gl.wrap) {\n        this.gl = this.canvas.gl.wrap();\n      } else {\n        this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n      }\n\n      var gl = this.gl;\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n      gl.disable(gl.DEPTH_TEST);\n      gl.enable(gl.STENCIL_TEST);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity', 'u_debug_line']);\n      this._debugBuffer = this.createBuffer();\n      this.useProgram(this.program);\n      this.texBuffer = this.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2, 'UNSIGNED_BYTE']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n      this.enableSampler('u_image');\n      gl.activeTexture(gl['TEXTURE0']);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    };\n\n    _proto.resizeGLCanvas = function resizeGLCanvas() {\n      if (this.gl) {\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n      }\n\n      if (!this.canvas2) {\n        return;\n      }\n\n      if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n        this.canvas2.width = this.canvas.width;\n        this.canvas2.height = this.canvas.height;\n      }\n    };\n\n    _proto.clearGLCanvas = function clearGLCanvas() {\n      if (this.gl) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n      }\n    };\n\n    _proto.disposeImage = function disposeImage(image) {\n      if (!image) {\n        return;\n      }\n\n      if (image.texture) {\n        this.saveTexture(image.texture);\n      }\n\n      if (image.glBuffer) {\n        this.saveImageBuffer(image.glBuffer);\n      }\n\n      delete image.texture;\n      delete image.glBuffer;\n    };\n\n    _proto._createTexture = function _createTexture(image) {\n      var gl = this.gl;\n      var texture = this.getTexture() || gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n      if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      return texture;\n    };\n\n    _proto.getTexture = function getTexture() {\n      if (!this._textures) {\n        this._textures = [];\n      }\n\n      var textures = this._textures;\n      return textures && textures.length > 0 ? textures.pop() : null;\n    };\n\n    _proto.saveTexture = function saveTexture(texture) {\n      this._textures.push(texture);\n    };\n\n    _proto.loadTexture = function loadTexture(image) {\n      var gl = this.gl;\n      var texture = image.texture;\n\n      if (!texture) {\n        texture = this._createTexture(image);\n        image.texture = texture;\n      }\n\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      return texture;\n    };\n\n    _proto.getImageBuffer = function getImageBuffer() {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      var imageBuffers = this._imageBuffers;\n      return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n    };\n\n    _proto.saveImageBuffer = function saveImageBuffer(buffer) {\n      this._imageBuffers.push(buffer);\n    };\n\n    _proto.loadImageBuffer = function loadImageBuffer(data, glBuffer) {\n      var gl = this.gl;\n      var buffer = glBuffer || this.createImageBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n      return buffer;\n    };\n\n    _proto.createImageBuffer = function createImageBuffer() {\n      return this.getImageBuffer() || this.createBuffer();\n    };\n\n    _proto.removeGLCanvas = function removeGLCanvas() {\n      var gl = this.gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (this._debugBuffer) {\n        gl.deleteBuffer(this._debugBuffer);\n        delete this._debugBuffer;\n      }\n\n      if (this._buffers) {\n        this._buffers.forEach(function (b) {\n          gl.deleteBuffer(b);\n        });\n\n        delete this._buffers;\n      }\n\n      if (this._textures) {\n        this._textures.forEach(function (t) {\n          return gl.deleteTexture(t);\n        });\n\n        delete this._textures;\n      }\n\n      if (this._debugInfoCanvas) {\n        var texture = this._debugInfoCanvas.texture;\n\n        if (texture) {\n          gl.deleteTexture(texture);\n        }\n\n        delete this._debugInfoCanvas.texture;\n        delete this._debugInfoCanvas;\n      }\n\n      var program = gl.program;\n      gl.deleteShader(program.fragmentShader);\n      gl.deleteShader(program.vertexShader);\n      gl.deleteProgram(program);\n      delete this.gl;\n      delete this.canvas2;\n    };\n\n    _proto.createBuffer = function createBuffer() {\n      var gl = this.gl;\n      var buffer = gl.createBuffer();\n\n      if (!buffer) {\n        throw new Error('Failed to create the buffer object');\n      }\n\n      if (!this._buffers) {\n        this._buffers = [];\n      }\n\n      this._buffers.push(buffer);\n\n      return buffer;\n    };\n\n    _proto.enableVertexAttrib = function enableVertexAttrib$$1(attributes) {\n      enableVertexAttrib(this.gl, this.gl.program, attributes);\n    };\n\n    _proto.createProgram = function createProgram$$1(vert, frag, uniforms) {\n      var gl = this.gl;\n\n      var _createProgram2 = createProgram(gl, vert, frag),\n          program = _createProgram2.program,\n          vertexShader = _createProgram2.vertexShader,\n          fragmentShader = _createProgram2.fragmentShader;\n\n      program.vertexShader = vertexShader;\n      program.fragmentShader = fragmentShader;\n\n      this._initUniforms(program, uniforms);\n\n      return program;\n    };\n\n    _proto.useProgram = function useProgram(program) {\n      var gl = this.gl;\n      gl.useProgram(program);\n      gl.program = program;\n      return this;\n    };\n\n    _proto.enableSampler = function enableSampler(sampler, texIdx) {\n      var gl = this.gl;\n\n      var uSampler = this._getUniform(gl.program, sampler);\n\n      if (!texIdx) {\n        texIdx = 0;\n      }\n\n      gl.uniform1i(uSampler, texIdx);\n      return uSampler;\n    };\n\n    _proto._initUniforms = function _initUniforms(program, uniforms) {\n      for (var i = 0; i < uniforms.length; i++) {\n        var name = uniforms[i];\n        var uniform = uniforms[i];\n        var b = name.indexOf('[');\n\n        if (b >= 0) {\n          name = name.substring(0, b);\n\n          if (!IS_NODE) {\n            uniform = uniform.substring(0, b);\n          }\n        }\n\n        program[name] = this._getUniform(program, uniform);\n      }\n    };\n\n    _proto._getUniform = function _getUniform(program, uniformName) {\n      var gl = this.gl;\n      var uniform = gl.getUniformLocation(program, uniformName);\n\n      if (!uniform) {\n        throw new Error('Failed to get the storage location of ' + uniformName);\n      }\n\n      return uniform;\n    };\n\n    return renderable;\n  }(Base);\n\n  extend(renderable.prototype, {\n    set8: function () {\n      var out = Browser$1.ie9 ? null : new Float32Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }(),\n    set8Int: function () {\n      var out = Browser$1.ie9 ? null : new Int16Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }()\n  });\n  return renderable;\n};\n\nvar options$w = {\n  renderer: Browser$1.webgl ? 'gl' : 'canvas',\n  crossOrigin: null\n};\nvar TEMP_POINT$1 = new Point(0, 0);\n\nvar ImageLayer = function (_Layer) {\n  _inheritsLoose(ImageLayer, _Layer);\n\n  function ImageLayer(id, images, options) {\n    var _this;\n\n    if (images && !Array.isArray(images) && !images.url) {\n      options = images;\n      images = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._images = images;\n    return _this;\n  }\n\n  var _proto = ImageLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    this._prepareImages(this._images);\n  };\n\n  _proto.setImages = function setImages(images) {\n    this._images = images;\n\n    this._prepareImages(images);\n\n    return this;\n  };\n\n  _proto.getImages = function getImages() {\n    return this._images;\n  };\n\n  _proto._prepareImages = function _prepareImages(images) {\n    images = images || [];\n\n    if (!Array.isArray(images)) {\n      images = [images];\n    }\n\n    var map = this.getMap();\n    this._imageData = images.map(function (img) {\n      var extent = new Extent(img.extent);\n      return extend({}, img, {\n        extent: extent,\n        extent2d: extent.convertTo(function (c) {\n          return map.coordToPoint(c, map.getGLZoom());\n        })\n      });\n    });\n    this._images = images;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.refreshImages();\n    }\n  };\n\n  return ImageLayer;\n}(Layer);\n\nImageLayer.mergeOptions(options$w);\nvar EMPTY_ARRAY = [];\n\nvar ImageLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(ImageLayerCanvasRenderer, _CanvasRenderer);\n\n  function ImageLayerCanvasRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = ImageLayerCanvasRenderer.prototype;\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.checkResources = function checkResources() {\n    var _this2 = this;\n\n    if (this._imageLoaded) {\n      return EMPTY_ARRAY;\n    }\n\n    var layer = this.layer;\n\n    var urls = layer._imageData.map(function (img) {\n      return [img.url, null, null];\n    });\n\n    if (this.resources) {\n      var unloaded = [];\n      var resources = new ResourceCache();\n      urls.forEach(function (url) {\n        if (_this2.resources.isResourceLoaded(url)) {\n          var img = _this2.resources.getImage(url);\n\n          resources.addResource(url, img);\n        } else {\n          unloaded.push(url);\n        }\n      });\n      this.resources.forEach(function (url, res) {\n        if (!resources.isResourceLoaded(url)) {\n          _this2.retireImage(res.image);\n        }\n      });\n      this.resources = resources;\n      urls = unloaded;\n    }\n\n    this._imageLoaded = true;\n    return urls;\n  };\n\n  _proto2.retireImage = function retireImage() {};\n\n  _proto2.refreshImages = function refreshImages() {\n    this._imageLoaded = false;\n    this.setToRedraw();\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isZooming() && !map.getPitch()) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto2.draw = function draw() {\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    this.prepareCanvas();\n    this._painted = false;\n\n    this._drawImages();\n\n    this.completeRender();\n  };\n\n  _proto2._drawImages = function _drawImages() {\n    var imgData = this.layer._imageData;\n    var map = this.getMap();\n\n    var mapExtent = map._get2DExtent(map.getGLZoom());\n\n    if (imgData && imgData.length) {\n      for (var i = 0; i < imgData.length; i++) {\n        var extent = imgData[i].extent2d;\n        var image = this.resources && this.resources.getImage(imgData[i].url);\n\n        if (image && mapExtent.intersects(extent)) {\n          this._painted = true;\n\n          this._drawImage(image, extent, imgData[i].opacity || 1);\n        }\n      }\n    }\n  };\n\n  _proto2._drawImage = function _drawImage(image, extent, opacity) {\n    var globalAlpha = 0;\n    var ctx = this.context;\n\n    if (opacity < 1) {\n      globalAlpha = ctx.globalAlpha;\n      ctx.globalAlpha = opacity;\n    }\n\n    var map = this.getMap();\n    var nw = TEMP_POINT$1.set(extent.xmin, extent.ymax);\n\n    var point = map._pointToContainerPoint(nw, map.getGLZoom());\n\n    var x = point.x,\n        y = point.y;\n    var bearing = map.getBearing();\n\n    if (bearing) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n      }\n\n      x = y = 0;\n    }\n\n    var scale = map.getGLScale();\n    ctx.drawImage(image, x, y, extent.getWidth() / scale, extent.getHeight() / scale);\n\n    if (bearing) {\n      ctx.restore();\n    }\n\n    if (globalAlpha) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  return ImageLayerCanvasRenderer;\n}(CanvasRenderer);\n\nvar ImageLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(ImageLayerGLRenderer, _ImageGLRenderable);\n\n  function ImageLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto3 = ImageLayerGLRenderer.prototype;\n\n  _proto3.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto3._drawImage = function _drawImage(image, extent, opacity) {\n    this.drawGLImage(image, extent.xmin, extent.ymax, extent.getWidth(), extent.getHeight(), 1, opacity);\n  };\n\n  _proto3.createContext = function createContext() {\n    this.createGLContext();\n  };\n\n  _proto3.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto3.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto3.retireImage = function retireImage(image) {\n    this.disposeImage(image);\n  };\n\n  _proto3.onRemove = function onRemove() {\n    this.removeGLCanvas();\n\n    _ImageGLRenderable.prototype.onRemove.call(this);\n  };\n\n  return ImageLayerGLRenderer;\n}(ImageGLRenderable(ImageLayerCanvasRenderer));\n\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nvar CanvasLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(CanvasLayerRenderer, _CanvasRenderer);\n\n  function CanvasLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayerRenderer.prototype;\n\n  _proto.getPrepareParams = function getPrepareParams() {\n    return [];\n  };\n\n  _proto.getDrawParams = function getDrawParams() {\n    return [];\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (this.canvas && this.layer.options['doubleBuffer']) {\n      this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n    }\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    if (this.layer.options['animation']) {\n      return true;\n    }\n\n    var map = this.getMap();\n\n    if (map.isInteracting() && !this.layer.drawOnInteracting) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    this.prepareCanvas();\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this._drawLayerOnInteracting();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var canvasImg = _CanvasRenderer.prototype.getCanvasImage.call(this);\n\n    if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n      var canvas = canvasImg.image;\n\n      if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n        this.buffer.width = canvas.width;\n        this.buffer.height = canvas.height;\n      }\n\n      var bufferContext = this.buffer.getContext('2d');\n      var prevent = this.layer.doubleBuffer(bufferContext, this.context);\n\n      if (prevent === undefined || prevent) {\n        Canvas.image(bufferContext, canvas, 0, 0);\n        canvasImg.image = this.buffer;\n      }\n    }\n\n    return canvasImg;\n  };\n\n  _proto.remove = function remove() {\n    delete this._drawContext;\n    return _CanvasRenderer.prototype.remove.call(this);\n  };\n\n  _proto.onZoomStart = function onZoomStart(param) {\n    this.layer.onZoomStart(param);\n\n    _CanvasRenderer.prototype.onZoomStart.call(this, param);\n  };\n\n  _proto.onZooming = function onZooming(param) {\n    this.layer.onZooming(param);\n\n    _CanvasRenderer.prototype.onZooming.call(this, param);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd(param) {\n    this.layer.onZoomEnd(param);\n\n    _CanvasRenderer.prototype.onZoomEnd.call(this, param);\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    this.layer.onMoveStart(param);\n\n    _CanvasRenderer.prototype.onMoveStart.call(this, param);\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this.layer.onMoving(param);\n\n    _CanvasRenderer.prototype.onMoving.call(this, param);\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this.layer.onMoveEnd(param);\n\n    _CanvasRenderer.prototype.onMoveEnd.call(this, param);\n  };\n\n  _proto.onResize = function onResize(param) {\n    this.layer.onResize(param);\n\n    _CanvasRenderer.prototype.onResize.call(this, param);\n  };\n\n  _proto.prepareDrawContext = function prepareDrawContext() {\n    if (!this._predrawed) {\n      var params = ensureParams(this.getPrepareParams());\n      this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n\n      if (!this._drawContext) {\n        this._drawContext = [];\n      }\n\n      if (!Array.isArray(this._drawContext)) {\n        this._drawContext = [this._drawContext];\n      }\n\n      this._predrawed = true;\n    }\n  };\n\n  _proto._prepareDrawParams = function _prepareDrawParams() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var view = this.getViewExtent();\n\n    if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n      this.completeRender();\n      return null;\n    }\n\n    var args = [this.context, view];\n    var params = ensureParams(this.getDrawParams());\n    args.push.apply(args, params);\n    args.push.apply(args, this._drawContext);\n    return args;\n  };\n\n  _proto._drawLayer = function _drawLayer() {\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.draw.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  _proto._drawLayerOnInteracting = function _drawLayerOnInteracting() {\n    if (!this.layer.drawOnInteracting) {\n      return;\n    }\n\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.drawOnInteracting.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  return CanvasLayerRenderer;\n}(CanvasRenderer);\n\nfunction ensureParams(params) {\n  if (!params) {\n    params = [];\n  }\n\n  if (!Array.isArray(params)) {\n    params = [params];\n  }\n\n  return params;\n}\n\nvar options$x = {\n  'doubleBuffer': false,\n  'animation': false\n};\n\nvar CanvasLayer = function (_Layer) {\n  _inheritsLoose(CanvasLayer, _Layer);\n\n  function CanvasLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayer.prototype;\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    return true;\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {};\n\n  _proto.draw = function draw() {};\n\n  _proto.redraw = function redraw() {\n    if (this._getRenderer()) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.play = function play() {\n    this.config('animation', true);\n    return this;\n  };\n\n  _proto.pause = function pause() {\n    this.config('animation', false);\n    return this;\n  };\n\n  _proto.isPlaying = function isPlaying() {\n    return this.options['animation'];\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (this._getRenderer()) {\n      this._getRenderer().clearCanvas();\n    }\n\n    return this;\n  };\n\n  _proto.requestMapToRender = function requestMapToRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().requestMapToRender();\n    }\n\n    return this;\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().completeRender();\n    }\n\n    return this;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    return this;\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {};\n\n  _proto.onResize = function onResize() {};\n\n  _proto.doubleBuffer = function doubleBuffer(bufferContext) {\n    bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n    return this;\n  };\n\n  return CanvasLayer;\n}(Layer);\n\nCanvasLayer.mergeOptions(options$x);\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\nvar TEMP_POINT$2 = new Point(0, 0);\nvar options$y = {\n  'animation': true\n};\n\nvar ParticleLayer = function (_CanvasLayer) {\n  _inheritsLoose(ParticleLayer, _CanvasLayer);\n\n  function ParticleLayer() {\n    return _CanvasLayer.apply(this, arguments) || this;\n  }\n\n  var _proto = ParticleLayer.prototype;\n\n  _proto.getParticles = function getParticles() {};\n\n  _proto.draw = function draw(context, view) {\n    var points = this.getParticles(now());\n\n    if (!points || points.length === 0) {\n      var renderer = this._getRenderer();\n\n      if (renderer) {\n        this._getRenderer()._shouldClear = true;\n      }\n\n      return;\n    }\n\n    var map = this.getMap();\n    var extent = view.extent;\n\n    if (view.maskExtent) {\n      extent = view.extent.intersection(view.maskExtent);\n    }\n\n    extent = extent.convertTo(function (c) {\n      return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT$2);\n    });\n    var e = 2 * Math.PI;\n\n    for (var i = 0, l = points.length; i < l; i++) {\n      var pos = points[i].point;\n\n      if (extent.contains(pos)) {\n        var color = points[i].color || this.options['lineColor'] || '#fff',\n            r = points[i].r;\n\n        if (context.fillStyle !== color) {\n          context.fillStyle = color;\n        }\n\n        if (r <= 2) {\n          context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n        } else {\n          context.beginPath();\n          context.arc(pos.x, pos.y, r / 2, 0, e);\n          context.fill();\n        }\n      }\n    }\n\n    this._fillCanvas(context);\n  };\n\n  _proto._fillCanvas = function _fillCanvas(context) {\n    var g = context.globalCompositeOperation;\n    context.globalCompositeOperation = 'destination-out';\n    var trail = this.options['trail'] || 30;\n    context.fillStyle = 'rgba(0, 0, 0, ' + 1 / trail + ')';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    context.globalCompositeOperation = g;\n  };\n\n  return ParticleLayer;\n}(CanvasLayer);\n\nParticleLayer.mergeOptions(options$y);\nParticleLayer.registerRenderer('canvas', function (_CanvasLayerRenderer) {\n  _inheritsLoose(_class, _CanvasLayerRenderer);\n\n  function _class() {\n    return _CanvasLayerRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = _class.prototype;\n\n  _proto2.draw = function draw() {\n    if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n      this.prepareCanvas();\n      this._shouldClear = false;\n    }\n\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n    this._shouldClear = false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {\n    this._shouldClear = true;\n  };\n\n  return _class;\n}(CanvasLayerRenderer));\nvar EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n  return {\n    'markerType': markerType,\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'opacity': opacity\n  };\n}\n\nvar options$z = {\n  'fixAspectRatio': false,\n  'symbol': null,\n  'removeVertexOn': 'contextmenu',\n  'centerHandleSymbol': createHandleSymbol('ellipse', 1),\n  'vertexHandleSymbol': createHandleSymbol('square', 1),\n  'newVertexHandleSymbol': createHandleSymbol('square', 0.4)\n};\n\nvar GeometryEditor = function (_Eventable) {\n  _inheritsLoose(GeometryEditor, _Eventable);\n\n  function GeometryEditor(geometry, opts) {\n    var _this;\n\n    _this = _Eventable.call(this, opts) || this;\n    _this._geometry = geometry;\n\n    if (!_this._geometry) {\n      return _assertThisInitialized(_this);\n    }\n\n    return _this;\n  }\n\n  var _proto = GeometryEditor.prototype;\n\n  _proto.getMap = function getMap() {\n    return this._geometry.getMap();\n  };\n\n  _proto.prepare = function prepare() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    if (this.options['symbol']) {\n      this._originalSymbol = this._geometry.getSymbol();\n\n      this._geometry.setSymbol(this.options['symbol']);\n    }\n\n    this._prepareEditStageLayer();\n  };\n\n  _proto._prepareEditStageLayer = function _prepareEditStageLayer() {\n    var map = this.getMap();\n    var uid = UID();\n    var stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n        shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n    this._editStageLayer = map.getLayer(stageId);\n    this._shadowLayer = map.getLayer(shadowId);\n\n    if (!this._editStageLayer) {\n      this._editStageLayer = new VectorLayer(stageId);\n      map.addLayer(this._editStageLayer);\n    }\n\n    if (!this._shadowLayer) {\n      this._shadowLayer = new VectorLayer(shadowId);\n      map.addLayer(this._shadowLayer);\n    }\n  };\n\n  _proto.start = function start() {\n    var _this2 = this;\n\n    if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n      return;\n    }\n\n    var map = this.getMap();\n    this.editing = true;\n    var geometry = this._geometry;\n    this._geometryDraggble = geometry.options['draggable'];\n    geometry.config('draggable', false);\n    this.prepare();\n    var shadow = geometry.copy();\n    shadow.setSymbol(geometry._getInternalSymbol());\n    shadow.copyEventListeners(geometry);\n\n    if (geometry._getParent()) {\n      shadow.copyEventListeners(geometry._getParent());\n    }\n\n    shadow._setEventTarget(geometry);\n\n    shadow.setId(null).config({\n      'draggable': false\n    });\n    this._shadow = shadow;\n\n    this._switchGeometryEvents('on');\n\n    geometry.hide();\n\n    if (geometry instanceof Marker || geometry instanceof Circle || geometry instanceof Rectangle || geometry instanceof Ellipse) {\n      this._createOrRefreshOutline();\n    }\n\n    this._shadowLayer.bringToFront().addGeometry(shadow);\n\n    this._editStageLayer.bringToFront();\n\n    this._addListener([map, 'zoomstart', function () {\n      _this2._editStageLayer.hide();\n    }]);\n\n    this._addListener([map, 'zoomend', function () {\n      _this2._editStageLayer.show();\n    }]);\n\n    if (!(geometry instanceof Marker)) {\n      this._createCenterHandle();\n    } else {\n      shadow.config('draggable', true);\n      shadow.on('dragend', this._onMarkerDragEnd, this);\n    }\n\n    if (geometry instanceof Marker) {\n      this.createMarkerEditor();\n    } else if (geometry instanceof Circle) {\n      this.createCircleEditor();\n    } else if (geometry instanceof Rectangle) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Ellipse) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Sector) ;else if (geometry instanceof Polygon || geometry instanceof LineString) {\n      this.createPolygonEditor();\n    }\n  };\n\n  _proto.stop = function stop() {\n    delete this._history;\n    delete this._historyPointer;\n    delete this._editOutline;\n\n    this._switchGeometryEvents('off');\n\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    delete this._shadow;\n\n    this._geometry.config('draggable', this._geometryDraggble);\n\n    delete this._geometryDraggble;\n\n    this._geometry.show();\n\n    this._editStageLayer.remove();\n\n    this._shadowLayer.remove();\n\n    this._clearAllListeners();\n\n    this._refreshHooks = [];\n\n    if (this.options['symbol']) {\n      this._geometry.setSymbol(this._originalSymbol);\n\n      delete this._originalSymbol;\n    }\n\n    this.editing = false;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (isNil(this.editing)) {\n      return false;\n    }\n\n    return this.editing;\n  };\n\n  _proto._getGeometryEvents = function _getGeometryEvents() {\n    return {\n      'symbolchange': this._onGeoSymbolChange,\n      'positionchange shapechange': this._exeAndReset\n    };\n  };\n\n  _proto._switchGeometryEvents = function _switchGeometryEvents(oper) {\n    if (this._geometry) {\n      var events = this._getGeometryEvents();\n\n      for (var p in events) {\n        this._geometry[oper](p, events[p], this);\n      }\n    }\n  };\n\n  _proto._onGeoSymbolChange = function _onGeoSymbolChange(param) {\n    if (this._shadow) {\n      this._shadow.setSymbol(param.target._getInternalSymbol());\n    }\n  };\n\n  _proto._onMarkerDragEnd = function _onMarkerDragEnd() {\n    this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n\n    this._refresh();\n  };\n\n  _proto._createOrRefreshOutline = function _createOrRefreshOutline() {\n    var geometry = this._geometry;\n    var outline = this._editOutline;\n\n    if (!outline) {\n      outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n\n      this._editOutline = outline;\n\n      this._addRefreshHook(this._createOrRefreshOutline);\n    } else {\n      outline.remove();\n      this._editOutline = outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n    }\n\n    return outline;\n  };\n\n  _proto._createCenterHandle = function _createCenterHandle() {\n    var _this3 = this;\n\n    var center = this._shadow.getCenter();\n\n    var symbol = this.options['centerHandleSymbol'];\n    var shadow;\n    var handle = this.createHandle(center, {\n      'symbol': symbol,\n      'cursor': 'move',\n      onDown: function onDown() {\n        shadow = _this3._shadow.copy();\n        var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n        shadow.setSymbol(symbol).addTo(_this3._editStageLayer);\n      },\n      onMove: function onMove(v, param) {\n        var offset = param['coordOffset'];\n        shadow.translate(offset);\n      },\n      onUp: function onUp() {\n        _this3._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n\n        shadow.remove();\n\n        _this3._refresh();\n      }\n    });\n\n    this._addRefreshHook(function () {\n      var center = _this3._shadow.getCenter();\n\n      handle.setCoordinates(center);\n    });\n  };\n\n  _proto._createHandleInstance = function _createHandleInstance(coordinate, opts) {\n    var symbol = opts['symbol'];\n    var handle = new Marker(coordinate, {\n      'draggable': true,\n      'dragShadow': false,\n      'dragOnAxis': opts['axis'],\n      'cursor': opts['cursor'],\n      'symbol': symbol\n    });\n    return handle;\n  };\n\n  _proto.createHandle = function createHandle(coordinate, opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var map = this.getMap();\n\n    var handle = this._createHandleInstance(coordinate, opts);\n\n    var me = this;\n\n    function onHandleDragstart(param) {\n      if (opts.onDown) {\n        this._geometry.fire('handledragstart');\n\n        opts.onDown.call(me, param['viewPoint'], param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragging(param) {\n      me._hideContext();\n\n      var viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n\n      if (opts.onMove) {\n        this._geometry.fire('handledragging');\n\n        opts.onMove.call(me, viewPoint, param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragEnd(ev) {\n      if (opts.onUp) {\n        this._geometry.fire('handledragend');\n\n        opts.onUp.call(me, ev);\n      }\n\n      return false;\n    }\n\n    function onHandleRemove() {\n      handle.config('draggable', false);\n      handle.off('dragstart', onHandleDragstart, me);\n      handle.off('dragging', onHandleDragging, me);\n      handle.off('dragend', onHandleDragEnd, me);\n      handle.off('removestart', onHandleRemove, me);\n      delete handle['maptalks--editor-refresh-fn'];\n    }\n\n    handle.on('dragstart', onHandleDragstart, this);\n    handle.on('dragging', onHandleDragging, this);\n    handle.on('dragend', onHandleDragEnd, this);\n    handle.on('removestart', onHandleRemove, this);\n\n    if (opts.onRefresh) {\n      handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n    }\n\n    this._editStageLayer.addGeometry(handle);\n\n    return handle;\n  };\n\n  _proto._createResizeHandles = function _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n    var _this4 = this;\n\n    var cursors = ['nw-resize', 'n-resize', 'ne-resize', 'w-resize', 'e-resize', 'sw-resize', 's-resize', 'se-resize'];\n    var axis = [null, 'y', null, 'x', 'x', null, 'y', null];\n    var geometry = this._geometry;\n\n    function getResizeAnchors(ext) {\n      return [new Point(ext['xmin'], ext['ymax']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']), new Point(ext['xmax'], ext['ymax']), new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmin'], ext['ymin']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']), new Point(ext['xmax'], ext['ymin'])];\n    }\n\n    if (!blackList) {\n      blackList = [];\n    }\n\n    var me = this;\n    var resizeHandles = [],\n        anchorIndexes = {},\n        map = this.getMap(),\n        handleSymbol = this.options['vertexHandleSymbol'];\n\n    var fnLocateHandles = function fnLocateHandles() {\n      var pExt = geometry._getPainter().get2DExtent(),\n          anchors = getResizeAnchors(pExt);\n\n      var _loop = function _loop(i) {\n        if (Array.isArray(blackList)) {\n          var isBlack = blackList.some(function (ele) {\n            return ele === i;\n          });\n\n          if (isBlack) {\n            return \"continue\";\n          }\n        }\n\n        var anchor = anchors[i],\n            coordinate = map.pointToCoordinate(anchor);\n\n        if (resizeHandles.length < anchors.length - blackList.length) {\n          var handle = _this4.createHandle(coordinate, {\n            'symbol': handleSymbol,\n            'cursor': cursors[i],\n            'axis': axis[i],\n            onMove: function (_index) {\n              return function (handleViewPoint) {\n                me._updating = true;\n                onHandleMove(handleViewPoint, _index);\n                geometry.fire('resizing');\n              };\n            }(i),\n            onUp: function onUp() {\n              me._updating = false;\n              onHandleUp();\n\n              _this4._refresh();\n            }\n          });\n\n          handle.setId(i);\n          anchorIndexes[i] = resizeHandles.length;\n          resizeHandles.push(handle);\n        } else {\n          resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n        }\n      };\n\n      for (var i = 0; i < anchors.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n    };\n\n    fnLocateHandles();\n\n    this._addRefreshHook(fnLocateHandles);\n\n    return resizeHandles;\n  };\n\n  _proto.createMarkerEditor = function createMarkerEditor() {\n    var _this5 = this;\n\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow,\n        map = this.getMap();\n\n    if (!shadow._canEdit()) {\n      if (console) {\n        console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n      }\n\n      return;\n    }\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var symbol = shadow._getInternalSymbol();\n\n    var dxdy = new Point(0, 0);\n\n    if (isNumber(symbol['markerDx'])) {\n      dxdy.x = symbol['markerDx'];\n    }\n\n    if (isNumber(symbol['markerDy'])) {\n      dxdy.y = symbol['markerDy'];\n    }\n\n    var blackList = null;\n\n    if (VectorMarkerSymbolizer.test(symbol)) {\n      if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n        blackList = [5, 6, 7];\n      }\n    } else if (ImageMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol)) {\n      blackList = [5, 6, 7];\n    }\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      var size = shadow.getSize();\n      aspectRatio = size.width / size.height;\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (handleViewPoint, i) {\n      if (blackList && blackList.indexOf(i) >= 0) {\n        var newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n        var coordinates = shadow.getCoordinates();\n        newCoordinates.x = coordinates.x;\n        shadow.setCoordinates(newCoordinates);\n\n        _this5._updateCoordFromShadow(true);\n\n        var mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n        handleViewPoint = mirrorViewPoint;\n      }\n\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n          symbol = shadow._getInternalSymbol();\n\n      var wh = handleViewPoint.sub(viewCenter);\n\n      if (blackList && handleViewPoint.y > viewCenter.y) {\n        wh.y = 0;\n      }\n\n      var r = blackList ? 1 : 2;\n      var width = Math.abs(wh.x) * 2,\n          height = Math.abs(wh.y) * r;\n\n      if (aspectRatio) {\n        width = Math.max(width, height * aspectRatio);\n        height = width / aspectRatio;\n      }\n\n      var ability = resizeAbilities[i];\n\n      if (!(shadow instanceof TextBox)) {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          symbol['markerWidth'] = width;\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          symbol['markerHeight'] = height;\n        }\n\n        shadow.setSymbol(symbol);\n        geometryToEdit.setSymbol(symbol);\n      } else {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          shadow.setWidth(width);\n          geometryToEdit.setWidth(width);\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          shadow.setHeight(height);\n          geometryToEdit.setHeight(height);\n        }\n      }\n    }, function () {\n      _this5._update(getUpdates());\n    });\n\n    function getUpdates() {\n      var updates = [['setCoordinates', shadow.getCoordinates().toArray()]];\n\n      if (shadow instanceof TextBox) {\n        updates.push(['setWidth', shadow.getWidth()]);\n        updates.push(['setHeight', shadow.getHeight()]);\n      } else {\n        updates.push(['setSymbol', shadow.getSymbol()]);\n      }\n\n      return updates;\n    }\n\n    function onZoomEnd() {\n      this._refresh();\n    }\n\n    this._addListener([map, 'zoomend', onZoomEnd]);\n  };\n\n  _proto.createCircleEditor = function createCircleEditor() {\n    var _this6 = this;\n\n    var circle = this._geometry,\n        shadow = this._shadow;\n    var map = this.getMap();\n\n    if (!this._history) {\n      this._recordHistory([['setCoordinates', shadow.getCoordinates().toArray()], ['setRadius', shadow.getRadius()]]);\n    }\n\n    this._createResizeHandles(null, function (handleViewPoint) {\n      var center = circle.getCenter();\n      var mouseCoordinate = map.viewPointToCoordinate(handleViewPoint);\n      var wline = new LineString([[center.x, center.y], [mouseCoordinate.x, center.y]]);\n      var hline = new LineString([[center.x, center.y], [center.x, mouseCoordinate.y]]);\n      var r = Math.max(map.computeGeometryLength(wline), map.computeGeometryLength(hline));\n      shadow.setRadius(r);\n      circle.setRadius(r);\n    }, function () {\n      _this6._update('setRadius', shadow.getRadius());\n    });\n  };\n\n  _proto.createEllipseOrRectEditor = function createEllipseOrRectEditor() {\n    var _this7 = this;\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow;\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var map = this.getMap();\n    var isRect = this._geometry instanceof Rectangle;\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (mouseViewPoint, i) {\n      var r = isRect ? 1 : 2;\n      var pointSub, w, h;\n      var targetPoint = mouseViewPoint;\n      var ability = resizeAbilities[i];\n\n      if (isRect) {\n        var mirror = resizeHandles[7 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n        pointSub = targetPoint.sub(mirrorViewPoint);\n        var absSub = pointSub.abs();\n        w = map.pixelToDistance(absSub.x, 0);\n        h = map.pixelToDistance(0, absSub.y);\n        var size = geometryToEdit.getSize();\n        var firstMirrorCoordinate = resizeHandles[0].getCoordinates();\n        var mouseCoordinate = map.viewPointToCoordinate(mouseViewPoint);\n        var mirrorCoordinate = mirror.getCoordinates();\n        var wline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mouseCoordinate.x, mirrorCoordinate.y]]);\n        var hline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mirrorCoordinate.x, mouseCoordinate.y]]);\n        w = map.computeGeometryLength(wline);\n        h = map.computeGeometryLength(hline);\n\n        if (ability === 0) {\n          if (aspectRatio) {\n            absSub.y = absSub.x / aspectRatio;\n            size.height = Math.abs(absSub.y);\n            h = w / aspectRatio;\n          }\n\n          targetPoint.y = mirrorViewPoint.y - size.height / 2;\n          mouseCoordinate.y = firstMirrorCoordinate.y;\n\n          if (i === 4) {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, firstMirrorCoordinate.x);\n          } else {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, mirrorCoordinate.x);\n          }\n        } else if (ability === 1) {\n          if (aspectRatio) {\n            absSub.x = absSub.y * aspectRatio;\n            size.width = Math.abs(absSub.x);\n            w = h * aspectRatio;\n          }\n\n          targetPoint.x = mirrorViewPoint.x - size.width / 2;\n          mouseCoordinate.x = firstMirrorCoordinate.x;\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        } else {\n          if (aspectRatio) {\n            if (w > h * aspectRatio) {\n              h = w / aspectRatio;\n              targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n            } else {\n              w = h * aspectRatio;\n              targetPoint.x = mirrorViewPoint.x + absSub.y * sign(pointSub.x) * aspectRatio;\n            }\n          }\n\n          mouseCoordinate.x = Math.min(mouseCoordinate.x, mirrorCoordinate.x);\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        }\n\n        shadow.setCoordinates(mouseCoordinate);\n\n        _this7._updateCoordFromShadow(true);\n      } else {\n        var center = geometryToEdit.getCenter();\n\n        var _mouseCoordinate = map.viewPointToCoordinate(targetPoint);\n\n        var _wline = new LineString([[center.x, center.y], [_mouseCoordinate.x, center.y]]);\n\n        var _hline = new LineString([[center.x, center.y], [center.x, _mouseCoordinate.y]]);\n\n        w = map.computeGeometryLength(_wline);\n        h = map.computeGeometryLength(_hline);\n\n        if (aspectRatio) {\n          w = Math.max(w, h * aspectRatio);\n          h = w / aspectRatio;\n        }\n      }\n\n      if (aspectRatio || ability === 0 || ability === 2) {\n        shadow.setWidth(w * r);\n        geometryToEdit.setWidth(w * r);\n      }\n\n      if (aspectRatio || ability === 1 || ability === 2) {\n        shadow.setHeight(h * r);\n        geometryToEdit.setHeight(h * r);\n      }\n    }, function () {\n      _this7._update(getUpdates());\n    });\n\n    function getUpdates() {\n      return [['setCoordinates', shadow.getCoordinates().toArray()], ['setWidth', shadow.getWidth()], ['setHeight', shadow.getHeight()]];\n    }\n  };\n\n  _proto.createPolygonEditor = function createPolygonEditor() {\n    var map = this.getMap(),\n        shadow = this._shadow,\n        me = this,\n        projection = map.getProjection();\n\n    if (!this._history) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n    }\n\n    var verticeLimit = shadow instanceof Polygon ? 3 : 2;\n    var propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n        propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n    var vertexHandles = {\n      0: []\n    },\n        newVertexHandles = {\n      0: []\n    };\n\n    function getVertexCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (shadow instanceof Polygon) {\n        var coordinates = shadow.getCoordinates()[ringIndex] || [];\n        return coordinates.slice(0, coordinates.length - 1);\n      } else {\n        return shadow.getCoordinates();\n      }\n    }\n\n    function getVertexPrjCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (ringIndex === 0) {\n        return shadow._getPrjCoordinates();\n      }\n\n      return shadow._getPrjHoles()[ringIndex - 1];\n    }\n\n    function onVertexAddOrRemove() {\n      for (var ringIndex in vertexHandles) {\n        for (var i = vertexHandles[ringIndex].length - 1; i >= 0; i--) {\n          vertexHandles[ringIndex][i][propertyOfVertexIndex] = i;\n        }\n\n        for (var _i = newVertexHandles[ringIndex].length - 1; _i >= 0; _i--) {\n          newVertexHandles[ringIndex][_i][propertyOfVertexIndex] = _i;\n        }\n      }\n\n      me._updateCoordFromShadow();\n    }\n\n    function removeVertex(param) {\n      var handle = param['target'],\n          index = handle[propertyOfVertexIndex];\n      var ringIndex = isNumber(handle._ringIndex) ? handle._ringIndex : 0;\n      var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n\n      if (prjCoordinates.length <= verticeLimit) {\n        return;\n      }\n\n      prjCoordinates.splice(index, 1);\n\n      if (ringIndex > 0) {\n        shadow._prjHoles[ringIndex - 1] = prjCoordinates;\n      } else {\n        shadow._setPrjCoordinates(prjCoordinates);\n      }\n\n      shadow._updateCache();\n\n      vertexHandles[ringIndex].splice(index, 1)[0].remove();\n\n      if (index < newVertexHandles[ringIndex].length) {\n        newVertexHandles[ringIndex].splice(index, 1)[0].remove();\n      }\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      newVertexHandles[ringIndex].splice(nextIndex, 1)[0].remove();\n      newVertexHandles[ringIndex].splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex, ringIndex));\n      onVertexAddOrRemove();\n\n      me._refresh();\n    }\n\n    function moveVertexHandle(handleViewPoint, index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertice = getVertexPrjCoordinates(ringIndex);\n\n      var nVertex = map._viewPointToPrj(handleViewPoint);\n\n      var pVertex = vertice[index];\n      pVertex.x = nVertex.x;\n      pVertex.y = nVertex.y;\n\n      shadow._updateCache();\n\n      shadow.onShapeChanged();\n\n      me._updateCoordFromShadow(true);\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      if (newVertexHandles[ringIndex][index]) {\n        newVertexHandles[ringIndex][index][propertyOfVertexRefreshFn]();\n      }\n\n      if (newVertexHandles[ringIndex][nextIndex]) {\n        newVertexHandles[ringIndex][nextIndex][propertyOfVertexRefreshFn]();\n      }\n    }\n\n    function createVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertex = getVertexCoordinates(ringIndex)[index];\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['vertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex], ringIndex);\n        },\n        onRefresh: function onRefresh() {\n          vertex = getVertexCoordinates(ringIndex)[handle[propertyOfVertexIndex]];\n          handle.setCoordinates(vertex);\n        },\n        onUp: function onUp() {\n          me._refresh();\n\n          me._updateCoordFromShadow();\n        },\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      handle._ringIndex = ringIndex;\n      handle.on(me.options['removeVertexOn'], removeVertex);\n      return handle;\n    }\n\n    function createNewVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertexCoordinates = getVertexCoordinates(ringIndex);\n      var nextVertex;\n\n      if (index + 1 >= vertexCoordinates.length) {\n        nextVertex = vertexCoordinates[0];\n      } else {\n        nextVertex = vertexCoordinates[index + 1];\n      }\n\n      var vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['newVertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var pVertex = projection.project(handle.getCoordinates());\n          prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n\n          if (ringIndex > 0) {\n            shadow._prjHoles[ringIndex - 1] = prjCoordinates;\n          } else {\n            shadow._setPrjCoordinates(prjCoordinates);\n          }\n\n          shadow._updateCache();\n\n          var symbol = handle.getSymbol();\n          delete symbol['opacity'];\n          handle.setSymbol(symbol);\n          newVertexHandles[ringIndex].splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex, ringIndex), createNewVertexHandle.call(me, vertexIndex + 1, ringIndex));\n        },\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1, ringIndex);\n        },\n        onUp: function onUp(e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var vertexIndex = handle[propertyOfVertexIndex];\n          removeFromArray(handle, newVertexHandles[ringIndex]);\n          handle.remove();\n          vertexHandles[ringIndex].splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1, ringIndex));\n          onVertexAddOrRemove();\n\n          me._updateCoordFromShadow();\n\n          me._refresh();\n        },\n        onRefresh: function onRefresh() {\n          vertexCoordinates = getVertexCoordinates(ringIndex);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var nextIndex;\n\n          if (vertexIndex === vertexCoordinates.length - 1) {\n            nextIndex = 0;\n          } else {\n            nextIndex = vertexIndex + 1;\n          }\n\n          var refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n          handle.setCoordinates(refreshVertex);\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      return handle;\n    }\n\n    if (shadow instanceof Polygon) {\n      var rings = shadow.getHoles().length + 1;\n\n      for (var ringIndex = 0; ringIndex < rings; ringIndex++) {\n        vertexHandles[ringIndex] = [];\n        newVertexHandles[ringIndex] = [];\n        var vertexCoordinates = getVertexCoordinates(ringIndex);\n\n        for (var i = 0, len = vertexCoordinates.length; i < len; i++) {\n          vertexHandles[ringIndex].push(createVertexHandle.call(this, i, ringIndex));\n\n          if (i < len - 1) {\n            newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, i, ringIndex));\n          }\n        }\n\n        newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, vertexCoordinates.length - 1, ringIndex));\n      }\n    } else {\n      var _ringIndex = 0;\n\n      var _vertexCoordinates = getVertexCoordinates(_ringIndex);\n\n      for (var _i2 = 0, _len = _vertexCoordinates.length; _i2 < _len; _i2++) {\n        vertexHandles[_ringIndex].push(createVertexHandle.call(this, _i2, _ringIndex));\n\n        if (_i2 < _len - 1) {\n          newVertexHandles[_ringIndex].push(createNewVertexHandle.call(this, _i2, _ringIndex));\n        }\n      }\n    }\n\n    this._addRefreshHook(function () {\n      for (var _ringIndex2 in newVertexHandles) {\n        for (var _i3 = newVertexHandles[_ringIndex2].length - 1; _i3 >= 0; _i3--) {\n          newVertexHandles[_ringIndex2][_i3][propertyOfVertexRefreshFn](_ringIndex2);\n        }\n      }\n\n      for (var _ringIndex3 in vertexHandles) {\n        for (var _i4 = vertexHandles[_ringIndex3].length - 1; _i4 >= 0; _i4--) {\n          vertexHandles[_ringIndex3][_i4][propertyOfVertexRefreshFn](_ringIndex3);\n        }\n      }\n    });\n  };\n\n  _proto._refresh = function _refresh() {\n    if (this._refreshHooks) {\n      for (var i = this._refreshHooks.length - 1; i >= 0; i--) {\n        this._refreshHooks[i].call(this);\n      }\n    }\n  };\n\n  _proto._hideContext = function _hideContext() {\n    if (this._geometry) {\n      this._geometry.closeMenu();\n\n      this._geometry.closeInfoWindow();\n    }\n  };\n\n  _proto._addListener = function _addListener(listener) {\n    if (!this._eventListeners) {\n      this._eventListeners = [];\n    }\n\n    this._eventListeners.push(listener);\n\n    listener[0].on(listener[1], listener[2], this);\n  };\n\n  _proto._clearAllListeners = function _clearAllListeners() {\n    if (this._eventListeners && this._eventListeners.length > 0) {\n      for (var i = this._eventListeners.length - 1; i >= 0; i--) {\n        var listener = this._eventListeners[i];\n        listener[0].off(listener[1], listener[2], this);\n      }\n\n      this._eventListeners = [];\n    }\n  };\n\n  _proto._addRefreshHook = function _addRefreshHook(fn) {\n    if (!fn) {\n      return;\n    }\n\n    if (!this._refreshHooks) {\n      this._refreshHooks = [];\n    }\n\n    this._refreshHooks.push(fn);\n  };\n\n  _proto._update = function _update(method) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key = 1; _key < _len2; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this._exeHistory([method, args]);\n\n    this._recordHistory.apply(this, [method].concat(args));\n  };\n\n  _proto._updateCoordFromShadow = function _updateCoordFromShadow(ignoreRecord) {\n    if (!this._shadow) {\n      return;\n    }\n\n    var coords = this._shadow.getCoordinates();\n\n    var geo = this._geometry;\n    var updating = this._updating;\n    this._updating = true;\n    geo.setCoordinates(coords);\n\n    if (!ignoreRecord) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n    }\n\n    this._updating = updating;\n  };\n\n  _proto._recordHistory = function _recordHistory(method) {\n    if (!this._history) {\n      this._history = [];\n      this._historyPointer = 0;\n    }\n\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key2 = 1; _key2 < _len3; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (this._history.length) {\n      var lastOperation = this._history[this._history.length - 1];\n\n      if (lastOperation[0] === method && JSON.stringify(lastOperation[1]) === JSON.stringify(args)) {\n        return;\n      }\n    }\n\n    if (this._historyPointer < this._history.length - 1) {\n      this._history.splice(this._historyPointer + 1);\n    }\n\n    this._history.push([method, args]);\n\n    this._historyPointer = this._history.length - 1;\n\n    this._geometry.fire('editrecord');\n  };\n\n  _proto.cancel = function cancel() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    this._historyPointer = 0;\n    var record = this._history[0];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    var record = this._history[--this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    if (!this._history || this._historyPointer === this._history.length - 1) {\n      return this;\n    }\n\n    var record = this._history[++this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto._exeAndReset = function _exeAndReset(record) {\n    if (this._updating) {\n      return;\n    }\n\n    this._exeHistory(record);\n\n    var history = this._history,\n        pointer = this._historyPointer;\n    this.stop();\n    this._history = history;\n    this._historyPointer = pointer;\n    this.start();\n  };\n\n  _proto._exeHistory = function _exeHistory(record) {\n    var _this8 = this;\n\n    if (!Array.isArray(record)) {\n      return;\n    }\n\n    var updating = this._updating;\n    this._updating = true;\n    var geo = this._geometry;\n\n    if (Array.isArray(record[0])) {\n      record[0].forEach(function (o) {\n        var m = o[0],\n            args = o.slice(1);\n\n        _this8._shadow[m].apply(_this8._shadow, args);\n\n        geo[m].apply(geo, args);\n      });\n    } else {\n      this._shadow[record[0]].apply(this._shadow, record[1]);\n\n      geo[record[0]].apply(geo, record[1]);\n    }\n\n    this._updating = updating;\n  };\n\n  return GeometryEditor;\n}(Eventable(Class));\n\nGeometryEditor.mergeOptions(options$z);\nvar TextEditable = {\n  startEditText: function startEditText() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    this.hide();\n    this.endEditText();\n\n    this._prepareEditor();\n\n    this._fireEvent('edittextstart');\n\n    return this;\n  },\n  endEditText: function endEditText() {\n    if (this._textEditor) {\n      var html = this._textEditor.innerHTML;\n      html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n      this._textEditor.innerHTML = html;\n\n      var content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n\n      this.setContent(content);\n      off(this._textEditor, 'mousedown dblclick', stopPropagation);\n      this.getMap().off('mousedown', this.endEditText, this);\n\n      this._editUIMarker.remove();\n\n      delete this._editUIMarker;\n      this._textEditor.onkeyup = null;\n      delete this._textEditor;\n      this.show();\n\n      this._fireEvent('edittextend');\n    }\n\n    return this;\n  },\n  isEditingText: function isEditingText() {\n    if (this._textEditor) {\n      return true;\n    }\n\n    return false;\n  },\n  getTextEditor: function getTextEditor() {\n    return this._editUIMarker;\n  },\n  _prepareEditor: function _prepareEditor() {\n    var map = this.getMap();\n\n    var editContainer = this._createEditor();\n\n    this._textEditor = editContainer;\n    map.on('mousedown', this.endEditText, this);\n\n    var offset = this._getEditorOffset();\n\n    this._editUIMarker = new UIMarker(this.getCoordinates(), {\n      'animation': null,\n      'content': editContainer,\n      'dx': offset.dx,\n      'dy': offset.dy\n    }).addTo(map);\n\n    this._setCursorToLast(this._textEditor);\n  },\n  _getEditorOffset: function _getEditorOffset() {\n    var symbol = this._getInternalSymbol() || {};\n    var dx = 0,\n        dy = 0;\n    var textAlign = symbol['textHorizontalAlignment'];\n\n    if (textAlign === 'middle' || isNil(textAlign)) {\n      dx = (symbol['textDx'] || 0) - 2;\n      dy = (symbol['textDy'] || 0) - 2;\n    } else {\n      dx = (symbol['markerDx'] || 0) - 2;\n      dy = (symbol['markerDy'] || 0) - 2;\n    }\n\n    return {\n      'dx': dx,\n      'dy': dy\n    };\n  },\n  _createEditor: function _createEditor() {\n    var content = this.getContent();\n    var labelSize = this.getSize(),\n        symbol = this._getInternalSymbol() || {},\n        width = labelSize.width,\n        textColor = symbol['textFill'] || '#000000',\n        textSize = symbol['textSize'] || 12,\n        height = labelSize.height,\n        lineColor = symbol['markerLineColor'] || '#000',\n        fill = symbol['markerFill'] || '#3398CC',\n        spacing = symbol['textLineSpacing'] || 0;\n    var editor = createEl('div');\n    editor.contentEditable = true;\n    editor.style.cssText = \"background:\" + fill + \"; border:1px solid \" + lineColor + \";\\n            color:\" + textColor + \";font-size:\" + textSize + \"px;width:\" + (width - 2) + \"px;height:\" + (height - 2) + \"px;margin: auto;\\n            line-height:\" + (textSize + spacing) + \"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;\";\n    editor.innerText = content;\n    on(editor, 'mousedown dblclick', stopPropagation);\n\n    editor.onkeyup = function (event) {\n      var h = editor.style.height || 0;\n\n      if (event.keyCode === 13) {\n        editor.style.height = parseInt(h) + textSize / 2 + 'px';\n      }\n    };\n\n    return editor;\n  },\n  _setCursorToLast: function _setCursorToLast(obj) {\n    var range;\n\n    if (window.getSelection) {\n      obj.focus();\n      range = window.getSelection();\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    } else if (document.selection) {\n      range = document.selection.createRange();\n      range.moveToElementText(obj);\n      range.collapse(false);\n      range.select();\n    }\n  }\n};\nTextMarker.include(TextEditable);\nGeometry.include({\n  animate: function animate(styles, options, step) {\n    var _this = this;\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      step = options;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    var map = this.getMap(),\n        projection = this._getProjection(),\n        symbol = this.getSymbol() || {},\n        stylesToAnimate = this._prepareAnimationStyles(styles);\n\n    var preTranslate;\n    var isFocusing = options['focus'];\n    delete this._animationStarted;\n\n    if (map) {\n      var renderer = map._getRenderer();\n\n      var framer = function framer(fn) {\n        renderer.callInNextFrame(fn);\n      };\n\n      options['framer'] = framer;\n    }\n\n    var player = Animation.animate(stylesToAnimate, options, function (frame) {\n      if (map && map.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (map && !_this._animationStarted && isFocusing) {\n        map.onMoveStart();\n      }\n\n      var styles = frame.styles;\n\n      for (var p in styles) {\n        if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n          var fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n\n          _this[fnName](styles[p]);\n        }\n      }\n\n      var translate = styles['translate'];\n\n      if (translate) {\n        var toTranslate = translate;\n\n        if (preTranslate) {\n          toTranslate = translate.sub(preTranslate);\n        }\n\n        preTranslate = translate;\n\n        _this.translate(toTranslate);\n      }\n\n      var dSymbol = styles['symbol'];\n\n      if (dSymbol) {\n        _this.setSymbol(extendSymbol(symbol, dSymbol));\n      }\n\n      if (map && isFocusing) {\n        var pcenter = projection.project(_this.getCenter());\n\n        map._setPrjCenter(pcenter);\n\n        var e = map._parseEventFromCoord(projection.unproject(pcenter));\n\n        if (player.playState !== 'running') {\n          map.onMoveEnd(e);\n        } else {\n          map.onMoving(e);\n        }\n      }\n\n      _this._fireAnimateEvent(player.playState);\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n    this._animPlayer = player;\n    return this._animPlayer.play();\n  },\n  _prepareAnimationStyles: function _prepareAnimationStyles(styles) {\n    var symbol = this._getInternalSymbol();\n\n    var stylesToAnimate = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var v = styles[p];\n\n        if (p !== 'translate' && p !== 'symbol') {\n          var fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n          var current = this[fnName]();\n          stylesToAnimate[p] = [current, v];\n        } else if (p === 'symbol') {\n          var symbolToAnimate = void 0;\n\n          if (Array.isArray(styles['symbol'])) {\n            if (!Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n            }\n\n            symbolToAnimate = [];\n            var symbolInStyles = styles['symbol'];\n\n            for (var i = 0; i < symbolInStyles.length; i++) {\n              if (!symbolInStyles[i]) {\n                symbolToAnimate.push(null);\n                continue;\n              }\n\n              var a = {};\n\n              for (var sp in symbolInStyles[i]) {\n                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                  a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                }\n              }\n\n              symbolToAnimate.push(a);\n            }\n          } else {\n            if (Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n            }\n\n            symbolToAnimate = {};\n\n            for (var _sp in v) {\n              if (v.hasOwnProperty(_sp)) {\n                symbolToAnimate[_sp] = [symbol[_sp], v[_sp]];\n              }\n            }\n          }\n\n          stylesToAnimate['symbol'] = symbolToAnimate;\n        } else if (p === 'translate') {\n          stylesToAnimate['translate'] = new Coordinate(v);\n        }\n      }\n    }\n\n    return stylesToAnimate;\n  },\n  _fireAnimateEvent: function _fireAnimateEvent(playState) {\n    if (playState === 'finished') {\n      delete this._animationStarted;\n\n      this._fireEvent('animateend');\n    } else if (playState === 'running') {\n      if (this._animationStarted) {\n        this._fireEvent('animating');\n      } else {\n        this._fireEvent('animatestart');\n\n        this._animationStarted = true;\n      }\n    }\n  }\n});\nvar DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\nvar EVENTS$2 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar GeometryDragHandler = function (_Handler) {\n  _inheritsLoose(GeometryDragHandler, _Handler);\n\n  function GeometryDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto = GeometryDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on(EVENTS$2, this._startDrag, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._endDrag();\n\n    this.target.off(EVENTS$2, this._startDrag, this);\n    delete this.container;\n  };\n\n  _proto._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.container);\n\n    this._dragHandler.on('dragging', this._dragging, this).on('mouseup', this._endDrag, this).enable();\n  };\n\n  _proto._prepareShadow = function _prepareShadow() {\n    var _this = this;\n\n    var target = this.target;\n\n    this._prepareDragStageLayer();\n\n    if (this._shadow) {\n      this._shadow.remove();\n    }\n\n    var shadow = this._shadow = target.copy();\n\n    if (shadow.getGeometries) {\n      var shadows = shadow.getGeometries();\n      var geos = target.getGeometries();\n      shadows.forEach(function (g, i) {\n        _this._updateShadowSymbol(g, geos[i]);\n      });\n    } else {\n      this._updateShadowSymbol(shadow, target);\n    }\n\n    shadow.setId(null);\n\n    this._prepareShadowConnectors();\n  };\n\n  _proto._updateShadowSymbol = function _updateShadowSymbol(shadow, target) {\n    shadow.setSymbol(target._getInternalSymbol());\n\n    if (target.options['dragShadow']) {\n      var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n      shadow.setSymbol(symbol);\n    }\n  };\n\n  _proto._prepareShadowConnectors = function _prepareShadowConnectors() {\n    var target = this.target;\n    var shadow = this._shadow;\n\n    var resources = this._dragStageLayer._getRenderer().resources;\n\n    var shadowConnectors = [];\n\n    if (ConnectorLine._hasConnectors(target)) {\n      var connectors = ConnectorLine._getConnectors(target);\n\n      for (var i = 0, l = connectors.length; i < l; i++) {\n        var targetConn = connectors[i];\n\n        var connOptions = targetConn.config(),\n            connSymbol = targetConn._getInternalSymbol();\n\n        connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n        var conn = void 0;\n\n        if (targetConn.getConnectSource() === target) {\n          conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n        } else {\n          conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n        }\n\n        shadowConnectors.push(conn);\n\n        if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n          resources.merge(targetConn.getLayer()._getRenderer().resources);\n        }\n      }\n    }\n\n    this._shadowConnectors = shadowConnectors;\n    shadowConnectors.push(shadow);\n\n    this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n  };\n\n  _proto._onTargetUpdated = function _onTargetUpdated() {\n    if (this._shadow) {\n      this._shadow.setSymbol(this.target._getSymbol());\n    }\n  };\n\n  _proto._prepareDragStageLayer = function _prepareDragStageLayer() {\n    var map = this.target.getMap(),\n        layer = this.target.getLayer();\n    this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n\n    if (!this._dragStageLayer) {\n      this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n        enableAltitude: layer.options['enableAltitude'],\n        altitudeProperty: layer.options['altitudeProperty']\n      });\n      map.addLayer(this._dragStageLayer);\n    }\n\n    var resources = new ResourceCache();\n    resources.merge(layer._getRenderer().resources);\n    this._dragStageLayer._getRenderer().resources = resources;\n  };\n\n  _proto._startDrag = function _startDrag(param) {\n    var map = this.target.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var parent = this.target._getParent();\n\n    if (parent) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    this.container = map._panels.mapWrapper || map._containerDOM;\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = this._correctCoord(param['coordinate']);\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    on(this.container, 'mouseleave', this._endDrag, this);\n    this._startParam = param;\n    this._moved = false;\n    return;\n  };\n\n  _proto._dragging = function _dragging(param) {\n    var target = this.target;\n\n    var map = target.getMap(),\n        e = map._parseEvent(param['domEvent']);\n\n    var domEvent = e['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._moved) {\n      this._moved = true;\n      target.on('symbolchange', this._onTargetUpdated, this);\n      this._isDragging = true;\n\n      this._prepareShadow();\n\n      if (!target.options['dragShadow']) {\n        target.hide();\n      }\n\n      this._shadow._fireEvent('dragstart', e);\n\n      this.target._fireEvent('dragstart', this._startParam || e);\n\n      delete this._startParam;\n      return;\n    }\n\n    if (!this._shadow) {\n      return;\n    }\n\n    var axis = this._shadow.options['dragOnAxis'],\n        coord = this._correctCoord(e['coordinate']),\n        point = e['containerPoint'];\n\n    this._lastPoint = this._lastPoint || point;\n    this._lastCoord = this._lastCoord || coord;\n    var pointOffset = point.sub(this._lastPoint);\n    var coordOffset = coord.sub(this._lastCoord);\n\n    if (axis === 'x') {\n      pointOffset.y = coordOffset.y = 0;\n    } else if (axis === 'y') {\n      pointOffset.x = coordOffset.x = 0;\n    }\n\n    this._lastPoint = point;\n    this._lastCoord = coord;\n\n    this._shadow.translate(coordOffset);\n\n    if (!target.options['dragShadow']) {\n      target.translate(coordOffset);\n    }\n\n    e['coordOffset'] = coordOffset;\n    e['pointOffset'] = pointOffset;\n\n    this._shadow._fireEvent('dragging', e);\n\n    target._fireEvent('dragging', e);\n  };\n\n  _proto._endDrag = function _endDrag(param) {\n    if (this._dragHandler) {\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    if (this.container) {\n      off(this.container, 'mouseleave', this._endDrag, this);\n    }\n\n    if (!this.target) {\n      return;\n    }\n\n    var target = this.target;\n    target.off('click', this._endDrag, this);\n    target.off('symbolchange', this._onTargetUpdated, this);\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n    var map = target.getMap();\n\n    if (this.enabled() && map) {\n      var e = map._parseEvent(param ? param['domEvent'] : null);\n\n      this._updateTargetAndRemoveShadow(e);\n\n      if (this._moved) {\n        target._fireEvent('dragend', e);\n      }\n    }\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._updateTargetAndRemoveShadow = function _updateTargetAndRemoveShadow(eventParam) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (!target.options['dragShadow']) {\n      target.show();\n    }\n\n    var shadow = this._shadow;\n\n    if (shadow) {\n      if (target.options['dragShadow']) {\n        if (target.getGeometries) {\n          var shadows = shadow.getGeometries();\n          var geos = target.getGeometries();\n          shadows.forEach(function (g, i) {\n            geos[i].setCoordinates(shadows[i].getCoordinates());\n          });\n        } else {\n          target.setCoordinates(shadow.getCoordinates());\n        }\n      }\n\n      shadow._fireEvent('dragend', eventParam);\n\n      shadow.remove();\n      delete this._shadow;\n    }\n\n    if (this._shadowConnectors) {\n      map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n      delete this._shadowConnectors;\n    }\n\n    if (this._dragStageLayer) {\n      this._dragStageLayer.remove();\n    }\n  };\n\n  _proto._correctCoord = function _correctCoord(coord) {\n    var map = this.target.getMap();\n\n    if (!map.getPitch()) {\n      return coord;\n    }\n\n    var painter = this.target._getPainter();\n\n    if (!painter.getMinAltitude()) {\n      return coord;\n    }\n\n    var alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n    return map.locateByPoint(coord, 0, -alt);\n  };\n\n  return GeometryDragHandler;\n}(Handler$1);\n\nGeometry.mergeOptions({\n  'draggable': false,\n  'dragShadow': true,\n  'dragOnAxis': null\n});\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\nGeometry.include({\n  isDragging: function isDragging() {\n    if (this._getParent()) {\n      return this._getParent().isDragging();\n    }\n\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  }\n});\nGeometry.include({\n  startEdit: function startEdit(opts) {\n    if (!this.getMap() || !this.options['editable']) {\n      return this;\n    }\n\n    this.endEdit();\n    this._editor = new GeometryEditor(this, opts);\n\n    this._editor.start();\n\n    this.fire('editstart');\n    return this;\n  },\n  endEdit: function endEdit() {\n    if (this._editor) {\n      this._editor.stop();\n\n      delete this._editor;\n      this.fire('editend');\n    }\n\n    return this;\n  },\n  redoEdit: function redoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.redo();\n\n    this.fire('redoedit');\n    return this;\n  },\n  undoEdit: function undoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.undo();\n\n    this.fire('undoedit');\n    return this;\n  },\n  cancelEdit: function cancelEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.cancel();\n\n    this.fire('canceledit');\n    return this;\n  },\n  isEditing: function isEditing() {\n    if (this._editor) {\n      return this._editor.isEditing();\n    }\n\n    return false;\n  }\n});\nGeometry.include({\n  _onEvent: function _onEvent(event, type) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var eventType = type || this._getEventTypeToFire(event);\n\n    if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n      stopPropagation(event);\n      preventDefault(event);\n    }\n\n    var params = this._getEventParams(event);\n\n    this._fireEvent(eventType, params);\n  },\n  _getEventTypeToFire: function _getEventTypeToFire(domEvent) {\n    return domEvent.type;\n  },\n  _getEventParams: function _getEventParams(e) {\n    var map = this.getMap();\n    var eventParam = {\n      'domEvent': e\n    };\n    var actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n\n    if (actual) {\n      var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n      eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n      eventParam['containerPoint'] = containerPoint;\n      eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n      eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n    }\n\n    return eventParam;\n  }\n});\nGeometry.include({\n  setInfoWindow: function setInfoWindow(options) {\n    this.removeInfoWindow();\n\n    if (options instanceof InfoWindow) {\n      this._infoWindow = options;\n      this._infoWinOptions = extend({}, this._infoWindow.options);\n\n      this._infoWindow.addTo(this);\n\n      return this;\n    }\n\n    this._infoWinOptions = extend({}, options);\n\n    if (this._infoWindow) {\n      this._infoWindow.setOptions(options);\n    } else if (this.getMap()) {\n      this._bindInfoWindow(this._infoWinOptions);\n    }\n\n    return this;\n  },\n  getInfoWindow: function getInfoWindow() {\n    if (!this._infoWindow) {\n      return null;\n    }\n\n    return this._infoWindow;\n  },\n  openInfoWindow: function openInfoWindow(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._infoWindow) {\n      if (this._infoWinOptions && this.getMap()) {\n        this._bindInfoWindow(this._infoWinOptions);\n\n        this._infoWindow.show(coordinate);\n      }\n    } else {\n      this._infoWindow.show(coordinate);\n    }\n\n    return this;\n  },\n  closeInfoWindow: function closeInfoWindow() {\n    if (this._infoWindow) {\n      this._infoWindow.hide();\n    }\n\n    return this;\n  },\n  removeInfoWindow: function removeInfoWindow() {\n    this._unbindInfoWindow();\n\n    delete this._infoWinOptions;\n    delete this._infoWindow;\n    return this;\n  },\n  _bindInfoWindow: function _bindInfoWindow(options) {\n    this._infoWindow = new InfoWindow(options);\n\n    this._infoWindow.addTo(this);\n\n    return this;\n  },\n  _unbindInfoWindow: function _unbindInfoWindow() {\n    if (this._infoWindow) {\n      this.closeInfoWindow();\n\n      this._infoWindow.remove();\n\n      delete this._infoWindow;\n    }\n\n    return this;\n  }\n});\n\nvar LRUCache = function () {\n  function LRUCache(max, onRemove) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  var _proto = LRUCache.prototype;\n\n  _proto.reset = function reset() {\n    for (var key in this.data) {\n      this.onRemove(this.data[key]);\n    }\n\n    this.data = {};\n    this.order = [];\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this.reset();\n    delete this.onRemove;\n  };\n\n  _proto.add = function add(key, data) {\n    if (this.has(key)) {\n      this.order.splice(this.order.indexOf(key), 1);\n      this.data[key] = data;\n      this.order.push(key);\n    } else {\n      this.data[key] = data;\n      this.order.push(key);\n\n      if (this.order.length > this.max) {\n        var removedData = this.getAndRemove(this.order[0]);\n        if (removedData) this.onRemove(removedData);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.has = function has(key) {\n    return key in this.data;\n  };\n\n  _proto.keys = function keys() {\n    return this.order;\n  };\n\n  _proto.getAndRemove = function getAndRemove(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.order.splice(this.order.indexOf(key), 1);\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    return data;\n  };\n\n  _proto.remove = function remove(key) {\n    if (!this.has(key)) {\n      return this;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.onRemove(data);\n    this.order.splice(this.order.indexOf(key), 1);\n    return this;\n  };\n\n  _proto.setMaxSize = function setMaxSize(max) {\n    this.max = max;\n\n    while (this.order.length > this.max) {\n      var removedData = this.getAndRemove(this.order[0]);\n      if (removedData) this.onRemove(removedData);\n    }\n\n    return this;\n  };\n\n  return LRUCache;\n}();\n\nvar TEMP_POINT$3 = new Point(0, 0);\nvar TEMP_POINT1$2 = new Point(0, 0);\nvar TEMP_POINT2$1 = new Point(0, 0);\n\nvar TileLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(TileLayerCanvasRenderer, _CanvasRenderer);\n\n  function TileLayerCanvasRenderer(layer) {\n    var _this;\n\n    _this = _CanvasRenderer.call(this, layer) || this;\n    _this.tilesInView = {};\n    _this.tilesLoading = {};\n    _this._parentTiles = [];\n    _this._childTiles = [];\n    _this.tileCache = new LRUCache(layer.options['maxCacheSize'], _this.deleteTile.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    return _this;\n  }\n\n  var _proto = TileLayerCanvasRenderer.prototype;\n\n  _proto.getCurrentTileZoom = function getCurrentTileZoom() {\n    return this._tileZoom;\n  };\n\n  _proto.draw = function draw() {\n    var map = this.getMap();\n\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    var mask2DExtent = this.prepareCanvas();\n\n    if (mask2DExtent) {\n      if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n        this.completeRender();\n        return;\n      }\n    }\n\n    var layer = this.layer;\n    var tileGrids = layer.getTiles().tileGrids;\n\n    if (!tileGrids || !tileGrids.length) {\n      this.completeRender();\n      return;\n    }\n\n    var loadingCount = 0;\n    var loading = false;\n    var checkedTiles = {};\n    var tiles = [],\n        parentTiles = [],\n        parentKeys = {},\n        childTiles = [],\n        childKeys = {},\n        placeholders = [],\n        placeholderKeys = {};\n    var tileQueue = {};\n\n    var preLoadingCount = this._markTiles(),\n        loadingLimit = this._getLoadLimit();\n\n    var l = tileGrids.length;\n    this._tileZoom = tileGrids[0]['zoom'];\n    this._tileOffset = tileGrids[0]['offset'];\n\n    for (var i = 0; i < l; i++) {\n      var tileGrid = tileGrids[i];\n      var allTiles = tileGrid['tiles'];\n\n      var placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n      for (var _i = 0, _l = allTiles.length; _i < _l; _i++) {\n        var tile = allTiles[_i],\n            tileId = tile['id'];\n        var tileLoading = false;\n\n        if (this._isLoadingTile(tileId)) {\n          tileLoading = loading = true;\n          this.tilesLoading[tileId].current = true;\n        } else {\n          var cached = this._getCachedTile(tileId);\n\n          if (cached) {\n            if (cached.image && this.getTileOpacity(cached.image) < 1) {\n              tileLoading = loading = true;\n            }\n\n            tiles.push(cached);\n          } else {\n            tileLoading = loading = true;\n            var hitLimit = loadingLimit && loadingCount + preLoadingCount[0] > loadingLimit;\n\n            if (!hitLimit && (!map.isInteracting() || map.isMoving() || map.isRotating())) {\n              loadingCount++;\n              tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n            }\n          }\n        }\n\n        if (!tileLoading) continue;\n\n        if (checkedTiles[tileId]) {\n          continue;\n        }\n\n        checkedTiles[tileId] = 1;\n\n        if (placeholder && !placeholderKeys[tileId]) {\n          tile.cache = false;\n          placeholders.push({\n            image: placeholder,\n            info: tile\n          });\n          placeholderKeys[tileId] = 1;\n        }\n\n        var parentTile = this._findParentTile(tile);\n\n        if (parentTile) {\n          var parentId = parentTile.info.id;\n\n          if (parentKeys[parentId] === undefined) {\n            parentKeys[parentId] = parentTiles.length;\n            parentTiles.push(parentTile);\n          }\n        } else if (!parentTiles.length) {\n          var children = this._findChildTiles(tile);\n\n          if (children.length) {\n            children.forEach(function (c) {\n              if (!childKeys[c.info.id]) {\n                childTiles.push(c);\n                childKeys[c.info.id] = 1;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (parentTiles.length) {\n      childTiles.length = 0;\n      this._childTiles.length = 0;\n    }\n\n    this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n\n    if (!loadingCount) {\n      if (!loading) {\n        if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n          this._parentTiles = [];\n          this._childTiles = [];\n          this.setToRedraw();\n        }\n\n        this.completeRender();\n      }\n    } else {\n      this.loadTileQueue(tileQueue);\n    }\n\n    this._retireTiles();\n  };\n\n  _proto.isTileCachedOrLoading = function isTileCachedOrLoading(tileId) {\n    return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n  };\n\n  _proto._drawTiles = function _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n    var _this2 = this;\n\n    if (parentTiles.length) {\n      parentTiles.sort(function (t1, t2) {\n        return Math.abs(t2.info.z - _this2._tileZoom) - Math.abs(t1.info.z - _this2._tileZoom);\n      });\n      this._parentTiles = parentTiles;\n    }\n\n    if (childTiles.length) {\n      this._childTiles = childTiles;\n    }\n\n    var context = {\n      tiles: tiles,\n      parentTiles: this._parentTiles,\n      childTiles: this._childTiles\n    };\n    this.onDrawTileStart(context);\n\n    this._parentTiles.forEach(function (t) {\n      return _this2._drawTileAndCache(t);\n    });\n\n    this._childTiles.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n\n    placeholders.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n    var layer = this.layer,\n        map = this.getMap();\n\n    if (!layer.options['cascadeTiles'] || map.getPitch() <= map.options['cascadePitches'][0]) {\n      tiles.forEach(function (t) {\n        return _this2._drawTileAndCache(t);\n      });\n    } else {\n      this.writeZoomStencil();\n      var started = false;\n\n      for (var i = 0, l = tiles.length; i < l; i++) {\n        if (tiles[i].info.z !== this._tileZoom) {\n          if (!started) {\n            this.startZoomStencilTest();\n            started = true;\n          } else {\n            this.resumeZoomStencilTest();\n          }\n        } else if (started) {\n          this.pauseZoomStencilTest();\n        }\n\n        this._drawTileAndCache(tiles[i]);\n      }\n\n      this.endZoomStencilTest();\n    }\n\n    this.onDrawTileEnd(context);\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {};\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {};\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {};\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {};\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {};\n\n  _proto.onDrawTileStart = function onDrawTileStart() {};\n\n  _proto.onDrawTileEnd = function onDrawTileEnd() {};\n\n  _proto._drawTileOffset = function _drawTileOffset(info, image) {\n    if (!image) {\n      return;\n    }\n\n    var offset = this._tileOffset;\n\n    if (!offset[0] && !offset[1]) {\n      this.drawTile(info, image);\n      return;\n    }\n\n    var map = this.getMap();\n\n    var scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n\n    info.point._sub(offset);\n\n    info.extent2d._sub(offset);\n\n    this.drawTile(info, image);\n\n    info.point._add(offset);\n\n    info.extent2d._add(offset);\n\n    offset[0] /= scale;\n    offset[1] /= scale;\n  };\n\n  _proto._drawTileAndCache = function _drawTileAndCache(tile) {\n    tile.current = true;\n    this.tilesInView[tile.info.id] = tile;\n\n    this._drawTileOffset(tile.info, tile.image);\n\n    this.tileCache.add(tile.info.id, tile);\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CanvasRenderer.prototype.needToRedraw.call(this);\n    }\n\n    if (map.isRotating() || map.isZooming()) {\n      return true;\n    }\n\n    if (map.isMoving()) {\n      return !!this.layer.options['forceRenderOnMoving'];\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.hitDetect = function hitDetect() {\n    return false;\n  };\n\n  _proto._getLoadLimit = function _getLoadLimit() {\n    if (this.getMap().isInteracting()) {\n      return this.layer.options['loadingLimitOnInteracting'];\n    }\n\n    return 0;\n  };\n\n  _proto.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      this.clear();\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.clear = function clear() {\n    this._retireTiles(true);\n\n    this.tileCache.reset();\n    this.tilesInView = {};\n    this.tilesLoading = {};\n    this._parentTiles = [];\n    this._childTiles = [];\n\n    _CanvasRenderer.prototype.clear.call(this);\n  };\n\n  _proto._isLoadingTile = function _isLoadingTile(tileId) {\n    return !!this.tilesLoading[tileId];\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    return _CanvasRenderer.prototype.clipCanvas.call(this, context);\n  };\n\n  _proto._clipByPitch = function _clipByPitch(ctx) {\n    var map = this.getMap();\n\n    if (map.getPitch() <= map.options['maxVisualPitch']) {\n      return false;\n    }\n\n    if (!this.layer.options['clipByPitch']) {\n      return false;\n    }\n\n    var clipExtent = map.getContainerExtent();\n    var r = map.getDevicePixelRatio();\n    ctx.save();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n    ctx.beginPath();\n    ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n    ctx.stroke();\n    ctx.clip();\n    return true;\n  };\n\n  _proto.loadTileQueue = function loadTileQueue(tileQueue) {\n    for (var p in tileQueue) {\n      if (tileQueue.hasOwnProperty(p)) {\n        var tile = tileQueue[p];\n        var tileImage = this.loadTile(tile);\n\n        if (tileImage.loadTime === undefined) {\n          this.tilesLoading[tile['id']] = {\n            image: tileImage,\n            current: true,\n            info: tile\n          };\n        }\n      }\n    }\n  };\n\n  _proto.loadTile = function loadTile(tile) {\n    var tileSize = this.layer.getTileSize();\n    var tileImage = new Image();\n    tileImage.width = tileSize['width'];\n    tileImage.height = tileSize['height'];\n    tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n    tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n    this.loadTileImage(tileImage, tile['url']);\n    return tileImage;\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n\n    if (!isNil(crossOrigin)) {\n      tileImage.crossOrigin = crossOrigin;\n    }\n\n    return loadImage(tileImage, [url]);\n  };\n\n  _proto.abortTileLoading = function abortTileLoading(tileImage) {\n    if (!tileImage) return;\n    tileImage.onload = falseFn;\n    tileImage.onerror = falseFn;\n    tileImage.src = emptyImageUrl;\n  };\n\n  _proto.onTileLoad = function onTileLoad(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    var id = tileInfo['id'];\n\n    if (!this.tilesInView) {\n      return;\n    }\n\n    var e = {\n      tile: tileInfo,\n      tileImage: tileImage\n    };\n    this.layer.fire('tileload', e);\n    tileImage = e.tileImage;\n    tileImage.loadTime = now();\n    delete this.tilesLoading[id];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n  };\n\n  _proto.onTileError = function onTileError(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    tileImage.onerrorTick = tileImage.onerrorTick || 0;\n    var tileRetryCount = this.layer.options['tileRetryCount'];\n\n    if (tileRetryCount > tileImage.onerrorTick) {\n      tileImage.onerrorTick++;\n      tileImage.src = tileInfo.url;\n      return;\n    }\n\n    if (tileImage instanceof Image) {\n      this.abortTileLoading(tileImage, tileInfo);\n    }\n\n    tileImage.loadTime = 0;\n    delete this.tilesLoading[tileInfo['id']];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n    this.layer.fire('tileerror', {\n      tile: tileInfo\n    });\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    if (!tileImage || !this.getMap()) {\n      return;\n    }\n\n    var point = tileInfo.point,\n        tileZoom = tileInfo.z,\n        tileId = tileInfo.id;\n\n    var map = this.getMap(),\n        tileSize = tileInfo.size,\n        zoom = map.getZoom(),\n        ctx = this.context,\n        cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT$3),\n        bearing = map.getBearing(),\n        transformed = bearing || zoom !== tileZoom;\n\n    var opacity = this.getTileOpacity(tileImage);\n    var alpha = ctx.globalAlpha;\n\n    if (opacity < 1) {\n      ctx.globalAlpha = opacity;\n      this.setToRedraw();\n    }\n\n    if (!transformed) {\n      cp._round();\n    }\n\n    var x = cp.x,\n        y = cp.y;\n    var w = tileSize[0],\n        h = tileSize[1];\n\n    if (transformed) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n        w += 0.1;\n        h += 0.1;\n      }\n\n      if (zoom !== tileZoom) {\n        var scale = map._getResolution(tileZoom) / map._getResolution();\n\n        ctx.scale(scale, scale);\n      }\n\n      x = y = 0;\n    }\n\n    Canvas.image(ctx, tileImage, x, y, w, h);\n\n    if (this.layer.options['debug']) {\n      var color = this.layer.options['debugOutline'];\n      ctx.save();\n      ctx.strokeStyle = color;\n      ctx.fillStyle = color;\n      ctx.strokeWidth = 10;\n      ctx.font = '20px monospace';\n\n      var _point = new Point(x, y);\n\n      Canvas.rectangle(ctx, _point, {\n        width: w,\n        height: h\n      }, 1, 0);\n      Canvas.fillText(ctx, this.getDebugInfo(tileId), _point._add(10, 20), color);\n      Canvas.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n      ctx.restore();\n    }\n\n    if (transformed) {\n      ctx.restore();\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n\n    this.setCanvasUpdated();\n  };\n\n  _proto.getDebugInfo = function getDebugInfo(tileId) {\n    var xyz = tileId.split('_');\n    var length = xyz.length;\n    return 'x:' + xyz[length - 2] + ', y:' + xyz[length - 3] + ', z:' + xyz[length - 1];\n  };\n\n  _proto._findChildTiles = function _findChildTiles(info) {\n    var layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var children = [];\n\n    var min = info.extent2d.getMin(),\n        max = info.extent2d.getMax(),\n        pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1$2), TEMP_POINT1$2),\n        pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2$1), TEMP_POINT2$1);\n\n    var zoomDiff = 2;\n\n    for (var i = 1; i < zoomDiff; i++) {\n      this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n    }\n\n    return children;\n  };\n\n  _proto._findChildTilesAt = function _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n    var zoomOffset = layer.options['zoomOffset'];\n    var layerId = layer.getId(),\n        res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n\n    if (!res) {\n      return;\n    }\n\n    var dmin = layer._getTileConfig().getTileIndex(pmin, res),\n        dmax = layer._getTileConfig().getTileIndex(pmax, res);\n\n    var sx = Math.min(dmin.idx, dmax.idx),\n        ex = Math.max(dmin.idx, dmax.idx);\n    var sy = Math.min(dmin.idy, dmax.idy),\n        ey = Math.max(dmin.idy, dmax.idy);\n    var id, tile;\n\n    for (var i = sx; i < ex; i++) {\n      for (var ii = sy; ii < ey; ii++) {\n        id = layer._getTileId(i, ii, childZoom + zoomOffset, layerId);\n\n        if (this.tileCache.has(id)) {\n          tile = this.tileCache.getAndRemove(id);\n          children.push(tile);\n          this.tileCache.add(id, tile);\n        }\n      }\n    }\n  };\n\n  _proto._findParentTile = function _findParentTile(info) {\n    var map = this.getMap(),\n        layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return null;\n    }\n\n    var sr = layer.getSpatialReference();\n    var d = sr.getZoomDirection(),\n        zoomOffset = layer.options['zoomOffset'],\n        zoomDiff = layer.options['backgroundZoomDiff'];\n\n    var center = info.extent2d.getCenter(),\n        prj = layer._project(map._pointToPrj(center, info.z));\n\n    for (var diff = 1; diff <= zoomDiff; diff++) {\n      var z = info.z - d * diff;\n      var res = sr.getResolution(z + zoomOffset);\n      if (!res) continue;\n\n      var tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n\n      var id = layer._getTileId(tileIndex.x, tileIndex.y, z + zoomOffset, info.layer);\n\n      if (this.tileCache.has(id)) {\n        var tile = this.tileCache.getAndRemove(id);\n        this.tileCache.add(id, tile);\n        return tile;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._getLayerOfTile = function _getLayerOfTile(layerId) {\n    return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n  };\n\n  _proto._getCachedTile = function _getCachedTile(tileId) {\n    var tilesInView = this.tilesInView;\n    var cached = this.tileCache.getAndRemove(tileId);\n\n    if (cached) {\n      tilesInView[tileId] = cached;\n      var tilesLoading = this.tilesLoading;\n\n      if (tilesLoading && tilesLoading[tileId]) {\n        tilesLoading[tileId].current = false;\n        var _tilesLoading$tileId = tilesLoading[tileId],\n            image = _tilesLoading$tileId.image,\n            info = _tilesLoading$tileId.info;\n        this.abortTileLoading(image, info);\n        console.log('_getCachedTile');\n        delete tilesLoading[tileId];\n      }\n    } else {\n      cached = tilesInView[tileId];\n    }\n\n    return cached;\n  };\n\n  _proto._addTileToCache = function _addTileToCache(tileInfo, tileImage) {\n    this.tilesInView[tileInfo.id] = {\n      image: tileImage,\n      current: true,\n      info: tileInfo\n    };\n  };\n\n  _proto.getTileOpacity = function getTileOpacity(tileImage) {\n    if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n      return 1;\n    }\n\n    return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.clear();\n    delete this.tileCache;\n    delete this._tilePlaceHolder;\n\n    _CanvasRenderer.prototype.onRemove.call(this);\n  };\n\n  _proto._markTiles = function _markTiles() {\n    var a = 0,\n        b = 0;\n\n    if (this.tilesLoading) {\n      for (var p in this.tilesLoading) {\n        this.tilesLoading[p].current = false;\n        a++;\n      }\n    }\n\n    if (this.tilesInView) {\n      for (var _p in this.tilesInView) {\n        this.tilesInView[_p].current = false;\n        b++;\n      }\n    }\n\n    return [a, b];\n  };\n\n  _proto._retireTiles = function _retireTiles(force) {\n    for (var i in this.tilesLoading) {\n      var tile = this.tilesLoading[i];\n\n      if (force || !tile.current) {\n        if (tile.image) {\n          this.abortTileLoading(tile.image, tile.info);\n        }\n\n        this.deleteTile(tile);\n        delete this.tilesLoading[i];\n      }\n    }\n\n    for (var _i2 in this.tilesInView) {\n      var _tile = this.tilesInView[_i2];\n\n      if (!_tile.current) {\n        delete this.tilesInView[_i2];\n\n        if (!this.tileCache.has(_i2)) {\n          this.deleteTile(_tile);\n        }\n      }\n    }\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    if (!tile || !tile.image) {\n      return;\n    }\n\n    tile.image.onload = null;\n    tile.image.onerror = null;\n  };\n\n  _proto._generatePlaceHolder = function _generatePlaceHolder(z) {\n    var map = this.getMap();\n    var placeholder = this.layer.options['placeholder'];\n\n    if (!placeholder || map.getPitch()) {\n      return null;\n    }\n\n    var tileSize = this.layer.getTileSize(),\n        scale = map._getResolution(z) / map._getResolution(),\n        canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n\n    canvas.width = tileSize.width * scale;\n    canvas.height = tileSize.height * scale;\n\n    if (isFunction(placeholder)) {\n      placeholder(canvas);\n    } else {\n      defaultPlaceholder(canvas);\n    }\n\n    return canvas;\n  };\n\n  return TileLayerCanvasRenderer;\n}(CanvasRenderer);\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() {\n  return false;\n}\n\nfunction defaultPlaceholder(canvas) {\n  var ctx = canvas.getContext('2d'),\n      cw = canvas.width,\n      ch = canvas.height,\n      w = cw / 16,\n      h = ch / 16;\n  ctx.beginPath();\n\n  for (var i = 0; i < 16; i++) {\n    ctx.moveTo(0, i * h);\n    ctx.lineTo(cw, i * h);\n    ctx.moveTo(i * w, 0);\n    ctx.lineTo(i * w, ch);\n  }\n\n  ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  ctx.beginPath();\n  var path = [[0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]];\n\n  for (var _i3 = 1; _i3 < path.length; _i3 += 2) {\n    ctx.moveTo(path[_i3 - 1][0], path[_i3 - 1][1]);\n    ctx.lineTo(path[_i3][0], path[_i3][1]);\n  }\n\n  ctx.lineWidth = 1 * 4;\n  ctx.stroke();\n}\n\nvar TileLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(TileLayerGLRenderer, _ImageGLRenderable);\n\n  function TileLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto = TileLayerGLRenderer.prototype;\n\n  _proto.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n      return true;\n    }\n\n    return _ImageGLRenderable.prototype.needToRedraw.call(this);\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    var map = this.getMap();\n\n    if (!tileInfo || !map || !tileImage) {\n      return;\n    }\n\n    var scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n        w = tileInfo.size[0],\n        h = tileInfo.size[1];\n\n    if (tileInfo.cache !== false) {\n      this._bindGLBuffer(tileImage, w, h);\n    }\n\n    if (!this._gl()) {\n      _ImageGLRenderable.prototype.drawTile.call(this, tileInfo, tileImage);\n\n      return;\n    }\n\n    var point = tileInfo.point;\n    var x = point.x * scale,\n        y = point.y * scale;\n    var opacity = this.getTileOpacity(tileImage);\n    var debugInfo = null;\n\n    if (this.layer.options['debug']) {\n      debugInfo = this.getDebugInfo(tileInfo.id);\n    }\n\n    this.drawGLImage(tileImage, x, y, w, h, scale, opacity, debugInfo);\n\n    if (opacity < 1) {\n      this.setToRedraw();\n    } else {\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n  };\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {\n    this.pauseZoomStencilTest();\n  };\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n  };\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto._bindGLBuffer = function _bindGLBuffer(image, w, h) {\n    if (!image.glBuffer) {\n      image.glBuffer = this.bufferTileData(0, 0, w, h);\n    }\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n    tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n    tileImage.src = url;\n    return;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (!this.canvas.gl || !this.canvas.gl.wrap) {\n      this.createCanvas2();\n    }\n  };\n\n  _proto.createContext = function createContext() {\n    _ImageGLRenderable.prototype.createContext.call(this);\n\n    this.createGLContext();\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    if (!this._gl() || !this.canvas2) {\n      return _ImageGLRenderable.prototype.getCanvasImage.call(this);\n    }\n\n    var img = _ImageGLRenderable.prototype.getCanvasImage.call(this);\n\n    if (img) {\n      img.image = this.canvas2;\n    }\n\n    return img;\n  };\n\n  _proto._gl = function _gl() {\n    if (this.canvas.gl && this.canvas.gl.wrap) {\n      return true;\n    }\n\n    var map = this.getMap();\n    return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    _ImageGLRenderable.prototype.deleteTile.call(this, tile);\n\n    if (tile && tile.image) {\n      this.disposeImage(tile.image);\n    }\n\n    delete tile.image;\n  };\n\n  _proto.onRemove = function onRemove() {\n    _ImageGLRenderable.prototype.onRemove.call(this);\n\n    this.removeGLCanvas();\n  };\n\n  return TileLayerGLRenderer;\n}(ImageGLRenderable(TileLayerCanvasRenderer));\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nfunction _loadTile(tile) {\n  var tileSize = this.layer.getTileSize(),\n      canvasClass = this.canvas.constructor,\n      map = this.getMap();\n  var r = map.getDevicePixelRatio();\n  var tileCanvas = Canvas.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n  tileCanvas['layer'] = this.layer;\n  var me = this;\n  var extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n  this.layer.drawTile(tileCanvas, {\n    'url': tile['url'],\n    'point': tile['point'],\n    'center': map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n    'extent': extent,\n    'z': tile['z'],\n    'x': tile['x'],\n    'y': tile['y']\n  }, function (error) {\n    if (error) {\n      me.onTileError(tileCanvas, tile);\n      return;\n    }\n\n    me.onTileLoad(tileCanvas, tile);\n  });\n  return tileCanvas;\n}\n\nvar CanvasRenderer$1 = function (_TileLayerCanvasRende) {\n  _inheritsLoose(CanvasRenderer, _TileLayerCanvasRende);\n\n  function CanvasRenderer() {\n    return _TileLayerCanvasRende.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return CanvasRenderer;\n}(TileLayerCanvasRenderer);\n\nvar GLRenderer = function (_TileLayerGLRenderer) {\n  _inheritsLoose(GLRenderer, _TileLayerGLRenderer);\n\n  function GLRenderer() {\n    return _TileLayerGLRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = GLRenderer.prototype;\n\n  _proto2.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return GLRenderer;\n}(TileLayerGLRenderer);\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer$1);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nvar OverlayLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(OverlayLayerRenderer, _CanvasRenderer);\n\n  function OverlayLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = OverlayLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var geometries = this._geosToCheck;\n\n    if (!this._resourceChecked && !geometries) {\n      geometries = this.layer._geoList;\n    }\n\n    if (!isArrayHasData(geometries)) {\n      return [];\n    }\n\n    var resources = [];\n    var cache = {};\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      var res = geo._getExternalResources();\n\n      if (!res.length) {\n        continue;\n      }\n\n      if (!this.resources) {\n        resources.push.apply(resources, res);\n      } else {\n        for (var _i = 0; _i < res.length; _i++) {\n          var url = res[_i][0];\n\n          if (!this.resources.isResourceLoaded(res[_i]) && !cache[url]) {\n            resources.push(res[_i]);\n            cache[url] = 1;\n          }\n        }\n      }\n    }\n\n    this._resourceChecked = true;\n    delete this._geosToCheck;\n    return resources;\n  };\n\n  _proto.render = function render() {\n    this.layer._sortGeometries();\n\n    return _CanvasRenderer.prototype.render.apply(this, arguments);\n  };\n\n  _proto._addGeoToCheckRes = function _addGeoToCheckRes(res) {\n    if (!res) {\n      return;\n    }\n\n    if (!Array.isArray(res)) {\n      res = [res];\n    }\n\n    if (!this._geosToCheck) {\n      this._geosToCheck = [];\n    }\n\n    pushIn(this._geosToCheck, res);\n  };\n\n  _proto.onGeometryAdd = function onGeometryAdd(geometries) {\n    this._addGeoToCheckRes(geometries);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryRemove = function onGeometryRemove() {\n    redraw(this);\n  };\n\n  _proto.onGeometrySymbolChange = function onGeometrySymbolChange(e) {\n    this._addGeoToCheckRes(e.target);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryShapeChange = function onGeometryShapeChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryZIndexChange = function onGeometryZIndexChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryShow = function onGeometryShow() {\n    redraw(this);\n  };\n\n  _proto.onGeometryHide = function onGeometryHide() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange() {\n    redraw(this);\n  };\n\n  return OverlayLayerRenderer;\n}(CanvasRenderer);\n\nfunction redraw(renderer) {\n  if (renderer.layer.options['drawImmediate']) {\n    renderer.render();\n  }\n\n  renderer.setToRedraw();\n}\n\nvar TEMP_EXTENT$4 = new PointExtent();\n\nvar VectorLayerRenderer = function (_OverlayLayerCanvasRe) {\n  _inheritsLoose(VectorLayerRenderer, _OverlayLayerCanvasRe);\n\n  function VectorLayerRenderer() {\n    return _OverlayLayerCanvasRe.apply(this, arguments) || this;\n  }\n\n  var _proto = VectorLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var _this = this;\n\n    var resources = _OverlayLayerCanvasRe.prototype.checkResources.apply(this, arguments);\n\n    var style = this.layer.getStyle();\n\n    if (style) {\n      if (!Array.isArray(style)) {\n        style = [style];\n      }\n\n      style.forEach(function (s) {\n        var res = getExternalResources(s['symbol'], true);\n\n        for (var i = 0, l = res.length; i < l; i++) {\n          if (!_this.resources.isResourceLoaded(res[i])) {\n            resources.push(res[i]);\n          }\n        }\n      });\n    }\n\n    return resources;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() && this.layer.options['enableAltitude']) {\n      return true;\n    }\n\n    if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n      return false;\n    }\n\n    return _OverlayLayerCanvasRe.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    if (!this.getMap()) {\n      return;\n    }\n\n    if (!this.layer.isVisible() || this.layer.isEmpty()) {\n      this.clearCanvas();\n      this.completeRender();\n      return;\n    }\n\n    this.prepareCanvas();\n    this.drawGeos();\n    this.completeRender();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this.context) {\n      return false;\n    }\n\n    return !this.context.canvas._drawn;\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    if (!this._geosToDraw) {\n      return;\n    }\n\n    this._updateDisplayExtent();\n\n    var map = this.getMap();\n    var count = this.layer.getCount();\n    var res = this.getMap().getResolution();\n\n    if (map.isZooming() && map.options['seamlessZoom'] && this._drawnRes !== undefined && res > this._drawnRes * 1.5 && this._geosToDraw.length < count || map.isMoving() || map.isInteracting()) {\n      this.prepareToDraw();\n      this.forEachGeo(this.checkGeo, this);\n      this._drawnRes = res;\n    }\n\n    for (var i = 0, l = this._geosToDraw.length; i < l; i++) {\n      var geo = this._geosToDraw[i];\n\n      if (!geo.isVisible()) {\n        continue;\n      }\n\n      geo._paint(this._displayExtent);\n    }\n  };\n\n  _proto.show = function show() {\n    this.layer.forEach(function (geo) {\n      geo._repaint();\n    });\n\n    _OverlayLayerCanvasRe.prototype.show.apply(this, arguments);\n  };\n\n  _proto.forEachGeo = function forEachGeo(fn, context) {\n    this.layer.forEach(fn, context);\n  };\n\n  _proto.drawGeos = function drawGeos() {\n    this._drawnRes = this.getMap().getResolution();\n\n    this._updateDisplayExtent();\n\n    this.prepareToDraw();\n    this.forEachGeo(this.checkGeo, this);\n\n    for (var i = 0, len = this._geosToDraw.length; i < len; i++) {\n      this._geosToDraw[i]._paint();\n    }\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {\n    this._hasPoint = false;\n    this._geosToDraw = [];\n  };\n\n  _proto.checkGeo = function checkGeo(geo) {\n    if (!geo || !geo.isVisible() || !geo.getMap() || !geo.getLayer() || !geo.getLayer().isCanvasRender()) {\n      return;\n    }\n\n    var painter = geo._getPainter();\n\n    var extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT$4);\n\n    if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n      return;\n    }\n\n    if (painter.hasPoint()) {\n      this._hasPoint = true;\n    }\n\n    this._geosToDraw.push(geo);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    delete this.canvasExtent2D;\n\n    _OverlayLayerCanvasRe.prototype.onZoomEnd.apply(this, arguments);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.forEachGeo(function (g) {\n      g.onHide();\n    });\n    delete this._geosToDraw;\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange(param) {\n    if (param) {\n      this.layer._styleGeometry(param['target']);\n    }\n\n    _OverlayLayerCanvasRe.prototype.onGeometryPropertiesChange.call(this, param);\n  };\n\n  _proto._updateDisplayExtent = function _updateDisplayExtent() {\n    var extent2D = this.canvasExtent2D;\n\n    if (this._maskExtent) {\n      if (!this._maskExtent.intersects(extent2D)) {\n        this.completeRender();\n        return;\n      }\n\n      extent2D = extent2D.intersection(this._maskExtent);\n    }\n\n    this._displayExtent = extent2D;\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var geometries = this._geosToDraw;\n\n    if (!geometries) {\n      return [];\n    }\n\n    return this.layer._hitGeos(geometries, coordinate, options);\n  };\n\n  return VectorLayerRenderer;\n}(OverlayLayerRenderer);\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nvar MapRenderer = function (_Class) {\n  _inheritsLoose(MapRenderer, _Class);\n\n  function MapRenderer(map) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.map = map;\n    _this._handlerQueue = {};\n    return _this;\n  }\n\n  var _proto = MapRenderer.prototype;\n\n  _proto.callInNextFrame = function callInNextFrame(fn) {\n    this._handlerQueue.push(fn);\n  };\n\n  _proto.executeFrameCallbacks = function executeFrameCallbacks() {\n    var running = this._handlerQueue;\n    this._handlerQueue = [];\n\n    for (var i = 0, l = running.length; i < l; i++) {\n      running[i]();\n    }\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset, force) {\n    if (!this.map._panels.front) {\n      return this;\n    }\n\n    if (!force && offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var panels = this.map._panels;\n    var hasFront = this._frontCount = panels.back.layerDOM.childElementCount;\n    var hasBack = this._backCount = panels.front.layerDOM.childElementCount;\n    var hasUI = this._uiCount = panels.front.uiDOM.childElementCount;\n\n    if (hasFront || hasBack || hasUI) {\n      var pos = this.map.offsetPlatform();\n\n      if (offset) {\n        pos = pos.add(offset)._round();\n      } else {\n        pos = pos.round();\n      }\n\n      if (hasBack) {\n        offsetDom(panels.back, pos);\n      }\n\n      if (hasFront || hasUI) {\n        offsetDom(panels.front, pos);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.domChanged = function domChanged() {\n    var panels = this.map._panels;\n\n    if (!panels.front) {\n      return false;\n    }\n\n    var frontCount = panels.back.layerDOM.childElementCount;\n\n    if (this._frontCount === undefined || this._frontCount !== frontCount) {\n      return true;\n    }\n\n    var backCount = panels.front.layerDOM.childElementCount;\n\n    if (this._backCount === undefined || this._backCount !== backCount) {\n      return true;\n    }\n\n    var uiCount = panels.front.uiDOM.childElementCount;\n\n    if (this._uiCount === undefined || this._uiCount !== uiCount) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.resetContainer = function resetContainer() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map._resetMapViewPoint();\n\n    if (this.map._panels.front) {\n      var pos = new Point(0, 0);\n      offsetDom(this.map._panels.back, pos);\n      offsetDom(this.map._panels.front, pos);\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.resetContainer();\n  };\n\n  _proto.onLoad = function onLoad() {\n    this._frameLoop();\n  };\n\n  return MapRenderer;\n}(Class);\n\nvar MapCanvasRenderer = function (_MapRenderer) {\n  _inheritsLoose(MapCanvasRenderer, _MapRenderer);\n\n  function MapCanvasRenderer(map) {\n    var _this;\n\n    _this = _MapRenderer.call(this, map) || this;\n    _this._containerIsCanvas = !!map._containerDOM.getContext;\n    _this._thisVisibilitychange = _this._onVisibilitychange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._registerEvents();\n\n    _this._loopTime = 0;\n    return _this;\n  }\n\n  var _proto = MapCanvasRenderer.prototype;\n\n  _proto.load = function load() {\n    this.initContainer();\n  };\n\n  _proto.renderFrame = function renderFrame(framestamp) {\n    if (!this.map) {\n      return false;\n    }\n\n    delete this._isViewChanged;\n    var map = this.map;\n\n    map._fireEvent('framestart');\n\n    this.updateMapDOM();\n\n    var layers = this._getAllLayerToRender();\n\n    this.drawLayers(layers, framestamp);\n    var updated = this.drawLayerCanvas(layers);\n\n    if (updated) {\n      this._drawCenterCross();\n    }\n\n    map._fireEvent('frameend');\n\n    this._recordView();\n\n    this._mapview = this._getMapView();\n    delete this._spatialRefChanged;\n\n    this._fireLayerLoadEvents();\n\n    this.executeFrameCallbacks();\n    this._canvasUpdated = false;\n    return true;\n  };\n\n  _proto.updateMapDOM = function updateMapDOM() {\n    var map = this.map;\n\n    if (map.isZooming()) {\n      return;\n    }\n\n    var offset = map._getViewPointFrameOffset();\n\n    if (offset) {\n      map.offsetPlatform(offset);\n    } else if (this.domChanged()) {\n      this.offsetPlatform(null, true);\n    }\n  };\n\n  _proto.drawLayers = function drawLayers(layers, framestamp) {\n    var map = this.map,\n        isInteracting = map.isInteracting(),\n        canvasIds = [],\n        updatedIds = [],\n        fps = map.options['fpsOnInteracting'] || 0,\n        timeLimit = fps === 0 ? 0 : 1000 / fps,\n        layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n        l = layers.length;\n    var baseLayer = map.getBaseLayer();\n    var t = 0;\n\n    for (var i = 0; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.isVisible()) {\n        continue;\n      }\n\n      var isCanvas = layer.isCanvasRender();\n\n      if (isCanvas) {\n        canvasIds.push(layer.getId());\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var needsRedraw = this._checkLayerRedraw(layer);\n\n      if (isCanvas && renderer.isCanvasUpdated()) {\n        if (!needsRedraw) {\n          updatedIds.push(layer.getId());\n        }\n\n        this.setLayerCanvasUpdated();\n      }\n\n      var transformMatrix = renderer.__zoomTransformMatrix;\n      delete renderer.__zoomTransformMatrix;\n\n      if (!needsRedraw) {\n        if (isCanvas && isInteracting) {\n          if (map.isZooming() && !map.getPitch()) {\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n          } else if (map.getPitch() || map.isRotating()) {\n            renderer.clearCanvas();\n          }\n        }\n\n        continue;\n      }\n\n      if (isInteracting && isCanvas) {\n        if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n          layer._getRenderer().clearCanvas();\n\n          continue;\n        }\n\n        t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n      } else if (isInteracting && renderer.drawOnInteracting) {\n        if (renderer.prepareRender) {\n          renderer.prepareRender();\n        }\n\n        if (renderer.checkAndDraw) {\n          renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n        } else {\n          renderer.drawOnInteracting(this._eventParam, framestamp);\n        }\n      } else {\n        renderer.render(framestamp);\n\n        if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n          renderer.__zoomTransformMatrix = transformMatrix;\n        }\n      }\n\n      if (isCanvas) {\n        updatedIds.push(layer.getId());\n        this.setLayerCanvasUpdated();\n      }\n    }\n\n    var preCanvasIds = this._canvasIds || [];\n    var preUpdatedIds = this._updatedIds || [];\n    this._canvasIds = canvasIds;\n    this._updatedIds = updatedIds;\n\n    if (!this.isLayerCanvasUpdated()) {\n      var sep = '---';\n\n      if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n        this.setLayerCanvasUpdated();\n      }\n    }\n  };\n\n  _proto._checkLayerRedraw = function _checkLayerRedraw(layer) {\n    if (this.isSpatialReferenceChanged()) {\n      return true;\n    }\n\n    var map = this.map;\n\n    var renderer = layer._getRenderer();\n\n    if (layer.isCanvasRender()) {\n      return renderer.testIfNeedRedraw();\n    } else {\n      if (renderer.needToRedraw && renderer.needToRedraw()) {\n        return true;\n      }\n\n      return map.isInteracting() || this.isViewChanged();\n    }\n  };\n\n  _proto._drawCanvasLayerOnInteracting = function _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n    var map = this.map,\n        renderer = layer._getRenderer(),\n        drawTime = renderer.getDrawTime(),\n        inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n\n    if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n      renderer.render(framestamp);\n    } else if (renderer.drawOnInteracting && (layer === map.getBaseLayer() || inTime || map.isZooming() && layer.options['forceRenderOnZooming'] || map.isMoving() && layer.options['forceRenderOnMoving'] || map.isRotating() && layer.options['forceRenderOnRotating'])) {\n      renderer.prepareRender();\n      renderer.prepareCanvas();\n\n      if (renderer.checkAndDraw) {\n        renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n      } else {\n        renderer.drawOnInteracting(this._eventParam, framestamp);\n      }\n\n      return drawTime;\n    } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n      renderer.prepareRender();\n      renderer.__zoomTransformMatrix = this._zoomMatrix;\n    } else if (map.getPitch() || map.isRotating()) {\n      renderer.clearCanvas();\n    }\n\n    if (renderer.drawOnInteracting && !inTime) {\n      renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n    }\n\n    return 0;\n  };\n\n  _proto._fireLayerLoadEvents = function _fireLayerLoadEvents() {\n    if (this._updatedIds && this._updatedIds.length > 0) {\n      var map = this.map;\n\n      this._updatedIds.reverse().forEach(function (id) {\n        var layer = map.getLayer(id);\n\n        if (!layer) {\n          return;\n        }\n\n        var renderer = layer._getRenderer();\n\n        if (!renderer || !renderer.isRenderComplete()) {\n          return;\n        }\n\n        layer.fire('layerload');\n      });\n    }\n  };\n\n  _proto.isLayerCanvasUpdated = function isLayerCanvasUpdated() {\n    return this._canvasUpdated;\n  };\n\n  _proto.setLayerCanvasUpdated = function setLayerCanvasUpdated() {\n    this._canvasUpdated = true;\n  };\n\n  _proto.drawLayerCanvas = function drawLayerCanvas(layers) {\n    var map = this.map;\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n      return false;\n    }\n\n    if (!this.canvas) {\n      this.createCanvas();\n    }\n\n    map._fireEvent('renderstart', {\n      'context': this.context\n    });\n\n    if (!this._updateCanvasSize()) {\n      this.clearCanvas();\n    }\n\n    var interacting = map.isInteracting(),\n        limit = map.options['layerCanvasLimitOnInteracting'];\n    var len = layers.length;\n    var baseLayerImage;\n    var images = [];\n\n    for (var i = 0; i < len; i++) {\n      if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n        continue;\n      }\n\n      var renderer = layers[i]._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var layerImage = this._getLayerImage(layers[i]);\n\n      if (layerImage && layerImage['image']) {\n        if (layers[i] === map.getBaseLayer()) {\n          baseLayerImage = [layers[i], layerImage];\n        } else {\n          images.push([layers[i], layerImage]);\n        }\n      }\n    }\n\n    if (baseLayerImage) {\n      this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n\n      this._drawFog();\n    }\n\n    len = images.length;\n    var start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n\n    for (var _i = start; _i < len; _i++) {\n      this._drawLayerCanvasImage(images[_i][0], images[_i][1]);\n    }\n\n    map._fireEvent('renderend', {\n      'context': this.context\n    });\n\n    return true;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    var layers = this._getAllLayerToRender();\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var renderer = layers[i].getRenderer();\n\n      if (renderer && renderer.canvas && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.updateMapSize = function updateMapSize(size) {\n    if (!size || this._containerIsCanvas) {\n      return;\n    }\n\n    var width = size['width'] + 'px',\n        height = size['height'] + 'px';\n    var panels = this.map._panels;\n    panels.mapWrapper.style.width = width;\n    panels.mapWrapper.style.height = height;\n\n    this._updateCanvasSize();\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    if (!this.map) {\n      return null;\n    }\n\n    if (this._containerIsCanvas) {\n      return this.map._containerDOM;\n    }\n\n    if (this.map._panels) {\n      return this.map._panels.mapWrapper;\n    }\n\n    return null;\n  };\n\n  _proto.toDataURL = function toDataURL(mimeType) {\n    if (!this.canvas) {\n      return null;\n    }\n\n    return this.canvas.toDataURL(mimeType);\n  };\n\n  _proto.remove = function remove() {\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      removeDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n\n    if (this._resizeInterval) {\n      clearInterval(this._resizeInterval);\n    }\n\n    delete this.context;\n    delete this.canvas;\n    delete this.map;\n    delete this._spatialRefChanged;\n\n    this._cancelFrameLoop();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    var map = this.map;\n\n    if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n      return;\n    }\n\n    var layers = map._getLayers();\n\n    var cursor = 'default';\n    var limit = map.options['hitDetectLimit'] || 0;\n    var counter = 0;\n\n    for (var i = layers.length - 1; i >= 0; i--) {\n      var layer = layers[i];\n\n      if (!layer.options['hitDetect'] || layer.isEmpty && layer.isEmpty()) {\n        continue;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer || !renderer.hitDetect) {\n        continue;\n      }\n\n      if (renderer.isBlank && renderer.isBlank()) {\n        continue;\n      }\n\n      if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n        cursor = layer.options['cursor'] || 'pointer';\n        break;\n      }\n\n      counter++;\n\n      if (limit > 0 && counter > limit) {\n        break;\n      }\n    }\n\n    map._trySetCursor(cursor);\n  };\n\n  _proto._getLayerImage = function _getLayerImage(layer) {\n    var renderer = layer._getRenderer();\n\n    if (renderer.getCanvasImage) {\n      return renderer.getCanvasImage();\n    }\n\n    return null;\n  };\n\n  _proto.initContainer = function initContainer() {\n    var panels = this.map._panels;\n\n    function createContainer(name, className, cssText, enableSelect) {\n      var c = createEl('div', className);\n\n      if (cssText) {\n        c.style.cssText = cssText;\n      }\n\n      panels[name] = c;\n\n      if (!enableSelect) {\n        preventSelection(c);\n      }\n\n      return c;\n    }\n\n    var containerDOM = this.map._containerDOM;\n\n    if (this._containerIsCanvas) {\n      return;\n    }\n\n    containerDOM.innerHTML = '';\n    var POSITION0 = 'position:absolute;top:0px;left:0px;';\n    var mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n        mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n        backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n        back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n        backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n        canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n        frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n        front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n        frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n        ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n        control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n    containerDOM.appendChild(mapWrapper);\n    mapAllLayers.appendChild(backStatic);\n    back.appendChild(backLayer);\n    back.layerDOM = backLayer;\n    mapAllLayers.appendChild(back);\n    mapAllLayers.appendChild(canvasContainer);\n    front.appendChild(frontLayer);\n    front.layerDOM = frontLayer;\n    front.uiDOM = ui;\n    mapAllLayers.appendChild(frontStatic);\n    mapAllLayers.appendChild(front);\n    front.appendChild(ui);\n    mapWrapper.appendChild(mapAllLayers);\n    mapWrapper.appendChild(control);\n    this.createCanvas();\n    this.resetContainer();\n\n    var mapSize = this.map._getContainerDomSize();\n\n    this.updateMapSize(mapSize);\n  };\n\n  _proto.isViewChanged = function isViewChanged() {\n    if (this._isViewChanged !== undefined) {\n      return this._isViewChanged;\n    }\n\n    var previous = this._mapview;\n\n    var view = this._getMapView();\n\n    this._isViewChanged = !previous || !equalMapView(previous, view);\n    return this._isViewChanged;\n  };\n\n  _proto._recordView = function _recordView() {\n    var map = this.map;\n\n    if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n      return;\n    }\n\n    if (!equalMapView(map.getView(), map._getCurrentView())) {\n      map._onViewChange(map.getView());\n    }\n  };\n\n  _proto.isSpatialReferenceChanged = function isSpatialReferenceChanged() {\n    return this._spatialRefChanged;\n  };\n\n  _proto._getMapView = function _getMapView() {\n    var map = this.map;\n\n    var center = map._getPrjCenter();\n\n    return {\n      x: center.x,\n      y: center.y,\n      zoom: map.getZoom(),\n      pitch: map.getPitch(),\n      bearing: map.getBearing(),\n      width: map.width,\n      height: map.height\n    };\n  };\n\n  _proto._frameLoop = function _frameLoop(framestamp) {\n    var _this2 = this;\n\n    if (!this.map) {\n      this._cancelFrameLoop();\n\n      return;\n    }\n\n    this.renderFrame(framestamp);\n    this._animationFrame = requestAnimFrame(function (framestamp) {\n      _this2._frameLoop(framestamp);\n    });\n  };\n\n  _proto._cancelFrameLoop = function _cancelFrameLoop() {\n    if (this._animationFrame) {\n      cancelAnimFrame(this._animationFrame);\n    }\n  };\n\n  _proto._drawLayerCanvasImage = function _drawLayerCanvasImage(layer, layerImage) {\n    var ctx = this.context;\n    var point = layerImage['point'].round();\n    var dpr = this.map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      point._multi(dpr);\n    }\n\n    var canvasImage = layerImage['image'];\n    var width = canvasImage.width,\n        height = canvasImage.height;\n\n    if (point.x + width <= 0 || point.y + height <= 0) {\n      return;\n    }\n\n    var op = layer.options['opacity'];\n\n    if (!isNumber(op)) {\n      op = 1;\n    }\n\n    if (op <= 0) {\n      return;\n    }\n\n    var imgOp = layerImage['opacity'];\n\n    if (!isNumber(imgOp)) {\n      imgOp = 1;\n    }\n\n    if (imgOp <= 0) {\n      return;\n    }\n\n    var alpha = ctx.globalAlpha;\n\n    if (op < 1) {\n      ctx.globalAlpha *= op;\n    }\n\n    if (imgOp < 1) {\n      ctx.globalAlpha *= imgOp;\n    }\n\n    if (layer.options['cssFilter']) {\n      ctx.filter = layer.options['cssFilter'];\n    }\n\n    var renderer = layer.getRenderer();\n    var matrix = renderer.__zoomTransformMatrix;\n    var clipped = renderer.clipCanvas(this.context);\n\n    if (matrix) {\n      ctx.save();\n      ctx.setTransform.apply(ctx, matrix);\n    }\n\n    ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n\n    if (matrix) {\n      ctx.restore();\n    }\n\n    if (clipped) {\n      ctx.restore();\n    }\n\n    if (ctx.filter !== 'none') {\n      ctx.filter = 'none';\n    }\n\n    ctx.globalAlpha = alpha;\n  };\n\n  _proto._drawCenterCross = function _drawCenterCross() {\n    var cross = this.map.options['centerCross'];\n\n    if (cross) {\n      var ctx = this.context;\n      var p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n\n      if (isFunction(cross)) {\n        cross(ctx, p);\n      } else {\n        Canvas.drawCross(this.context, p.x, p.y, 2, '#f00');\n      }\n    }\n  };\n\n  _proto._drawContainerExtent = function _drawContainerExtent() {\n    var cascadePitches = this.map.options.cascadePitches;\n\n    var h30 = this.map.height - this.map._getVisualHeight(cascadePitches[0]);\n\n    var h60 = this.map.height - this.map._getVisualHeight(cascadePitches[1]);\n\n    var extent = this.map.getContainerExtent();\n    var ctx = this.context;\n    ctx.beginPath();\n    ctx.moveTo(0, extent.ymin);\n    ctx.lineTo(extent.xmax, extent.ymin);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h30);\n    ctx.lineTo(extent.xmax, h30);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h60);\n    ctx.lineTo(extent.xmax, h60);\n    ctx.stroke();\n  };\n\n  _proto._drawFog = function _drawFog() {\n    var map = this.map;\n\n    if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n      return;\n    }\n\n    var fogThickness = 30;\n    var r = map.getDevicePixelRatio();\n    var ctx = this.context,\n        clipExtent = map.getContainerExtent();\n    var top = (map.height - map._getVisualHeight(75)) * r;\n    if (top < 0) top = 0;\n    var bottom = clipExtent.ymin * r,\n        h = Math.ceil(bottom - top),\n        color = map.options['fogColor'].join();\n    var gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n    var landscape = 1 - fogThickness / (h + fogThickness);\n    gradient.addColorStop(0, \"rgba(\" + color + \", 0)\");\n    gradient.addColorStop(0.3, \"rgba(\" + color + \", 0.3)\");\n    gradient.addColorStop(landscape, \"rgba(\" + color + \", 1)\");\n    gradient.addColorStop(1, \"rgba(\" + color + \", 0)\");\n    ctx.beginPath();\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n  };\n\n  _proto._getAllLayerToRender = function _getAllLayerToRender() {\n    return this.map._getLayers();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto._updateCanvasSize = function _updateCanvasSize() {\n    if (!this.canvas || this._containerIsCanvas) {\n      return false;\n    }\n\n    var map = this.map,\n        mapSize = map.getSize(),\n        canvas = this.canvas,\n        r = map.getDevicePixelRatio();\n\n    if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n      return false;\n    }\n\n    canvas.height = r * mapSize['height'];\n    canvas.width = r * mapSize['width'];\n\n    if (canvas.style) {\n      canvas.style.width = mapSize['width'] + 'px';\n      canvas.style.height = mapSize['height'] + 'px';\n    }\n\n    return true;\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this._containerIsCanvas) {\n      this.canvas = this.map._containerDOM;\n    } else {\n      this.canvas = createEl('canvas');\n\n      this._updateCanvasSize();\n\n      this.map._panels.canvasContainer.appendChild(this.canvas);\n    }\n\n    this.context = this.canvas.getContext('2d');\n  };\n\n  _proto._checkSize = function _checkSize() {\n    if (!this.map || this.map.isInteracting()) {\n      return;\n    }\n\n    computeDomPosition(this.map._containerDOM);\n    this.map.checkSize();\n  };\n\n  _proto._setCheckSizeInterval = function _setCheckSizeInterval(interval) {\n    var _this3 = this;\n\n    clearInterval(this._resizeInterval);\n    this._checkSizeInterval = interval;\n    this._resizeInterval = setInterval(function () {\n      if (!_this3.map || _this3.map.isRemoved()) {\n        clearInterval(_this3._resizeInterval);\n      } else {\n        _this3._checkSize();\n      }\n    }, this._checkSizeInterval);\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    var _this4 = this;\n\n    var map = this.map;\n\n    if (map.options['checkSize'] && !IS_NODE && typeof window !== 'undefined') {\n      this._setCheckSizeInterval(map.options['checkSizeInterval']);\n    }\n\n    if (!Browser$1.mobile) {\n      map.on('_mousemove', this._onMapMouseMove, this);\n    }\n\n    map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', function (param) {\n      _this4._eventParam = param;\n    });\n    map.on('_zooming', function (param) {\n      if (!map.getPitch()) {\n        _this4._zoomMatrix = param['matrix']['container'];\n      }\n\n      _this4._eventParam = param;\n    });\n    map.on('_zoomend', function (param) {\n      _this4._eventParam = param;\n      delete _this4._zoomMatrix;\n    });\n    map.on('_spatialreferencechange', function () {\n      _this4._spatialRefChanged = true;\n    });\n\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      addDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n  };\n\n  _proto._onMapMouseMove = function _onMapMouseMove(param) {\n    var _this5 = this;\n\n    var map = this.map;\n\n    if (map.isInteracting() || !map.options['hitDetect']) {\n      return;\n    }\n\n    if (this._hitDetectFrame) {\n      cancelAnimFrame(this._hitDetectFrame);\n    }\n\n    this._hitDetectFrame = requestAnimFrame(function () {\n      _this5.hitDetect(param['containerPoint']);\n    });\n  };\n\n  _proto._getCanvasLayers = function _getCanvasLayers() {\n    return this.map._getLayers(function (layer) {\n      return layer.isCanvasRender();\n    });\n  };\n\n  _proto._onVisibilitychange = function _onVisibilitychange() {\n    if (document.visibilityState !== 'visible') {\n      return;\n    }\n\n    this.setToRedraw();\n  };\n\n  return MapCanvasRenderer;\n}(MapRenderer);\n\nMap$1.registerRenderer('canvas', MapCanvasRenderer);\nMap$1.mergeOptions({\n  'fog': false,\n  'fogColor': [233, 233, 233]\n});\nvar index$6 = /*#__PURE__*/Object.freeze({\n  ResourceCache: ResourceCache,\n  CanvasRenderer: CanvasRenderer,\n  ImageGLRenderable: ImageGLRenderable,\n  MapRenderer: MapRenderer,\n  MapCanvasRenderer: MapCanvasRenderer,\n  Renderable: Renderable,\n  ImageLayerCanvasRenderer: ImageLayerCanvasRenderer,\n  ImageLayerGLRenderer: ImageLayerGLRenderer,\n  TileLayerCanvasRenderer: TileLayerCanvasRenderer,\n  TileLayerGLRenderer: TileLayerGLRenderer,\n  CanvasTileLayerCanvasRenderer: CanvasRenderer$1,\n  CanvasTileLayerGLRenderer: GLRenderer,\n  OverlayLayerCanvasRenderer: OverlayLayerRenderer,\n  VectorLayerCanvasRenderer: VectorLayerRenderer,\n  CanvasLayerRenderer: CanvasLayerRenderer\n});\nvar CenterPointRenderer = {\n  _getRenderPoints: function _getRenderPoints() {\n    return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n  }\n};\nMarker.include(CenterPointRenderer);\nEllipse.include(CenterPointRenderer);\nCircle.include(CenterPointRenderer);\nSector.include(CenterPointRenderer);\nRectangle.include({\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n\n    if (placement === 'vertex') {\n      var shell = this._trimRing(this.getShell());\n\n      var points = [];\n\n      for (var i = 0, len = shell.length; i < len; i++) {\n        points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n      }\n\n      return [points, null];\n    } else {\n      var c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n      return [[c], null];\n    }\n  }\n});\nvar PolyRenderer = {\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var points,\n        rotations = null;\n\n    if (placement === 'point') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        points = points[0].concat(points[1]);\n      }\n    } else if (placement === 'vertex') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n      rotations = [];\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        for (var i = 0, l = points.length; i < l; i++) {\n          for (var ii = 0, ll = points[i].length; ii < ll; ii++) {\n            if (ii === 0) {\n              rotations.push([points[i][ii], points[i][ii + 1]]);\n            } else {\n              rotations.push([points[i][ii - 1], points[i][ii]]);\n            }\n          }\n        }\n\n        points = points[0].concat(points[1]);\n      } else {\n        for (var _i = 0, _l = points.length; _i < _l; _i++) {\n          if (_i === 0) {\n            rotations.push([points[_i], points[_i + 1]]);\n          } else {\n            rotations.push([points[_i - 1], points[_i]]);\n          }\n        }\n      }\n    } else if (placement === 'line') {\n      points = [];\n      rotations = [];\n\n      var vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n          isSplitted = vertice.length > 0 && Array.isArray(vertice[0]);\n\n      if (isSplitted) {\n        var ring;\n\n        for (var _i2 = 1, _l2 = vertice.length; _i2 < _l2; _i2++) {\n          ring = vertice[_i2];\n\n          if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n            ring.push(ring[0]);\n          }\n\n          for (var _ii = 1, _ll = ring.length; _ii < _ll; _ii++) {\n            points.push(ring[_ii].add(ring[_ii - 1])._multi(0.5));\n            rotations.push([ring[_ii - 1], ring[_ii]]);\n          }\n        }\n      } else {\n        if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n          vertice.push(vertice[0]);\n        }\n\n        for (var _i3 = 1, _l3 = vertice.length; _i3 < _l3; _i3++) {\n          points.push(vertice[_i3].add(vertice[_i3 - 1])._multi(0.5));\n          rotations.push([vertice[_i3 - 1], vertice[_i3]]);\n        }\n      }\n    } else if (placement === 'vertex-first') {\n      var coords = this._getPrjCoordinates();\n\n      points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n      rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n    } else if (placement === 'vertex-last') {\n      var _coords = this._getPrjCoordinates();\n\n      var _l4 = _coords.length;\n      points = _l4 ? [map._prjToPoint(_coords[_l4 - 1], glZoom)] : [];\n      var current = _l4 - 1,\n          previous = _l4 > 1 ? _l4 - 2 : _l4 - 1;\n      rotations = _l4 ? [[map._prjToPoint(_coords[previous], glZoom), map._prjToPoint(_coords[current], glZoom)]] : [];\n    } else {\n      var pcenter = this._getProjection().project(this.getCenter());\n\n      points = [map._prjToPoint(pcenter, glZoom)];\n    }\n\n    return [points, rotations];\n  }\n};\nLineString.include(PolyRenderer);\nPolygon.include(PolyRenderer);\nGeometry.include({\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return false;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return false;\n  }\n});\nvar el = {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return this instanceof Ellipse || this instanceof Sector;\n  },\n  _paintAsPath: function _paintAsPath() {\n    var map = this.getMap();\n    var altitude = this.getAltitude();\n    return altitude > 0 || map.getPitch() || this instanceof Ellipse && map.getBearing();\n  },\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pt = map._prjToPoint(pcenter, map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt].concat(size);\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      return Canvas.ellipse.apply(Canvas, arguments);\n    }\n  },\n  _getRenderSize: function _getRenderSize(pt) {\n    var map = this.getMap(),\n        z = map.getGLZoom();\n\n    var prjExtent = this._getPrjExtent();\n\n    var pmin = map._prjToPoint(prjExtent.getMin(), z),\n        pmax = map._prjToPoint(prjExtent.getMax(), z);\n\n    return [Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pt.y), Math.abs(pt.y - pmin.y)];\n  }\n};\nEllipse.include(el);\nCircle.include(el);\nRectangle.include({\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n    var pointZoom = map.getGLZoom();\n\n    var shell = this._getPrjShell();\n\n    var points = this._getPath2DPoints(shell, false, pointZoom);\n\n    return [points];\n  },\n  _paintOn: Canvas.polygon\n});\nSector.include(el, {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _getPaintParams: function _getPaintParams() {\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var map = this.getMap();\n\n    var pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt, size[0], [this.getStartAngle(), this.getEndAngle()]];\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      var r = this.getMap().getBearing();\n      var args = arguments;\n\n      if (r) {\n        args[3] = args[3].slice(0);\n        args[3][0] += r;\n        args[3][1] += r;\n      }\n\n      return Canvas.sector.apply(Canvas, args);\n    }\n  }\n});\nPath.include({\n  _paintAsPath: function _paintAsPath() {\n    return true;\n  }\n});\nLineString.include({\n  arrowStyles: {\n    'classic': [3, 4]\n  },\n  _getArrowShape: function _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n    if (!prePoint || !point || prePoint.equals(point)) {\n      return null;\n    }\n\n    if (!tolerance) {\n      tolerance = 0;\n    }\n\n    var width = lineWidth * arrowStyle[0],\n        height = lineWidth * arrowStyle[1] + tolerance,\n        hw = width / 2 + tolerance;\n    var normal;\n\n    if (point.nextCtrlPoint || point.prevCtrlPoint) {\n      if (point.prevCtrlPoint) {\n        normal = point.sub(new Point(point.prevCtrlPoint));\n      } else {\n        normal = point.sub(new Point(point.nextCtrlPoint));\n      }\n    } else {\n      normal = point.sub(prePoint);\n    }\n\n    normal._unit();\n\n    var p1 = point.sub(normal.multi(height));\n\n    normal._perp();\n\n    var p0 = p1.add(normal.multi(hw));\n\n    normal._multi(-1);\n\n    var p2 = p1.add(normal.multi(hw));\n    return [p0, point, p2, p0];\n  },\n  _getPaintParams: function _getPaintParams() {\n    var prjVertexes = this._getPrjCoordinates();\n\n    var points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    if (this.options['smoothness']) {\n      Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n    } else {\n      Canvas.path(ctx, points, lineOpacity, null, dasharray);\n    }\n\n    this._paintArrow(ctx, points, lineOpacity);\n  },\n  _getArrowPlacement: function _getArrowPlacement() {\n    return this.options['arrowPlacement'];\n  },\n  _getArrowStyle: function _getArrowStyle() {\n    var arrowStyle = this.options['arrowStyle'];\n\n    if (arrowStyle) {\n      return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n    }\n\n    return null;\n  },\n  _getArrows: function _getArrows(points, lineWidth, tolerance) {\n    var arrowStyle = this._getArrowStyle();\n\n    if (!arrowStyle || points.length < 2) {\n      return [];\n    }\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n    var segments = isSplitted ? points : [points];\n\n    var placement = this._getArrowPlacement();\n\n    var arrows = [];\n    var map = this.getMap(),\n        first = map.coordToContainerPoint(this.getFirstCoordinate()),\n        last = map.coordToContainerPoint(this.getLastCoordinate());\n\n    for (var i = segments.length - 1; i >= 0; i--) {\n      if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n        var arrow = this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance);\n\n        if (arrow) {\n          arrows.push(arrow);\n        }\n      }\n\n      if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n        var _arrow = this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      } else if (placement === 'point') {\n        this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n      }\n    }\n\n    return arrows;\n  },\n  _getArrowPoints: function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    for (var ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n      var arrow = this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n  },\n  _paintArrow: function _paintArrow(ctx, points, lineOpacity) {\n    var lineWidth = this._getInternalSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth) || lineWidth < 3) {\n      lineWidth = 3;\n    }\n\n    var arrows = this._getArrows(points, lineWidth);\n\n    if (!arrows.length) {\n      return;\n    }\n\n    if (ctx.setLineDash) {\n      ctx.setLineDash([]);\n    }\n\n    for (var i = arrows.length - 1; i >= 0; i--) {\n      ctx.fillStyle = ctx.strokeStyle;\n      Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n    }\n  }\n});\nPolygon.include({\n  _getPaintParams: function _getPaintParams(disableSimplify) {\n    var maxZoom = this.getMap().getGLZoom();\n\n    var prjVertexes = this._getPrjShell();\n\n    var points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      points = [[points[0]], [points[1]]];\n    }\n\n    var prjHoles = this._getPrjHoles();\n\n    var holePoints = [];\n\n    if (prjHoles && prjHoles.length > 0) {\n      var simplified = this._simplified;\n\n      for (var i = 0; i < prjHoles.length; i++) {\n        var hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n\n        if (Array.isArray(hole) && isSplitted) {\n          if (Array.isArray(hole[0])) {\n            points[0].push(hole[0]);\n            points[1].push(hole[1]);\n          } else {\n            points[0].push(hole);\n          }\n        } else {\n          holePoints.push(hole);\n        }\n      }\n\n      if (simplified) {\n        this._simplified = simplified;\n      }\n    }\n\n    if (!isSplitted) {\n      points = [points];\n      pushIn(points, holePoints);\n    }\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n  }\n});\nMap$1.VERSION = version;\nexport { index$1 as Util, dom as DomUtil, strings as StringUtil, index as MapboxUtil, Map$1 as Map, index$4 as ui, index$5 as control, index$6 as renderer, index$3 as symbolizer, Animation$1 as animation, Browser$1 as Browser, Ajax, Canvas, Promise$1 as Promise, Class, Eventable, JSONAble, Handlerable, Handler$1 as Handler, DragHandler, MapTool, DrawTool, AreaTool, DistanceTool, SpatialReference, INTERNAL_LAYER_PREFIX, GEOMETRY_COLLECTION_TYPES, GEOJSON_TYPES, RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES, NUMERICAL_PROPERTIES, COLOR_PROPERTIES, DEFAULT_TEXT_SIZE, projections as projection, index$2 as measurer, Coordinate, CRS, Extent, Point, PointExtent, Size, Transformation, Layer, TileLayer, GroupTileLayer, WMSTileLayer, CanvasTileLayer, ImageLayer, OverlayLayer, VectorLayer, CanvasLayer, ParticleLayer, TileSystem, TileConfig, ArcCurve, Circle, ConnectorLine, ArcConnectorLine, CubicBezierCurve, Curve, Ellipse, GeoJSON, Geometry, GeometryCollection, Label, LineString, Marker, MultiLineString, MultiPoint, MultiPolygon, Polygon, QuadBezierCurve, Rectangle, Sector, TextBox, TextMarker };","map":{"version":3,"sources":["/home/usuario/davi/thalamus/wms/3dmaptestes/client/node_modules/maptalks/dist/maptalks.es.js"],"names":["version","INTERNAL_LAYER_PREFIX","GEOMETRY_COLLECTION_TYPES","GEOJSON_TYPES","concat","RESOURCE_PROPERTIES","RESOURCE_SIZE_PROPERTIES","NUMERICAL_PROPERTIES","COLOR_PROPERTIES","DEFAULT_TEXT_SIZE","now","Date","extend","dest","i","arguments","length","src","k","isNil","obj","isNumber","val","isNaN","isInteger","n","isObject","isString","constructor","String","isFunction","Function","hasOwnProperty","Object","prototype","hasOwn","key","call","join","arr","seperator","Array","isEmpty","object","property","pi","Math","PI","toRadian","d","toDegree","r","IS_NODE","toString","process","versions","requestAnimFrame","cancelAnimFrame","fn","setTimeout","clearTimeout","requestFn","cancelFn","timeToCall","timeoutDefer","getPrefixed","name","window","id","isSVG","url","prefix","slice","loadImage","img","imgDesc","node","uid","UID","GUID","parseJSON","str","JSON","parse","pushIn","ii","ll","push","removeFromArray","array","indexOf","splice","forEachCoord","context","isArray","result","p","pp","len","getValueOrDefault","v","undefined","sign","x","Number","log2","log","LOG2E","rounded","round","abs","interpolate","a","b","t","wrap","min","max","w","clamp","isArrayHasData","urlPattern","isURL","test","cssUrlReWithQuote","cssUrlRe","isCssUrl","extractCssUrl","matches","exec","b64chrs","btoa","input","output","block","charCode","idx","map","charAt","charCodeAt","Error","b64toBlob","b64Data","contentType","byteCharacters","atob","arraybuffer","ArrayBuffer","view","Uint8Array","blob","Blob","type","computeDegree","x0","y0","x1","y1","dx","dy","atan2","emptyImageUrl","equalMapView","obj1","obj2","approx","expected","delta","flash","interval","count","cb","me","_flashTimeout","flashGeo","show","hide","_defaults","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","configurable","defineProperty","types","createFilter","filter","compile","op","compileComparisonOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","compilePropertyReference","substring","stringify","checkType","left","right","expressions","values","sort","compare","expression","getFilterFeature","geometry","json","_toJSON","g","compileStyle","styles","compiled","extend$1","createFunction","parameters","defaultType","fun","isFeatureConstant","isZoomConstant","isFunctionDefinition","zoomAndFeatureDependent","stops","featureDependent","zoomDependent","innerFun","evaluateExponentialFunction","evaluateIntervalFunction","evaluateCategoricalFunction","evaluateIdentityFunction","featureFunctions","featureFunctionStops","s","stop","zoom","default","z","feature","base","coalesce","c","interpolate$1","inputLower","inputUpper","outputLower","outputUpper","evaluatedLower","apply","evaluatedUpper","interpolateArray","interpolateNumber","difference","progress","ratio","pow","hasFunctionDefinition","interpolated","createFunction1","piecewiseConstant","loadFunctionTypes","argFn","hit","multResult","loaded","props","buildFn","get","set","enumerable","_i","getFunctionTypeResources","res","l","_fn","index","freeze","translateToSVGStyles","getMarkerPathBase64","symbol","width","height","svgStyles","_p","pathes","path","pathesToRender","svg","strPath","_p2","b64","getExternalResources","toAbsolute","symbols","resources","resSizeProp","h","convertResourceUrl","iii","_iii","_convertUrl","isGradient","getGradientStamp","getSymbolStamp","lowerSymbolOpacity","_symbol","_ratio","lower","extendSymbol","sources","args","parseStyleRootPath","style","root","iconset","replacer","match","convertStylePath","parseSymbolPath","URL_PATTERN","replace","parseStops","defaultValue","index$1","Browser","ua","navigator","userAgent","toLowerCase","doc","document","documentElement","ie","webkit","phantomjs","android23","search","chrome","gecko","opera","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","opera12","any3d","chromeVersion","touch","DocumentTouch","webgl","canvas","createElement","gl","getContext","WebGLRenderingContext","err","devicePixelRatio","screen","deviceXDPI","logicalXDPI","ielt9","addEventListener","edge","android","safari","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","language","browserLanguage","ie9","documentMode","ie10","Browser$1","_inheritsLoose","subClass","superClass","create","__proto__","_assertThisInitialized","self","ReferenceError","Position","y","_isNaN","_proto","_abs","_round","_ceil","ceil","distanceTo","point","sqrt","_floor","floor","copy","_add","add","nx","ny","_sub","_substract","sub","substract","multi","_multi","div","_div","equals","isZero","toArray","toFixed","toJSON","Point","_Position","closeTo","mag","unit","_unit","perp","_perp","angleWith","angleWithSep","_rotate","angle","cos","sin","rotate","Size","size","toPoint","trim","specialPattern","escapeSpecialChars","splitWords","chr","split","rulerCtx","stringWidth","text","font","measureText","stringLength","getFontHeight","domRuler","getDomRuler","innerHTML","clientHeight","removeDomNode","splitContent","content","wrapWidth","textWidth","chrWidth","minChrCount","testStr","prew","contentExpRe","replaceVariable","getAlignPoint","horizontalAlignment","verticalAlignment","alignW","alignH","DEFAULT_FONT","getFont","splitTextToRow","lineSpacing","textHeight","wrapChar","textRows","actualWidth","texts","tWidth","contents","_contents","_w","rowNum","textSize","strings","first","testProp","TRANSFORM","TRANSFORMORIGIN","TRANSITION","CSSFILTER","createEl","tagName","className","el","setClass","createElOn","container","setStyle","appendChild","parentNode","removeChild","addDomEvent","typeArr","handler","eventHandler","e","event","listensDomEvent","removeDomEvent","callback","capture","passive","doRemove","removeEventListener","handlers","j","jlen","hitHandler","preventDefault","returnValue","stopPropagation","cancelBubble","preventSelection","dom","onselectstart","ondragstart","setAttribute","offsetDom","offset","setTransform","top","computeDomPosition","getComputedStyle","padding","parseInt","rect","getBoundingClientRect","offsetWidth","offsetHeight","scaleX","scaleY","__position","getEventContainerPoint","ev","domPos","clientX","clientLeft","clientY","clientTop","endsWith","suffix","strCss","cssText","hasClass","classList","contains","getClass","RegExp","addClass","classes","baseVal","setOpacity","opacity","pos","setTransformMatrix","m","removeTransform","isHTML","measureDom","parentTag","ruler","clientWidth","tag","span","body","on","off","Ajax","jsonp","script","data","getElementsByTagName","options","client","_getClient","open","headers","setRequestHeader","withCredentials","credentials","responseType","send","post","postData","_t","_wrapCallback","readyState","status","response","byteLength","cacheControl","getResponseHeader","expires","responseText","statusText","XMLHttpRequest","ActiveXObject","onreadystatechange","getArrayBuffer","getImage","imgData","onerror","URL","webkitURL","onload","revokeObjectURL","createObjectURL","getJSON","resp","DEFAULT_STROKE_COLOR","DEFAULT_FILL_COLOR","DEFAULT_TEXT_COLOR","hitTesting","TEMP_CANVAS","RADIAN","textOffsetY","Canvas","setHitTesting","testing","createCanvas","canvasClass","prepareCanvasFont","ctx","textBaseline","fill","fillStyle","getRgba","prepareCanvas","strokeWidth","lineWidth","strokePattern","strokeColor","strokeStyle","patternOffset","_setStrokePattern","_createGradient","lineJoin","lineCap","setLineDash","polygonPattern","fillImgUrl","extractImageUrl","fillTexture","Image","image","console","warn","createPattern","extent","gradient","places","getMin","getMax","getWidth","getHeight","createLinearGradient","getCenter","createRadialGradient","forEach","addColorStop","linePatternOffset","imgUrl","imageTexture","imageRes","patternCanvas","addResource","clearRect","x2","y2","_drawn","fillCanvas","fillOpacity","isPattern","_isPattern","alpha","globalAlpha","translate","color","drawImage","error","_text","pt","textDesc","_textOnMultiRow","splitTextSize","ptAlign","lineHeight","basePoint","maxHeight","rowAlign","_textOnLine","textHaloRadius","textHaloFill","textHaloAlpha","drawHalo","gco","shadowBlur","shadowOffsetX","shadowOffsetY","miterLimit","strokeText","globalCompositeOperation","fillText","rgba","_stroke","strokeOpacity","stroke","_path","points","lineDashArray","lineOpacity","ignoreStrokePattern","fillWithPattern","p1","p2","degree","save","cosd","restore","isDashed","isPatternLine","prePoint","nextPoint","lineTo","beginPath","moveTo","drawDashLine","_multiClip","polygon","smoothness","isMultiClip","fillFirst","savedCtx","copyProperties","_ring","paintSmoothLine","closePath","ring","ignorePattern","smoothValue","close","tailIdx","tailRatio","interpolate$$1","t0","t1","bx1","by1","bx2","by2","u0","u1","qxa","qxb","qxc","qxd","qya","qyb","qyc","qyd","xb","xc","xd","yb","yc","yd","getCubicControlPoints","x3","y3","xc1","yc1","xc2","yc2","xc3","yc3","len1","len2","len3","k1","k2","xm1","ym1","xm2","ym2","ctrl1X","ctrl1Y","ctrl2X","ctrl2Y","ctrlPoints","preCtrlPoints","bezierCurveTo","lastPoint","prevCtrlPoint","nextCtrlPoint","_arcBetween","dist","p1p2","asin","cp2","da","cx","cy","startAngle","endAngle","arc","_lineTo","bezierCurveAndFill","start","_bezierCurveTo","p3","ellipse","heightTop","heightBottom","bezierEllipse","b1","ox","oy","oy1","rectangle","sector","angles","rad","radius","sDeg","eDeg","drawCross","target","startPoint","endPoint","dashArray","fromX","fromY","toX","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","offsetX","offsetY","dash","ang","lineDashOffset","shadowColor","commonjsGlobal","global","createCommonjsModule","module","exports","zousanMin","resolve","reject","o","u","f","MutationObserver","observe","attributes","setImmediate","state","TypeError","then","suppressUncaughtRejectionError","stack","_catch","_finally","timeout","all","define","amd","Zousan","soon","promise","Promise","Promise$1","Eventable","Base","_Base","_class","on$$1","eventsOn","_switch","_eventMap","eventTypes","evtType","handlerChain","once","_wrapOnceHandler","evetTypes","off$$1","eventsOff","eventType","listeners","wrapKey","jl","listener","listens","getListeningEvents","copyEventListeners","eventMap","fire","_eventParent","_fire","called","onceHandler","to","eventKeys","_clearListeners","_clearAllListeners","_setEventParent","parent","_setEventTarget","_eventTarget","param","queue","bubble","passed","Handler","enable","_enabled","addHooks","disable","removeHooks","enabled","remove","Handler$1","Class","setOptions","callInitHooks","proto","getPrototypeOf","_visitInitHooks","config","conf","onConfig","_initHooksCalled","parentProto","hooks","_initHooks","addInitHook","_len","_key","init","include","mergeOptions","registeredTypes","JSONAble","registerJSONType","getJSONClass","getJSONType","_jsonType","clazz","Handlerable","addHandler","handlerClass","_handlers","removeHandler","_clearHandlers","START_EVENTS","MOVE_EVENTS","mousedown","touchstart","pointerdown","MSPointerDown","END_EVENTS","DragHandler","_Handler","_this","_onMouseDown","onMouseDown","_offEvents","button","touches","setCapture","captureEvents","MOUSEMOVE","MOUSEUP","moved","actual","startPos","onMouseMove","onMouseUp","interupted","newPos","changedTouches","Coordinate","toNumberArrays","coordinates","coord","toCoordinates","child","CRS","properties","createProj4","proj","fromProjectionCode","code","toUpperCase","WGS84","EPSG4326","EPSG3857","IDENTITY","CGCS2000","EPSG4490","BD09LL","GCJ02","TEMP_POINT0","TEMP_COORD0","TEMP_COORD1","TEMP_COORD2","TEMP_COORD3","TEMP_COORD4","TEMP_COORD5","TEMP_COORD6","TEMP_COORD7","MINMAX","TEMP_EXTENT","TEMP_COMBINE","Extent","p4","_clazz","unproject","projection","_dirty","_initialize","xmin","xmax","ymin","ymax","_scale","out","isValid","ext2","intersects","_project","rxmin","rymin","rxmax","rymax","within","pxmin","pxmax","pymin","pymax","project","getSize","__combine","inited","_combine","ext","combine","intersection","expand","distance","_expand","convertTo","minmax","projectCoords","PointExtent","_Extent","Transformation","matrix","transform","scale","untransform","Common","isSphere","coords","circum","getCircum","getSphereExtent","sx","sy","wrapX","wrapY","pre","current","prj","unprojectCoords","projCoords","sphere","isOutSphere","pcoord","wrapCoord","wrapped","Common$1","measureLength","c1","c2","measureLenBetween","Identity","measureArea","area","locate","xDist","yDist","_locate","pivot","tmp","Sphere","ry","rx","initialAngle","rhumbBearing","finalAngle","calculateRhumbDestination","end","bear360","final","calculateRhumbBearing","bear180","from","phi1","phi2","deltaLambda","deltaPsi","tan","theta","origin","bearing","lambda1","DeltaPhi","DeltaPsi","q","DeltaLambda","lambda2","WGS84Sphere","BaiduSphere","DEFAULT","measurers","registerMeasurer","measure","Measurer","getInstance","mName","index$2","metersPerDegree","maxLatitude","lnglat","lng","lat","pLnglat","atan","exp","PROJ4326","Projection_EPSG4490","Projection_Baidu","convertLL2MC","convertMC2LL","EARTHRADIUS","MCBAND","LLBAND","MC2LL","LL2MC","cB","cE","cD","T","convertor","cC","getLoop","getRange","toRadians","toDegrees","Infinity","Projection_IDENTITY","DEFAULT$1","projections","BAIDU","Renderable","registerRenderer","_rendererClasses","getRendererClass","CanvasRenderer","_Class","layer","_painted","_drawTime","setToRedraw","render","framestamp","prepareRender","getMap","isVisible","ResourceCache","checkAndDraw","_tryToDraw","drawFn","_this2","checkResources","_loadingResource","loadResources","testIfNeedRedraw","_toRedraw","isInteracting","drawOnInteracting","needToRedraw","getRenderer","isViewChanged","getPitch","isMoving","isZooming","isRotating","onSkipDrawOnInteracting","isLoadingResource","isRenderComplete","_renderComplete","mustRenderOnInteracting","setCanvasUpdated","_canvasUpdated","isCanvasUpdated","onRemove","southWest","canvasExtent2D","_extent2D","onAdd","getCanvasImage","_renderZoom","getZoom","isBlank","containerPoint","_pointToContainerPoint","clear","clearCanvas","setZIndex","hitDetect","_errorThrown","getDevicePixelRatio","getImageData","resourceUrls","promises","cache","isResourceLoaded","_promiseResource","_get2DExtent","_containerPointToPoint","_canvas","CanvasClass","onCanvasCreate","createContext","dpr","resetCanvasTransform","resizeCanvas","canvasSize","_maskExtent","mask","getMask","maskExtent2D","_getMaskPainter","get2DExtent","clipCanvas","old","getGeometries","masks","_mask","painter","paint","clip","getViewExtent","completeRender","getEvents","onZoomStart","onZooming","onZoomEnd","onResize","onMoveStart","onMoving","onMoveEnd","onDragRotateStart","onDragRotating","onDragRotateEnd","onSpatialReferenceChange","getDrawTime","_drawAndRecord","painted","draw","getId","crossOrigin","_cacheResource","onabort","markErrorResource","_errors","_proto2","checkSVG","_getImgUrl","merge","clipLine","bounds","noCut","parts","segment","clipSegment","_lastCode","useLastCode","codeA","_getBitCode","codeB","codeOut","newCode","_getEdgeIntersection","clipPolygon","edges","clippedPoints","_code","withInEllipse","center","southeast","tolerance","xfocus","f1","f2","Symbolizer","getPainter","isDynamicSize","testColor","prop","CanvasSymbolizer","_Symbolizer","_prepareContext","isHitTesting","_defineStyle","set$1","getProperties","setProp","getBearing","bind","a0","a1","TEMP_POINT0$1","TEMP_POINT1","PointSymbolizer","_CanvasSymbolizer","glZoom","getGLZoom","renderPoints","_getRenderPoints","_pointToPoint","_rotateExtent","fixedExtent","placement","isSpriting","getPlacement","getRenderPoints","_getRenderContainerPoints","ignoreAltitude","dxdy","getDxDy","cpoints","_pointContainerPoints","flat","_getRotationAt","getRotation","rotations","p0","isTransforming","maxZoom","rotation","VectorMarkerSymbolizer","_PointSymbolizer","_dynamic","strokeAndFill","translateLineAndFill","symbolize","cookedPoints","getLayer","_drawMarkers","_drawMarkersWithCache","_drawVectorMarker","stamp","_stampSymbol","_createMarkerImage","anchor","_getAnchor","_calMarkerSize","_size","shadow","_getCacheImageAnchor","_stamp","margin","markerType","_getGraidentExtent","getFixedExtent","vectorArray","_getVectorPoints","gradientExtent","hLineWidth","_j","_j2","_lineCap","alignPoint","ha","va","hh","hw","v0","v1","v2","v3","extWidth","DebugSymbolizer","outline","getContainerExtent","cross","ImageMarkerSymbolizer","_getImage","_url","imgURL","removeCache","TEMP_COORD0$1","TEMP_COORD1$1","StrokeAndFillSymbolizer","paintParams","_getPaintParams","isGradient$$1","isPath","isSplitted","params","_paintOn","_params","_getPrjExtent","_extMin","_extMax","_prjToPoint","_pxExtent","getPaintParams","lineColor","grad","CACHE_KEY","TextMarkerSymbolizer","textContent","_cacheKey","genCacheKey","_descText","_measureText","_loadFromCache","_storeToCache","active","desc","VectorPathMarkerSymbolizer","_ImageMarkerSymbolize","renderer","defaultSymbol","polygonFill","polygonOpacity","DrawAltitudeSymbolizer","_getStyle","groundPoints","_drawLineAltitude","groundPoint","_drawMarkerAltitude","_drawLine","index$3","registerSymbolizers","testCanvas","TEMP_POINT0$2","TEMP_PAINT_EXTENT","TEMP_EXTENT$1","TEMP_FIXED_EXTENT","TEMP_CLIP_EXTENT0","TEMP_CLIP_EXTENT1","Painter","symbolizers","_createSymbolizers","_altAtGLZoom","_getGeometryAltitude","geoSymbol","getSymbol","regSymbolizers","symbolizer","_hasPoint","getType","_debugSymbolizer","hasPoint","_renderPoints","getResolution","pitched","rotated","_cachedParams","paintAsPath","_paintAsPath","_unsimpledParams","_res","_pitched","_redrawWhenPitch","_rotated","_redrawWhenRotate","_simplified","zoomScale","getGLScale","tr","mapExtent","cPoints","_hitPoint","disableClip","pointPlacement","_aboveCamera","containerOffset","pointContainerPoint","alt","altitude","getAltitude","clipped","_clip","clipPoints","cring","cc","extent2D","cameraLookAt","cameraPosition","glExtent2D","_glScale","getShell","getHoles","part","_interpolateSegAlt","clipSegs","orig","segsWithAlt","interpolateAlt","cp","_getInternalSymbol","_getRenderer","minAltitude","getMinAltitude","frustumAlt","getFrustumAltitude","_beforePaint","contexts","_prepareShadow","_afterPaint","getSprite","_spriting","_sprite","markerExtent","bak","hitTest","_eachSymbolizer","_verifyProjection","_isDynamicSize","_zoom","_fixedExtent","_computeExtent2D","_computeFixedExtent","_this$_fixedExtent","glScale","maxAltitude","getMaxAltitude","extent2","groundExtent","change","isCanvasRender","repaint","refreshSymbol","_removeSymbolizers","_paintParams","propAlt","_propAlt","MAX_VALUE","MIN_VALUE","_meterToPoint","distanceToPoint","_getProjection","_projCode","textcache","w0","w1","TEMP_EXTENT$2","CollectionPainter","isMask","_eachPainter","geometries","_getPainter","DefaultSpatialReference","resolutions","SpatialReference","_initSpatialRef","getProjectionInstance","prjName","sp1","sp2","fullExtent","bottom","r1","r2","_projection","defaultSpatialRef","isEPSG","_resolutions","_fullExtent","_transformation","getResolutions","next","getProjection","getFullExtent","getTransformation","getMinZoom","getMaxZoom","getZoomDirection","Geometry","_JSONAble","opts","setSymbol","setProperties","setId","getFirstCoordinate","getCoordinates","getLastCoordinate","addTo","fitview","addGeometry","_layer","_id","oldId","_fireEvent","_getParent","_repaint","_prepareSymbol","onSymbolChanged","updateSymbol","_getSymbol","_eventSymbolProperties","_computeCenter","_getMeasurer","getExtent","prjExt","_computeExtent","containsPoint","coordToContainerPoint","_containsPoint","_hitTestTolerance","onHide","getZIndex","zIndex","setZIndexSilently","bringToFront","getGeoMaxZIndex","topZ","bringToBack","getGeoMinZIndex","bottomZ","translated","setCoordinates","flash$$1","ret","fromJSON","_unbind","toGeoJSONGeometry","gJson","_exportGeoJSONGeometry","toGeoJSON","geoJSON","_exportProperties","other","_exportGraphicOptions","getLength","_computeGeodesicLength","getArea","_computeGeodesicArea","measurer","_getConnectPoints","_initOptions","_bindLayer","_clearCache","cookedSymbols","_checkAndCopySymbol","_setExternSymbol","_externSymbol","_extent","_computePrjExtent","_animPlayer","finish","_unbindMenu","_unbindInfoWindow","isEditing","endEdit","_removePainter","onRemoveGeometry","_internalId","_getInternalId","_setInternalId","_clearProjection","_getExternalResources","_painter","getCollectionPainterClass","getPainterClass","_maskPainter","_paint","closeMenu","closeInfoWindow","onShapeChanged","onPositionChanged","needRepaint","_setParent","_parent","eventName","_onGeometryEvent","_infoWinOptions","geoProperties","layerOpts","layerAltitude","options$1","Layer","setMask","load","onLoad","_initRenderer","_renderer","onLoadEnd","addLayer","_zIndex","_sortLayersByZIndex","minZoom","getOpacity","layers","_getLayerList","topLayer","bottomLayer","_this3","removeLayer","_isVectorMarker","removeMask","isLoaded","_loaded","onRendererCreate","_bindMap","_switchEvents","_doRemove","emitter","_layers","_getMask2DExtent","_onLayerEvent","options$2","Map$1","_Handlerable","Map","baseLayer","VERSION","writable","_initContainer","_panels","_baseLayer","_zoomLevel","_center","setSpatialReference","setMaxExtent","_mapViewPoint","_updateMapSize","_getContainerDomSize","setBaseLayer","_Load","addOnLoadHook","_onLoadHooks","getContainer","_containerDOM","getSpatialReference","_spatialReference","ref","oldRef","_updateSpatialReference","_resetMapStatus","setCursor","cursor","_cursor","_trySetCursor","resetCursor","_prjCenter","setCenter","pcenter","_verifyExtent","_setPrjCenter","_parseEventFromCoord","visualHeight","pitch","maxVisualPitch","_getVisualHeight","visualPitch","fov","getFov","cameraToCenter","cameraCenterDistance","tanB","tanP","visualDistance","_pointToExtent","getProjExtent","_pointToPrj","getPrjExtent","getMaxExtent","maxExt","_getPrjCenter","_panTo","_prjMaxExtent","getZoomForScale","fromZoom","isFraction","_getResolution","targetRes","scaleZoom","getZoomFromRes","_getResolutions","minRes","maxRes","gap","setZoom","_zoomAnimation","getMaxNativeZoom","setMaxZoom","viewMaxZoom","setMinZoom","viewMinZoom","zoomIn","zoomOut","_zooming","setCenterAndZoom","animation","getFitZoom","containerExtent","getView","setView","setPitch","setBearing","getScale","fitExtent","zoomOffset","step","_animateTo","getBaseLayer","isChange","onbaseLayerload","removeBaseLayer","getLayers","_getLayers","_layerCache","mapLayers","removed","_removeLayer","setLayerCanvasUpdated","sortLayers","layersToOrder","minZ","_l","toDataURL","mimeType","file","dataURL","dlLink","download","href","click","coordToPoint","coordinate","coordinateToPoint","pointToCoord","pointToCoordinate","coordToViewPoint","coordinateToViewPoint","viewPointToCoord","viewPoint","viewPointToCoordinate","coordinateToContainerPoint","containerPointToCoord","containerPointToCoordinate","containerPointToViewPoint","getViewPoint","viewPointToContainerPoint","checkSize","justStart","_initTime","watched","oldHeight","oldWidth","vh","nwCP","nwCoord","_containerPointToPrj","vhAfter","nwCPAfter","_setPrjCoordAtContainerPoint","_mapViewCoord","hided","_eventSilence","getMainPanel","getPanels","isRemoved","_removeDomEvents","childNodes","_moving","prjCenter","_originCenter","_parseEvent","_dragRotating","isDragRotating","getElementById","_priorityCursor","_setCursorToPanel","_setPriorityCursor","hasCursor","panel","layerList","_order","_loadAllLayers","_callOnLoadHooks","loadLayer","_eachLayer","layerLists","_calcMatrices","resetContainer","containerDOM","mSize","updateMapSize","_offsetCenterByPixel","pixel","pCenter","offsetPlatform","_getViewPointFrameOffset","panelOffset","_resetMapViewPoint","_mapRes","_mapGlRes","pCoord","_pointToPointAtZoom","COORD","prjCoord","_prjToViewPoint","_viewPointToPrj","pCoordinate","_prjToContainerPoint","containerToExtent","POINT0","POINT1","distanceToPixel","POINT","paramCenter","pixelToDistance","COORD0","COORD1","fullExt","pointToDistance","locateByPoint","px","py","_this4","cached","_mapExtent2D","_mapGlExtent2D","cExtent","min2d","max2d","_ref","minx","maxx","_ref2","miny","maxy","_viewPointToPoint","_pointToViewPoint","MapDoubleClickZoomHandler","_onDoubleClick","oldZoom","MapDragHandler","mapWrapper","_dragHandler","_cancelOn","_onDragStart","_onDragging","_onDragEnd","domEvent","_ignore","_ignoreEvent","startDragTime","_mode","ctrlKey","_stopAnim","_mapAnimPlayer","_moveStart","_rotateStart","_isEventOutMap","_rotating","_moveEnd","_rotateEnd","startBearing","_start","preX","preY","startX","startY","_getActualEvent","startPrjCoord","mx","my","_clear","panBy","_rotateMode","_db","prePitch","preBearing","db","_bearing","EVENTS","MapGeometryEventsHandler","allLayers","_identifyGeometryEvents","identify","oneMoreEvent","_mouseDownTime","downTime","time","geometryCursorStyle","identifyOptions","eventToFire","_getEventTypeToFire","fireGeometryEvent","_queryIdentifyTimeout","callInNextFrame","propagation","geoMap","geo","iid","_onEvent","_prevOverGeos","geomap","oldTargets","geos","oldTarget","oldTargetId","_i2","wheelZoomDelta","defaultZoomRate","wheelZoomRate","maxScalePerFrame","MapScrollWheelZoomHandler","_thisScrollZoom","_scrollZoom","_wheelZoomRate","_defaultZoomRate","_delta","_onWheelScroll","evt","_checkZoomOrigin","_trackPadSuspect","_ensureTrackpad","_seamless","_interval","deltaMode","WheelEvent","DOM_DELTA_LINE","deltaY","shiftKey","_lastWheelEvent","_zoomOrigin","_active","zoomRate","targetZoom","_timeout","_requesting","levelValue","wheelDelta","detail","nextZoom","_checkZoom","_origin","_startZoom","duration","frame","playState","MapTouchZoomHandler","_onTouchStart","_startP1","_startP2","_startDist","_startVector","_startBearing","_onTouchMove","_onTouchEnd","d1","d2","vector","mode","_startTouching","_Origin","KEY","Easing","in","_in","inAndOut","linear","upAndDown","Frame","Player","onFrame","_animation","_onFrame","ready","finished","Animation","speed","_resolveStyles","resolveChild","_styles","resolveVal","isChild","childStyles","framing","easing","dStyles","startStyles","destStyles","deltaStyles","_startStyles","_dStyles","children","elapsed","_requestAnimFrame","_frameQueue","_a","_animationFrameId","_frameFn","_run","running","animate","player","_prepare","_framer","play","currentTime","startTime","_playStartTime","pause","cancel","reverse","_frame","Animation$1","simplify","getSqDist","getSqSegDist","simplifyRadialDist","sqTolerance","prevPoint","newPoints","simplifyDPStep","last","simplified","maxSqDist","sqDist","simplifyDouglasPeucker","highestQuality","options$3","Path","_Geometry","getOutline","Polygon","animateShow","_showPlayer","_animIdx","_animLenSoFar","isPolygon","animCoords","prjAnimCoords","_prjAniShowCenter","_aniShowCenter","_coordinates","currentCoord","_drawAnimShowFrame","_animTailRatio","prjCoords","targetLength","segLen","lastCoord","targetCoord","_setPrjCoordinates","_animCoords","_prjAnimCoords","_getCenterInExtent","clipFn","meExtent","sumx","sumy","counter","_getPath2DPoints","disableSimplify","isSimplify","_shouldSimplify","isMulti","hasAltitude","prjPoints","_prjCoords","_getPrjCoordinates","_projectCoords","_updateCache","_unprojectCoords","shell","rings","hasHoles","_coords2Extent","_getPrjHoles","_get2DLength","vertexes","JSON_TYPE","_Path","_holes","_projectRings","_trimRing","holes","_copyAndCloseRing","getCenterInExtent","_prjHoles","_cleanRing","_checkRing","isClose","_getPrjShell","_prjShell","CenterMixin","_getCenter2DPoint","_pcenter","options$4","Marker","_CenterMixin","_canEdit","computeExtent","_getSprite","options$5","LineString","GeometryCollection","setGeometries","_geometries","_checkGeometries","_bindGeometriesToLayer","selected","isFn","isEmpty$$1","is","invalidGeoError","_checkGeo","sumX","sumY","computeExtent$1","anchors","startEdit","_originalSymbol","_draggbleBeforeEdit","_editing","geoExtent","MultiGeometry","_GeometryCollection","geoType","GeometryType","_initData","MultiPoint","_MultiGeometry","findClosest","MultiPath","MultiLineString","_MultiPath","MultiPolygon","types$1","GeoJSON","toGeometry","foreachFn","resultGeos","_convert","resultGeo","features","_result2","mGeos","_result","options$6","Circle","circle","_radius","getRadius","setRadius","numberOfPoints","vertex","se","_getMinMax","pminmax","leftx","rightx","topy","bottomy","options$7","Ellipse","setWidth","setHeight","deg","pps","longer","Rectangle","_Polygon","_width","_height","nw","fExt","_pnw","pnw","sphereExtent","_getSouthEast","prjs","options$8","Sector","_Circle","getStartAngle","setStartAngle","getEndAngle","setEndAngle","pc","sAngle","eAngle","between","options$9","Curve","_LineString","_arc","ctrlPoint","_quadraticCurve","quadraticCurveTo","_bezierCurve","_getCurveArrowPoints","arrows","segments","arrowStyle","arrow","_getArrowShape","_arrow","options$a","ArcCurve","_Curve","_paintArrow","CubicBezierCurve","curve","_getArrowPoints","QuadBezierCurve","defaultSymbol$1","defaultBoxSymbol","TextMarker","_Marker","getContent","_content","setContent","_refresh","_refreshing","_parseSymbol","setTextStyle","getTextStyle","setTextSymbol","setBoxStyle","_style","getBoxStyle","setBoxSymbol","_getTextSize","_getDefaultTextSymbol","_getDefaultBoxSymbol","_getDefaultPadding","options$b","TextBox","_TextMarker","boxSymbol","textStyle","getBoxSymbol","textBox","maxWidth","hAlign","vAlign","options$c","textSymbol","Label","boxStyle","getTextSymbol","label","sizes","_getBoxSize","boxSize","textAlignPoint","Connectable","_hasConnectors","__connectors","_getConnectors","getConnectSource","_connSource","setConnectSource","_connTarget","getConnectTarget","setConnectTarget","_updateCoordinates","_registerEvents","srcPoints","targetPoints","minDist","oldCoordinates","computeLength","_showConnect","trigger","options$d","showOn","ConnectorLine","_Connectable","ArcConnectorLine","_Connectable2","options$e","OverlayLayer","_Layer","_maxZIndex","_minZIndex","_initCache","getGeometryById","_geoMap","_geoList","filtered","getFirstGeometry","getLastGeometry","getCount","copyOnWrite","fitView","_toSort","onGeometryAdd","animateTo","zoomAnimationDuration","_updateZIndex","geoId","internalId","onAddGeometry","_cookedStyles","_styleGeometry","removeGeometry","_clearing","onGeometryRemove","_findInList","getStyle","removeStyle","_sortGeometries","_compare","low","high","middle","_onGeometryIdChange","_onGeometryZIndexChange","_onGeometryPositionChange","_onGeometryShapeChange","_onGeometrySymbolChange","_onGeometryShow","_onGeometryHide","_onGeometryPropertiesChange","onGeometryZIndexChange","onGeometryPositionChange","onGeometryShapeChange","onGeometrySymbolChange","onGeometryShow","onGeometryHide","onGeometryPropertiesChange","TEMP_EXTENT$3","options$f","VectorLayer","_OverlayLayer","_hitGeos","hits","_getArrowStyle","profile","clipExtent","geoJSONs","geoExt","MapTool","_Eventable","_map","onEnable","onDisable","isEnabled","events","options$g","registeredMode","DrawTool","_MapTool","registerMode","modeAction","getRegisterMode","_checkMode","_events","_clickHandler","_mouseMoveHandler","_doubleClickHandler","_mouseDownHandler","_mouseUpHandler","getMode","setMode","_geometry","_clearStage","_restoreMapCfg","_saveMapCfg","getCurrentGeometry","_drawToolLayer","_getDrawLayer","_loadResources","_mapAutoPanAtEdge","autoPanAtEdge","endDraw","undo","_getRegisterMode","action","_shouldRecordHistory","_historyPointer","_clickCoords","update","redo","actions","_mapDoubleClickZoom","_mapDraggable","_createGeometry","drawTool","_addGeometryToStage","_getMouseContainerPoint","_isValidContainerPoint","clickCoords","drawLayer","_ending","mapSize","drawLayerId","drawToolLayer","MapBoxZoomHander","_boxZoom","markerWidth","markerHeight","PANOFFSET","MapAutoPanAtEdgeHandler","_onMouseMove","currView","empty","_from","_to","_isInternalAnimation","_prevAnimPlayer","zoomOrigin","framer","_interupted","_endAnim","_startAnim","isAnimating","_animRotating","endCoord","_endCoord","_resumePrev","prevPlayer","_registerDomEvents","_handleDOMEvent","mimicClick","_fireDOMEvent","_clickTime","control","srcElement","preTarget","actualEvent","eventPos","eventParam","isFullScreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","requestFullScreen","_requestFullScreen","cancelFullScreen","_cancelFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullScreen","availWidth","availHeight","newWin","location","opener","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","panTo","_panAnimation","setInfoWindow","layerJSON","layerType","extraLayerOptions","layersJSON","exportOption","_opts","layerJSONs","coord1","coord2","computeGeometryLength","computeGeometryArea","reqLayers","layerHits","_frameZoom","startScale","_startZoomAnim","endScale","_startZoomVal","_startZoomCoord","frameZoom","_zoomTo","fromRes","originOffset","startZoomVal","perspective","fovy","aspect","near","far","nf","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","rotateX","rotateZ","multiply","a30","a31","a32","a33","b0","b2","b3","invert","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","identity","set$2","subtract","normalize","dot","scale$1","ax","ay","az","bx","by","bz","hypot","transformMat4","applyMatrix","matrixToQuaternion","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","quaternionToMatrix","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","setPosition","lookAt","eye","up","RADIAN$1","DEFAULT_FOV","TEMP_COORD","_fov","setFov","_renderLayers","_angle","_pitch","_frustumAltitude","_calcFrustumAltitude","cameraAlt","_projIfBehindCamera","cameraForward","projViewMatrix","w2","h2","centerPoint","vectorFromCam","position","cameraPos","camForward","camNormDot","coord0","projViewMatrixInverse","z0","z1","_x","_y","scale$$1","m0","createMat4","m1","worldMatrix","_getCameraWorldMatrix","farZ","_getCameraFar","cameraFar","cameraNear","projMatrix","viewMatrix","_calcCascadeMatrixes","domCssMatrix","_calcDomMatrix","tanFov","cal","curPitch","cascadePitch0","cascadePitch1","projViewMatrix0","cascadeFrustumMatrix0","projViewMatrix1","cascadeFrustumMatrix1","minusY","cameraToCenterDistance","targetZ","center2D","_getFovRatio","cz","cameraUp","cameraWorldMatrix","_onViewChange","_viewHistory","_viewHistoryPointer","_getCurrentView","_fireViewChange","zoomToPreviousView","hasPreviousView","_zoomToView","zoomToNextView","hasNextView","getViewHistory","options$h","DistanceTool","_DrawTool","_afterEnable","_afterDisable","_measureLayers","_lastMeasure","_lastVertex","getMeasureLayers","getLastMeasure","_vertexes","marker","_measureMarkerLayer","_measure","toMeasure","units","_registerMeasureEvents","_msOnDrawStart","_msOnDrawVertex","_msOnMouseMove","_msOnDrawEnd","layerId","markerLayerId","_measureLineLayer","startLabel","_addVertexMarker","ms","_msGetCoordsToMeasure","_tailMarker","_tailLabel","vertexLabel","_clearTailMarker","_addClearMarker","dxSymbol","endMarker","measureLineLayer","measureMarkerLayer","options$i","AreaTool","_DistanceTool","sqmi","vertexMarker","endLabel","circleHooks","prjPath","nextCoord","generate","ellipseHooks","rectangleHooks","_firstClick","firstClick","polygonHooks","line","pSymbol","lineStringHooks","arcConf","tileInfo","tileSize","lods","tileSystem","loadArcgis","spatialRef","strReplace","repArray","rep","template","parseWMTSXML","requestUrl","parser","DOMParser","xmlDoc","parseFromString","querySelectorAll","TileMatrixSets","nodeName","layerName","resourceURL","_parseTileMatrixSet","parseTileMatrixSet","TileMatrixSet","substr","lastIndexOf","urlTemplate","spatialReference","info","TileMatrixs","tset","supportedCRS","transformValue","isArcgis","minLevel","_index","TileMatrix","level","ScaleDenominator","TopLeftCorner","TileWidth","TileHeight","_TopLeftCorner$split$","parseFloat","loadWMTS","xml","options$j","UIComponent","owner","_owner","_mapEventsOn","_switchMapEvents","_coordinate","visible","_getUIContainer","_removePrevDOM","__uiDOM","buildOn","_measureSize","_singleton","_uiDomKey","_setPosition","anim","_getAnimation","ok","fade","getTransformOrigin","_toCSSTranslate","_pos","display","_autoPan","transition","getDOM","getOwner","getPosition","_getViewPoint","getOffset","animations","trimed","mapWidth","mapHeight","onDomRemove","eventsToStop","_getClassName","_getDefaultEvents","ownerEvents","_getOwnerEvents","onEvent","positionchange","getOwnerEvents","_updatePosition","isSupport","options$k","domEvents","UIMarker","_markerCoord","_registerDOMEvents","_removeDOMEvents","isDragging","_onDomEvents","EVENTS$1","UIMarkerDragHandler","_startDrag","_endDrag","_lastCoord","_lastPoint","_prepareDragHandler","_dragging","_isDragging","coordOffset","pointOffset","options$l","InfoWindow","_UIComponent","getInfoWindow","removeInfoWindow","_infoWindow","setTitle","title","getTitle","_dom","_getWindowWidth","msgContent","querySelector","_onCloseBtnClick","closeBtn","markerSize","fixExtent","_onAutoOpen","_rectifyMouseCoordinte","mouseCoordinate","_rectifyLineStringMouseCoordinate","lineString","dis","pts","mousePt","minDis","coordinateIndex","filterPts","xys","_this$getMap$getSize","pt1","pt2","minPtDis","ptIndex","_len2","_pt","_dis","defaultWidth","options$m","ToolTip","onMouseOut","setStyle$$1","cssName","containerClass","onMouseOver","defaultOptions","Menu","_menu","removeMenu","setItems","items","getItems","_getMenuWidth","menuItems","_createMenuItemDom","ul","onMenuClick","_callback","item","itemDOM","itemTitle","Menuable","setMenu","_menuOptions","_defaultOpenMenu","openMenu","_bindMenu","setMenuItems","getMenuItems","index$4","Control","controlContainer","__ctrlContainer","_controlDom","_parse","getContainerPoint","positions","addControl","removeControl","options$n","layerEvents","Attribution","_Control","_attributionContainer","_update","attributions","attributionControl","options$o","LayerSwitcher","_show","_hide","_createPanel","toElement","relatedTarget","elm","baseLayers","li","_isExcluded","_renderLayer","_li","_ul","_label","excludeLayers","isBase","checked","onchange","layerSwitcherControl","options$p","Overview","mapContainer","_createOverview","_updateBaseLayer","_onButtonClick","_updateButtonText","_overview","_perspective","maxmize","minimize","getOverviewMap","_getOverviewZoom","_getPerspectiveCoords","showIndex","overviewControl","options$q","Panel","closeButton","onclick","panelContent","draggable","_startPos","_startPosition","startPosition","options$r","Scale","_scaleContainer","_addScales","css","_mScale","_iScale","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_updateScale","maxFeet","maxMiles","miles","feet","num","pow10","scaleControl","options$s","Toolbar","onButtonClick","childIndex","targetDom","_getItems","textAlign","itemSize","dropMenu","_createDropMenu","menuDom","menuUL","liWidth","options$t","UNIT","Zoom","levelDOM","_levelDOM","zoomDOM","zoomInButton","_zoomInButton","box","reading","_sliderBox","_sliderRuler","_sliderReading","_sliderDot","zoomOutButton","_zoomOutButton","_onZoomInClick","_onZoomOutClick","_onClickRuler","dotDragger","totalRange","zoomRange","_updateText","_onDotDragstart","_onDotDrag","zoomControl","index$5","TileSystem","getDefault","semiCircum","TileConfig","prepareTileInfo","_xScale","_yScale","_pointOrigin","_glRes","transformation","_getTileNum","tileX","tileY","getTileIndex","repeatWorld","tileIndex","getNeighorTileIndex","idy","_getTileFullIndex","_tileFullIndex","nwIndex","seIndex","getTilePrjNW","getTilePointNW","getTilePrjSE","getTilePointSE","getTilePrjExtent","planes","intersectsBox","setPlanes","plane","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","distance$1","isSetAvailable","Set","TileHashset","_table","add$$1","has","reset","options$u","URL_PATTERN$1","TEMP_POINT","TEMP_POINT0$3","TEMP_POINT1$1","TEMP_POINT2","TEMP_POINT3","TEMP_POINT4","TEMP_POINT5","TEMP_POINT6","TILE_BOX","ARR3","TileLayer","getTileSize","getTiles","parentLayer","parentRenderer","tileGrids","visualHeight1","tileZoom","_getTileZoom","_visitedTiles","_coordCache","_currentTiles","_getTiles","tiles","visualHeight0","extent0","currentTiles","cascadeHeight","cascadeLevels","cascadeTiles1","extent1","cascadeTiles2","getTileUrl","domain","subdomains","length$$1","_sr","_srMinZoom","_srMaxZoom","sr","cascadeLevel","frustumMatrix","_getTileOffset","hasOffset","emptyGrid","tileConfig","_getTileConfig","mapSR","extent2d","maskExtent","pmin","pmax","centerTile","ltTile","rbTile","allCount","leftVisitEnd","rightVisitEnd","tileId","_getTileId","isTileCachedOrLoading","_tileInfo","point0","_hasOwnSR","_unproject","pse","tileExtent","_isTileInExtent","_splitTiles","tileIdx","yOrder","corner","corner0","tile","_checkAndAddTile","childExtent","_isSplittedTileInExtent","mapProjection","_initTileConfig","_defaultTileConfig","_tileConfig","tileCenter","ndc","_onSpatialReferenceChange","GroupTileLayer","_TileLayer","_checkChildren","layerMap","_groupChildren","childGrid","getChildLayer","_onLayerShowHide","ids","options$v","crs","uppercase","detectRetina","defaultWmsParams","service","request","format","transparent","WMSTileLayer","wmsParams","_wmsVersion","projectionKey","bbox","getParamString","existingUrl","encodeURIComponent","CanvasTileLayer","drawTile","createGLContext","names","compileShader","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createProgram","vert","frag","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","attachShader","linkProgram","enableVertexAttrib","FSIZE","Float32Array","BYTES_PER_ELEMENT","STRIDE","attr","getAttribLocation","vertexAttribPointer","enableVertexAttribArray","_attr","shaders","arr16","DEBUG_POINT","ImageGLRenderable","renderable","drawGLImage","debug","useProgram","loadTexture","uMatrix","uniformMatrix4fv","uniform1f","glBuffer","saveImageBuffer","bufferTileData","bindBuffer","ARRAY_BUFFER","drawArrays","TRIANGLE_STRIP","drawDebug","attrib","debugInfo","_debugBuffer","bufferData","DYNAMIC_DRAW","LINE_STRIP","_debugInfoCanvas","_ctx","texImage2D","TEXTURE_2D","RGBA","UNSIGNED_BYTE","set8","buffer","set8Int","loadImageBuffer","Int16Array","drawTinImage","vertices","texCoords","indices","posBuffer","texBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","drawElements","TRIANGLES","UNSIGNED_SHORT","createCanvas2","canvas2","createGLContext$$1","clearColor","DEPTH_TEST","STENCIL_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","createBuffer","STATIC_DRAW","enableSampler","activeTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","resizeGLCanvas","viewport","clearGLCanvas","COLOR_BUFFER_BIT","STENCIL_BUFFER_BIT","disposeImage","texture","saveTexture","_createTexture","getTexture","createTexture","bindTexture","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","generateMipmap","_textures","textures","pop","getImageBuffer","_imageBuffers","imageBuffers","createImageBuffer","removeGLCanvas","deleteBuffer","_buffers","deleteTexture","deleteProgram","enableVertexAttrib$$1","createProgram$$1","uniforms","_createProgram2","_initUniforms","sampler","texIdx","uSampler","_getUniform","uniform1i","uniform","uniformName","getUniformLocation","a2","a3","a4","a5","a6","a7","options$w","TEMP_POINT$1","ImageLayer","images","_images","_prepareImages","setImages","getImages","_imageData","refreshImages","EMPTY_ARRAY","ImageLayerCanvasRenderer","_CanvasRenderer","isDrawable","_imageLoaded","urls","unloaded","retireImage","_drawImages","_drawImage","ImageLayerGLRenderer","_ImageGLRenderable","_proto3","CanvasLayerRenderer","getPrepareParams","getDrawParams","prepareDrawContext","_drawLayer","_drawLayerOnInteracting","canvasImg","bufferContext","prevent","doubleBuffer","_drawContext","_predrawed","ensureParams","prepareToDraw","_prepareDrawParams","options$x","CanvasLayer","redraw","isPlaying","requestMapToRender","TEMP_POINT$2","options$y","ParticleLayer","_CanvasLayer","getParticles","_shouldClear","fillRect","_fillCanvas","trail","_CanvasLayerRenderer","EDIT_STAGE_LAYER_PREFIX","createHandleSymbol","options$z","GeometryEditor","prepare","_prepareEditStageLayer","stageId","shadowId","_editStageLayer","_shadowLayer","editing","_geometryDraggble","_shadow","_switchGeometryEvents","_createOrRefreshOutline","_addListener","_createCenterHandle","_onMarkerDragEnd","createMarkerEditor","createCircleEditor","createEllipseOrRectEditor","createPolygonEditor","_history","_editOutline","_refreshHooks","_getGeometryEvents","_onGeoSymbolChange","_exeAndReset","oper","_addRefreshHook","handle","createHandle","onDown","onMove","onUp","_createHandleInstance","onHandleDragstart","onHandleDragging","_hideContext","onHandleDragEnd","onHandleRemove","onRefresh","_createResizeHandles","blackList","onHandleMove","onHandleUp","cursors","axis","getResizeAnchors","resizeHandles","anchorIndexes","handleSymbol","fnLocateHandles","pExt","_loop","isBlack","some","ele","handleViewPoint","_updating","_ret","_this5","geometryToEdit","_recordHistory","getUpdates","resizeAbilities","aspectRatio","newCoordinates","_updateCoordFromShadow","mirrorHandle","mirrorViewPoint","viewCenter","wh","ability","updates","_this6","wline","hline","_this7","isRect","mouseViewPoint","pointSub","targetPoint","mirror","absSub","firstMirrorCoordinate","mirrorCoordinate","_mouseCoordinate","_wline","_hline","verticeLimit","propertyOfVertexRefreshFn","propertyOfVertexIndex","vertexHandles","newVertexHandles","getVertexCoordinates","ringIndex","getVertexPrjCoordinates","onVertexAddOrRemove","removeVertex","_ringIndex","prjCoordinates","nextIndex","createNewVertexHandle","moveVertexHandle","vertice","nVertex","pVertex","createVertexHandle","vertexCoordinates","nextVertex","vertexIndex","refreshVertex","_vertexCoordinates","_ringIndex2","_i3","_ringIndex3","_i4","_eventListeners","method","_exeHistory","ignoreRecord","updating","_len3","_key2","lastOperation","record","history","_this8","TextEditable","startEditText","endEditText","_prepareEditor","_textEditor","html","innerText","_editUIMarker","onkeyup","isEditingText","getTextEditor","editContainer","_createEditor","_getEditorOffset","_setCursorToLast","labelSize","textColor","spacing","editor","contentEditable","keyCode","range","getSelection","focus","selectAllChildren","collapseToEnd","selection","createRange","moveToElementText","collapse","select","stylesToAnimate","_prepareAnimationStyles","preTranslate","isFocusing","_animationStarted","fnName","toTranslate","dSymbol","_fireAnimateEvent","symbolToAnimate","symbolInStyles","sp","_sp","DRAG_STAGE_LAYER_ID","EVENTS$2","GeometryDragHandler","_prepareDragStageLayer","shadows","_updateShadowSymbol","_prepareShadowConnectors","_dragStageLayer","shadowConnectors","connectors","targetConn","connOptions","connSymbol","conn","_shadowConnectors","_onTargetUpdated","enableAltitude","altitudeProperty","_correctCoord","_startParam","_moved","_updateTargetAndRemoveShadow","_editor","redoEdit","undoEdit","cancelEdit","_getEventParams","_bindInfoWindow","openInfoWindow","LRUCache","order","removedData","getAndRemove","setMaxSize","TEMP_POINT$3","TEMP_POINT1$2","TEMP_POINT2$1","TileLayerCanvasRenderer","tilesInView","tilesLoading","_parentTiles","_childTiles","tileCache","deleteTile","getCurrentTileZoom","_tileZoom","mask2DExtent","loadingCount","loading","checkedTiles","parentTiles","parentKeys","childTiles","childKeys","placeholders","placeholderKeys","tileQueue","preLoadingCount","_markTiles","loadingLimit","_getLoadLimit","_tileOffset","tileGrid","allTiles","placeholder","_generatePlaceHolder","tileLoading","_isLoadingTile","_getCachedTile","getTileOpacity","hitLimit","parentTile","_findParentTile","parentId","_findChildTiles","_drawTiles","loadTileQueue","_retireTiles","t2","onDrawTileStart","_drawTileAndCache","_drawTileOffset","writeZoomStencil","started","startZoomStencilTest","resumeZoomStencilTest","pauseZoomStencilTest","endZoomStencilTest","onDrawTileEnd","_clipByPitch","tileImage","loadTile","loadTime","onTileLoad","onTileError","loadTileImage","abortTileLoading","falseFn","_addTileToCache","onerrorTick","tileRetryCount","transformed","_point","getDebugInfo","xyz","_getLayerOfTile","zoomDiff","_findChildTilesAt","childZoom","dmin","dmax","ex","ey","diff","_tilesLoading$tileId","_tilePlaceHolder","force","_tile","defaultPlaceholder","cw","ch","TileLayerGLRenderer","_gl","_bindGLBuffer","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","EQUAL","_loadTile","tileCanvas","CanvasRenderer$1","_TileLayerCanvasRende","GLRenderer","_TileLayerGLRenderer","OverlayLayerRenderer","_geosToCheck","_resourceChecked","_addGeoToCheckRes","TEMP_EXTENT$4","VectorLayerRenderer","_OverlayLayerCanvasRe","drawGeos","_geosToDraw","_updateDisplayExtent","_drawnRes","forEachGeo","checkGeo","_displayExtent","MapRenderer","_handlerQueue","executeFrameCallbacks","front","panels","hasFront","_frontCount","back","layerDOM","childElementCount","hasBack","_backCount","hasUI","_uiCount","uiDOM","domChanged","frontCount","backCount","uiCount","_frameLoop","MapCanvasRenderer","_MapRenderer","_containerIsCanvas","_thisVisibilitychange","_onVisibilitychange","_loopTime","initContainer","renderFrame","_isViewChanged","updateMapDOM","_getAllLayerToRender","drawLayers","updated","drawLayerCanvas","_drawCenterCross","_recordView","_mapview","_getMapView","_spatialRefChanged","_fireLayerLoadEvents","canvasIds","updatedIds","fps","timeLimit","layerLimit","isCanvas","needsRedraw","_checkLayerRedraw","transformMatrix","__zoomTransformMatrix","_zoomMatrix","_drawCanvasLayerOnInteracting","_eventParam","preCanvasIds","_canvasIds","preUpdatedIds","_updatedIds","isLayerCanvasUpdated","sep","isSpatialReferenceChanged","drawTime","inTime","_updateCanvasSize","interacting","limit","baseLayerImage","layerImage","_getLayerImage","_drawLayerCanvasImage","_drawFog","_resizeInterval","clearInterval","_cancelFrameLoop","createContainer","enableSelect","POSITION0","mapAllLayers","backStatic","backLayer","canvasContainer","frontStatic","frontLayer","ui","previous","_animationFrame","canvasImage","imgOp","_drawContainerExtent","cascadePitches","h30","h60","fogThickness","landscape","_checkSize","_setCheckSizeInterval","_checkSizeInterval","setInterval","_onMapMouseMove","_hitDetectFrame","_getCanvasLayers","visibilityState","index$6","CanvasTileLayerCanvasRenderer","CanvasTileLayerGLRenderer","OverlayLayerCanvasRenderer","VectorLayerCanvasRenderer","CenterPointRenderer","PolyRenderer","_l2","_ii","_ll","_l3","_coords","_l4","_getRenderSize","prjExtent","pointZoom","arrowStyles","normal","prjVertexes","dasharray","_getArrowPlacement","_getArrows","prjHoles","holePoints","hole","Util","DomUtil","StringUtil","MapboxUtil"],"mappings":"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","sourcesContent":["/*!\n * maptalks v0.49.1\n * LICENSE : BSD-3-Clause\n * (c) 2016-2020 maptalks.org\n */\nvar version = \"0.49.1\";\n\nvar INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\nvar GEOMETRY_COLLECTION_TYPES = ['MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nvar GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\nvar RESOURCE_PROPERTIES = ['markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'];\nvar RESOURCE_SIZE_PROPERTIES = [['markerWidth', 'markerHeight'], [], [null, 'lineWidth'], [], [null, 'markerLineWidth']];\nvar NUMERICAL_PROPERTIES = {\n  'lineWidth': 1,\n  'lineOpacity': 1,\n  'lineDx': 1,\n  'lineDy': 1,\n  'polygonOpacity': 1,\n  'markerWidth': 1,\n  'markerHeight': 1,\n  'markerDx': 1,\n  'markerDy': 1,\n  'markerOpacity': 1,\n  'markerFillOpacity': 1,\n  'markerLineWidth': 1,\n  'markerLineOpacity': 1,\n  'textSize': 1,\n  'textOpacity': 1,\n  'textHaloRadius': 1,\n  'textWrapWidth': 1,\n  'textLineSpacing': 1,\n  'textDx': 1,\n  'textDy': 1\n};\nvar COLOR_PROPERTIES = ['lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'];\nvar DEFAULT_TEXT_SIZE = 14;\n\nfunction now() {\n  return Date.now();\n}\nfunction extend(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\nfunction isNil(obj) {\n  return obj == null;\n}\nfunction isNumber(val) {\n  return typeof val === 'number' && !isNaN(val);\n}\nfunction isInteger(n) {\n  return (n | 0) === n;\n}\nfunction isObject(obj) {\n  return typeof obj === 'object' && !!obj;\n}\nfunction isString(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'string' || obj.constructor !== null && obj.constructor === String;\n}\nfunction isFunction(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'function' || obj.constructor !== null && obj.constructor === Function;\n}\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn(obj, key) {\n  return hasOwnProperty.call(obj, key);\n}\nfunction join(arr, seperator) {\n  if (arr.join) {\n    return arr.join(seperator || ',');\n  } else {\n    return Array.prototype.join.call(arr, seperator || ',');\n  }\n}\nfunction isEmpty(object) {\n  var property;\n\n  for (property in object) {\n    return false;\n  }\n\n  return !property;\n}\nvar pi = Math.PI / 180;\nfunction toRadian(d) {\n  return d * pi;\n}\nfunction toDegree(r) {\n  return r / pi;\n}\n\nvar IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\n\nvar requestAnimFrame, cancelAnimFrame;\n\n(function () {\n  if (IS_NODE) {\n    requestAnimFrame = function requestAnimFrame(fn) {\n      return setTimeout(fn, 16);\n    };\n\n    cancelAnimFrame = clearTimeout;\n    return;\n  }\n\n  var requestFn, cancelFn;\n  var timeToCall = 1000 / 30;\n\n  function timeoutDefer(fn) {\n    return setTimeout(fn, timeToCall);\n  }\n\n  function getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n  }\n\n  if (typeof window != 'undefined') {\n    requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n    cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') || getPrefixed('CancelRequestAnimationFrame') || function (id) {\n      window.clearTimeout(id);\n    };\n  } else {\n    requestFn = timeoutDefer;\n    cancelFn = clearTimeout;\n  }\n\n  requestAnimFrame = function requestAnimFrame(fn) {\n    return requestFn(fn);\n  };\n\n  cancelAnimFrame = function cancelAnimFrame(id) {\n    if (id) {\n      cancelFn(id);\n    }\n  };\n})();\nfunction isSVG(url) {\n  var prefix = 'data:image/svg+xml';\n\n  if (url.length > 4 && url.slice(-4) === '.svg') {\n    return 1;\n  } else if (url.slice(0, prefix.length) === prefix) {\n    return 2;\n  }\n\n  return 0;\n}\nfunction loadImage(img, imgDesc) {\n  if (IS_NODE && loadImage.node) {\n    loadImage.node(img, imgDesc);\n    return;\n  }\n\n  img.src = imgDesc[0];\n}\nvar uid = 0;\nfunction UID() {\n  return uid++;\n}\nvar GUID = UID;\nfunction parseJSON(str) {\n  if (!str || !isString(str)) {\n    return str;\n  }\n\n  return JSON.parse(str);\n}\nfunction pushIn(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    if (src) {\n      for (var ii = 0, ll = src.length; ii < ll; ii++) {\n        dest.push(src[ii]);\n      }\n    }\n  }\n\n  return dest.length;\n}\nfunction removeFromArray(obj, array) {\n  var i = array.indexOf(obj);\n\n  if (i > -1) {\n    array.splice(i, 1);\n  }\n}\nfunction forEachCoord(arr, fn, context) {\n  if (!Array.isArray(arr)) {\n    return context ? fn.call(context, arr) : fn(arr);\n  }\n\n  var result = [];\n  var p, pp;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    p = arr[i];\n\n    if (isNil(p)) {\n      result.push(null);\n      continue;\n    }\n\n    if (Array.isArray(p)) {\n      result.push(forEachCoord(p, fn, context));\n    } else {\n      pp = context ? fn.call(context, p) : fn(p);\n      result.push(pp);\n    }\n  }\n\n  return result;\n}\nfunction getValueOrDefault(v, d) {\n  return v === undefined ? d : v;\n}\nfunction sign(x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n\n  if (x === 0 || isNaN(x)) {\n    return Number(x);\n  }\n\n  return x > 0 ? 1 : -1;\n}\nfunction log2(x) {\n  if (Math.log2) {\n    return Math.log2(x);\n  }\n\n  var v = Math.log(x) * Math.LOG2E;\n  var rounded = Math.round(v);\n\n  if (Math.abs(rounded - v) < 1E-14) {\n    return rounded;\n  } else {\n    return v;\n  }\n}\nfunction interpolate(a, b, t) {\n  return a * (1 - t) + b * t;\n}\nfunction wrap(n, min, max) {\n  if (n === max || n === min) {\n    return n;\n  }\n\n  var d = max - min;\n  var w = ((n - min) % d + d) % d + min;\n  return w;\n}\nfunction clamp(n, min, max) {\n  return Math.min(max, Math.max(min, n));\n}\nfunction isArrayHasData(obj) {\n  return Array.isArray(obj) && obj.length > 0;\n}\nvar urlPattern = /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i;\nfunction isURL(url) {\n  return urlPattern.test(url);\n}\nvar cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\nvar cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\nfunction isCssUrl(str) {\n  if (!isString(str)) {\n    return 0;\n  }\n\n  if (cssUrlRe.test(str)) {\n    return 1;\n  }\n\n  if (cssUrlReWithQuote.test(str)) {\n    return 2;\n  }\n\n  return 3;\n}\nfunction extractCssUrl(str) {\n  var test = isCssUrl(str);\n  var matches;\n\n  if (test === 3) {\n    return str;\n  } else if (test === 1) {\n    matches = cssUrlRe.exec(str);\n    return matches[1];\n  } else if (test === 2) {\n    matches = cssUrlReWithQuote.exec(str);\n    return matches[2];\n  } else {\n    return str;\n  }\n}\nvar b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nfunction btoa(input) {\n  if (typeof window !== 'undefined' && window.btoa) {\n    return window.btoa(input);\n  }\n\n  var str = String(input);\n  var output = '';\n\n  for (var block, charCode, idx = 0, map = b64chrs; str.charAt(idx | 0) || (map = '=', idx % 1); output += map.charAt(63 & block >> 8 - idx % 1 * 8)) {\n    charCode = str.charCodeAt(idx += 3 / 4);\n\n    if (charCode > 0xFF) {\n      throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode;\n  }\n\n  return output;\n}\nfunction b64toBlob(b64Data, contentType) {\n  var byteCharacters = atob(b64Data);\n  var arraybuffer = new ArrayBuffer(byteCharacters.length);\n  var view = new Uint8Array(arraybuffer);\n\n  for (var i = 0; i < byteCharacters.length; i++) {\n    view[i] = byteCharacters.charCodeAt(i) & 0xff;\n  }\n\n  var blob = new Blob([arraybuffer], {\n    type: contentType\n  });\n  return blob;\n}\nfunction computeDegree(x0, y0, x1, y1) {\n  var dx = x1 - x0;\n  var dy = y1 - y0;\n  return Math.atan2(dy, dx);\n}\nvar emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\nfunction equalMapView(obj1, obj2) {\n  if (!obj1 && !obj2) {\n    return true;\n  } else if (!obj1 || !obj2) {\n    return false;\n  }\n\n  for (var p in obj1) {\n    if (p === 'center') {\n      if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n        return false;\n      }\n    } else if (obj1[p] !== obj2[p]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction approx(val, expected, delta) {\n  if (delta == null) {\n    delta = 1e-6;\n  }\n\n  return val >= expected - delta && val <= expected + delta;\n}\n\nfunction flash(interval, count, cb, context) {\n  if (!interval) {\n    interval = 100;\n  }\n\n  if (!count) {\n    count = 4;\n  }\n\n  var me = this;\n  count *= 2;\n\n  if (this._flashTimeout) {\n    clearTimeout(this._flashTimeout);\n  }\n\n  function flashGeo() {\n    if (count === 0) {\n      me.show();\n\n      if (cb) {\n        if (context) {\n          cb.call(context);\n        } else {\n          cb();\n        }\n      }\n\n      return;\n    }\n\n    if (count % 2 === 0) {\n      me.hide();\n    } else {\n      me.show();\n    }\n\n    count--;\n    me._flashTimeout = setTimeout(flashGeo, interval);\n  }\n\n  this._flashTimeout = setTimeout(flashGeo, interval);\n  return this;\n}\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nvar types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nfunction createFilter(filter) {\n  return new Function('f', \"var p = (f && f.properties || {}); return \" + compile(filter));\n}\n\nfunction compile(filter) {\n  if (!filter) return 'true';\n  var op = filter[0];\n  if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n  var str = op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) : op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) : op === '<' || op === '>' || op === '<=' || op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) : op === 'any' ? compileLogicalOp(filter.slice(1), '||') : op === 'all' ? compileLogicalOp(filter.slice(1), '&&') : op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) : op === 'in' ? compileInOp(filter[1], filter.slice(2)) : op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) : op === 'has' ? compileHasOp(filter[1]) : op === '!has' ? compileNegation(compileHasOp(filter[1])) : 'true';\n  return \"(\" + str + \")\";\n}\n\nfunction compilePropertyReference(property) {\n  return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n  var left = compilePropertyReference(property);\n  var right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n  return (checkType ? \"typeof \" + left + \"=== typeof \" + right + \"&&\" : '') + left + op + right;\n}\n\nfunction compileLogicalOp(expressions, op) {\n  return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n  if (property === '$type') values = values.map(function (value) {\n    return types.indexOf(value);\n  });\n  var left = JSON.stringify(values.sort(compare));\n  var right = compilePropertyReference(property);\n  if (values.length <= 200) return left + \".indexOf(\" + right + \") !== -1\";\n  return \"function(v, a, i, j) {\\n        while (i <= j) { var m = (i + j) >> 1;\\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\\n        }\\n    return false; }(\" + right + \", \" + left + \",0,\" + (values.length - 1) + \")\";\n}\n\nfunction compileHasOp(property) {\n  return property === '$id' ? '\"id\" in f' : JSON.stringify(property) + \" in p\";\n}\n\nfunction compileNegation(expression) {\n  return \"!(\" + expression + \")\";\n}\n\nfunction compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction getFilterFeature(geometry) {\n  var json = geometry._toJSON(),\n      g = json['feature'];\n\n  g['type'] = types.indexOf(g['geometry']['type']);\n  g['subType'] = json['subType'];\n  return g;\n}\nfunction compileStyle(styles) {\n  if (!Array.isArray(styles)) {\n    return compileStyle([styles]);\n  }\n\n  var compiled = [];\n\n  for (var i = 0; i < styles.length; i++) {\n    var filter = void 0;\n\n    if (styles[i]['filter'] === true) {\n      filter = function filter() {\n        return true;\n      };\n    } else {\n      filter = createFilter(styles[i]['filter']);\n    }\n\n    compiled.push(extend$1({}, styles[i], {\n      filter: filter\n    }));\n  }\n\n  return compiled;\n}\n\nfunction extend$1(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction createFunction(parameters, defaultType) {\n  var fun;\n  var isFeatureConstant, isZoomConstant;\n\n  if (!isFunctionDefinition(parameters)) {\n    fun = function fun() {\n      return parameters;\n    };\n\n    isFeatureConstant = true;\n    isZoomConstant = true;\n  } else {\n    var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    var zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    var type = parameters.type || defaultType || 'exponential';\n    var innerFun;\n\n    if (type === 'exponential') {\n      innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n      innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n      innerFun = evaluateCategoricalFunction;\n    } else if (type === 'identity') {\n      innerFun = evaluateIdentityFunction;\n    } else {\n      throw new Error('Unknown function type \"' + type + '\"');\n    }\n\n    if (zoomAndFeatureDependent) {\n      var featureFunctions = {};\n      var featureFunctionStops = [];\n\n      for (var s = 0; s < parameters.stops.length; s++) {\n        var stop = parameters.stops[s];\n\n        if (featureFunctions[stop[0].zoom] === undefined) {\n          featureFunctions[stop[0].zoom] = {\n            zoom: stop[0].zoom,\n            type: parameters.type,\n            property: parameters.property,\n            default: parameters.default,\n            stops: []\n          };\n        }\n\n        featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\n      }\n\n      for (var z in featureFunctions) {\n        featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\n      }\n\n      fun = function fun(zoom, feature) {\n        var value = evaluateExponentialFunction({\n          stops: featureFunctionStops,\n          base: parameters.base\n        }, zoom)(zoom, feature);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = false;\n    } else if (zoomDependent) {\n      fun = function fun(zoom) {\n        var value = innerFun(parameters, zoom);\n        return typeof value === 'function' ? value(zoom) : value;\n      };\n\n      isFeatureConstant = true;\n      isZoomConstant = false;\n    } else {\n      fun = function fun(zoom, feature) {\n        var value = innerFun(parameters, feature ? feature[parameters.property] : null);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = true;\n    }\n  }\n\n  fun.isZoomConstant = isZoomConstant;\n  fun.isFeatureConstant = isFeatureConstant;\n  return fun;\n}\n\nfunction coalesce(a, b, c) {\n  if (a !== undefined) return a;\n  if (b !== undefined) return b;\n  if (c !== undefined) return c;\n  return null;\n}\n\nfunction evaluateCategoricalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input === parameters.stops[i][0]) {\n      return parameters.stops[i][1];\n    }\n  }\n\n  return parameters.default;\n}\n\nfunction evaluateIntervalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input < parameters.stops[i][0]) break;\n  }\n\n  return parameters.stops[Math.max(i - 1, 0)][1];\n}\n\nfunction evaluateExponentialFunction(parameters, input) {\n  var base = parameters.base !== undefined ? parameters.base : 1;\n  var i = 0;\n\n  while (true) {\n    if (i >= parameters.stops.length) break;else if (input <= parameters.stops[i][0]) break;else i++;\n  }\n\n  if (i === 0) {\n    return parameters.stops[i][1];\n  } else if (i === parameters.stops.length) {\n    return parameters.stops[i - 1][1];\n  } else {\n    return interpolate$1(input, base, parameters.stops[i - 1][0], parameters.stops[i][0], parameters.stops[i - 1][1], parameters.stops[i][1]);\n  }\n}\n\nfunction evaluateIdentityFunction(parameters, input) {\n  return coalesce(input, parameters.default);\n}\n\nfunction interpolate$1(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  if (typeof outputLower === 'function') {\n    return function () {\n      var evaluatedLower = outputLower.apply(undefined, arguments);\n      var evaluatedUpper = outputUpper.apply(undefined, arguments);\n      return interpolate$1(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\n    };\n  } else if (outputLower.length) {\n    return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  } else {\n    return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  }\n}\n\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var difference = inputUpper - inputLower;\n  var progress = input - inputLower;\n  var ratio;\n\n  if (base === 1) {\n    ratio = progress / difference;\n  } else {\n    ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n\n  return outputLower * (1 - ratio) + outputUpper * ratio;\n}\n\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var output = [];\n\n  for (var i = 0; i < outputLower.length; i++) {\n    output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\n  }\n\n  return output;\n}\n\nfunction isFunctionDefinition(obj) {\n  return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\n}\nfunction hasFunctionDefinition(obj) {\n  for (var p in obj) {\n    if (isFunctionDefinition(obj[p])) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction interpolated(parameters) {\n  return createFunction1(parameters, 'exponential');\n}\nfunction piecewiseConstant(parameters) {\n  return createFunction1(parameters, 'interval');\n}\nfunction loadFunctionTypes(obj, argFn) {\n  if (!obj) {\n    return null;\n  }\n\n  var hit = false;\n\n  if (Array.isArray(obj)) {\n    var multResult = [],\n        loaded;\n\n    for (var i = 0; i < obj.length; i++) {\n      loaded = loadFunctionTypes(obj[i], argFn);\n\n      if (!loaded) {\n        multResult.push(obj[i]);\n      } else {\n        multResult.push(loaded);\n        hit = true;\n      }\n    }\n\n    return hit ? multResult : obj;\n  }\n\n  var result = {\n    '__fn_types_loaded': true\n  },\n      props = [],\n      p;\n\n  for (p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      props.push(p);\n    }\n  }\n\n  var buildFn = function buildFn(p) {\n    Object.defineProperty(result, p, {\n      get: function get() {\n        if (!this['__fn_' + p]) {\n          this['__fn_' + p] = interpolated(this['_' + p]);\n        }\n\n        return this['__fn_' + p].apply(this, argFn());\n      },\n      set: function set(v) {\n        this['_' + p] = v;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  };\n\n  for (var _i = 0, len = props.length; _i < len; _i++) {\n    p = props[_i];\n\n    if (isFunctionDefinition(obj[p])) {\n      hit = true;\n      result['_' + p] = obj[p];\n      buildFn(p);\n    } else {\n      result[p] = obj[p];\n    }\n  }\n\n  return hit ? result : obj;\n}\nfunction getFunctionTypeResources(t) {\n  if (!t || !t.stops) {\n    return [];\n  }\n\n  var res = [];\n\n  for (var i = 0, l = t.stops.length; i < l; i++) {\n    res.push(t.stops[i][1]);\n  }\n\n  return res;\n}\n\nfunction createFunction1(parameters, defaultType) {\n  if (!isFunctionDefinition(parameters)) {\n    return function () {\n      return parameters;\n    };\n  }\n\n  parameters = JSON.parse(JSON.stringify(parameters));\n  var isZoomConstant = true;\n  var isFeatureConstant = true;\n  var stops = parameters.stops;\n\n  if (stops) {\n    for (var i = 0; i < stops.length; i++) {\n      if (isFunctionDefinition(stops[i][1])) {\n        var _fn = createFunction1(stops[i][1], defaultType);\n\n        isZoomConstant = isZoomConstant && _fn.isZoomConstant;\n        isFeatureConstant = isFeatureConstant && _fn.isFeatureConstant;\n        stops[i] = [stops[i][0], _fn];\n      }\n    }\n  }\n\n  var fn = createFunction(parameters, defaultType);\n  fn.isZoomConstant = isZoomConstant && fn.isZoomConstant;\n  fn.isFeatureConstant = isFeatureConstant && fn.isFeatureConstant;\n  return fn;\n}\n\n\n\nvar index = /*#__PURE__*/Object.freeze({\n  createFilter: createFilter,\n  getFilterFeature: getFilterFeature,\n  compileStyle: compileStyle,\n  isFunctionDefinition: isFunctionDefinition,\n  hasFunctionDefinition: hasFunctionDefinition,\n  interpolated: interpolated,\n  piecewiseConstant: piecewiseConstant,\n  loadFunctionTypes: loadFunctionTypes,\n  getFunctionTypeResources: getFunctionTypeResources\n});\n\nfunction translateToSVGStyles(s) {\n  var result = {\n    'stroke': {\n      'stroke': s['markerLineColor'],\n      'stroke-width': s['markerLineWidth'],\n      'stroke-opacity': s['markerLineOpacity'],\n      'stroke-dasharray': null,\n      'stroke-linecap': 'butt',\n      'stroke-linejoin': 'round'\n    },\n    'fill': {\n      'fill': s['markerFill'],\n      'fill-opacity': s['markerFillOpacity']\n    }\n  };\n\n  if (result['stroke']['stroke-width'] === 0) {\n    result['stroke']['stroke-opacity'] = 0;\n  }\n\n  return result;\n}\nfunction getMarkerPathBase64(symbol, width, height) {\n  if (!symbol['markerPath']) {\n    return null;\n  }\n\n  var op = 1;\n  var styles = translateToSVGStyles(symbol);\n\n  if (isNumber(symbol['markerOpacity'])) {\n    op = symbol['markerOpacity'];\n  }\n\n  if (isNumber(symbol['opacity'])) {\n    op *= symbol['opacity'];\n  }\n\n  var svgStyles = {};\n\n  if (styles) {\n    for (var p in styles['stroke']) {\n      if (styles['stroke'].hasOwnProperty(p)) {\n        if (!isNil(styles['stroke'][p])) {\n          svgStyles[p] = styles['stroke'][p];\n        }\n      }\n    }\n\n    for (var _p in styles['fill']) {\n      if (styles['fill'].hasOwnProperty(_p)) {\n        if (!isNil(styles['fill'][_p])) {\n          svgStyles[_p] = styles['fill'][_p];\n        }\n      }\n    }\n  }\n\n  var pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n  var path;\n  var pathesToRender = [];\n\n  for (var i = 0; i < pathes.length; i++) {\n    path = isString(pathes[i]) ? {\n      'path': pathes[i]\n    } : pathes[i];\n    path = extend({}, path, svgStyles);\n    path['d'] = path['path'];\n    delete path['path'];\n    pathesToRender.push(path);\n  }\n\n  var svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n\n  if (op < 1) {\n    svg.push('opacity=\"' + op + '\"');\n  }\n\n  if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n    svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n  }\n\n  svg.push('preserveAspectRatio=\"none\"');\n\n  if (width) {\n    svg.push('width=\"' + width + '\"');\n  }\n\n  if (height) {\n    svg.push('height=\"' + height + '\"');\n  }\n\n  svg.push('><defs></defs>');\n\n  for (var _i = 0; _i < pathesToRender.length; _i++) {\n    var strPath = '<path ';\n\n    for (var _p2 in pathesToRender[_i]) {\n      if (pathesToRender[_i].hasOwnProperty(_p2)) {\n        strPath += ' ' + _p2 + '=\"' + pathesToRender[_i][_p2] + '\"';\n      }\n    }\n\n    strPath += '></path>';\n    svg.push(strPath);\n  }\n\n  svg.push('</svg>');\n  var b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n  return b64;\n}\nfunction getExternalResources(symbol, toAbsolute) {\n  if (!symbol) {\n    return [];\n  }\n\n  var symbols = symbol;\n\n  if (!Array.isArray(symbol)) {\n    symbols = [symbol];\n  }\n\n  var resources = [];\n  var props = RESOURCE_PROPERTIES;\n  var res, resSizeProp;\n  var w, h;\n\n  for (var i = symbols.length - 1; i >= 0; i--) {\n    symbol = symbols[i];\n\n    if (!symbol) {\n      continue;\n    }\n\n    if (toAbsolute) {\n      symbol = convertResourceUrl(symbol);\n    }\n\n    for (var ii = 0; ii < props.length; ii++) {\n      res = symbol[props[ii]];\n\n      if (isFunctionDefinition(res)) {\n        res = getFunctionTypeResources(res);\n      }\n\n      if (!res) {\n        continue;\n      }\n\n      if (!Array.isArray(res)) {\n        res = [res];\n      }\n\n      for (var iii = 0; iii < res.length; iii++) {\n        if (res[iii].slice(0, 4) === 'url(') {\n          res[iii] = extractCssUrl(res[iii]);\n        }\n\n        resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n        resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n      }\n    }\n\n    if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n      w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n      h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n\n      if (isFunctionDefinition(symbol['markerPath'])) {\n        res = getFunctionTypeResources(symbol['markerPath']);\n        var path = symbol['markerPath'];\n\n        for (var _iii = 0; _iii < res.length; _iii++) {\n          symbol['markerPath'] = res[_iii];\n          resources.push([getMarkerPathBase64(symbol), w, h]);\n        }\n\n        symbol['markerPath'] = path;\n      } else {\n        resources.push([getMarkerPathBase64(symbol), w, h]);\n      }\n    }\n  }\n\n  return resources;\n}\nfunction convertResourceUrl(symbol) {\n  if (!symbol) {\n    return null;\n  }\n\n  var s = symbol;\n\n  if (IS_NODE) {\n    return s;\n  }\n\n  var props = RESOURCE_PROPERTIES;\n  var res;\n\n  for (var ii = 0, len = props.length; ii < len; ii++) {\n    res = s[props[ii]];\n\n    if (!res) {\n      continue;\n    }\n\n    s[props[ii]] = _convertUrl(res);\n  }\n\n  return s;\n}\n\nfunction _convertUrl(res) {\n  if (isFunctionDefinition(res)) {\n    var stops = res.stops;\n\n    for (var i = 0; i < stops.length; i++) {\n      stops[i][1] = _convertUrl(stops[i][1]);\n    }\n\n    return res;\n  }\n\n  if (res.slice(0, 4) === 'url(') {\n    res = extractCssUrl(res);\n  }\n\n  return res;\n}\n\nfunction isGradient(g) {\n  return g && g['colorStops'];\n}\nfunction getGradientStamp(g) {\n  var keys = [g['type']];\n\n  if (g['places']) {\n    keys.push(g['places'].join());\n  }\n\n  if (g['colorStops']) {\n    var stops = [];\n\n    for (var i = g['colorStops'].length - 1; i >= 0; i--) {\n      stops.push(g['colorStops'][i].join());\n    }\n\n    keys.push(stops.join(','));\n  }\n\n  return keys.join('_');\n}\nfunction getSymbolStamp(symbol) {\n  var keys = [];\n\n  if (Array.isArray(symbol)) {\n    for (var i = 0; i < symbol.length; i++) {\n      keys.push(getSymbolStamp(symbol[i]));\n    }\n\n    return '[ ' + keys.join(' , ') + ' ]';\n  }\n\n  for (var p in symbol) {\n    if (hasOwn(symbol, p)) {\n      if (!isFunction(symbol[p])) {\n        if (isGradient(symbol[p])) {\n          keys.push(p + '=' + getGradientStamp(symbol[p]));\n        } else {\n          keys.push(p + '=' + symbol[p]);\n        }\n      }\n    }\n  }\n\n  return keys.join(';');\n}\nfunction lowerSymbolOpacity(symbol, ratio) {\n  function s(_symbol, _ratio) {\n    var op = _symbol['opacity'];\n\n    if (isNil(op)) {\n      _symbol['opacity'] = _ratio;\n    } else {\n      _symbol['opacity'] *= _ratio;\n    }\n  }\n\n  var lower;\n\n  if (Array.isArray(symbol)) {\n    lower = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      var d = extend({}, symbol[i]);\n      s(d, ratio);\n      lower.push(d);\n    }\n  } else {\n    lower = extend({}, symbol);\n    s(lower, ratio);\n  }\n\n  return lower;\n}\nfunction extendSymbol(symbol) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  if (!sources || !sources.length) {\n    sources = [{}];\n  }\n\n  if (Array.isArray(symbol)) {\n    var s, dest;\n    var result = [];\n\n    for (var i = 0, l = symbol.length; i < l; i++) {\n      s = symbol[i];\n      dest = {};\n\n      for (var ii = 0, ll = sources.length; ii < ll; ii++) {\n        if (!Array.isArray(sources[ii])) {\n          extend(dest, s, sources[ii] ? sources[ii] : {});\n        } else if (!isNil(sources[ii][i])) {\n          extend(dest, s, sources[ii][i]);\n        } else {\n          extend(dest, s ? s : {});\n        }\n      }\n\n      result.push(dest);\n    }\n\n    return result;\n  } else {\n    var args = [{}, symbol];\n    args.push.apply(args, sources);\n    return extend.apply(this, args);\n  }\n}\nfunction parseStyleRootPath(style) {\n  if (style.symbol) {\n    style = [style];\n  }\n\n  if (Array.isArray(style)) {\n    return style;\n  }\n\n  var root = style['$root'];\n  var iconset = style['$iconset'];\n  style = style.style;\n\n  if (root || iconset) {\n    if (root && root[root.length - 1] === '/') {\n      root = root.substring(0, root.length - 1);\n    }\n\n    if (iconset && iconset[iconset.length - 1] === '/') {\n      iconset = iconset.substring(0, iconset.length - 1);\n    }\n\n    var replacer = function replacer(match) {\n      if (match === '{$root}') {\n        return root;\n      } else if (match === '{$iconset}') {\n        return iconset;\n      }\n\n      return null;\n    };\n\n    style = convertStylePath(style, replacer);\n  }\n\n  return style;\n}\nfunction convertStylePath(styles, replacer) {\n  for (var i = 0; i < styles.length; i++) {\n    var symbol = styles[i].symbol;\n\n    if (symbol) {\n      parseSymbolPath(symbol, replacer);\n    }\n  }\n}\nvar URL_PATTERN = /(\\{\\$root\\}|\\{\\$iconset\\})/g;\n\nfunction parseSymbolPath(symbol, replacer) {\n  for (var p in symbol) {\n    if (symbol.hasOwnProperty(p) && p !== 'textName') {\n      if (isString(symbol[p]) && symbol[p].length > 2) {\n        symbol[p] = symbol[p].replace(URL_PATTERN, replacer);\n      } else if (isFunctionDefinition(symbol[p])) {\n        symbol[p] = parseStops(symbol[p], replacer);\n      } else if (isObject(symbol[p])) {\n        parseSymbolPath(symbol[p], replacer);\n      }\n    }\n  }\n}\n\nfunction parseStops(value, replacer) {\n  var defaultValue = value['default'];\n\n  if (isString(defaultValue)) {\n    value['default'] = defaultValue.replace(URL_PATTERN, replacer);\n  }\n\n  var stops = value.stops;\n\n  for (var i = 0; i < stops.length; i++) {\n    if (!Array.isArray(stops[i])) {\n      continue;\n    }\n\n    if (isString(stops[i][1])) {\n      stops[i][1] = stops[i][1].replace(URL_PATTERN, replacer);\n    } else if (isFunctionDefinition(stops[i][1])) {\n      stops[i][1] = parseStops(stops[i][1], replacer);\n    }\n  }\n\n  return value;\n}\n\n\n\nvar index$1 = /*#__PURE__*/Object.freeze({\n  now: now,\n  extend: extend,\n  isNil: isNil,\n  isNumber: isNumber,\n  isInteger: isInteger,\n  isObject: isObject,\n  isString: isString,\n  isFunction: isFunction,\n  hasOwn: hasOwn,\n  join: join,\n  isEmpty: isEmpty,\n  toRadian: toRadian,\n  toDegree: toDegree,\n  IS_NODE: IS_NODE,\n  get requestAnimFrame () { return requestAnimFrame; },\n  get cancelAnimFrame () { return cancelAnimFrame; },\n  isSVG: isSVG,\n  loadImage: loadImage,\n  UID: UID,\n  GUID: GUID,\n  parseJSON: parseJSON,\n  pushIn: pushIn,\n  removeFromArray: removeFromArray,\n  forEachCoord: forEachCoord,\n  getValueOrDefault: getValueOrDefault,\n  sign: sign,\n  log2: log2,\n  interpolate: interpolate,\n  wrap: wrap,\n  clamp: clamp,\n  isArrayHasData: isArrayHasData,\n  isURL: isURL,\n  isCssUrl: isCssUrl,\n  extractCssUrl: extractCssUrl,\n  btoa: btoa,\n  b64toBlob: b64toBlob,\n  computeDegree: computeDegree,\n  emptyImageUrl: emptyImageUrl,\n  equalMapView: equalMapView,\n  flash: flash,\n  _defaults: _defaults,\n  translateToSVGStyles: translateToSVGStyles,\n  getMarkerPathBase64: getMarkerPathBase64,\n  getExternalResources: getExternalResources,\n  convertResourceUrl: convertResourceUrl,\n  isGradient: isGradient,\n  getGradientStamp: getGradientStamp,\n  getSymbolStamp: getSymbolStamp,\n  lowerSymbolOpacity: lowerSymbolOpacity,\n  extendSymbol: extendSymbol,\n  parseStyleRootPath: parseStyleRootPath,\n  convertStylePath: convertStylePath\n});\n\nvar Browser = {};\n\nif (!IS_NODE) {\n  var ua = navigator.userAgent.toLowerCase(),\n      doc = document.documentElement,\n      ie = 'ActiveXObject' in window,\n      webkit = ua.indexOf('webkit') !== -1,\n      phantomjs = ua.indexOf('phantom') !== -1,\n      android23 = ua.search('android [23]') !== -1,\n      chrome = ua.indexOf('chrome') !== -1,\n      gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n      mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n      msPointer = !window.PointerEvent && window.MSPointerEvent,\n      pointer = window.PointerEvent && navigator.pointerEnabled || msPointer,\n      ie3d = ie && 'transition' in doc.style,\n      webkit3d = 'WebKitCSSMatrix' in window && 'm11' in new window.WebKitCSSMatrix() && !android23,\n      gecko3d = 'MozPerspective' in doc.style,\n      opera12 = 'OTransition' in doc.style,\n      any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n  var chromeVersion = 0;\n\n  if (chrome) {\n    chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n  }\n\n  var touch = !phantomjs && (pointer || 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n  var webgl;\n\n  try {\n    var canvas = document.createElement('canvas');\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    webgl = gl && gl instanceof WebGLRenderingContext;\n  } catch (err) {\n    webgl = false;\n  }\n\n  var devicePixelRatio = window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n  Browser = {\n    ie: ie,\n    ielt9: ie && !document.addEventListener,\n    edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n    webkit: webkit,\n    gecko: gecko,\n    android: ua.indexOf('android') !== -1,\n    android23: android23,\n    chrome: chrome,\n    chromeVersion: chromeVersion,\n    safari: !chrome && ua.indexOf('safari') !== -1,\n    phantomjs: phantomjs,\n    ie3d: ie3d,\n    webkit3d: webkit3d,\n    gecko3d: gecko3d,\n    opera12: opera12,\n    any3d: any3d,\n    mobile: mobile,\n    mobileWebkit: mobile && webkit,\n    mobileWebkit3d: mobile && webkit3d,\n    mobileOpera: mobile && window.opera,\n    mobileGecko: mobile && gecko,\n    touch: !!touch,\n    msPointer: !!msPointer,\n    pointer: !!pointer,\n    retina: devicePixelRatio > 1,\n    devicePixelRatio: devicePixelRatio,\n    language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n    ie9: ie && document.documentMode === 9,\n    ie10: ie && document.documentMode === 10,\n    webgl: webgl\n  };\n}\n\nvar Browser$1 = Browser;\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Position = function () {\n  function Position(x, y) {\n    if (!isNil(x) && !isNil(y)) {\n      this.x = +x;\n      this.y = +y;\n    } else if (!isNil(x.x) && !isNil(x.y)) {\n      this.x = +x.x;\n      this.y = +x.y;\n    } else if (Array.isArray(x)) {\n      this.x = +x[0];\n      this.y = +x[1];\n    }\n\n    if (this._isNaN()) {\n      throw new Error('Position is NaN');\n    }\n  }\n\n  var _proto = Position.prototype;\n\n  _proto.set = function set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.abs = function abs() {\n    return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n  };\n\n  _proto._abs = function _abs() {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this.x), Math.round(this.y));\n  };\n\n  _proto._ceil = function _ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  };\n\n  _proto.ceil = function ceil() {\n    return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n  };\n\n  _proto.distanceTo = function distanceTo(point) {\n    var x = point.x - this.x,\n        y = point.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  };\n\n  _proto._floor = function _floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  };\n\n  _proto.floor = function floor() {\n    return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this.x, this.y);\n  };\n\n  _proto._add = function _add(x, y) {\n    if (!isNil(x.x)) {\n      this.x += x.x;\n      this.y += x.y;\n    } else if (!isNil(x[0])) {\n      this.x += x[0];\n      this.y += x[1];\n    } else {\n      this.x += x;\n      this.y += y;\n    }\n\n    return this;\n  };\n\n  _proto.add = function add(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x + x.x;\n      ny = this.y + x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x + x[0];\n      ny = this.y + x[1];\n    } else {\n      nx = this.x + x;\n      ny = this.y + y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto._sub = function _sub(x, y) {\n    if (!isNil(x.x)) {\n      this.x -= x.x;\n      this.y -= x.y;\n    } else if (!isNil(x[0])) {\n      this.x -= x[0];\n      this.y -= x[1];\n    } else {\n      this.x -= x;\n      this.y -= y;\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x - x.x;\n      ny = this.y - x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x - x[0];\n      ny = this.y - x[1];\n    } else {\n      nx = this.x - x;\n      ny = this.y - y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new this.constructor(this.x * ratio, this.y * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this.x *= ratio;\n    this.y *= ratio;\n    return this;\n  };\n\n  _proto.div = function div(n) {\n    return this.multi(1 / n);\n  };\n\n  _proto._div = function _div(n) {\n    return this._multi(1 / n);\n  };\n\n  _proto.equals = function equals(c) {\n    if (!(c instanceof this.constructor)) {\n      return false;\n    }\n\n    return this.x === c.x && this.y === c.y;\n  };\n\n  _proto._isNaN = function _isNaN() {\n    return isNaN(this.x) || isNaN(this.y);\n  };\n\n  _proto.isZero = function isZero() {\n    return this.x === 0 && this.y === 0;\n  };\n\n  _proto.toArray = function toArray() {\n    return [this.x, this.y];\n  };\n\n  _proto.toFixed = function toFixed(n) {\n    return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      x: this.x,\n      y: this.y\n    };\n  };\n\n  return Position;\n}();\n\nvar Point = function (_Position) {\n  _inheritsLoose(Point, _Position);\n\n  function Point() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  var _proto = Point.prototype;\n\n  _proto.closeTo = function closeTo(p, delta) {\n    if (!delta) {\n      delta = 0;\n    }\n\n    return this.x >= p.x - delta && this.x <= p.x + delta && this.y >= p.y - delta && this.y <= p.y + delta;\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto.unit = function unit() {\n    return this.copy()._unit();\n  };\n\n  _proto._unit = function _unit() {\n    this._div(this.mag());\n\n    return this;\n  };\n\n  _proto.perp = function perp() {\n    return this.copy()._perp();\n  };\n\n  _proto._perp = function _perp() {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  };\n\n  _proto.angleWith = function angleWith(b) {\n    return this.angleWithSep(b.x, b.y);\n  };\n\n  _proto.angleWithSep = function angleWithSep(x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  };\n\n  _proto._rotate = function _rotate(angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.rotate = function rotate(a) {\n    return this.copy()._rotate(a);\n  };\n\n  return Point;\n}(Position);\n\nvar Size = function () {\n  function Size(width, height) {\n    if (isNumber(width) && isNumber(height)) {\n      this.width = width;\n      this.height = height;\n    } else if (isNumber(width['width'])) {\n      this.width = width.width;\n      this.height = width.height;\n    } else if (Array.isArray(width)) {\n      this.width = width[0];\n      this.height = width[1];\n    }\n  }\n\n  var _proto = Size.prototype;\n\n  _proto.copy = function copy() {\n    return new Size(this['width'], this['height']);\n  };\n\n  _proto.add = function add(x, y) {\n    var w, h;\n\n    if (x instanceof Size) {\n      w = this.width + x.width;\n      h = this.height + x.height;\n    } else {\n      w = this.width + x;\n      h = this.height + y;\n    }\n\n    return new Size(w, h);\n  };\n\n  _proto.equals = function equals(size) {\n    return this['width'] === size['width'] && this['height'] === size['height'];\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new Size(this['width'] * ratio, this['height'] * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this['width'] *= ratio;\n    this['height'] *= ratio;\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this['width'] = Math.round(this['width']);\n    this['height'] = Math.round(this['height']);\n    return this;\n  };\n\n  _proto.toPoint = function toPoint() {\n    return new Point(this['width'], this['height']);\n  };\n\n  _proto.toArray = function toArray() {\n    return [this['width'], this['height']];\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'width': this['width'],\n      'height': this['height']\n    };\n  };\n\n  return Size;\n}();\n\nfunction trim(str) {\n  return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\nvar specialPattern = /[\\b\\t\\r\\v\\f]/igm;\nfunction escapeSpecialChars(str) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(specialPattern, '');\n}\nfunction splitWords(chr) {\n  return trim(chr).split(/\\s+/);\n}\nvar rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\nfunction stringWidth(text, font) {\n  if (stringWidth.node) {\n    return stringWidth.node(text, font);\n  }\n\n  rulerCtx.font = font;\n  return rulerCtx.measureText(text).width;\n}\nfunction stringLength(text, font, size) {\n  var w = stringWidth(text, font);\n  return new Size(w, size || DEFAULT_TEXT_SIZE);\n}\nfunction getFontHeight(font) {\n  var domRuler = getDomRuler('span');\n\n  if (font !== '_default_') {\n    domRuler.style.font = font;\n  }\n\n  domRuler.innerHTML = '秦';\n  var h = domRuler.clientHeight;\n  removeDomNode(domRuler);\n  return h;\n}\nfunction splitContent(content, font, wrapWidth, textWidth) {\n  if (!content || content.length === 0) {\n    return [{\n      'text': '',\n      'width': 0\n    }];\n  }\n\n  var width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n  var chrWidth = width / content.length,\n      minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n\n  if (chrWidth >= wrapWidth || minChrCount <= 0) {\n    return [{\n      'text': '',\n      'width': wrapWidth\n    }];\n  }\n\n  if (width <= wrapWidth) return [{\n    'text': content,\n    'width': width\n  }];\n  var result = [];\n  var testStr = content.substring(0, minChrCount),\n      prew = chrWidth * minChrCount;\n\n  for (var i = minChrCount, l = content.length; i < l; i++) {\n    var chr = content[i];\n    var w = stringWidth(testStr + chr);\n\n    if (w >= wrapWidth) {\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n      testStr = content.substring(i, minChrCount + i);\n      i += minChrCount - 1;\n      prew = chrWidth * minChrCount;\n    } else {\n      testStr += chr;\n      prew = w;\n    }\n\n    if (i >= l - 1) {\n      prew = stringWidth(testStr);\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n    }\n  }\n\n  return result;\n}\nvar contentExpRe = /\\{([\\w_]+)\\}/g;\nfunction replaceVariable(str, props) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(contentExpRe, function (str, key) {\n    if (!props) {\n      return '';\n    }\n\n    var value = props[key];\n\n    if (isNil(value)) {\n      return '';\n    } else if (Array.isArray(value)) {\n      return value.join();\n    }\n\n    return value;\n  });\n}\nfunction getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n  var width = size['width'],\n      height = size['height'];\n  var alignW, alignH;\n\n  if (horizontalAlignment === 'left') {\n    alignW = -width;\n  } else if (horizontalAlignment === 'right') {\n    alignW = 0;\n  } else {\n    alignW = -width / 2;\n  }\n\n  if (verticalAlignment === 'top') {\n    alignH = -height;\n  } else if (verticalAlignment === 'bottom') {\n    alignH = 0;\n  } else {\n    alignH = -height / 2;\n  }\n\n  return new Point(alignW, alignH);\n}\nvar DEFAULT_FONT = 'monospace';\nfunction getFont(style) {\n  if (style['textFont']) {\n    return style['textFont'];\n  } else {\n    return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') + (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') + style['textSize'] + 'px ' + (!style['textFaceName'] ? DEFAULT_FONT : style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"');\n  }\n}\nfunction splitTextToRow(text, style) {\n  var font = getFont(style),\n      lineSpacing = style['textLineSpacing'] || 0,\n      size = stringLength(text, font, style['textSize']),\n      textWidth = size['width'],\n      textHeight = size['height'],\n      wrapChar = style['textWrapCharacter'],\n      textRows = [];\n  var wrapWidth = style['textWrapWidth'];\n\n  if (!wrapWidth || wrapWidth > textWidth) {\n    wrapWidth = textWidth;\n  }\n\n  if (!isString(text)) {\n    text += '';\n  }\n\n  var actualWidth = 0;\n\n  if (wrapChar && text.indexOf(wrapChar) >= 0) {\n    var texts = text.split(wrapChar);\n\n    for (var i = 0, l = texts.length; i < l; i++) {\n      var t = texts[i];\n      var tWidth = stringWidth(t, font);\n\n      if (tWidth > wrapWidth) {\n        var contents = splitContent(t, font, wrapWidth, tWidth);\n\n        for (var ii = 0, ll = contents.length; ii < ll; ii++) {\n          var w = contents[ii].width;\n\n          if (w > actualWidth) {\n            actualWidth = w;\n          }\n\n          textRows.push({\n            'text': contents[ii].text,\n            'size': new Size(w, textHeight)\n          });\n        }\n      } else {\n        if (tWidth > actualWidth) {\n          actualWidth = tWidth;\n        }\n\n        textRows.push({\n          'text': t,\n          'size': new Size(tWidth, textHeight)\n        });\n      }\n    }\n  } else if (textWidth > wrapWidth) {\n    var _contents = splitContent(text, font, wrapWidth, textWidth);\n\n    for (var _i = 0; _i < _contents.length; _i++) {\n      var _w = _contents[_i].width;\n\n      if (_w > actualWidth) {\n        actualWidth = _w;\n      }\n\n      textRows.push({\n        'text': _contents[_i].text,\n        'size': new Size(_w, textHeight)\n      });\n    }\n  } else {\n    if (textWidth > actualWidth) {\n      actualWidth = textWidth;\n    }\n\n    textRows.push({\n      'text': text,\n      'size': size\n    });\n  }\n\n  var rowNum = textRows.length;\n  var textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n  return {\n    'total': rowNum,\n    'size': textSize,\n    'rows': textRows,\n    'rawSize': size\n  };\n}\n\nvar strings = /*#__PURE__*/Object.freeze({\n  trim: trim,\n  escapeSpecialChars: escapeSpecialChars,\n  splitWords: splitWords,\n  stringWidth: stringWidth,\n  stringLength: stringLength,\n  getFontHeight: getFontHeight,\n  splitContent: splitContent,\n  replaceVariable: replaceVariable,\n  getAlignPoint: getAlignPoint,\n  getFont: getFont,\n  splitTextToRow: splitTextToRow\n});\n\nvar first = function first(props) {\n  return props[0];\n};\n\nvar testProp = IS_NODE ? first : function (props) {\n  var style = document.documentElement.style;\n\n  for (var i = 0; i < props.length; i++) {\n    if (props[i] in style) {\n      return props[i];\n    }\n  }\n\n  return false;\n};\nvar TRANSFORM = testProp(['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\nvar TRANSFORMORIGIN = testProp(['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\nvar TRANSITION = testProp(['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\nvar CSSFILTER = testProp(['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\nfunction createEl(tagName, className) {\n  var el = document.createElement(tagName);\n\n  if (className) {\n    setClass(el, className);\n  }\n\n  return el;\n}\nfunction createElOn(tagName, style, container) {\n  var el = createEl(tagName);\n\n  if (style) {\n    setStyle(el, style);\n  }\n\n  if (container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction removeDomNode(node) {\n  if (!node) {\n    return this;\n  }\n\n  if (Browser$1.ielt9 || Browser$1.ie9) {\n    var d = createEl('div');\n    d.appendChild(node);\n    d.innerHTML = '';\n    d = null;\n  } else if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return this;\n}\nfunction addDomEvent(obj, typeArr, handler, context) {\n  if (!obj || !obj.addEventListener || !typeArr || !handler) {\n    return this;\n  }\n\n  var eventHandler = function eventHandler(e) {\n    if (!e) {\n      e = window.event;\n    }\n\n    handler.call(context || obj, e);\n    return;\n  };\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!obj['Z__' + type]) {\n      obj['Z__' + type] = [];\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit >= 0) {\n      removeDomEvent(obj, type, handler);\n    }\n\n    obj['Z__' + type].push({\n      callback: eventHandler,\n      src: handler\n    });\n\n    if (Browser$1.ie) {\n      obj.addEventListener(type, eventHandler, false);\n    } else {\n      obj.addEventListener(type, eventHandler, {\n        capture: false,\n        passive: false\n      });\n    }\n  }\n\n  return this;\n}\nfunction removeDomEvent(obj, typeArr, handler) {\n  function doRemove(type, callback) {\n    if (type === 'mousewheel' && Browser$1.gecko) {\n      type = 'DOMMouseScroll';\n    }\n\n    obj.removeEventListener(type, callback, false);\n  }\n\n  if (!obj || !obj.removeEventListener || !typeArr) {\n    return this;\n  }\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!handler && obj['Z__' + type]) {\n      var handlers = obj['Z__' + type];\n\n      for (var j = 0, jlen = handlers.length; j < jlen; j++) {\n        doRemove(handlers[j].callback);\n      }\n\n      delete obj['Z__' + type];\n      return this;\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit < 0) {\n      return this;\n    }\n\n    var hitHandler = obj['Z__' + type][hit];\n    doRemove(type, hitHandler.callback);\n    obj['Z__' + type].splice(hit, 1);\n  }\n\n  return this;\n}\nfunction listensDomEvent(obj, type, handler) {\n  if (!obj || !obj['Z__' + type] || !handler) {\n    return -1;\n  }\n\n  var handlers = obj['Z__' + type];\n\n  for (var i = 0, len = handlers.length; i < len; i++) {\n    if (handlers[i].src === handler) {\n      return i;\n    }\n  }\n\n  return -1;\n}\nfunction preventDefault(event) {\n  if (event.preventDefault) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n\n  return this;\n}\nfunction stopPropagation(e) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.cancelBubble = true;\n  }\n\n  return this;\n}\nfunction preventSelection(dom) {\n  dom.onselectstart = function () {\n    return false;\n  };\n\n  dom.ondragstart = function () {\n    return false;\n  };\n\n  dom.setAttribute('unselectable', 'on');\n  return this;\n}\nfunction offsetDom(dom, offset) {\n  if (!dom) {\n    return null;\n  }\n\n  if (Browser$1.any3d) {\n    setTransform(dom, offset);\n  } else {\n    dom.style.left = offset.x + 'px';\n    dom.style.top = offset.y + 'px';\n  }\n\n  return offset;\n}\nfunction computeDomPosition(dom) {\n  var style = window.getComputedStyle(dom);\n  var padding = [parseInt(style['padding-left']), parseInt(style['padding-top'])];\n  var rect = dom.getBoundingClientRect();\n  var offsetWidth = dom.offsetWidth,\n      offsetHeight = dom.offsetHeight;\n  var scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n      scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n  dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n  return dom.__position;\n}\nfunction getEventContainerPoint(ev, dom) {\n  if (!ev) {\n    ev = window.event;\n  }\n\n  var domPos = dom.__position;\n\n  if (!domPos) {\n    domPos = computeDomPosition(dom);\n  }\n\n  return new Point((ev.clientX - domPos[0] - dom.clientLeft) / domPos[2], (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]);\n}\n\nfunction endsWith(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\nfunction setStyle(dom, strCss) {\n  var cssText = dom.style.cssText;\n\n  if (!endsWith(cssText, ';')) {\n    cssText += ';';\n  }\n\n  dom.style.cssText = cssText + strCss;\n  return this;\n}\nfunction hasClass(el, name) {\n  if (el.classList !== undefined) {\n    return el.classList.contains(name);\n  }\n\n  var className = getClass(el);\n  return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\nfunction addClass(el, name) {\n  if (el.classList !== undefined && !hasClass(el, name)) {\n    var classes = splitWords(name);\n\n    for (var i = 0, len = classes.length; i < len; i++) {\n      el.classList.add(classes[i]);\n    }\n  } else {\n    var className = getClass(el);\n    setClass(el, (className ? className + ' ' : '') + name);\n  }\n\n  return this;\n}\nfunction setClass(el, name) {\n  if (isNil(el.className.baseVal)) {\n    el.className = name;\n  } else {\n    el.className.baseVal = name;\n  }\n\n  return this;\n}\nfunction getClass(el) {\n  return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\nfunction setOpacity(el, value) {\n  el.style.opacity = value;\n  return this;\n}\nfunction setTransform(el, offset) {\n  var pos = offset || new Point(0, 0);\n  el.style[TRANSFORM] = Browser$1.any3d ? 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' : 'translate(' + pos.x + 'px,' + pos.y + 'px)';\n  return this;\n}\nfunction setTransformMatrix(el, m) {\n  var text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n\n  if (el.style[TRANSFORM] !== text) {\n    el.style[TRANSFORM] = text;\n  }\n\n  return this;\n}\nfunction removeTransform(el) {\n  if (el.style[TRANSFORM]) {\n    el.style[TRANSFORM] = '';\n  }\n\n  return this;\n}\nfunction isHTML(str) {\n  return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\nfunction measureDom(parentTag, dom) {\n  var ruler = getDomRuler(parentTag);\n\n  if (isString(dom)) {\n    ruler.innerHTML = dom;\n  } else {\n    ruler.appendChild(dom);\n  }\n\n  var result = new Size(ruler.clientWidth, ruler.clientHeight);\n  removeDomNode(ruler);\n  return result;\n}\nfunction getDomRuler(tag) {\n  var span = document.createElement(tag);\n  span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n  document.body.appendChild(span);\n  return span;\n}\nvar on = addDomEvent;\nvar off = removeDomEvent;\n\nvar dom = /*#__PURE__*/Object.freeze({\n  TRANSFORM: TRANSFORM,\n  TRANSFORMORIGIN: TRANSFORMORIGIN,\n  TRANSITION: TRANSITION,\n  CSSFILTER: CSSFILTER,\n  createEl: createEl,\n  createElOn: createElOn,\n  removeDomNode: removeDomNode,\n  addDomEvent: addDomEvent,\n  removeDomEvent: removeDomEvent,\n  listensDomEvent: listensDomEvent,\n  preventDefault: preventDefault,\n  stopPropagation: stopPropagation,\n  preventSelection: preventSelection,\n  offsetDom: offsetDom,\n  computeDomPosition: computeDomPosition,\n  getEventContainerPoint: getEventContainerPoint,\n  setStyle: setStyle,\n  hasClass: hasClass,\n  addClass: addClass,\n  setClass: setClass,\n  getClass: getClass,\n  setOpacity: setOpacity,\n  setTransform: setTransform,\n  setTransformMatrix: setTransformMatrix,\n  removeTransform: removeTransform,\n  isHTML: isHTML,\n  measureDom: measureDom,\n  getDomRuler: getDomRuler,\n  on: on,\n  off: off\n});\n\nvar Ajax = {\n  jsonp: function jsonp(url, callback) {\n    var name = '_maptalks_jsonp_' + UID();\n    if (url.match(/\\?/)) url += '&callback=' + name;else url += '?callback=' + name;\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    window[name] = function (data) {\n      callback(null, data);\n      document.getElementsByTagName('head')[0].removeChild(script);\n      script = null;\n      delete window[name];\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n    return this;\n  },\n  get: function get(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (IS_NODE && Ajax.get.node) {\n      return Ajax.get.node(url, cb, options);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('GET', url, true);\n\n    if (options) {\n      for (var k in options.headers) {\n        client.setRequestHeader(k, options.headers[k]);\n      }\n\n      client.withCredentials = options.credentials === 'include';\n\n      if (options['responseType']) {\n        client.responseType = options['responseType'];\n      }\n    }\n\n    client.send(null);\n    return client;\n  },\n  post: function post(url, options, cb) {\n    var postData;\n\n    if (!isString(url)) {\n      var t = cb;\n      postData = options;\n      options = url;\n      url = options.url;\n      cb = t;\n    } else {\n      if (isFunction(options)) {\n        var _t = cb;\n        cb = options;\n        options = _t;\n      }\n\n      options = options || {};\n      postData = options.postData;\n    }\n\n    if (IS_NODE && Ajax.post.node) {\n      options.url = url;\n      return Ajax.post.node(options, postData, cb);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('POST', options.url, true);\n\n    if (!options.headers) {\n      options.headers = {};\n    }\n\n    if (!options.headers['Content-Type']) {\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n    }\n\n    if ('setRequestHeader' in client) {\n      for (var p in options.headers) {\n        if (options.headers.hasOwnProperty(p)) {\n          client.setRequestHeader(p, options.headers[p]);\n        }\n      }\n    }\n\n    if (!isString(postData)) {\n      postData = JSON.stringify(postData);\n    }\n\n    client.send(postData);\n    return client;\n  },\n  _wrapCallback: function _wrapCallback(client, cb) {\n    return function () {\n      if (client.readyState === 4) {\n        if (client.status === 200) {\n          if (client.responseType === 'arraybuffer') {\n            var response = client.response;\n\n            if (response.byteLength === 0) {\n              cb(new Error('http status 200 returned without content.'));\n            } else {\n              cb(null, {\n                data: client.response,\n                cacheControl: client.getResponseHeader('Cache-Control'),\n                expires: client.getResponseHeader('Expires'),\n                contentType: client.getResponseHeader('Content-Type')\n              });\n            }\n          } else {\n            cb(null, client.responseText);\n          }\n        } else {\n          cb(new Error(client.statusText + ',' + client.status));\n        }\n      }\n    };\n  },\n  _getClient: function _getClient(cb) {\n    var client;\n\n    try {\n      client = new XMLHttpRequest();\n    } catch (e) {\n      try {\n        client = new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          client = new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e) {}\n      }\n    }\n\n    client.onreadystatechange = Ajax._wrapCallback(client, cb);\n    return client;\n  },\n  getArrayBuffer: function getArrayBuffer(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    options['responseType'] = 'arraybuffer';\n    return Ajax.get(url, options, cb);\n  },\n  getImage: function getImage(img, url, options) {\n    return Ajax.getArrayBuffer(url, options, function (err, imgData) {\n      if (err) {\n        if (img.onerror) {\n          img.onerror(err);\n        }\n      } else if (imgData) {\n        var URL = window.URL || window.webkitURL;\n        var onload = img.onload;\n\n        img.onload = function () {\n          if (onload) {\n            onload();\n          }\n\n          URL.revokeObjectURL(img.src);\n        };\n\n        var blob = new Blob([new Uint8Array(imgData.data)], {\n          type: imgData.contentType\n        });\n        img.cacheControl = imgData.cacheControl;\n        img.expires = imgData.expires;\n        img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n      }\n    });\n  }\n};\n\nAjax.getJSON = function (url, options, cb) {\n  if (isFunction(options)) {\n    var t = cb;\n    cb = options;\n    options = t;\n  }\n\n  var callback = function callback(err, resp) {\n    var data = resp ? parseJSON(resp) : null;\n    cb(err, data);\n  };\n\n  if (options && options['jsonp']) {\n    return Ajax.jsonp(url, callback);\n  }\n\n  return Ajax.get(url, options, callback);\n};\n\nvar DEFAULT_STROKE_COLOR = '#000';\nvar DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nvar DEFAULT_TEXT_COLOR = '#000';\nvar hitTesting = false;\nvar TEMP_CANVAS = null;\nvar RADIAN = Math.PI / 180;\nvar textOffsetY = 1;\nvar Canvas = {\n  setHitTesting: function setHitTesting(testing) {\n    hitTesting = testing;\n  },\n  createCanvas: function createCanvas(width, height, canvasClass) {\n    var canvas;\n\n    if (!IS_NODE) {\n      canvas = createEl('canvas');\n      canvas.width = width;\n      canvas.height = height;\n    } else {\n      canvas = new canvasClass(width, height);\n    }\n\n    return canvas;\n  },\n  prepareCanvasFont: function prepareCanvasFont(ctx, style) {\n    ctx.textBaseline = 'top';\n    ctx.font = getFont(style);\n    var fill = style['textFill'];\n\n    if (!fill) {\n      fill = DEFAULT_TEXT_COLOR;\n    }\n\n    ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n  },\n  prepareCanvas: function prepareCanvas(ctx, style, resources, testing) {\n    if (!style) {\n      return;\n    }\n\n    var strokeWidth = style['lineWidth'];\n\n    if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n      ctx.lineWidth = strokeWidth;\n    }\n\n    var strokePattern = style['linePatternFile'];\n    var strokeColor = style['lineColor'] || DEFAULT_STROKE_COLOR;\n\n    if (testing) {\n      ctx.strokeStyle = '#000';\n    } else if (strokePattern && resources) {\n      var patternOffset;\n\n      if (style['linePatternDx'] || style['linePatternDy']) {\n        patternOffset = [style['linePatternDx'], style['linePatternDy']];\n      }\n\n      Canvas._setStrokePattern(ctx, strokePattern, strokeWidth, patternOffset, resources);\n\n      style['lineDasharray'] = [];\n    } else if (isGradient(strokeColor)) {\n      if (style['lineGradientExtent']) {\n        ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n      } else {\n        ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n      }\n    } else {\n        ctx.strokeStyle = strokeColor;\n      }\n\n    if (style['lineJoin']) {\n      ctx.lineJoin = style['lineJoin'];\n    }\n\n    if (style['lineCap']) {\n      ctx.lineCap = style['lineCap'];\n    }\n\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var polygonPattern = style['polygonPatternFile'];\n    var fill = style['polygonFill'] || DEFAULT_FILL_COLOR;\n\n    if (testing) {\n      ctx.fillStyle = '#000';\n    } else if (polygonPattern && resources) {\n      var fillImgUrl = extractImageUrl(polygonPattern);\n      var fillTexture = resources.getImage([fillImgUrl, null, null]);\n\n      if (!fillTexture) {\n        fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n      }\n\n      if (isSVG(fillImgUrl) && fillTexture instanceof Image && (Browser$1.edge || Browser$1.ie)) {\n        var w = fillTexture.width || 20,\n            h = fillTexture.height || 20;\n        var canvas = Canvas.createCanvas(w, h);\n        Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n        fillTexture = canvas;\n      }\n\n      if (!fillTexture) {\n        if (typeof console !== 'undefined') {\n          console.warn('img not found for', fillImgUrl);\n        }\n      } else {\n        ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n\n        if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n          ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n        }\n      }\n    } else if (isGradient(fill)) {\n      if (style['polygonGradientExtent']) {\n        ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n      } else {\n        ctx.fillStyle = 'rgba(255,255,255,0)';\n      }\n    } else {\n        ctx.fillStyle = fill;\n      }\n  },\n  _createGradient: function _createGradient(ctx, g, extent) {\n    var gradient = null,\n        places = g['places'];\n    var min = extent.getMin(),\n        max = extent.getMax(),\n        width = extent.getWidth(),\n        height = extent.getHeight();\n\n    if (!g['type'] || g['type'] === 'linear') {\n      if (!places) {\n        places = [min.x, min.y, max.x, min.y];\n      } else {\n        if (places.length !== 4) {\n          throw new Error('A linear gradient\\'s places should have 4 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, min.x + places[2] * width, min.y + places[3] * height];\n      }\n\n      gradient = ctx.createLinearGradient.apply(ctx, places);\n    } else if (g['type'] === 'radial') {\n      if (!places) {\n        var c = extent.getCenter()._round();\n\n        places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n      } else {\n        if (places.length !== 6) {\n          throw new Error('A radial gradient\\'s places should have 6 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, width * places[2], min.x + places[3] * width, min.y + places[4] * height, width * places[5]];\n      }\n\n      gradient = ctx.createRadialGradient.apply(ctx, places);\n    }\n\n    g['colorStops'].forEach(function (stop) {\n      gradient.addColorStop.apply(gradient, stop);\n    });\n    return gradient;\n  },\n  _setStrokePattern: function _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n    var imgUrl = extractImageUrl(strokePattern);\n    var imageTexture;\n\n    if (IS_NODE) {\n      imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n    } else {\n      var key = imgUrl + '-texture-' + strokeWidth;\n      imageTexture = resources.getImage(key);\n\n      if (!imageTexture) {\n        var imageRes = resources.getImage([imgUrl, null, null]);\n\n        if (imageRes) {\n          var w;\n\n          if (!imageRes.width || !imageRes.height) {\n            w = strokeWidth;\n          } else {\n            w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n          }\n\n          var patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n          Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n          resources.addResource([key, null, strokeWidth], patternCanvas);\n          imageTexture = patternCanvas;\n        }\n      }\n    }\n\n    if (imageTexture) {\n      ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n      ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n    } else if (typeof console !== 'undefined') {\n      console.warn('img not found for', imgUrl);\n    }\n  },\n  clearRect: function clearRect(ctx, x1, y1, x2, y2) {\n    ctx.canvas._drawn = false;\n    ctx.clearRect(x1, y1, x2, y2);\n  },\n  fillCanvas: function fillCanvas(ctx, fillOpacity, x, y) {\n    if (hitTesting) {\n      fillOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (fillOpacity === 0) {\n      return;\n    }\n\n    var isPattern = Canvas._isPattern(ctx.fillStyle);\n\n    var offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n\n    if (isNil(fillOpacity)) {\n      fillOpacity = 1;\n    }\n\n    var alpha;\n\n    if (fillOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= fillOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.fill();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (fillOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  getRgba: function getRgba(color, op) {\n    if (isNil(op)) {\n      op = 1;\n    }\n\n    if (color[0] !== '#') {\n      return color;\n    }\n\n    var r, g, b;\n\n    if (color.length === 7) {\n      r = parseInt(color.substring(1, 3), 16);\n      g = parseInt(color.substring(3, 5), 16);\n      b = parseInt(color.substring(5, 7), 16);\n    } else {\n      r = parseInt(color.substring(1, 2), 16) * 17;\n      g = parseInt(color.substring(2, 3), 16) * 17;\n      b = parseInt(color.substring(3, 4), 16) * 17;\n    }\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n  },\n  image: function image(ctx, img, x, y, width, height) {\n    ctx.canvas._drawn = true;\n\n    try {\n      if (isNumber(width) && isNumber(height)) {\n        ctx.drawImage(img, x, y, width, height);\n      } else {\n        ctx.drawImage(img, x, y);\n      }\n    } catch (error) {\n      if (console) {\n        console.warn('error when drawing image on canvas:', error);\n        console.warn(img);\n      }\n    }\n  },\n  text: function text(ctx, _text, pt, style, textDesc) {\n    Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n  },\n  _textOnMultiRow: function _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n    var ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n        lineHeight = textSize['height'] + style['textLineSpacing'],\n        basePoint = point.add(0, ptAlign.y),\n        maxHeight = style['textMaxHeight'];\n    var text,\n        rowAlign,\n        height = 0;\n\n    for (var i = 0, len = texts.length; i < len; i++) {\n      text = texts[i]['text'];\n      rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n\n      Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n\n      if (maxHeight > 0) {\n        height += lineHeight;\n\n        if (height + textSize['height'] >= maxHeight) {\n          break;\n        }\n      }\n    }\n  },\n  _textOnLine: function _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n    if (hitTesting) {\n      textHaloAlpha = 1;\n    }\n\n    var drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n    ctx.textBaseline = 'top';\n    var gco, fill;\n    var shadowBlur = ctx.shadowBlur,\n        shadowOffsetX = ctx.shadowOffsetX,\n        shadowOffsetY = ctx.shadowOffsetY;\n\n    if (drawHalo) {\n      var alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= textHaloAlpha;\n      ctx.miterLimit = 2;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = textHaloRadius * 2;\n      ctx.strokeStyle = textHaloFill;\n      ctx.strokeText(text, pt.x, pt.y + textOffsetY);\n      ctx.miterLimit = 10;\n      ctx.globalAlpha = alpha;\n      gco = ctx.globalCompositeOperation;\n      ctx.globalCompositeOperation = 'destination-out';\n      fill = ctx.fillStyle;\n      ctx.fillStyle = '#000';\n    }\n\n    if (shadowBlur && drawHalo) {\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    }\n\n    Canvas.fillText(ctx, text, pt);\n\n    if (gco) {\n      ctx.globalCompositeOperation = gco;\n      Canvas.fillText(ctx, text, pt, fill);\n\n      if (shadowBlur) {\n        ctx.shadowBlur = shadowBlur;\n        ctx.shadowOffsetX = shadowOffsetX;\n        ctx.shadowOffsetY = shadowOffsetY;\n      }\n    }\n  },\n  fillText: function fillText(ctx, text, pt, rgba) {\n    ctx.canvas._drawn = true;\n\n    if (rgba) {\n      ctx.fillStyle = rgba;\n    }\n\n    ctx.fillText(text, pt.x, pt.y + textOffsetY);\n  },\n  _stroke: function _stroke(ctx, strokeOpacity, x, y) {\n    if (hitTesting) {\n      strokeOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (strokeOpacity === 0) {\n      return;\n    }\n\n    var offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n    var isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n    if (isNil(strokeOpacity)) {\n      strokeOpacity = 1;\n    }\n\n    var alpha;\n\n    if (strokeOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= strokeOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.stroke();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (strokeOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  _path: function _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    function fillWithPattern(p1, p2) {\n      var degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n      ctx.save();\n      var cosd = Math.cos(degree);\n\n      if (Math.abs(cosd) < 1E-7) {\n        ctx.translate(p1.x - ctx.lineWidth / 2, p1.y);\n      } else {\n        ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / cosd);\n      }\n\n      ctx.rotate(degree);\n\n      Canvas._stroke(ctx, lineOpacity);\n\n      ctx.restore();\n    }\n\n    var isDashed = isArrayHasData(lineDashArray);\n    var isPatternLine = ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle);\n    var point, prePoint, nextPoint;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      point = points[i];\n\n      if (!isDashed || ctx.setLineDash) {\n        ctx.lineTo(point.x, point.y);\n\n        if (isPatternLine && i > 0) {\n          prePoint = points[i - 1];\n          fillWithPattern(prePoint, point);\n          ctx.beginPath();\n          ctx.moveTo(point.x, point.y);\n        }\n      } else if (isDashed) {\n        if (i === len - 1) {\n          break;\n        }\n\n        nextPoint = points[i + 1];\n        drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n      }\n    }\n  },\n  path: function path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    Canvas._path(ctx, points, lineDashArray, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _multiClip: function _multiClip(ctx, points) {\n    if (!points || points.length === 0) return;\n    points = points[0];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      var x = point.x,\n          y = point.y;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n\n      if (i === len - 1) {\n        x = points[0].x;\n        y = points[0].y;\n        ctx.lineTo(x, y);\n      }\n    }\n  },\n  polygon: function polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n    if (ctx.isMultiClip) {\n      Canvas._multiClip(ctx, points);\n\n      return;\n    }\n\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    var isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n        fillFirst = isArrayHasData(lineDashArray) && !ctx.setLineDash || isPatternLine && !smoothness;\n\n    if (!isArrayHasData(points[0])) {\n      points = [points];\n    }\n\n    var savedCtx = ctx;\n\n    if (points.length > 1 && !IS_NODE) {\n      if (!TEMP_CANVAS) {\n        TEMP_CANVAS = Canvas.createCanvas(1, 1);\n      }\n\n      ctx.canvas._drawn = false;\n      TEMP_CANVAS.width = ctx.canvas.width;\n      TEMP_CANVAS.height = ctx.canvas.height;\n      ctx = TEMP_CANVAS.getContext('2d');\n      copyProperties(ctx, savedCtx);\n    }\n\n    var op, i, len;\n\n    if (fillFirst) {\n      ctx.save();\n\n      for (i = 0, len = points.length; i < len; i++) {\n        if (!isArrayHasData(points[i])) {\n          continue;\n        }\n\n        Canvas._ring(ctx, points[i], null, 0, true);\n\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n\n        Canvas._stroke(ctx, 0);\n      }\n\n      ctx.restore();\n    }\n\n    for (i = 0, len = points.length; i < len; i++) {\n      if (!isArrayHasData(points[i])) {\n        continue;\n      }\n\n      if (smoothness) {\n        Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n        ctx.closePath();\n      } else {\n        Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n      }\n\n      if (!fillFirst) {\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n      }\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n\n    if (points.length > 1 && !IS_NODE) {\n      savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n      savedCtx.canvas._drawn = ctx.canvas._drawn;\n      copyProperties(savedCtx, ctx);\n    }\n  },\n  _ring: function _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n    var isPattern = Canvas._isPattern(ctx.strokeStyle);\n\n    if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n      ring = ring.concat([ring[0]]);\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(ring[0].x, ring[0].y);\n\n    Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n\n    if (!isPattern) {\n      ctx.closePath();\n    }\n  },\n  paintSmoothLine: function paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n    if (!points) {\n      return;\n    }\n\n    if (points.length <= 2 || !smoothValue) {\n      Canvas.path(ctx, points, lineOpacity);\n      return;\n    }\n\n    function interpolate$$1(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n      var u0 = 1.0 - t0;\n      var u1 = 1.0 - t1;\n      var qxa = x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n      var qxb = x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n      var qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 + x2 * t0 * t0;\n      var qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 + x2 * t1 * t1;\n      var qya = y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n      var qyb = y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n      var qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 + y2 * t0 * t0;\n      var qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 + y2 * t1 * t1;\n      var xb = qxa * u1 + qxc * t1;\n      var xc = qxb * u0 + qxd * t0;\n      var xd = qxb * u1 + qxd * t1;\n      var yb = qya * u1 + qyc * t1;\n      var yc = qyb * u0 + qyd * t0;\n      var yd = qyb * u1 + qyd * t1;\n      return [xb, yb, xc, yc, xd, yd];\n    }\n\n    function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n      var xc1 = (x0 + x1) / 2.0,\n          yc1 = (y0 + y1) / 2.0;\n      var xc2 = (x1 + x2) / 2.0,\n          yc2 = (y1 + y2) / 2.0;\n      var xc3 = (x2 + x3) / 2.0,\n          yc3 = (y2 + y3) / 2.0;\n      var len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n      var len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      var len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n      var k1 = len1 / (len1 + len2);\n      var k2 = len2 / (len2 + len3);\n      var xm1 = xc1 + (xc2 - xc1) * k1,\n          ym1 = yc1 + (yc2 - yc1) * k1;\n      var xm2 = xc2 + (xc3 - xc2) * k2,\n          ym2 = yc2 + (yc3 - yc2) * k2;\n      var ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n          ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n          ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n          ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n      var ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n\n      if (t < 1) {\n        return interpolate$$1(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n      } else {\n        return ctrlPoints;\n      }\n    }\n\n    var count = points.length;\n    var l = close ? count : count - 1;\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n    if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n    var preCtrlPoints;\n\n    for (var i = 0; i < l; i++) {\n      var x1 = points[i].x,\n          y1 = points[i].y;\n      var x0 = void 0,\n          y0 = void 0,\n          x2 = void 0,\n          y2 = void 0,\n          x3 = void 0,\n          y3 = void 0;\n\n      if (i - 1 < 0) {\n        if (!close) {\n          x0 = points[i + 1].x;\n          y0 = points[i + 1].y;\n        } else {\n          x0 = points[l - 1].x;\n          y0 = points[l - 1].y;\n        }\n      } else {\n        x0 = points[i - 1].x;\n        y0 = points[i - 1].y;\n      }\n\n      if (i + 1 < count) {\n        x2 = points[i + 1].x;\n        y2 = points[i + 1].y;\n      } else {\n        x2 = points[i + 1 - count].x;\n        y2 = points[i + 1 - count].y;\n      }\n\n      if (i + 2 < count) {\n        x3 = points[i + 2].x;\n        y3 = points[i + 2].y;\n      } else if (!close) {\n        x3 = points[i].x;\n        y3 = points[i].y;\n      } else {\n        x3 = points[i + 2 - count].x;\n        y3 = points[i + 2 - count].y;\n      }\n\n      var ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n\n      if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n        points.splice(l - 1, count - (l - 1) - 1);\n        var lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n        lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n        points.push(lastPoint);\n        count = points.length;\n      } else {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n      }\n\n      points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n      points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n      preCtrlPoints = ctrlPoints;\n    }\n\n    if (!close && points[1].prevCtrlPoint) {\n      points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n      delete points[0].prevCtrlPoint;\n    }\n\n    if (!points[count - 1].prevCtrlPoint) {\n      points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n    }\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _arcBetween: function _arcBetween(ctx, p1, p2, degree) {\n    var a = degree,\n        dist = p1.distanceTo(p2),\n        r = dist / 2 / Math.sin(a / 2);\n    var p1p2 = Math.asin((p2.y - p1.y) / dist);\n\n    if (p1.x > p2.x) {\n      p1p2 = Math.PI - p1p2;\n    }\n\n    var cp2 = 90 * RADIAN - a / 2,\n        da = p1p2 - cp2;\n    var dx = Math.cos(da) * r,\n        dy = Math.sin(da) * r,\n        cx = p1.x + dx,\n        cy = p1.y + dy;\n    var startAngle = Math.asin((p2.y - cy) / r);\n\n    if (cx > p2.x) {\n      startAngle = Math.PI - startAngle;\n    }\n\n    var endAngle = startAngle + a;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r, startAngle, endAngle);\n    return [cx, cy];\n  },\n  _lineTo: function _lineTo(ctx, p) {\n    ctx.lineTo(p.x, p.y);\n  },\n  bezierCurveAndFill: function bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n    ctx.beginPath();\n    var start = points[0];\n    ctx.moveTo(start.x, start.y);\n    var args = [ctx];\n    args.push.apply(args, points.splice(1));\n\n    Canvas._bezierCurveTo.apply(Canvas, args);\n\n    Canvas.fillCanvas(ctx, fillOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _bezierCurveTo: function _bezierCurveTo(ctx, p1, p2, p3) {\n    ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n  },\n  ellipse: function ellipse(ctx, pt, width, heightTop, heightBottom, lineOpacity, fillOpacity) {\n    function bezierEllipse(x, y, a, b, b1) {\n      var k = 0.5522848,\n          ox = a * k,\n          oy = b * k,\n          oy1 = b1 * k;\n      ctx.moveTo(x - a, y);\n      ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n      ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n      ctx.bezierCurveTo(x + a, y + oy1, x + ox, y + b1, x, y + b1);\n      ctx.bezierCurveTo(x - ox, y + b1, x - a, y + oy1, x - a, y);\n      ctx.closePath();\n    }\n\n    ctx.beginPath();\n\n    if (width === heightTop && width === heightBottom) {\n      ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n    } else if (ctx.ellipse) {\n      if (heightTop !== heightBottom) {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, RADIAN * 180, RADIAN * 360, false);\n        ctx.ellipse(pt.x, pt.y, width, heightBottom, 0, 0, RADIAN * 180, false);\n      } else {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, 0, RADIAN * 360, false);\n      }\n    } else {\n      bezierEllipse(pt.x, pt.y, width, heightTop, heightBottom);\n    }\n\n    Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - heightTop);\n\n    Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - heightTop);\n  },\n  rectangle: function rectangle(ctx, pt, size, lineOpacity, fillOpacity) {\n    var x = pt.x,\n        y = pt.y;\n    ctx.beginPath();\n    ctx.rect(x, y, size['width'], size['height']);\n    Canvas.fillCanvas(ctx, fillOpacity, x, y);\n\n    Canvas._stroke(ctx, lineOpacity, x, y);\n  },\n  sector: function sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n    var rad = RADIAN;\n    var startAngle = angles[0],\n        endAngle = angles[1];\n\n    function sector(ctx, x, y, radius, startAngle, endAngle) {\n      var sDeg = rad * -endAngle;\n      var eDeg = rad * -startAngle;\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      ctx.arc(x, y, radius, sDeg, eDeg);\n      ctx.lineTo(x, y);\n      Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n\n      Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n    }\n\n    sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n  },\n  _isPattern: function _isPattern(style) {\n    return !isString(style) && !('addColorStop' in style);\n  },\n  drawCross: function drawCross(ctx, x, y, lineWidth, color) {\n    ctx.canvas._drawn = true;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.moveTo(x - 5, y);\n    ctx.lineTo(x + 5, y);\n    ctx.moveTo(x, y - 5);\n    ctx.lineTo(x, y + 5);\n    ctx.stroke();\n  },\n  copy: function copy(canvas, c) {\n    var target = c || createEl('canvas');\n    target.width = canvas.width;\n    target.height = canvas.height;\n    target.getContext('2d').drawImage(canvas, 0, 0);\n    return target;\n  }\n};\n\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n  var fromX = startPoint.x,\n      fromY = startPoint.y,\n      toX = endPoint.x,\n      toY = endPoint.y;\n  var pattern = dashArray;\n\n  var lt = function lt(a, b) {\n    return a <= b;\n  };\n\n  var gt = function gt(a, b) {\n    return a >= b;\n  };\n\n  var capmin = function capmin(a, b) {\n    return Math.min(a, b);\n  };\n\n  var capmax = function capmax(a, b) {\n    return Math.max(a, b);\n  };\n\n  var checkX = {\n    thereYet: gt,\n    cap: capmin\n  };\n  var checkY = {\n    thereYet: gt,\n    cap: capmin\n  };\n\n  if (fromY - toY > 0) {\n    checkY.thereYet = lt;\n    checkY.cap = capmax;\n  }\n\n  if (fromX - toX > 0) {\n    checkX.thereYet = lt;\n    checkX.cap = capmax;\n  }\n\n  ctx.moveTo(fromX, fromY);\n  var offsetX = fromX;\n  var offsetY = fromY;\n  var idx = 0,\n      dash = true;\n  var ang, len;\n\n  while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n    ang = Math.atan2(toY - fromY, toX - fromX);\n    len = pattern[idx];\n    offsetX = checkX.cap(toX, offsetX + Math.cos(ang) * len);\n    offsetY = checkY.cap(toY, offsetY + Math.sin(ang) * len);\n\n    if (dash) {\n      ctx.lineTo(offsetX, offsetY);\n    } else {\n      ctx.moveTo(offsetX, offsetY);\n    }\n\n    idx = (idx + 1) % pattern.length;\n    dash = !dash;\n  }\n}\n\nvar prefix = 'data:image/';\n\nfunction extractImageUrl(url) {\n  if (url.substring(0, prefix.length) === prefix) {\n    return url;\n  }\n\n  return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n  ctx.filter = savedCtx.filter;\n  ctx.fillStyle = savedCtx.fillStyle;\n  ctx.globalAlpha = savedCtx.globalAlpha;\n  ctx.lineCap = savedCtx.lineCap;\n  ctx.lineDashOffset = savedCtx.lineDashOffset;\n  ctx.lineJoin = savedCtx.lineJoin;\n  ctx.lineWidth = savedCtx.lineWidth;\n  ctx.shadowBlur = savedCtx.shadowBlur;\n  ctx.shadowColor = savedCtx.shadowColor;\n  ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n  ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n  ctx.strokeStyle = savedCtx.strokeStyle;\n}\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar zousanMin = createCommonjsModule(function (module) {\n  !function (t) {\n\n    function e(t) {\n      if (t) {\n        var e = this;\n        t(function (t) {\n          e.resolve(t);\n        }, function (t) {\n          e.reject(t);\n        });\n      }\n    }\n\n    function n(t, e) {\n      if (\"function\" == typeof t.y) try {\n        var n = t.y.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.resolve(e);\n    }\n\n    function o(t, e) {\n      if (\"function\" == typeof t.n) try {\n        var n = t.n.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.reject(e);\n    }\n\n    var r,\n        i,\n        c = \"fulfilled\",\n        u = \"rejected\",\n        s = \"undefined\",\n        f = function () {\n      function e() {\n        for (; n.length - o;) {\n          try {\n            n[o]();\n          } catch (e) {\n            t.console && t.console.error(e);\n          }\n\n          n[o++] = i, o == r && (n.splice(0, r), o = 0);\n        }\n      }\n\n      var n = [],\n          o = 0,\n          r = 1024,\n          c = function () {\n        if (typeof MutationObserver !== s) {\n          var t = document.createElement(\"div\"),\n              n = new MutationObserver(e);\n          return n.observe(t, {\n            attributes: !0\n          }), function () {\n            t.setAttribute(\"a\", 0);\n          };\n        }\n\n        return typeof setImmediate !== s ? function () {\n          setImmediate(e);\n        } : function () {\n          setTimeout(e, 0);\n        };\n      }();\n\n      return function (t) {\n        n.push(t), n.length - o == 1 && c();\n      };\n    }();\n\n    e.prototype = {\n      resolve: function resolve(t) {\n        if (this.state === r) {\n          if (t === this) return this.reject(new TypeError(\"Attempt to resolve promise with self\"));\n          var e = this;\n          if (t && (\"function\" == typeof t || \"object\" == typeof t)) try {\n            var o = !0,\n                i = t.then;\n            if (\"function\" == typeof i) return void i.call(t, function (t) {\n              o && (o = !1, e.resolve(t));\n            }, function (t) {\n              o && (o = !1, e.reject(t));\n            });\n          } catch (u) {\n            return void (o && this.reject(u));\n          }\n          this.state = c, this.v = t, e.c && f(function () {\n            for (var o = 0, r = e.c.length; r > o; o++) {\n              n(e.c[o], t);\n            }\n          });\n        }\n      },\n      reject: function reject(n) {\n        if (this.state === r) {\n          this.state = u, this.v = n;\n          var i = this.c;\n          i ? f(function () {\n            for (var t = 0, e = i.length; e > t; t++) {\n              o(i[t], n);\n            }\n          }) : !e.suppressUncaughtRejectionError && t.console && t.console.log(\"You upset Zousan. Please catch rejections: \", n, n ? n.stack : null);\n        }\n      },\n      then: function then(t, i) {\n        var u = new e(),\n            s = {\n          y: t,\n          n: i,\n          p: u\n        };\n        if (this.state === r) this.c ? this.c.push(s) : this.c = [s];else {\n          var l = this.state,\n              a = this.v;\n          f(function () {\n            l === c ? n(s, a) : o(s, a);\n          });\n        }\n        return u;\n      },\n      \"catch\": function _catch(t) {\n        return this.then(null, t);\n      },\n      \"finally\": function _finally(t) {\n        return this.then(t, t);\n      },\n      timeout: function timeout(t, n) {\n        n = n || \"Timeout\";\n        var o = this;\n        return new e(function (e, r) {\n          setTimeout(function () {\n            r(Error(n));\n          }, t), o.then(function (t) {\n            e(t);\n          }, function (t) {\n            r(t);\n          });\n        });\n      }\n    }, e.resolve = function (t) {\n      var n = new e();\n      return n.resolve(t), n;\n    }, e.reject = function (t) {\n      var n = new e();\n      return n.reject(t), n;\n    }, e.all = function (t) {\n      function n(n, c) {\n        n && \"function\" == typeof n.then || (n = e.resolve(n)), n.then(function (e) {\n          o[c] = e, r++, r == t.length && i.resolve(o);\n        }, function (t) {\n          i.reject(t);\n        });\n      }\n\n      for (var o = [], r = 0, i = new e(), c = 0; c < t.length; c++) {\n        n(t[c], c);\n      }\n\n      return t.length || i.resolve(o), i;\n    }, module.exports && (module.exports = e), t.define && t.define.amd && t.define([], function () {\n      return e;\n    }), t.Zousan = e, e.soon = f;\n  }(\"undefined\" != typeof commonjsGlobal ? commonjsGlobal : commonjsGlobal);\n});\n\nvar promise;\n\nif (typeof Promise !== 'undefined') {\n  promise = Promise;\n} else {\n  promise = zousanMin;\n}\n\nvar Promise$1 = promise;\n\nvar Eventable = function Eventable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.on = function on$$1(eventsOn, handler, context) {\n      if (!eventsOn) {\n        return this;\n      }\n\n      if (!isString(eventsOn)) {\n        return this._switch('on', eventsOn, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      if (!this._eventMap) {\n        this._eventMap = {};\n      }\n\n      var eventTypes = eventsOn.toLowerCase().split(' ');\n      var evtType;\n\n      if (!context) {\n        context = this;\n      }\n\n      var handlerChain;\n\n      for (var ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n        evtType = eventTypes[ii];\n        handlerChain = this._eventMap[evtType];\n\n        if (!handlerChain) {\n          handlerChain = [];\n          this._eventMap[evtType] = handlerChain;\n        }\n\n        var l = handlerChain.length;\n\n        if (l > 0) {\n          for (var i = 0; i < l; i++) {\n            if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n              return this;\n            }\n          }\n        }\n\n        handlerChain.push({\n          handler: handler,\n          context: context\n        });\n      }\n\n      return this;\n    };\n\n    _proto.addEventListener = function addEventListener() {\n      return this.on.apply(this, arguments);\n    };\n\n    _proto.once = function once(eventTypes, handler, context) {\n      if (!isString(eventTypes)) {\n        var once = {};\n\n        for (var p in eventTypes) {\n          if (eventTypes.hasOwnProperty(p)) {\n            once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n          }\n        }\n\n        return this._switch('on', once);\n      }\n\n      var evetTypes = eventTypes.split(' ');\n\n      for (var i = 0, l = evetTypes.length; i < l; i++) {\n        this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n      }\n\n      return this;\n    };\n\n    _proto.off = function off$$1(eventsOff, handler, context) {\n      if (!this._eventMap || !eventsOff) {\n        return this;\n      }\n\n      if (!isString(eventsOff)) {\n        return this._switch('off', eventsOff, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      var eventTypes = eventsOff.split(' ');\n      var eventType, listeners, wrapKey;\n\n      if (!context) {\n        context = this;\n      }\n\n      for (var j = 0, jl = eventTypes.length; j < jl; j++) {\n        eventType = eventTypes[j].toLowerCase();\n        wrapKey = 'Z__' + eventType;\n        listeners = this._eventMap[eventType];\n\n        if (!listeners) {\n          return this;\n        }\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n          var listener = listeners[i];\n\n          if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n            delete listener.handler[wrapKey];\n            listeners.splice(i, 1);\n          }\n        }\n\n        if (!listeners.length) {\n          delete this._eventMap[eventType];\n        }\n      }\n\n      return this;\n    };\n\n    _proto.removeEventListener = function removeEventListener() {\n      return this.off.apply(this, arguments);\n    };\n\n    _proto.listens = function listens(eventType, handler, context) {\n      if (!this._eventMap || !isString(eventType)) {\n        return 0;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain || !handlerChain.length) {\n        return 0;\n      }\n\n      if (!handler) {\n        return handlerChain.length;\n      }\n\n      for (var i = 0, len = handlerChain.length; i < len; i++) {\n        if (handler === handlerChain[i].handler && (isNil(context) || handlerChain[i].context === context)) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n\n    _proto.getListeningEvents = function getListeningEvents() {\n      if (!this._eventMap) {\n        return [];\n      }\n\n      return Object.keys(this._eventMap);\n    };\n\n    _proto.copyEventListeners = function copyEventListeners(target) {\n      var eventMap = target._eventMap;\n\n      if (!eventMap) {\n        return this;\n      }\n\n      var handlerChain;\n\n      for (var eventType in eventMap) {\n        handlerChain = eventMap[eventType];\n\n        for (var i = 0, len = handlerChain.length; i < len; i++) {\n          this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto.fire = function fire() {\n      if (this._eventParent) {\n        return this._eventParent.fire.apply(this._eventParent, arguments);\n      }\n\n      return this._fire.apply(this, arguments);\n    };\n\n    _proto._wrapOnceHandler = function _wrapOnceHandler(evtType, handler, context) {\n      var me = this;\n      var key = 'Z__' + evtType;\n      var called = false;\n\n      var fn = function onceHandler() {\n        if (called) {\n          return;\n        }\n\n        delete fn[key];\n        called = true;\n\n        if (context) {\n          handler.apply(context, arguments);\n        } else {\n          handler.apply(this, arguments);\n        }\n\n        me.off(evtType, onceHandler, this);\n      };\n\n      fn[key] = handler;\n      return fn;\n    };\n\n    _proto._switch = function _switch(to, eventKeys, context) {\n      for (var p in eventKeys) {\n        if (eventKeys.hasOwnProperty(p)) {\n          this[to](p, eventKeys[p], context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto._clearListeners = function _clearListeners(eventType) {\n      if (!this._eventMap || !isString(eventType)) {\n        return;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return;\n      }\n\n      this._eventMap[eventType] = null;\n    };\n\n    _proto._clearAllListeners = function _clearAllListeners() {\n      this._eventMap = null;\n    };\n\n    _proto._setEventParent = function _setEventParent(parent) {\n      this._eventParent = parent;\n      return this;\n    };\n\n    _proto._setEventTarget = function _setEventTarget(target) {\n      this._eventTarget = target;\n      return this;\n    };\n\n    _proto._fire = function _fire(eventType, param) {\n      if (!this._eventMap) {\n        return this;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return this;\n      }\n\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventType;\n      param['target'] = this._eventTarget || this;\n      var queue = handlerChain.slice(0);\n      var context, bubble, passed;\n\n      for (var i = 0, len = queue.length; i < len; i++) {\n        if (!queue[i]) {\n          continue;\n        }\n\n        context = queue[i].context;\n        bubble = true;\n        passed = extend({}, param);\n\n        if (context) {\n          bubble = queue[i].handler.call(context, passed);\n        } else {\n          bubble = queue[i].handler(passed);\n        }\n\n        if (bubble === false) {\n          if (param['domEvent']) {\n            stopPropagation(param['domEvent']);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar Handler = function () {\n  function Handler(target) {\n    this.target = target;\n  }\n\n  var _proto = Handler.prototype;\n\n  _proto.enable = function enable() {\n    if (this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n    this.addHooks();\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled) {\n      return this;\n    }\n\n    this._enabled = false;\n    this.removeHooks();\n    return this;\n  };\n\n  _proto.enabled = function enabled() {\n    return !!this._enabled;\n  };\n\n  _proto.remove = function remove() {\n    this.disable();\n    delete this.target;\n    delete this.dom;\n  };\n\n  return Handler;\n}();\n\nvar Handler$1 = Eventable(Handler);\n\nvar Class = function () {\n  function Class(options) {\n    if (!this || !this.setOptions) {\n      throw new Error('Class instance is being created without \"new\" operator.');\n    }\n\n    this.setOptions(options);\n    this.callInitHooks();\n  }\n\n  var _proto = Class.prototype;\n\n  _proto.callInitHooks = function callInitHooks() {\n    var proto = Object.getPrototypeOf(this);\n\n    this._visitInitHooks(proto);\n\n    return this;\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    if (!this.hasOwnProperty('options')) {\n      this.options = this.options ? Object.create(this.options) : {};\n    }\n\n    if (!options) {\n      return this;\n    }\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    return this;\n  };\n\n  _proto.config = function config(conf) {\n    if (!conf) {\n      var config = {};\n\n      for (var p in this.options) {\n        if (this.options.hasOwnProperty(p)) {\n          config[p] = this.options[p];\n        }\n      }\n\n      return config;\n    } else {\n      if (arguments.length === 2) {\n        var t = {};\n        t[conf] = arguments[1];\n        conf = t;\n      }\n\n      for (var i in conf) {\n        this.options[i] = conf[i];\n\n        if (this[i] && this[i] instanceof Handler$1) {\n          if (conf[i]) {\n            this[i].enable();\n          } else {\n            this[i].disable();\n          }\n        }\n      }\n\n      this.onConfig(conf);\n    }\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig() {};\n\n  _proto._visitInitHooks = function _visitInitHooks(proto) {\n    if (this._initHooksCalled) {\n      return;\n    }\n\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (parentProto._visitInitHooks) {\n      parentProto._visitInitHooks.call(this, parentProto);\n    }\n\n    this._initHooksCalled = true;\n    var hooks = proto._initHooks;\n\n    if (hooks && hooks !== parentProto._initHooks) {\n      for (var i = 0; i < hooks.length; i++) {\n        hooks[i].call(this);\n      }\n    }\n  };\n\n  Class.addInitHook = function addInitHook(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var init = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n      proto._initHooks = [];\n    }\n\n    proto._initHooks.push(init);\n\n    return this;\n  };\n\n  Class.include = function include() {\n    for (var i = 0; i < arguments.length; i++) {\n      extend(this.prototype, i < 0 || arguments.length <= i ? undefined : arguments[i]);\n    }\n\n    return this;\n  };\n\n  Class.mergeOptions = function mergeOptions(options) {\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto.options || proto.options === parentProto.options) {\n      proto.options = proto.options ? Object.create(proto.options) : {};\n    }\n\n    extend(proto.options, options);\n    return this;\n  };\n\n  return Class;\n}();\n\nvar registeredTypes = {};\nvar JSONAble = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerJSONType = function registerJSONType(type) {\n      if (!type) {\n        return this;\n      }\n\n      registeredTypes[type] = this;\n      return this;\n    };\n\n    _class.getJSONClass = function getJSONClass(type) {\n      if (!type) {\n        return null;\n      }\n\n      return registeredTypes[type];\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getJSONType = function getJSONType() {\n      if (this._jsonType === undefined) {\n        var clazz = Object.getPrototypeOf(this).constructor;\n\n        for (var p in registeredTypes) {\n          if (registeredTypes[p] === clazz) {\n            this._jsonType = p;\n            break;\n          }\n        }\n      }\n\n      if (!this._jsonType) {\n        throw new Error('Found an unregistered geometry class!');\n      }\n\n      return this._jsonType;\n    };\n\n    return _class;\n  }(Base);\n});\n\nfunction Handlerable (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.addHandler = function addHandler(name, handlerClass) {\n      if (!handlerClass) {\n        return this;\n      }\n\n      if (!this._handlers) {\n        this._handlers = [];\n      }\n\n      if (this[name]) {\n        this[name].enable();\n        return this;\n      }\n\n      var handler = this[name] = new handlerClass(this);\n\n      this._handlers.push(handler);\n\n      if (this.options[name]) {\n        handler.enable();\n      }\n\n      return this;\n    };\n\n    _proto.removeHandler = function removeHandler(name) {\n      if (!name) {\n        return this;\n      }\n\n      var handler = this[name];\n\n      if (handler) {\n        var hit = this._handlers.indexOf(handler);\n\n        if (hit >= 0) {\n          this._handlers.splice(hit, 1);\n        }\n\n        this[name].remove();\n        delete this[name];\n      }\n\n      return this;\n    };\n\n    _proto._clearHandlers = function _clearHandlers() {\n      for (var i = 0, len = this._handlers.length; i < len; i++) {\n        this._handlers[i].remove();\n      }\n\n      this._handlers = [];\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar START_EVENTS = 'touchstart mousedown';\nvar MOVE_EVENTS = {\n  mousedown: 'mousemove',\n  touchstart: 'touchmove',\n  pointerdown: 'touchmove',\n  MSPointerDown: 'touchmove'\n};\nvar END_EVENTS = {\n  mousedown: 'mouseup',\n  touchstart: 'touchend',\n  pointerdown: 'touchend',\n  MSPointerDown: 'touchend'\n};\n\nvar DragHandler = function (_Handler) {\n  _inheritsLoose(DragHandler, _Handler);\n\n  function DragHandler(dom, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _Handler.call(this, null) || this;\n    _this.dom = dom;\n    _this.options = options;\n    return _this;\n  }\n\n  var _proto = DragHandler.prototype;\n\n  _proto.enable = function enable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._onMouseDown = function (e) {\n      return this.onMouseDown(e);\n    };\n\n    on(this.dom, START_EVENTS, this._onMouseDown, this);\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._offEvents();\n\n    off(this.dom, START_EVENTS, this._onMouseDown);\n    delete this._onMouseDown;\n    return this;\n  };\n\n  _proto.onMouseDown = function onMouseDown(event) {\n    if (!this.options['rightclick'] && event.button === 2) {\n      return;\n    }\n\n    if (event.touches && event.touches.length > 1) {\n      return;\n    }\n\n    if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n      return;\n    }\n\n    var dom = this.dom;\n\n    if (dom.setCapture) {\n      dom.setCapture();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n\n    dom['ondragstart'] = function () {\n      return false;\n    };\n\n    delete this.moved;\n    var actual = event.touches ? event.touches[0] : event;\n    this.startPos = new Point(actual.clientX, actual.clientY);\n    on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n    on(document, END_EVENTS[event.type], this.onMouseUp, this);\n\n    if (!this.options['ignoreMouseleave']) {\n      on(this.dom, 'mouseleave', this.onMouseUp, this);\n    }\n\n    this.fire('mousedown', {\n      'domEvent': event,\n      'mousePos': new Point(actual.clientX, actual.clientY)\n    });\n  };\n\n  _proto.onMouseMove = function onMouseMove(event) {\n    if (event.touches && event.touches.length > 1) {\n      if (this.moved) {\n        this.interupted = true;\n        this.onMouseUp(event);\n      }\n\n      return;\n    }\n\n    var actual = event.touches ? event.touches[0] : event;\n    var newPos = new Point(actual.clientX, actual.clientY),\n        offset = newPos.sub(this.startPos);\n\n    if (!offset.x && !offset.y) {\n      return;\n    }\n\n    if (!this.moved) {\n      this.fire('dragstart', {\n        'domEvent': event,\n        'mousePos': this.startPos.copy()\n      });\n      this.moved = true;\n    } else {\n      this.fire('dragging', {\n        'domEvent': event,\n        'mousePos': new Point(actual.clientX, actual.clientY)\n      });\n    }\n  };\n\n  _proto.onMouseUp = function onMouseUp(event) {\n    var actual = event.changedTouches ? event.changedTouches[0] : event;\n\n    this._offEvents();\n\n    var param = {\n      'domEvent': event\n    };\n\n    if (isNumber(actual.clientX)) {\n      param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n    }\n\n    if (this.moved) {\n        param.interupted = this.interupted;\n        this.fire('dragend', param);\n        delete this.interupted;\n        delete this.moved;\n      }\n\n    this.fire('mouseup', param);\n  };\n\n  _proto._offEvents = function _offEvents() {\n    var dom = this.dom;\n    off(dom, 'mouseleave', this.onMouseUp, this);\n\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\n      return;\n    }\n\n    for (var i in MOVE_EVENTS) {\n      off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n      off(document, END_EVENTS[i], this.onMouseUp, this);\n    }\n\n    if (dom['releaseCapture']) {\n      dom['releaseCapture']();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n  };\n\n  return DragHandler;\n}(Handler$1);\n\nvar Coordinate = function (_Position) {\n  _inheritsLoose(Coordinate, _Position);\n\n  function Coordinate() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  Coordinate.toNumberArrays = function toNumberArrays(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return [coordinates.x, coordinates.y];\n    }\n\n    return forEachCoord(coordinates, function (coord) {\n      return [coord.x, coord.y];\n    });\n  };\n\n  Coordinate.toCoordinates = function toCoordinates(coordinates) {\n    if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n      return new Coordinate(coordinates);\n    }\n\n    var result = [];\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var child = coordinates[i];\n\n      if (Array.isArray(child)) {\n        if (isNumber(child[0])) {\n          result.push(new Coordinate(child));\n        } else {\n          result.push(Coordinate.toCoordinates(child));\n        }\n      } else {\n        result.push(new Coordinate(child));\n      }\n    }\n\n    return result;\n  };\n\n  return Coordinate;\n}(Position);\n\nvar CRS = function () {\n  function CRS(type, properties) {\n    this.type = type;\n    this.properties = properties;\n  }\n\n  CRS.createProj4 = function createProj4(proj) {\n    return new CRS('proj4', {\n      'proj': proj\n    });\n  };\n\n  CRS.fromProjectionCode = function fromProjectionCode(code) {\n    if (!code) {\n      return null;\n    }\n\n    code = code.toUpperCase().replace(':', '');\n    return CRS[code] || null;\n  };\n\n  return CRS;\n}();\n\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\nCRS.EPSG4326 = CRS.WGS84;\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\nCRS.EPSG4490 = CRS.CGCS2000;\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\n\nvar TEMP_POINT0 = new Point(0, 0);\nvar TEMP_COORD0 = new Coordinate(0, 0);\nvar TEMP_COORD1 = new Coordinate(0, 0);\nvar TEMP_COORD2 = new Coordinate(0, 0);\nvar TEMP_COORD3 = new Coordinate(0, 0);\nvar TEMP_COORD4 = new Coordinate(0, 0);\nvar TEMP_COORD5 = new Coordinate(0, 0);\nvar TEMP_COORD6 = new Coordinate(0, 0);\nvar TEMP_COORD7 = new Coordinate(0, 0);\nvar MINMAX = [];\nvar TEMP_EXTENT;\nvar TEMP_COMBINE = [];\n\nvar Extent = function () {\n  function Extent(p1, p2, p3, p4) {\n    this._clazz = Coordinate;\n    var l = arguments.length;\n    var proj = l > 0 ? arguments[l - 1] : null;\n\n    if (proj && proj.unproject) {\n      this.projection = arguments[l - 1];\n    }\n\n    this._dirty = true;\n\n    this._initialize(p1, p2, p3, p4);\n  }\n\n  var _proto = Extent.prototype;\n\n  _proto._initialize = function _initialize(p1, p2, p3, p4) {\n    this.xmin = null;\n    this.xmax = null;\n    this.ymin = null;\n    this.ymax = null;\n\n    if (isNil(p1)) {\n      return;\n    }\n\n    var projection = this.projection;\n\n    if (isNumber(p1) && isNumber(p2) && isNumber(p3) && isNumber(p4)) {\n      if (projection) {\n        this.set(p1, p2, p3, p4);\n      } else {\n        this.set(Math.min(p1, p3), Math.min(p2, p4), Math.max(p1, p3), Math.max(p2, p4));\n      }\n\n      return;\n    } else if (Array.isArray(p1)) {\n      if (projection) {\n        this.set(p1[0], p1[1], p1[2], p1[3]);\n      } else {\n        this.set(Math.min(p1[0], p1[2]), Math.min(p1[1], p1[3]), Math.max(p1[0], p1[2]), Math.max(p1[1], p1[3]));\n      }\n    } else if (isNumber(p1.x) && isNumber(p2.x) && isNumber(p1.y) && isNumber(p2.y)) {\n      if (projection) {\n        this.set(p1.x, p1.y, p2.x, p2.y);\n      } else {\n        if (p1.x > p2.x) {\n          this['xmin'] = p2.x;\n          this['xmax'] = p1.x;\n        } else {\n          this['xmin'] = p1.x;\n          this['xmax'] = p2.x;\n        }\n\n        if (p1.y > p2.y) {\n          this['ymin'] = p2.y;\n          this['ymax'] = p1.y;\n        } else {\n          this['ymin'] = p1.y;\n          this['ymax'] = p2.y;\n        }\n      }\n    } else if (isNumber(p1['xmin']) && isNumber(p1['xmax']) && isNumber(p1['ymin']) && isNumber(p1['ymax'])) {\n      this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n    }\n  };\n\n  _proto._add = function _add(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] += p.x;\n      this['ymin'] += p.y;\n      this['xmax'] += p.x;\n      this['ymax'] += p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] += p.xmin;\n      this['ymin'] += p.ymin;\n      this['xmax'] += p.xmax;\n      this['ymax'] += p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] += p[0];\n      this['ymin'] += p[1];\n      this['xmax'] += p[0];\n      this['ymax'] += p[1];\n    }\n\n    return this;\n  };\n\n  _proto.add = function add() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._add.apply(e, arguments);\n  };\n\n  _proto._scale = function _scale(s) {\n    this._dirty = true;\n    this['xmin'] *= s;\n    this['ymin'] *= s;\n    this['xmax'] *= s;\n    this['ymax'] *= s;\n    return this;\n  };\n\n  _proto._sub = function _sub(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] -= p.x;\n      this['ymin'] -= p.y;\n      this['xmax'] -= p.x;\n      this['ymax'] -= p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] -= p.xmin;\n      this['ymin'] -= p.ymin;\n      this['xmax'] -= p.xmax;\n      this['ymax'] -= p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] -= p[0];\n      this['ymin'] -= p[1];\n      this['xmax'] -= p[0];\n      this['ymax'] -= p[1];\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._sub.apply(e, arguments);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']), Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n  };\n\n  _proto._round = function _round() {\n    this._dirty = true;\n    this['xmin'] = Math.round(this['xmin']);\n    this['ymin'] = Math.round(this['ymin']);\n    this['xmax'] = Math.round(this['xmax']);\n    this['ymax'] = Math.round(this['ymax']);\n    return this;\n  };\n\n  _proto.getMin = function getMin(out) {\n    if (out) {\n      out.set(this['xmin'], this['ymin']);\n      return out;\n    }\n\n    return new this._clazz(this['xmin'], this['ymin']);\n  };\n\n  _proto.getMax = function getMax(out) {\n    if (out) {\n      out.set(this['xmax'], this['ymax']);\n      return out;\n    }\n\n    return new this._clazz(this['xmax'], this['ymax']);\n  };\n\n  _proto.getCenter = function getCenter(out) {\n    var x = (this['xmin'] + this['xmax']) / 2;\n    var y = (this['ymin'] + this['ymax']) / 2;\n\n    if (out) {\n      out.set(x, y);\n      return out;\n    }\n\n    return new this._clazz(x, y);\n  };\n\n  _proto.isValid = function isValid() {\n    return !isNil(this['xmin']) && !isNil(this['ymin']) && !isNil(this['xmax']) && !isNil(this['ymax']);\n  };\n\n  _proto.equals = function equals(ext2) {\n    return this['xmin'] === ext2['xmin'] && this['xmax'] === ext2['xmax'] && this['ymin'] === ext2['ymin'] && this['ymax'] === ext2['ymax'];\n  };\n\n  _proto.intersects = function intersects(ext2) {\n    this._project(this);\n\n    this._project(ext2);\n\n    var rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n    var rymin = Math.max(this['pymin'], ext2['pymin']);\n    var rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n    var rymax = Math.min(this['pymax'], ext2['pymax']);\n    var intersects = !(rxmin > rxmax || rymin > rymax);\n    return intersects;\n  };\n\n  _proto.within = function within(extent) {\n    this._project(this);\n\n    this._project(extent);\n\n    return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n  };\n\n  _proto.contains = function contains(c) {\n    if (!c) {\n      return false;\n    }\n\n    this._project(this);\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (c.x !== undefined) {\n        var coord = TEMP_COORD0;\n\n        if (Array.isArray(c)) {\n          coord.x = c[0];\n          coord.y = c[1];\n        } else {\n          coord.x = c.x;\n          coord.y = c.y;\n        }\n\n        c = proj.project(coord, coord);\n      } else if (c.xmin !== undefined) {\n        this._project(c);\n      }\n    }\n\n    return (c.x || c.pxmin || 0) >= this.pxmin && (c.x || c.pxmax || 0) <= this.pxmax && (c.y || c.pymin || 0) >= this.pymin && (c.y || c.pymax || 0) <= this.pymax;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return Math.abs(this['xmax'] - this['xmin']);\n  };\n\n  _proto.getHeight = function getHeight() {\n    return Math.abs(this['ymax'] - this['ymin']);\n  };\n\n  _proto.getSize = function getSize() {\n    return new Size(this.getWidth(), this.getHeight());\n  };\n\n  _proto.set = function set(xmin, ymin, xmax, ymax) {\n    this.xmin = xmin;\n    this.ymin = ymin;\n    this.xmax = xmax;\n    this.ymax = ymax;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.__combine = function __combine(extent) {\n    if (extent.x !== undefined) {\n      TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n      TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n      extent = TEMP_EXTENT;\n    }\n\n    this._project(extent);\n\n    this._project(this);\n\n    var inited = isNumber(this.pxmin);\n    var xmin, ymin, xmax, ymax;\n\n    if (!inited) {\n      xmin = extent['pxmin'];\n      ymin = extent['pymin'];\n      xmax = extent['pxmax'];\n      ymax = extent['pymax'];\n    } else {\n      xmin = Math.min(this['pxmin'], extent['pxmin']);\n      ymin = Math.min(this['pymin'], extent['pymin']);\n      xmax = Math.max(this['pxmax'], extent['pxmax']);\n      ymax = Math.max(this['pymax'], extent['pymax']);\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      TEMP_COORD1.set(xmin, ymin);\n      TEMP_COORD2.set(xmax, ymax);\n      var min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n          max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n      xmin = min.x;\n      ymin = min.y;\n      xmax = max.x;\n      ymax = max.y;\n    }\n\n    TEMP_COMBINE[0] = xmin;\n    TEMP_COMBINE[1] = ymin;\n    TEMP_COMBINE[2] = xmax;\n    TEMP_COMBINE[3] = ymax;\n    return TEMP_COMBINE;\n  };\n\n  _proto._combine = function _combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    this.set(ext[0], ext[1], ext[2], ext[3]);\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.combine = function combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n  };\n\n  _proto.intersection = function intersection(extent) {\n    if (!this.intersects(extent)) {\n      return null;\n    }\n\n    TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n    TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n    TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n    TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n    var min = TEMP_COORD3,\n        max = TEMP_COORD4;\n    var proj = this.projection;\n\n    if (proj) {\n      min = proj.unproject(min, min);\n      max = proj.unproject(max, max);\n    }\n\n    return new this.constructor(min, max, proj);\n  };\n\n  _proto.expand = function expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n  };\n\n  _proto._expand = function _expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    this['xmin'] -= w;\n    this['ymin'] -= h;\n    this['xmax'] += w;\n    this['ymax'] += h;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'xmin': this['xmin'],\n      'ymin': this['ymin'],\n      'xmax': this['xmax'],\n      'ymax': this['ymax']\n    };\n  };\n\n  _proto.toArray = function toArray() {\n    var xmin = this['xmin'],\n        ymin = this['ymin'],\n        xmax = this['xmax'],\n        ymax = this['ymax'];\n    return [new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]), new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]), new this._clazz([xmin, ymax])];\n  };\n\n  _proto.toString = function toString() {\n    return this.xmin + \",\" + this.ymin + \",\" + this.xmax + \",\" + this.ymax;\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n  };\n\n  _proto.convertTo = function convertTo(fn, out) {\n    if (!this.isValid()) {\n      return null;\n    }\n\n    var e = out || new this.constructor();\n\n    if (out) {\n      e.set(null, null, null, null);\n    }\n\n    var coord;\n\n    if (this._clazz === Coordinate) {\n      coord = TEMP_COORD5;\n    } else if (this._clazz === Point) {\n      coord = TEMP_POINT0;\n    }\n\n    coord.x = this.xmin;\n    coord.y = this.ymax;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmax;\n\n    e._combine(fn(coord));\n\n    coord.y = this.ymin;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmin;\n\n    e._combine(fn(coord));\n\n    return e;\n  };\n\n  _proto._project = function _project(ext) {\n    if (!ext || !ext.isValid()) {\n      if (ext) {\n        ext.pxmin = ext.pxmax = ext.pymin = ext.pymax = null;\n      }\n\n      return;\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (ext._dirty) {\n        TEMP_COORD6.set(ext.xmax, ext.ymin);\n        TEMP_COORD7.set(ext.xmin, ext.ymax);\n        MINMAX[0] = TEMP_COORD6;\n        MINMAX[1] = TEMP_COORD7;\n        var minmax = proj.projectCoords(MINMAX);\n        var min = minmax[0],\n            max = minmax[1];\n        ext.pxmin = Math.min(min.x, max.x);\n        ext.pymin = Math.min(min.y, max.y);\n        ext.pxmax = Math.max(min.x, max.x);\n        ext.pymax = Math.max(min.y, max.y);\n      }\n\n      delete ext._dirty;\n    } else {\n      ext.pxmin = ext.xmin;\n      ext.pxmax = ext.xmax;\n      ext.pymin = ext.ymin;\n      ext.pymax = ext.ymax;\n    }\n  };\n\n  return Extent;\n}();\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nvar PointExtent = function (_Extent) {\n  _inheritsLoose(PointExtent, _Extent);\n\n  function PointExtent(p1, p2, p3, p4) {\n    var _this;\n\n    _this = _Extent.call(this, p1, p2, p3, p4) || this;\n    _this._clazz = Point;\n    return _this;\n  }\n\n  return PointExtent;\n}(Extent);\n\nvar Transformation = function () {\n  function Transformation(matrix) {\n    this.matrix = matrix;\n  }\n\n  var _proto = Transformation.prototype;\n\n  _proto.transform = function transform(coordinates, scale, out) {\n    var x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n    var y = -this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.untransform = function untransform(point, scale, out) {\n    var x = point.x * scale / this.matrix[0] + this.matrix[2];\n    var y = point.y * scale / -this.matrix[1] + this.matrix[3];\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  };\n\n  return Transformation;\n}();\n\nvar Common = {\n  project: function project() {},\n  unproject: function unproject() {},\n  projectCoords: function projectCoords(coordinates) {\n    var _this = this;\n\n    if (!coordinates) {\n      return [];\n    }\n\n    if (!Array.isArray(coordinates)) {\n      return this.project(coordinates);\n    }\n\n    if (coordinates.length === 0) {\n      return [];\n    }\n\n    if (!this.isSphere()) {\n      return forEachCoord(coordinates, this.project, this);\n    }\n\n    if (Array.isArray(coordinates[0])) {\n      return coordinates.map(function (coords) {\n        return _this.projectCoords(coords);\n      });\n    } else {\n      var circum = this.getCircum();\n      var extent = this.getSphereExtent(),\n          sx = extent.sx,\n          sy = extent.sy;\n      var wrapX, wrapY;\n      var pre = coordinates[0],\n          current,\n          dx,\n          dy,\n          p;\n      var prj = [this.project(pre)];\n\n      for (var i = 1, l = coordinates.length; i < l; i++) {\n        current = coordinates[i];\n        dx = current.x - pre.x;\n        dy = current.y - pre.y;\n        p = this.project(current);\n\n        if (Math.abs(dx) > 180) {\n          if (wrapX === undefined) {\n            wrapX = current.x > pre.x;\n          }\n\n          if (wrapX) {\n            p._add(-circum.x * sign(dx) * sx, 0);\n\n            current._add(-360 * sign(dx), 0);\n          }\n        }\n\n        if (Math.abs(dy) > 90) {\n          if (wrapY === undefined) {\n            wrapY = current.y < pre.y;\n          }\n\n          if (wrapY) {\n            p._add(0, -circum.y * sign(dy) * sy);\n\n            current._add(0, -180 * sign(dy));\n          }\n        }\n\n        pre = current;\n        prj.push(p);\n      }\n\n      return prj;\n    }\n  },\n  unprojectCoords: function unprojectCoords(projCoords) {\n    if (!projCoords) {\n      return [];\n    }\n\n    if (!Array.isArray(projCoords)) {\n      return this.unproject(projCoords);\n    }\n\n    return forEachCoord(projCoords, this.unproject, this);\n  },\n  isSphere: function isSphere() {\n    return !!this.sphere;\n  },\n  isOutSphere: function isOutSphere(pcoord) {\n    if (!this.isSphere()) {\n      return false;\n    }\n\n    var extent = this.getSphereExtent();\n    return !extent.contains(pcoord);\n  },\n  wrapCoord: function wrapCoord(pcoord) {\n    if (!this.isSphere()) {\n      return pcoord;\n    }\n\n    var extent = this.getSphereExtent();\n    var wrapped = new Coordinate(pcoord);\n\n    if (!extent.contains(wrapped)) {\n      wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n      wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n    }\n\n    return wrapped;\n  },\n  getCircum: function getCircum() {\n    if (!this.circum && this.isSphere()) {\n      var extent = this.getSphereExtent();\n      this.circum = {\n        x: extent.getWidth(),\n        y: extent.getHeight()\n      };\n    }\n\n    return this.circum;\n  },\n  getSphereExtent: function getSphereExtent() {\n    if (!this.extent && this.isSphere()) {\n      var max = this.project(new Coordinate(180, 90)),\n          min = this.project(new Coordinate(-180, -90));\n      this.extent = new Extent(min, max, this);\n      this.extent.sx = max.x > min.x ? 1 : -1;\n      this.extent.sy = max.y > min.y ? 1 : -1;\n    }\n\n    return this.extent;\n  }\n};\n\nvar Common$1 = {\n  measureLength: function measureLength(c1, c2) {\n    if (!Array.isArray(c1)) {\n      return this.measureLenBetween(c1, c2);\n    }\n\n    var len = 0;\n\n    for (var i = 0, l = c1.length; i < l - 1; i++) {\n      len += this.measureLenBetween(c1[i], c1[i + 1]);\n    }\n\n    return len;\n  }\n};\n\nvar Identity = extend({\n  'measure': 'IDENTITY',\n  measureLenBetween: function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    try {\n      return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n    } catch (err) {\n      return 0;\n    }\n  },\n  measureArea: function measureArea(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return 0;\n    }\n\n    var area = 0;\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var c1 = coordinates[i];\n      var c2 = null;\n\n      if (i === len - 1) {\n        c2 = coordinates[0];\n      } else {\n        c2 = coordinates[i + 1];\n      }\n\n      area += c1.x * c2.y - c1.y * c2.x;\n    }\n\n    return Math.abs(area / 2);\n  },\n  locate: function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  },\n  _locate: function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    c.x = c.x + xDist;\n    c.y = c.y + yDist;\n    return c;\n  },\n  rotate: function rotate(c, pivot, angle) {\n    c = new Coordinate(c.x, c.y);\n    return this._rotate(c, pivot, angle);\n  },\n  _rotate: function () {\n    var tmp = new Point(0, 0);\n    return function (c, pivot, angle) {\n      tmp.x = c.x - pivot.x;\n      tmp.y = c.y - pivot.y;\n\n      tmp._rotate(angle * Math.PI / 180);\n\n      c.x = pivot.x + tmp.x;\n      c.y = pivot.y + tmp.y;\n      return c;\n    };\n  }()\n}, Common$1);\n\nvar Sphere = function () {\n  function Sphere(radius) {\n    this.radius = radius;\n  }\n\n  var _proto = Sphere.prototype;\n\n  _proto.measureLenBetween = function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    var b = toRadian(c1.y);\n    var d = toRadian(c2.y),\n        e = b - d,\n        f = toRadian(c1.x) - toRadian(c2.x);\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n    b *= this.radius;\n    return Math.round(b * 1E5) / 1E5;\n  };\n\n  _proto.measureArea = function measureArea(coordinates) {\n    var a = toRadian(this.radius);\n    var b = 0,\n        c = coordinates,\n        d = c.length;\n\n    if (d < 3) {\n      return 0;\n    }\n\n    var i;\n\n    for (i = 0; i < d - 1; i++) {\n      var e = c[i],\n          f = c[i + 1];\n      b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n    }\n\n    d = c[i];\n    c = c[0];\n    b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n    return 0.5 * Math.abs(b);\n  };\n\n  _proto.locate = function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  };\n\n  _proto._locate = function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    var x, y;\n    var ry = toRadian(c.y);\n\n    if (yDist !== 0) {\n      var dy = Math.abs(yDist);\n      var sy = Math.sin(dy / (2 * this.radius)) * 2;\n      ry = ry + sy * (yDist > 0 ? 1 : -1);\n      y = wrap(ry * 180 / Math.PI, -90, 90);\n    } else {\n      y = c.y;\n    }\n\n    if (xDist !== 0) {\n      var dx = Math.abs(xDist);\n      var rx = toRadian(c.x);\n      var sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n      rx = rx + sx * (xDist > 0 ? 1 : -1);\n      x = wrap(rx * 180 / Math.PI, -180, 180);\n    } else {\n      x = c.x;\n    }\n\n    c.x = x;\n    c.y = y;\n    return c;\n  };\n\n  _proto.rotate = function rotate(c, pivot, angle) {\n    c = new Coordinate(c);\n    return this._rotate(c, pivot, angle);\n  };\n\n  _proto._rotate = function _rotate(c, pivot, angle) {\n    var initialAngle = rhumbBearing(pivot, c);\n    var finalAngle = initialAngle - angle;\n    var distance = this.measureLenBetween(pivot, c);\n    c.x = pivot.x;\n    c.y = pivot.y;\n    return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n  };\n\n  return Sphere;\n}();\n\nfunction rhumbBearing(start, end, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var bear360;\n  if (options.final) bear360 = calculateRhumbBearing(end, start);else bear360 = calculateRhumbBearing(start, end);\n  var bear180 = bear360 > 180 ? -(360 - bear360) : bear360;\n  return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n  var phi1 = toRadian(from.y);\n  var phi2 = toRadian(to.y);\n  var deltaLambda = toRadian(to.x - from.x);\n  if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n  if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n  var deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var theta = Math.atan2(deltaLambda, deltaPsi);\n  return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n  var delta = distance / radius;\n  var lambda1 = origin.x * Math.PI / 180;\n  var phi1 = toRadian(origin.y);\n  var theta = toRadian(bearing);\n  var DeltaPhi = delta * Math.cos(theta);\n  var phi2 = phi1 + DeltaPhi;\n  if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n  var DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1);\n  var DeltaLambda = delta * Math.sin(theta) / q;\n  var lambda2 = lambda1 + DeltaLambda;\n  origin.x = (lambda2 * 180 / Math.PI + 540) % 360 - 180;\n  origin.y = phi2 * 180 / Math.PI;\n  return origin;\n}\n\nvar WGS84Sphere = extend({\n  'measure': 'EPSG:4326',\n  sphere: new Sphere(6378137),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar BaiduSphere = extend({\n  'measure': 'BAIDU',\n  sphere: new Sphere(6370996.81),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\n\nvar DEFAULT = WGS84Sphere;\nvar measurers = {};\n\nfunction registerMeasurer(m) {\n  measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\nvar Measurer = {\n  getInstance: function getInstance(name) {\n    if (!name) {\n      return DEFAULT;\n    }\n\n    for (var p in measurers) {\n      if (hasOwn(measurers, p)) {\n        var mName = measurers[p]['measure'];\n\n        if (!mName) {\n          continue;\n        }\n\n        if (name.toLowerCase() === mName.toLowerCase()) {\n          return measurers[p];\n        }\n      }\n    }\n\n    return null;\n  }\n};\n\nvar index$2 = /*#__PURE__*/Object.freeze({\n  Identity: Identity,\n  DEFAULT: DEFAULT,\n  Measurer: Measurer,\n  WGS84Sphere: WGS84Sphere,\n  BaiduSphere: BaiduSphere\n});\n\nvar delta = 1E-7;\nvar EPSG3857 = extend({}, Common, {\n  code: 'EPSG:3857',\n  rad: Math.PI / 180,\n  metersPerDegree: 6378137 * Math.PI / 180,\n  maxLatitude: 85.0511287798,\n  project: function project(lnglat, out) {\n    var rad = this.rad,\n        metersPerDegree = this.metersPerDegree,\n        max = this.maxLatitude;\n    var lng = lnglat.x,\n        lat = Math.max(Math.min(max, lnglat.y), -max);\n    var c;\n\n    if (lat === 0) {\n      c = 0;\n    } else {\n      c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n    }\n\n    var x = lng * metersPerDegree;\n    var y = c * metersPerDegree;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  },\n  unproject: function unproject(pLnglat, out) {\n    var rad = this.rad;\n    var metersPerDegree = this.metersPerDegree;\n    var x = pLnglat.x / metersPerDegree;\n    var y = pLnglat.y;\n    var c;\n\n    if (y === 0) {\n      c = 0;\n    } else {\n      c = y / metersPerDegree;\n      c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n    }\n\n    if (Math.abs(Math.abs(x) - 180) < delta) {\n      x = sign(x) * 180;\n    }\n\n    if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n      c = sign(c) * this.maxLatitude;\n    }\n\n    var rx = wrap(x, -180, 180);\n    var ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n\n    if (out) {\n      out.x = rx;\n      out.y = ry;\n      return out;\n    }\n\n    return new Coordinate(rx, ry);\n  }\n}, WGS84Sphere);\n\nvar PROJ4326 = extend({}, Common, {\n  code: 'EPSG:4326',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  }\n}, WGS84Sphere);\n\nvar Projection_EPSG4490 = extend({}, PROJ4326, {\n  code: 'EPSG:4490'\n});\n\nvar Projection_Baidu = extend({}, Common, {\n  code: 'BAIDU',\n  project: function project(p, out) {\n    return this.convertLL2MC(p, out);\n  },\n  unproject: function unproject(p, out) {\n    return this.convertMC2LL(p, out);\n  }\n}, BaiduSphere, {\n  EARTHRADIUS: 6370996.81,\n  MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n  LLBAND: [75, 60, 45, 30, 15, 0],\n  MC2LL: [[1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2], [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86], [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37], [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06], [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4], [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]],\n  LL2MC: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5], [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5], [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],\n  convertMC2LL: function convertMC2LL(cB, out) {\n    var cE;\n\n    for (var cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n      if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n        cE = this.MC2LL[cD];\n        break;\n      }\n    }\n\n    var T = this.convertor(cB, cE, out);\n    return T;\n  },\n  convertLL2MC: function convertLL2MC(T, out) {\n    var cD, cC, len;\n    T.x = this.getLoop(T.x, -180, 180);\n    T.y = this.getRange(T.y, -74, 74);\n    var cB = new Coordinate(T.x, T.y);\n\n    for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n      if (cB.y >= this.LLBAND[cC]) {\n        cD = this.LL2MC[cC];\n        break;\n      }\n    }\n\n    if (!cD) {\n      for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n        if (cB.y <= -this.LLBAND[cC]) {\n          cD = this.LL2MC[cC];\n          break;\n        }\n      }\n    }\n\n    var cE = this.convertor(T, cD, out);\n    return cE;\n  },\n  convertor: function convertor(cC, cD, out) {\n    if (!cC || !cD) {\n      return null;\n    }\n\n    var T = cD[0] + cD[1] * Math.abs(cC.x);\n    var cB = Math.abs(cC.y) / cD[9];\n    var cE = cD[2] + cD[3] * cB + cD[4] * cB * cB + cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB + cD[7] * cB * cB * cB * cB * cB + cD[8] * cB * cB * cB * cB * cB * cB;\n    T *= cC.x < 0 ? -1 : 1;\n    cE *= cC.y < 0 ? -1 : 1;\n\n    if (out) {\n      out.x = T;\n      out.y = cE;\n      return out;\n    }\n\n    return new Coordinate(T, cE);\n  },\n  toRadians: function toRadians(T) {\n    return Math.PI * T / 180;\n  },\n  toDegrees: function toDegrees(T) {\n    return 180 * T / Math.PI;\n  },\n  getRange: function getRange(cC, cB, T) {\n    if (cB != null) {\n      cC = Math.max(cC, cB);\n    }\n\n    if (T != null) {\n      cC = Math.min(cC, T);\n    }\n\n    return cC;\n  },\n  getLoop: function getLoop(cC, cB, T) {\n    if (cC === Infinity) {\n      return T;\n    } else if (cC === -Infinity) {\n      return cB;\n    }\n\n    while (cC > T) {\n      cC -= T - cB;\n    }\n\n    while (cC < cB) {\n      cC += T - cB;\n    }\n\n    return cC;\n  }\n});\n\nvar Projection_IDENTITY = extend({}, Common, {\n  code: 'IDENTITY',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  }\n}, Identity);\n\nvar DEFAULT$1 = EPSG3857;\n\nvar projections = /*#__PURE__*/Object.freeze({\n  EPSG3857: EPSG3857,\n  DEFAULT: DEFAULT$1,\n  EPSG4326: PROJ4326,\n  EPSG4490: Projection_EPSG4490,\n  BAIDU: Projection_Baidu,\n  IDENTITY: Projection_IDENTITY,\n  Common: Common\n});\n\nvar Renderable = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerRenderer = function registerRenderer(name, clazz) {\n      var proto = this.prototype;\n      var parentProto = Object.getPrototypeOf(proto);\n\n      if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n        proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n      }\n\n      proto._rendererClasses[name.toLowerCase()] = clazz;\n      return this;\n    };\n\n    _class.getRendererClass = function getRendererClass(name) {\n      var proto = this.prototype;\n\n      if (!proto._rendererClasses) {\n        return null;\n      }\n\n      return proto._rendererClasses[name.toLowerCase()];\n    };\n\n    return _class;\n  }(Base);\n});\n\nvar CanvasRenderer = function (_Class) {\n  _inheritsLoose(CanvasRenderer, _Class);\n\n  function CanvasRenderer(layer) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.layer = layer;\n    _this._painted = false;\n    _this._drawTime = 0;\n\n    _this.setToRedraw();\n\n    return _this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.render = function render(framestamp) {\n    this.prepareRender();\n\n    if (!this.getMap() || !this.layer.isVisible()) {\n      return;\n    }\n\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    this.checkAndDraw(this._tryToDraw, framestamp);\n  };\n\n  _proto.checkAndDraw = function checkAndDraw(drawFn) {\n    var _this2 = this;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.checkResources) {\n      var resources = this.checkResources();\n\n      if (resources.length > 0) {\n        this._loadingResource = true;\n        this.loadResources(resources).then(function () {\n          _this2._loadingResource = false;\n\n          if (_this2.layer) {\n            _this2.layer.fire('resourceload');\n\n            _this2.setToRedraw();\n          }\n        });\n      } else {\n        drawFn.call.apply(drawFn, [this].concat(args));\n      }\n    } else {\n      drawFn.call.apply(drawFn, [this].concat(args));\n    }\n  };\n\n  _proto.testIfNeedRedraw = function testIfNeedRedraw() {\n    var map = this.getMap();\n\n    if (this._loadingResource) {\n      return false;\n    }\n\n    if (this._toRedraw) {\n      return true;\n    }\n\n    if (map.isInteracting() && !this.drawOnInteracting) {\n      return false;\n    }\n\n    if (this.needToRedraw()) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() || map.getRenderer().isViewChanged()) {\n      return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n    }\n\n    return false;\n  };\n\n  _proto.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {};\n\n  _proto.isLoadingResource = function isLoadingResource() {\n    return this._loadingResource;\n  };\n\n  _proto.isRenderComplete = function isRenderComplete() {\n    return !!this._renderComplete;\n  };\n\n  _proto.mustRenderOnInteracting = function mustRenderOnInteracting() {\n    return !this._painted;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    this._toRedraw = true;\n    return this;\n  };\n\n  _proto.setCanvasUpdated = function setCanvasUpdated() {\n    this._canvasUpdated = true;\n    return this;\n  };\n\n  _proto.isCanvasUpdated = function isCanvasUpdated() {\n    return !!this._canvasUpdated;\n  };\n\n  _proto.remove = function remove() {\n    this.onRemove();\n    delete this._loadingResource;\n    delete this.southWest;\n    delete this.canvas;\n    delete this.context;\n    delete this.canvasExtent2D;\n    delete this._extent2D;\n    delete this.resources;\n    delete this.layer;\n  };\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.getMap = function getMap() {\n    if (!this.layer) {\n      return null;\n    }\n\n    return this.layer.getMap();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var map = this.getMap();\n    this._canvasUpdated = false;\n\n    if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n      return null;\n    }\n\n    if (this.isBlank()) {\n      return null;\n    }\n\n    if (this.layer.isEmpty && this.layer.isEmpty()) {\n      return null;\n    }\n\n    var containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    return {\n      'image': this.canvas,\n      'layer': this.layer,\n      'point': containerPoint\n    };\n  };\n\n  _proto.clear = function clear() {\n    this.clearCanvas();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this._painted) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.show = function show() {\n    this.setToRedraw();\n  };\n\n  _proto.hide = function hide() {\n    this.clear();\n    this.setToRedraw();\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    this.setToRedraw();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    if (!this.context || this.layer.isEmpty && this.layer.isEmpty() || this.isBlank() || this._errorThrown) {\n      return false;\n    }\n\n    var map = this.getMap();\n    var r = map.getDevicePixelRatio();\n    var size = map.getSize();\n\n    if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n      return false;\n    }\n\n    try {\n      var imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n\n      if (imgData[3] > 0) {\n        return true;\n      }\n    } catch (error) {\n      if (!this._errorThrown) {\n        if (console) {\n          console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n        }\n\n        this._errorThrown = true;\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  _proto.loadResources = function loadResources(resourceUrls) {\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    var resources = this.resources,\n        promises = [];\n\n    if (isArrayHasData(resourceUrls)) {\n      var cache = {};\n\n      for (var i = resourceUrls.length - 1; i >= 0; i--) {\n        var url = resourceUrls[i];\n\n        if (!url || !url.length || cache[url.join('-')]) {\n          continue;\n        }\n\n        cache[url.join('-')] = 1;\n\n        if (!resources.isResourceLoaded(url, true)) {\n          promises.push(new Promise$1(this._promiseResource(url)));\n        }\n      }\n    }\n\n    return Promise$1.all(promises);\n  };\n\n  _proto.prepareRender = function prepareRender() {\n    delete this._renderComplete;\n    var map = this.getMap();\n    this._renderZoom = map.getZoom();\n    this.canvasExtent2D = this._extent2D = map._get2DExtent();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this.canvas) {\n      return;\n    }\n\n    var map = this.getMap();\n    var size = map.getSize();\n    var r = map.getDevicePixelRatio(),\n        w = r * size.width,\n        h = r * size.height;\n\n    if (this.layer._canvas) {\n      var canvas = this.layer._canvas;\n      canvas.width = w;\n      canvas.height = h;\n\n      if (canvas.style) {\n        canvas.style.width = size.width + 'px';\n        canvas.style.height = size.height + 'px';\n      }\n\n      this.canvas = this.layer._canvas;\n    } else {\n      this.canvas = Canvas.createCanvas(w, h, map.CanvasClass);\n    }\n\n    this.onCanvasCreate();\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.createContext = function createContext() {\n    if (this.gl && this.gl.canvas === this.canvas || this.context) {\n      return;\n    }\n\n    this.context = this.canvas.getContext('2d');\n\n    if (!this.context) {\n      return;\n    }\n\n    if (this.layer.options['globalCompositeOperation']) {\n      this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  _proto.resetCanvasTransform = function resetCanvasTransform() {\n    if (!this.context) {\n      return;\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n    this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    var canvas = this.canvas;\n\n    if (!canvas) {\n      return;\n    }\n\n    var size = canvasSize || this.getMap().getSize();\n    var r = this.getMap().getDevicePixelRatio();\n\n    if (canvas.width === r * size.width && canvas.height === r * size.height) {\n      return;\n    }\n\n    canvas.height = r * size.height;\n    canvas.width = r * size.width;\n\n    if (r !== 1 && this.context) {\n      this.context.scale(r, r);\n    }\n\n    if (this.layer._canvas && canvas.style) {\n      canvas.style.width = size.width + 'px';\n      canvas.style.height = size.height + 'px';\n    }\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.context) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto.prepareCanvas = function prepareCanvas() {\n    if (!this.canvas) {\n      this.createCanvas();\n      this.createContext();\n      this.layer.onCanvasCreate();\n      this.layer.fire('canvascreate', {\n        'context': this.context,\n        'gl': this.gl\n      });\n    } else {\n      this.resetCanvasTransform();\n      this.clearCanvas();\n      this.resizeCanvas();\n    }\n\n    delete this._maskExtent;\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return null;\n    }\n\n    var maskExtent2D = this._maskExtent = mask._getMaskPainter().get2DExtent();\n\n    if (!maskExtent2D.intersects(this._extent2D)) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return maskExtent2D;\n    }\n\n    this.layer.fire('renderstart', {\n      'context': this.context,\n      'gl': this.gl\n    });\n    return maskExtent2D;\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      return false;\n    }\n\n    var old = this.southWest;\n    var map = this.getMap();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    context.save();\n    var dpr = map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      context.save();\n      context.scale(dpr, dpr);\n    }\n\n    if (mask.getGeometries) {\n      context.isMultiClip = true;\n      var masks = mask.getGeometries() || [];\n      context.beginPath();\n      masks.forEach(function (_mask) {\n        var painter = _mask._getMaskPainter();\n\n        painter.paint(null, context);\n      });\n      context.stroke();\n      delete context.isMultiClip;\n    } else {\n      var painter = mask._getMaskPainter();\n\n      painter.paint(null, context);\n    }\n\n    if (dpr !== 1) {\n      context.restore();\n    }\n\n    context.clip();\n    this.southWest = old;\n    return true;\n  };\n\n  _proto.getViewExtent = function getViewExtent() {\n    return {\n      'extent': this._extent2D,\n      'maskExtent': this._maskExtent,\n      'zoom': this._renderZoom,\n      'southWest': this.southWest\n    };\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this.getMap()) {\n      this._renderComplete = true;\n      this.layer.fire('renderend', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart': this.onZoomStart,\n      '_zooming': this.onZooming,\n      '_zoomend': this.onZoomEnd,\n      '_resize': this.onResize,\n      '_movestart': this.onMoveStart,\n      '_moving': this.onMoving,\n      '_moveend': this.onMoveEnd,\n      '_dragrotatestart': this.onDragRotateStart,\n      '_dragrotating': this.onDragRotating,\n      '_dragrotateend': this.onDragRotateEnd,\n      '_spatialreferencechange': this.onSpatialReferenceChange\n    };\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onResize = function onResize() {\n    delete this._extent2D;\n    this.resizeCanvas();\n    this.setToRedraw();\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart() {};\n\n  _proto.onDragRotating = function onDragRotating() {};\n\n  _proto.onDragRotateEnd = function onDragRotateEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onSpatialReferenceChange = function onSpatialReferenceChange() {};\n\n  _proto.getDrawTime = function getDrawTime() {\n    return this._drawTime;\n  };\n\n  _proto._tryToDraw = function _tryToDraw(framestamp) {\n    this._toRedraw = false;\n\n    if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n      this._renderComplete = true;\n      return;\n    }\n\n    this._drawAndRecord(framestamp);\n  };\n\n  _proto._drawAndRecord = function _drawAndRecord(framestamp) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var painted = this._painted;\n    this._painted = true;\n    var t = now();\n    this.draw(framestamp);\n    t = now() - t;\n    this._drawTime = painted ? t : t / 2;\n\n    if (painted && this.layer && this.layer.options['logDrawTime']) {\n      console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n    }\n  };\n\n  _proto._promiseResource = function _promiseResource(url) {\n    var me = this,\n        resources = this.resources,\n        crossOrigin = this.layer.options['crossOrigin'];\n    return function (resolve) {\n      if (resources.isResourceLoaded(url, true)) {\n        resolve(url);\n        return;\n      }\n\n      var img = new Image();\n\n      if (!isNil(crossOrigin)) {\n        img['crossOrigin'] = crossOrigin;\n      }\n\n      if (isSVG(url[0]) && !IS_NODE) {\n        if (url[1]) {\n          url[1] *= 2;\n        }\n\n        if (url[2]) {\n          url[2] *= 2;\n        }\n      }\n\n      img.onload = function () {\n        me._cacheResource(url, img);\n\n        resolve(url);\n      };\n\n      img.onabort = function (err) {\n        if (console) {\n          console.warn('image loading aborted: ' + url[0]);\n        }\n\n        if (err) {\n          if (console) {\n            console.warn(err);\n          }\n        }\n\n        resolve(url);\n      };\n\n      img.onerror = function (err) {\n        if (err && typeof console !== 'undefined') {\n          console.warn(err);\n        }\n\n        resources.markErrorResource(url);\n        resolve(url);\n      };\n\n      loadImage(img, url);\n    };\n  };\n\n  _proto._cacheResource = function _cacheResource(url, img) {\n    if (!this.layer || !this.resources) {\n      return;\n    }\n\n    var w = url[1],\n        h = url[2];\n\n    if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser$1.edge || Browser$1.ie)) {\n      if (isNil(w)) {\n        w = img.width || this.layer.options['defaultIconSize'][0];\n      }\n\n      if (isNil(h)) {\n        h = img.height || this.layer.options['defaultIconSize'][1];\n      }\n\n      var canvas = Canvas.createCanvas(w, h);\n      Canvas.image(canvas.getContext('2d'), img, 0, 0, w, h);\n      img = canvas;\n    }\n\n    this.resources.addResource(url, img);\n  };\n\n  return CanvasRenderer;\n}(Class);\nvar ResourceCache = function () {\n  function ResourceCache() {\n    this.resources = {};\n    this._errors = {};\n  }\n\n  var _proto2 = ResourceCache.prototype;\n\n  _proto2.addResource = function addResource(url, img) {\n    this.resources[url[0]] = {\n      image: img,\n      width: +url[1],\n      height: +url[2]\n    };\n  };\n\n  _proto2.isResourceLoaded = function isResourceLoaded(url, checkSVG) {\n    if (!url) {\n      return false;\n    }\n\n    var imgUrl = this._getImgUrl(url);\n\n    if (this._errors[imgUrl]) {\n      return true;\n    }\n\n    var img = this.resources[imgUrl];\n\n    if (!img) {\n      return false;\n    }\n\n    if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.getImage = function getImage(url) {\n    var imgUrl = this._getImgUrl(url);\n\n    if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n      return null;\n    }\n\n    return this.resources[imgUrl].image;\n  };\n\n  _proto2.markErrorResource = function markErrorResource(url) {\n    this._errors[this._getImgUrl(url)] = 1;\n  };\n\n  _proto2.merge = function merge(res) {\n    if (!res) {\n      return this;\n    }\n\n    for (var p in res.resources) {\n      var img = res.resources[p];\n      this.addResource([p, img.width, img.height], img.image);\n    }\n\n    return this;\n  };\n\n  _proto2.forEach = function forEach(fn) {\n    if (!this.resources) {\n      return this;\n    }\n\n    for (var p in this.resources) {\n      if (hasOwn(this.resources, p)) {\n        fn(p, this.resources[p]);\n      }\n    }\n\n    return this;\n  };\n\n  _proto2._getImgUrl = function _getImgUrl(url) {\n    if (!Array.isArray(url)) {\n      return url;\n    }\n\n    return url[0];\n  };\n\n  return ResourceCache;\n}();\n\nfunction clipLine(points, bounds, round, noCut) {\n  var parts = [];\n  var k = 0,\n      segment;\n\n  for (var j = 0, l = points.length; j < l - 1; j++) {\n    segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n    if (!segment) {\n      continue;\n    }\n\n    parts[k] = parts[k] || [];\n    parts[k].push({\n      'point': segment[0],\n      'index': j\n    });\n\n    if (segment[1] !== points[j + 1] || j === l - 2) {\n      parts[k].push({\n        'point': segment[1],\n        'index': j + 1\n      });\n      k++;\n    }\n  }\n\n  return parts;\n}\n\nvar _lastCode;\n\nfunction clipSegment(a, b, bounds, useLastCode, round, noCut) {\n  var codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n      codeB = _getBitCode(b, bounds),\n      codeOut,\n      p,\n      newCode;\n\n  _lastCode = codeB;\n\n  while (true) {\n    if (!(codeA | codeB)) {\n      return [a, b];\n    }\n\n    if (codeA & codeB) {\n      return false;\n    }\n\n    if (noCut) {\n      return [a, b];\n    }\n\n    codeOut = codeA || codeB;\n    p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n    newCode = _getBitCode(p, bounds);\n\n    if (codeOut === codeA) {\n      a = p;\n      codeA = newCode;\n    } else {\n      b = p;\n      codeB = newCode;\n    }\n  }\n}\nfunction clipPolygon(points, bounds, round) {\n  var edges = [1, 4, 2, 8];\n  var clippedPoints, i, j, k, a, b, len, edge, p;\n\n  for (i = 0, len = points.length; i < len; i++) {\n    points[i]._code = _getBitCode(points[i], bounds);\n  }\n\n  for (k = 0; k < 4; k++) {\n    edge = edges[k];\n    clippedPoints = [];\n\n    for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n      a = points[i];\n      b = points[j];\n\n      if (!(a._code & edge)) {\n        if (b._code & edge) {\n          p = _getEdgeIntersection(b, a, edge, bounds, round);\n          p._code = _getBitCode(p, bounds);\n          clippedPoints.push(p);\n        }\n\n        clippedPoints.push(a);\n      } else if (!(b._code & edge)) {\n        p = _getEdgeIntersection(b, a, edge, bounds, round);\n        p._code = _getBitCode(p, bounds);\n        clippedPoints.push(p);\n      }\n    }\n\n    points = clippedPoints;\n  }\n\n  return points;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      min = bounds.getMin(),\n      max = bounds.getMax();\n  var x, y;\n\n  if (code & 8) {\n    x = a.x + dx * (max.y - a.y) / dy;\n    y = max.y;\n  } else if (code & 4) {\n    x = a.x + dx * (min.y - a.y) / dy;\n    y = min.y;\n  } else if (code & 2) {\n    x = max.x;\n    y = a.y + dy * (max.x - a.x) / dx;\n  } else if (code & 1) {\n    x = min.x;\n    y = a.y + dy * (min.x - a.x) / dx;\n  }\n\n  var p = new Point(x, y);\n\n  if (round) {\n    p._round();\n  }\n\n  return p;\n}\n\nfunction _getBitCode(p, bounds) {\n  var code = 0;\n\n  if (p.x < bounds.getMin().x) {\n    code |= 1;\n  } else if (p.x > bounds.getMax().x) {\n    code |= 2;\n  }\n\n  if (p.y < bounds.getMin().y) {\n    code |= 4;\n  } else if (p.y > bounds.getMax().y) {\n    code |= 8;\n  }\n\n  return code;\n}\n\nfunction withInEllipse(point, center, southeast, tolerance) {\n  point = new Point(point);\n  var a = Math.abs(southeast.x - center.x),\n      b = Math.abs(southeast.y - center.y),\n      c = Math.sqrt(Math.abs(a * a - b * b)),\n      xfocus = a >= b;\n  var f1, f2, d;\n\n  if (xfocus) {\n    f1 = new Point(center.x - c, center.y);\n    f2 = new Point(center.x + c, center.y);\n    d = a * 2;\n  } else {\n    f1 = new Point(center.x, center.y - c);\n    f2 = new Point(center.x, center.y + c);\n    d = b * 2;\n  }\n\n  return point.distanceTo(f1) + point.distanceTo(f2) <= d + 2 * tolerance;\n}\n\nvar Symbolizer = function () {\n  function Symbolizer() {}\n\n  var _proto = Symbolizer.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getPainter = function getPainter() {\n    return this.painter;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    return false;\n  };\n\n  Symbolizer.testColor = function testColor(prop) {\n    if (!prop || !isString(prop)) {\n      return false;\n    }\n\n    if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return Symbolizer;\n}();\n\nvar CanvasSymbolizer = function (_Symbolizer) {\n  _inheritsLoose(CanvasSymbolizer, _Symbolizer);\n\n  function CanvasSymbolizer() {\n    return _Symbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext(ctx) {\n    if (isNumber(this.symbol['opacity'])) {\n      if (ctx.globalAlpha !== this.symbol['opacity']) {\n        ctx.globalAlpha = this.symbol['opacity'];\n      }\n    } else if (ctx.globalAlpha !== 1) {\n      ctx.globalAlpha = 1;\n    }\n  };\n\n  _proto.prepareCanvas = function prepareCanvas(ctx, style, resources) {\n    Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n  };\n\n  _proto.remove = function remove() {};\n\n  _proto.setZIndex = function setZIndex() {};\n\n  _proto.show = function show() {};\n\n  _proto.hide = function hide() {};\n\n  _proto._defineStyle = function _defineStyle(style) {\n    return function () {\n      var _this = this;\n\n      var arr = [],\n          prop = {};\n      return loadFunctionTypes(style, function () {\n        var map = _this.getMap();\n\n        return set$1(arr, map.getZoom(), extend({}, _this.geometry.getProperties(), setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())));\n      });\n    }.bind(this)();\n  };\n\n  return CanvasSymbolizer;\n}(Symbolizer);\n\nfunction set$1(arr, a0, a1) {\n  arr[0] = a0;\n  arr[1] = a1;\n  return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n  prop['{bearing}'] = b;\n  prop['{pitch}'] = p;\n  prop['{zoom}'] = z;\n  return prop;\n}\n\nvar TEMP_POINT0$1 = new Point(0, 0);\nvar TEMP_POINT1 = new Point(0, 0);\n\nvar PointSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(PointSymbolizer, _CanvasSymbolizer);\n\n  function PointSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n    return _this;\n  }\n\n  var _proto = PointSymbolizer.prototype;\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var extent = new PointExtent();\n\n    var renderPoints = this._getRenderPoints()[0];\n\n    for (var i = renderPoints.length - 1; i >= 0; i--) {\n      if (renderPoints[i]) {\n        extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    var symbol = this.symbol;\n    return isFunctionDefinition(symbol['markerWidth']) || isFunctionDefinition(symbol['markerHeight']) || isFunctionDefinition(symbol['textSize']);\n  };\n\n  _proto._rotateExtent = function _rotateExtent(fixedExtent, angle) {\n    return fixedExtent.convertTo(function (p) {\n      return p._rotate(angle);\n    });\n  };\n\n  _proto._getRenderPoints = function _getRenderPoints() {\n    var painter = this.getPainter();\n    var placement = painter.isSpriting() ? 'center' : this.getPlacement();\n    return this.getPainter().getRenderPoints(placement);\n  };\n\n  _proto._getRenderContainerPoints = function _getRenderContainerPoints(ignoreAltitude) {\n    var painter = this.getPainter(),\n        points = this._getRenderPoints()[0];\n\n    if (painter.isSpriting()) {\n      return points;\n    }\n\n    var dxdy = this.getDxDy();\n\n    var cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n\n    if (!cpoints || !Array.isArray(cpoints[0])) {\n      return cpoints;\n    }\n\n    var flat = [];\n\n    for (var i = 0, l = cpoints.length; i < l; i++) {\n      for (var ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n        flat.push(cpoints[i][ii]);\n      }\n    }\n\n    return flat;\n  };\n\n  _proto._getRotationAt = function _getRotationAt(i) {\n    var r = this.getRotation();\n\n    if (!r) {\n      r = 0;\n    }\n\n    var rotations = this._getRenderPoints()[1];\n\n    if (!rotations || !rotations[i]) {\n      return r;\n    }\n\n    var map = this.getMap();\n    var p0 = rotations[i][0],\n        p1 = rotations[i][1];\n\n    if (map.isTransforming()) {\n      var maxZoom = map.getGLZoom();\n      p0 = map._pointToContainerPoint(rotations[i][0], maxZoom, 0, TEMP_POINT0$1);\n      p1 = map._pointToContainerPoint(rotations[i][1], maxZoom, 0, TEMP_POINT1);\n      return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    } else {\n      return r + -computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n  };\n\n  _proto._rotate = function _rotate(ctx, origin, rotation) {\n    if (rotation) {\n      var dxdy = this.getDxDy();\n      var p = origin.sub(dxdy);\n      ctx.save();\n      ctx.translate(p.x, p.y);\n      ctx.rotate(rotation);\n      return this.getDxDy();\n    }\n\n    return null;\n  };\n\n  return PointSymbolizer;\n}(CanvasSymbolizer);\n\nvar VectorMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(VectorMarkerSymbolizer, _PointSymbolizer);\n\n  VectorMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && symbol['markerType'] !== 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n    _this.strokeAndFill = _this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(_this.style));\n    var lineWidth = _this.strokeAndFill['lineWidth'];\n\n    if (lineWidth % 2 === 0) {\n      _this.padding = 2;\n    } else {\n      _this.padding = 1.5;\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['polygonOpacity'] === 0 && style['lineOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    if (this.getPainter().isSpriting() || this.geometry.getLayer().getMask() === this.geometry || this._dynamic || this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n      this._drawMarkers(ctx, cookedPoints, resources);\n    } else {\n      this._drawMarkersWithCache(ctx, cookedPoints, resources);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto._drawMarkers = function _drawMarkers(ctx, cookedPoints, resources) {\n    var strokeAndFill = this.strokeAndFill;\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      this._drawVectorMarker(ctx, point, resources);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._drawMarkersWithCache = function _drawMarkersWithCache(ctx, cookedPoints, resources) {\n    var stamp = this._stampSymbol();\n\n    var image = resources.getImage(stamp);\n\n    if (!image) {\n      image = this._createMarkerImage(ctx, resources);\n      resources.addResource([stamp, image.width, image.height], image);\n    }\n\n    var anchor = this._getAnchor(image.width, image.height);\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._calMarkerSize = function _calMarkerSize() {\n    if (!this._size) {\n      var lineWidth = this.strokeAndFill['lineWidth'],\n          shadow = 2 * (this.symbol['shadowBlur'] || 0),\n          w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n          h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n\n      if (isFunctionDefinition(this.symbol['markerWidth']) || isFunctionDefinition(this.symbol['markerHeight'])) {\n        return [w, h];\n      }\n\n      this._size = [w, h];\n    }\n\n    return this._size;\n  };\n\n  _proto._createMarkerImage = function _createMarkerImage(ctx, resources) {\n    var canvasClass = ctx.canvas.constructor,\n        size = this._calMarkerSize(),\n        canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n        point = this._getCacheImageAnchor(size[0], size[1]);\n\n    var context = canvas.getContext('2d');\n    var gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(context, this.strokeAndFill, resources);\n    }\n\n    this._drawVectorMarker(context, point, resources);\n\n    return canvas;\n  };\n\n  _proto._stampSymbol = function _stampSymbol() {\n    if (!this._stamp) {\n      this._stamp = [this.style['markerType'], isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'], this.style['markerFillOpacity'], this.style['markerFillPatternFile'], isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'], this.style['markerLineWidth'], this.style['markerLineOpacity'], this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '', this.style['markerLinePatternFile'], this.style['markerWidth'], this.style['markerHeight'], this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']].join('_');\n    }\n\n    return this._stamp;\n  };\n\n  _proto._getAnchor = function _getAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n\n    if (p.x !== -w / 2) {\n      p.x -= sign(p.x + w / 2) * margin;\n    }\n\n    if (p.y !== -h / 2) {\n      p.y -= sign(p.y + h / 2) * margin;\n    }\n\n    return p;\n  };\n\n  _proto._getCacheImageAnchor = function _getCacheImageAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var markerType = this.style['markerType'];\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      return new Point(w / 2, h - margin);\n    } else if (markerType === 'rectangle') {\n      return new Point(margin, margin);\n    } else {\n      return new Point(w / 2, h / 2);\n    }\n  };\n\n  _proto._getGraidentExtent = function _getGraidentExtent(points) {\n    var e = new PointExtent(),\n        dxdy = this.getDxDy(),\n        m = this.getFixedExtent();\n\n    if (Array.isArray(points)) {\n      for (var i = points.length - 1; i >= 0; i--) {\n        e._combine(points[i]);\n      }\n    } else {\n      e._combine(points);\n    }\n\n    e['xmin'] += m['xmin'] - dxdy.x;\n    e['ymin'] += m['ymin'] - dxdy.y;\n    e['xmax'] += m['xmax'] - dxdy.x;\n    e['ymax'] += m['ymax'] - dxdy.y;\n    return e;\n  };\n\n  _proto._drawVectorMarker = function _drawVectorMarker(ctx, point, resources) {\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill,\n        markerType = style['markerType'].toLowerCase(),\n        vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n        lineOpacity = strokeAndFill['lineOpacity'],\n        fillOpacity = strokeAndFill['polygonOpacity'];\n\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (gradient) {\n      var gradientExtent;\n\n      if (isGradient(strokeAndFill['lineColor'])) {\n        gradientExtent = this._getGraidentExtent(point);\n        strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n      }\n\n      if (isGradient(strokeAndFill['polygonFill'])) {\n        if (!gradientExtent) {\n          gradientExtent = this._getGraidentExtent(point);\n        }\n\n        strokeAndFill['polygonGradientExtent'] = gradientExtent;\n      }\n\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    var width = style['markerWidth'],\n        height = style['markerHeight'],\n        hLineWidth = style['markerLineWidth'] / 2;\n\n    if (markerType === 'ellipse') {\n      Canvas.ellipse(ctx, point, width / 2, height / 2, height / 2, lineOpacity, fillOpacity);\n    } else if (markerType === 'cross' || markerType === 'x') {\n      for (var j = vectorArray.length - 1; j >= 0; j--) {\n        vectorArray[j]._add(point);\n      }\n\n      Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n      Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n    } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n      if (markerType === 'bar') {\n        point = point.add(0, -hLineWidth);\n      } else if (markerType === 'rectangle') {\n        point = point.add(hLineWidth, hLineWidth);\n      }\n\n      for (var _j = vectorArray.length - 1; _j >= 0; _j--) {\n        vectorArray[_j]._add(point);\n      }\n\n      Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n    } else if (markerType === 'pin') {\n      point = point.add(0, -hLineWidth);\n\n      for (var _j2 = vectorArray.length - 1; _j2 >= 0; _j2--) {\n        vectorArray[_j2]._add(point);\n      }\n\n      var lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n      ctx.lineCap = lineCap;\n    } else if (markerType === 'pie') {\n      point = point.add(0, hLineWidth);\n      var angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n      var _lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n      ctx.lineCap = _lineCap;\n    } else {\n      throw new Error('unsupported markerType: ' + markerType);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        padding = this.padding * 2;\n\n    var size = this._calMarkerSize().map(function (d) {\n      return d - padding;\n    });\n\n    var alignPoint = this._getAnchor(size[0], size[1]);\n\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'markerType': getValueOrDefault(s['markerType'], 'ellipse'),\n      'markerFill': getValueOrDefault(s['markerFill'], '#00f'),\n      'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n      'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n      'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'),\n      'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n      'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n      'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n      'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n      'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0)\n    };\n    var markerType = result['markerType'];\n    var ha, va;\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      ha = 'middle';\n      va = 'top';\n    } else if (markerType === 'rectangle') {\n      ha = 'right';\n      va = 'bottom';\n    } else {\n      ha = 'middle';\n      va = 'middle';\n    }\n\n    result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha);\n    result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va);\n\n    if (isNumber(s['markerOpacity'])) {\n      if (isNumber(s['markerFillOpacity'])) {\n        result['markerFillOpacity'] *= s['markerOpacity'];\n      }\n\n      if (isNumber(s['markerLineOpacity'])) {\n        result['markerLineOpacity'] *= s['markerOpacity'];\n      }\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer.translateLineAndFill = function translateLineAndFill(s) {\n    var result = {\n      'lineColor': s['markerLineColor'],\n      'linePatternFile': s['markerLinePatternFile'],\n      'lineWidth': s['markerLineWidth'],\n      'lineOpacity': s['markerLineOpacity'],\n      'lineDasharray': s['markerLineDasharray'],\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['markerFill'],\n      'polygonPatternFile': s['markerFillPatternFile'],\n      'polygonOpacity': s['markerFillOpacity']\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer._getVectorPoints = function _getVectorPoints(markerType, width, height) {\n    var hh = height / 2,\n        hw = width / 2;\n    var left = 0,\n        top = 0;\n    var v0, v1, v2, v3;\n\n    if (markerType === 'triangle') {\n      v0 = new Point(left, top - hh);\n      v1 = new Point(left - hw, top + hh);\n      v2 = new Point(left + hw, top + hh);\n      return [v0, v1, v2];\n    } else if (markerType === 'cross') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left + hw, top);\n      v2 = new Point(left, top - hh);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'diamond') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left, top - hh);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'square') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top + hh);\n      v2 = new Point(left + hw, top - hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'rectangle') {\n      v0 = new Point(left, top);\n      v1 = v0.add(width, 0);\n      v2 = v0.add(width, height);\n      v3 = v0.add(0, height);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'x') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top - hh);\n      v2 = new Point(left + hw, top + hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'bar') {\n      v0 = new Point(left - hw, top - height);\n      v1 = new Point(left + hw, top - height);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left - hw, top);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'pin') {\n      var extWidth = height * Math.atan(hw / hh);\n      v0 = new Point(left, top);\n      v1 = new Point(left - extWidth, top - height);\n      v2 = new Point(left + extWidth, top - height);\n      v3 = new Point(left, top);\n      return [v0, v1, v2, v3];\n    }\n\n    return [];\n  };\n\n  return VectorMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar DebugSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DebugSymbolizer, _PointSymbolizer);\n\n  function DebugSymbolizer() {\n    return _PointSymbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = DebugSymbolizer.prototype;\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    return new Point(0, 0);\n  };\n\n  _proto.symbolize = function symbolize(ctx) {\n    var geometry = this.geometry,\n        layer = geometry.getLayer();\n\n    if (!geometry.options['debug'] && layer && !layer.options['debug']) {\n      return;\n    }\n\n    var map = this.getMap();\n\n    if (!map || map.isZooming()) {\n      return;\n    }\n\n    var color = layer.options['debugOutline'],\n        op = 1;\n    ctx.strokeStyle = color;\n    ctx.fillStyle = color;\n    var outline = this.getPainter().getContainerExtent().toArray();\n    Canvas.polygon(ctx, [outline], op, 0);\n\n    var points = this._getRenderContainerPoints(),\n        id = this.geometry.getId(),\n        cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n\n      if (!isNil(id)) {\n        Canvas.fillText(ctx, id, p.add(8, -4), color);\n      }\n\n      var c = [];\n\n      for (var ii = 0; ii < cross.length; ii++) {\n        c.push(cross[ii].add(p));\n      }\n\n      Canvas.path(ctx, c.slice(0, 2), op);\n      Canvas.path(ctx, c.slice(2, 4), op);\n    }\n  };\n\n  return DebugSymbolizer;\n}(PointSymbolizer);\n\nvar ImageMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(ImageMarkerSymbolizer, _PointSymbolizer);\n\n  ImageMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['markerFile'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function ImageMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = ImageMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var img = this._getImage(resources);\n\n    if (!img) {\n      if (typeof console !== 'undefined') {\n        console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n      }\n\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var width = style['markerWidth'];\n    var height = style['markerHeight'];\n\n    if (!isNumber(width) || !isNumber(height)) {\n      width = img.width;\n      height = img.height;\n      style['markerWidth'] = width;\n      style['markerHeight'] = height;\n      var imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n\n      if (!resources.isResourceLoaded(imgURL)) {\n        resources.addResource(imgURL, img);\n      }\n\n      var painter = this.getPainter();\n\n      if (!painter.isSpriting()) {\n        painter.removeCache();\n      }\n    }\n\n    var alpha;\n\n    if (this.symbol['markerType'] !== 'path' && isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= style['markerOpacity'];\n    }\n\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.image(ctx, img, p.x + alignPoint.x, p.y + alignPoint.y, width, height);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n\n    if (alpha !== undefined) {\n      ctx.globalAlpha = alpha;\n    }\n  };\n\n  _proto._getImage = function _getImage(resources) {\n    var img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n    return img;\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent(resources) {\n    var style = this.style;\n    var url = style['markerFile'],\n        img = resources ? resources.getImage(url) : null;\n    var width = style['markerWidth'] || (img ? img.width : 0),\n        height = style['markerHeight'] || (img ? img.height : 0);\n    var dxdy = this.getDxDy();\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    return {\n      'markerFile': s['markerFile'],\n      'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n      'markerWidth': getValueOrDefault(s['markerWidth'], null),\n      'markerHeight': getValueOrDefault(s['markerHeight'], null),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'),\n      'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top')\n    };\n  };\n\n  return ImageMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_COORD0$1 = new Coordinate(0, 0);\nvar TEMP_COORD1$1 = new Coordinate(0, 0);\n\nvar StrokeAndFillSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(StrokeAndFillSymbolizer, _CanvasSymbolizer);\n\n  StrokeAndFillSymbolizer.test = function test(symbol, geometry) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (geometry && geometry.type === 'Point') {\n      return false;\n    }\n\n    for (var p in symbol) {\n      var f = p.slice(0, 4);\n\n      if (f === 'line' || f === 'poly') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  function StrokeAndFillSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n\n    if (geometry.type === 'Point') {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = StrokeAndFillSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n      return;\n    }\n\n    var paintParams = this._getPaintParams();\n\n    if (!paintParams) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var isGradient$$1 = isGradient(style['lineColor']),\n        isPath = this.geometry.getJSONType() === 'Polygon' || this.geometry.type === 'LineString';\n\n    if (isGradient$$1 && (style['lineColor']['places'] || !isPath)) {\n      style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n    }\n\n    if (isGradient(style['polygonFill'])) {\n      style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n    }\n\n    var points = paintParams[0],\n        isSplitted = this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0]) || this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this.prepareCanvas(ctx, style, resources);\n\n        if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n          this._createGradient(ctx, points[i], style['lineColor']);\n        }\n\n        var params = [ctx, points[i]];\n\n        if (paintParams.length > 1) {\n          params.push.apply(params, paintParams.slice(1));\n        }\n\n        params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n        this.geometry._paintOn.apply(this.geometry, params);\n      }\n    } else {\n      this.prepareCanvas(ctx, style, resources);\n\n      if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n        this._createGradient(ctx, points, style['lineColor']);\n      }\n\n      var _params = [ctx];\n\n      _params.push.apply(_params, paintParams);\n\n      _params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n      this.geometry._paintOn.apply(this.geometry, _params);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    var extent = this.geometry._getPrjExtent();\n\n    if (!extent) {\n      return null;\n    }\n\n    if (!this._extMin || !this._extMax) {\n      this._extMin = new Coordinate(0, 0);\n      this._extMax = new Coordinate(0, 0);\n    }\n\n    this._extMin.x = extent['xmin'];\n    this._extMin.y = extent['ymin'];\n    this._extMax.x = extent['xmax'];\n    this._extMax.y = extent['ymax'];\n\n    var min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0$1),\n        max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1$1);\n\n    if (!this._pxExtent) {\n      this._pxExtent = new PointExtent(min, max);\n    } else {\n      this._pxExtent.set(Math.min(min.x, max.x), Math.min(min.y, max.y), Math.max(min.x, max.x), Math.max(min.y, max.y));\n    }\n\n    return this._pxExtent;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var t = this.style['lineWidth'] / 2;\n    return new PointExtent(-t, -t, t, t);\n  };\n\n  _proto._getPaintParams = function _getPaintParams() {\n    return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n      'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n      'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n      'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n      'lineCap': getValueOrDefault(s['lineCap'], 'butt'),\n      'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'),\n      'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n      'lineDx': getValueOrDefault(s['lineDx'], 0),\n      'lineDy': getValueOrDefault(s['lineDy'], 0),\n      'polygonFill': getValueOrDefault(s['polygonFill'], null),\n      'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n      'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n      'polygonPatternDx': getValueOrDefault(s['polygonPatternDx'], 0),\n      'polygonPatternDy': getValueOrDefault(s['polygonPatternDy'], 0),\n      'linePatternDx': getValueOrDefault(s['linePatternDx'], 0),\n      'linePatternDy': getValueOrDefault(s['linePatternDy'], 0)\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    if (this.geometry.type === 'LineString' && !result['polygonFill']) {\n      result['polygonFill'] = result['lineColor'];\n    }\n\n    return result;\n  };\n\n  _proto._createGradient = function _createGradient(ctx, points, lineColor) {\n    if (!Array.isArray(points) || !points.length) {\n      return;\n    }\n\n    var len = points.length;\n    var grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n    lineColor['colorStops'].forEach(function (stop) {\n      grad.addColorStop.apply(grad, stop);\n    });\n    ctx.strokeStyle = grad;\n  };\n\n  return StrokeAndFillSymbolizer;\n}(CanvasSymbolizer);\n\nvar CACHE_KEY = '___text_symbol_cache';\n\nvar TextMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(TextMarkerSymbolizer, _PointSymbolizer);\n\n  TextMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['textName'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function TextMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n\n    if (_this.style['textWrapWidth'] === 0) {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.strokeAndFill = _this._defineStyle(_this.translateLineAndFill(_this.style));\n    var textContent = replaceVariable(_this.style['textName'], _this.geometry.getProperties());\n\n    if (!_this._dynamic) {\n      _this._cacheKey = genCacheKey(textContent, _this.style);\n    }\n\n    _this._descText(textContent);\n\n    return _this;\n  }\n\n  var _proto = TextMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 || !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) || this.style['textWrapWidth'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill;\n    var textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n\n    this._descText(textContent);\n\n    this._prepareContext(ctx);\n\n    this.prepareCanvas(ctx, strokeAndFill, resources);\n    Canvas.prepareCanvasFont(ctx, style);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.text(ctx, textContent, p, style, this.textDesc);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['textPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['textRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    return new Point(s['textDx'], s['textDy']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        style = this.style;\n    var size = this.textDesc['size'];\n    var alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n    var alignW = alignPoint.x,\n        alignH = alignPoint.y;\n\n    if (style['textHaloRadius']) {\n      var r = style['textHaloRadius'];\n      size = size.add(r * 2, r * 2);\n    }\n\n    var result = new PointExtent(dxdy.add(alignW, alignH), dxdy.add(alignW + size['width'], alignH + size['height']));\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'textName': s['textName'],\n      'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n      'textWeight': getValueOrDefault(s['textWeight'], 'normal'),\n      'textStyle': getValueOrDefault(s['textStyle'], 'normal'),\n      'textSize': getValueOrDefault(s['textSize'], DEFAULT_TEXT_SIZE),\n      'textFont': getValueOrDefault(s['textFont'], null),\n      'textFill': getValueOrDefault(s['textFill'], '#000'),\n      'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n      'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n      'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n      'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n      'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n      'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n      'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n      'textDx': getValueOrDefault(s['textDx'], 0),\n      'textDy': getValueOrDefault(s['textDy'], 0),\n      'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'),\n      'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'),\n      'textAlign': getValueOrDefault(s['textAlign'], 'center'),\n      'textRotation': getValueOrDefault(s['textRotation'], 0),\n      'textMaxWidth': getValueOrDefault(s['textMaxWidth'], 0),\n      'textMaxHeight': getValueOrDefault(s['textMaxHeight'], 0)\n    };\n\n    if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n      if (!result['textWrapWidth']) {\n        result['textMaxHeight'] = 1;\n      }\n\n      result['textWrapWidth'] = result['textMaxWidth'];\n    }\n\n    return result;\n  };\n\n  _proto.translateLineAndFill = function translateLineAndFill(s) {\n    return {\n      'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n      'lineWidth': s['textHaloRadius'],\n      'lineOpacity': s['textOpacity'],\n      'lineDasharray': null,\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['textFill'],\n      'polygonOpacity': s['textOpacity']\n    };\n  };\n\n  _proto._descText = function _descText(textContent) {\n    if (this._dynamic) {\n      this.textDesc = this._measureText(textContent);\n      return;\n    }\n\n    this.textDesc = this._loadFromCache();\n\n    if (!this.textDesc) {\n      this.textDesc = this._measureText(textContent);\n\n      this._storeToCache(this.textDesc);\n    }\n  };\n\n  _proto._measureText = function _measureText(textContent) {\n    var maxHeight = this.style['textMaxHeight'];\n    var textDesc = splitTextToRow(textContent, this.style);\n\n    if (maxHeight && maxHeight < textDesc.size.height) {\n      textDesc.size.height = maxHeight;\n    }\n\n    return textDesc;\n  };\n\n  _proto._storeToCache = function _storeToCache(textDesc) {\n    if (IS_NODE) {\n      return;\n    }\n\n    if (!this.geometry[CACHE_KEY]) {\n      this.geometry[CACHE_KEY] = {};\n    }\n\n    this.geometry[CACHE_KEY][this._cacheKey] = {\n      'desc': textDesc,\n      'active': true\n    };\n  };\n\n  _proto._loadFromCache = function _loadFromCache() {\n    if (!this.geometry[CACHE_KEY]) {\n      return null;\n    }\n\n    var cache = this.geometry[CACHE_KEY][this._cacheKey];\n\n    if (!cache) {\n      return null;\n    }\n\n    cache.active = true;\n    return cache.desc;\n  };\n\n  return TextMarkerSymbolizer;\n}(PointSymbolizer);\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n  var key = [textContent];\n\n  for (var p in style) {\n    if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n      key.push(p + '=' + style[p]);\n    }\n  }\n\n  return key.join('-');\n}\n\nvar VectorPathMarkerSymbolizer = function (_ImageMarkerSymbolize) {\n  _inheritsLoose(VectorPathMarkerSymbolizer, _ImageMarkerSymbolize);\n\n  VectorPathMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorPathMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    if (isNil(symbol['markerWidth'])) {\n      symbol['markerWidth'] = 80;\n    }\n\n    if (isNil(symbol['markerHeight'])) {\n      symbol['markerHeight'] = 80;\n    }\n\n    _this = _ImageMarkerSymbolize.call(this, symbol, geometry, painter) || this;\n    symbol = extend(symbol, _this.translate());\n\n    var style = _this.style = _this._defineStyle(symbol);\n\n    if (Browser$1.gecko) {\n      _this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n    } else {\n      _this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorPathMarkerSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext() {};\n\n  _proto._getImage = function _getImage(resources) {\n    var _this2 = this;\n\n    if (resources && resources.isResourceLoaded(this._url)) {\n      return resources.getImage(this._url);\n    }\n\n    var painter = this.painter;\n    var image = new Image();\n\n    image.onload = function () {\n      var renderer = painter.getLayer() && painter.getLayer().getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    };\n\n    image.onerror = function (err) {\n      if (err && typeof console !== 'undefined') {\n        console.warn(err);\n      }\n\n      resources.markErrorResource(_this2._url);\n    };\n\n    image.src = this._url[0];\n\n    if (resources) {\n      resources.addResource(this._url, image);\n    }\n\n    return image;\n  };\n\n  return VectorPathMarkerSymbolizer;\n}(ImageMarkerSymbolizer);\n\nvar defaultSymbol = {\n  lineWidth: 1,\n  polygonFill: '#fff',\n  polygonOpacity: 0.5\n};\n\nvar DrawAltitudeSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DrawAltitudeSymbolizer, _PointSymbolizer);\n\n  DrawAltitudeSymbolizer.test = function test(symbol, geometry) {\n    var layer = geometry.getLayer();\n\n    if (!layer) {\n      return false;\n    }\n\n    var type = geometry.getJSONType();\n    return type === 'Marker' || type === 'LineString';\n  };\n\n  function DrawAltitudeSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = geometry.getLayer().options['drawAltitude'];\n\n    if (!_this.style || !isObject(_this.style)) {\n      _this.style = {\n        'lineWidth': 2\n      };\n    }\n\n    if (!_this.style['lineWidth']) {\n      _this.style['lineWidth'] = 0;\n    }\n\n    _this.dxdy = _this._defineStyle({\n      'dx': symbol['textDx'] || symbol['markerDx'],\n      'dy': symbol['textDy'] || symbol['markerDy']\n    });\n    return _this;\n  }\n\n  var _proto = DrawAltitudeSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx) {\n    var layer = this.geometry.getLayer();\n\n    if (!layer.options['drawAltitude']) {\n      return;\n    }\n\n    var properties = this.geometry.getProperties();\n\n    if (!properties || !properties[layer.options['altitudeProperty']]) {\n      return;\n    }\n\n    var style = this._getStyle();\n\n    this._prepareContext(ctx);\n\n    if (this.geometry.type === 'LineString') {\n      var paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n\n      if (!paintParams) {\n        return;\n      }\n\n      var groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n\n      this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n    } else {\n      var point = this._getRenderContainerPoints(),\n          groundPoint = this._getRenderContainerPoints(true);\n\n      if (!point || point.length === 0) {\n        return;\n      }\n\n      this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.dxdy;\n    return new Point(s['dx'] || 0, s['dy'] || 0);\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    if (this.geometry.type === 'LineString') {\n      return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n    } else {\n      return _PointSymbolizer.prototype.get2DExtent.call(this);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto._getPaintParams = function _getPaintParams(dx, dy) {\n    return this.getPainter().getPaintParams(dx || 0, dy || 0);\n  };\n\n  _proto._drawMarkerAltitude = function _drawMarkerAltitude(ctx, point, groundPoint) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n    Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n  };\n\n  _proto._drawLineAltitude = function _drawLineAltitude(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this._drawLine(ctx, points[i], groundPoints[i]);\n      }\n    } else {\n      this._drawLine(ctx, points, groundPoints);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto._drawLine = function _drawLine(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n\n    for (var i = 0, l = points.length - 1; i < l; i++) {\n      Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n    }\n  };\n\n  _proto._getStyle = function _getStyle() {\n    var style = this.geometry.getLayer().options['drawAltitude'];\n\n    if (!isObject(style)) {\n      style = defaultSymbol;\n    }\n\n    if (!style['lineWidth']) {\n      style['lineWidth'] = 0;\n      style['lineOpacity'] = 0;\n    }\n\n    return style;\n  };\n\n  return DrawAltitudeSymbolizer;\n}(PointSymbolizer);\n\n\n\nvar index$3 = /*#__PURE__*/Object.freeze({\n  Symbolizer: Symbolizer,\n  CanvasSymbolizer: CanvasSymbolizer,\n  DebugSymbolizer: DebugSymbolizer,\n  ImageMarkerSymbolizer: ImageMarkerSymbolizer,\n  PointSymbolizer: PointSymbolizer,\n  StrokeAndFillSymbolizer: StrokeAndFillSymbolizer,\n  TextMarkerSymbolizer: TextMarkerSymbolizer,\n  VectorMarkerSymbolizer: VectorMarkerSymbolizer,\n  VectorPathMarkerSymbolizer: VectorPathMarkerSymbolizer,\n  DrawAltitudeSymbolizer: DrawAltitudeSymbolizer\n});\n\nvar registerSymbolizers = [DrawAltitudeSymbolizer, StrokeAndFillSymbolizer, ImageMarkerSymbolizer, VectorPathMarkerSymbolizer, VectorMarkerSymbolizer, TextMarkerSymbolizer];\nvar testCanvas;\nvar TEMP_POINT0$2 = new Point(0, 0);\nvar TEMP_PAINT_EXTENT = new PointExtent();\nvar TEMP_EXTENT$1 = new PointExtent();\nvar TEMP_FIXED_EXTENT = new PointExtent();\nvar TEMP_CLIP_EXTENT0 = new PointExtent();\nvar TEMP_CLIP_EXTENT1 = new PointExtent();\n\nvar Painter = function (_Class) {\n  _inheritsLoose(Painter, _Class);\n\n  function Painter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.symbolizers = _this._createSymbolizers();\n    _this._altAtGLZoom = _this._getGeometryAltitude();\n    return _this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getLayer = function getLayer() {\n    return this.geometry.getLayer();\n  };\n\n  _proto._createSymbolizers = function _createSymbolizers() {\n    var geoSymbol = this.getSymbol(),\n        symbolizers = [],\n        regSymbolizers = registerSymbolizers;\n    var symbols = geoSymbol;\n\n    if (!Array.isArray(geoSymbol)) {\n      symbols = [geoSymbol];\n    }\n\n    for (var ii = symbols.length - 1; ii >= 0; ii--) {\n      var symbol = symbols[ii];\n\n      for (var i = regSymbolizers.length - 1; i >= 0; i--) {\n        if (regSymbolizers[i].test(symbol, this.geometry)) {\n          var symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n          symbolizers.push(symbolizer);\n\n          if (symbolizer instanceof PointSymbolizer) {\n            this._hasPoint = true;\n          }\n        }\n      }\n    }\n\n    if (!symbolizers.length) {\n      if (console) {\n        var id = this.geometry.getId();\n        console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n      }\n    }\n\n    this._debugSymbolizer = new DebugSymbolizer(geoSymbol, this.geometry, this);\n    return symbolizers;\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    return !!this._hasPoint;\n  };\n\n  _proto.getRenderPoints = function getRenderPoints(placement) {\n    if (!this._renderPoints) {\n      this._renderPoints = {};\n    }\n\n    if (!placement) {\n      placement = 'center';\n    }\n\n    if (!this._renderPoints[placement]) {\n      this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n    }\n\n    return this._renderPoints[placement];\n  };\n\n  _proto.getPaintParams = function getPaintParams(dx, dy, ignoreAltitude) {\n    var map = this.getMap(),\n        geometry = this.geometry,\n        res = map.getResolution(),\n        pitched = map.getPitch() !== 0,\n        rotated = map.getBearing() !== 0;\n    var params = this._cachedParams;\n\n    var paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n\n    if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n      params = this._unsimpledParams;\n    } else if (!params || params._res !== map.getResolution() || this._pitched !== pitched && geometry._redrawWhenPitch() || this._rotated !== rotated && geometry._redrawWhenRotate()) {\n      params = geometry._getPaintParams();\n\n      if (!params) {\n        return null;\n      }\n\n      params._res = res;\n\n      if (!geometry._simplified && paintAsPath) {\n        if (!this._unsimpledParams) {\n          this._unsimpledParams = params;\n        }\n\n        if (res > this._unsimpledParams._res) {\n          this._unsimpledParams._res = res;\n        }\n      }\n\n      this._cachedParams = params;\n    }\n\n    if (!params) {\n      return null;\n    }\n\n    this._pitched = pitched;\n    this._rotated = rotated;\n    var zoomScale = map.getGLScale(),\n        tr = [],\n        points = params[0];\n    var mapExtent = map.getContainerExtent();\n\n    var cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n\n    if (!cPoints) {\n      return null;\n    }\n\n    tr.push(cPoints);\n\n    for (var i = 1, l = params.length; i < l; i++) {\n      if (isNumber(params[i]) || params[i] instanceof Size) {\n        if (isNumber(params[i])) {\n          tr.push(params[i] / zoomScale);\n        } else {\n          tr.push(params[i].multi(1 / zoomScale));\n        }\n      } else {\n        tr.push(params[i]);\n      }\n    }\n\n    return tr;\n  };\n\n  _proto._pointContainerPoints = function _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    var map = this.getMap(),\n        glZoom = map.getGLZoom(),\n        containerOffset = this.containerOffset;\n    var cPoints;\n\n    function pointContainerPoint(point, alt) {\n      var p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n\n      if (dx || dy) {\n        p._add(dx || 0, dy || 0);\n      }\n\n      return p;\n    }\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(points)) {\n      var geometry = this.geometry;\n      var clipped;\n\n      if (!disableClip && geometry.options['enableClip']) {\n        clipped = this._clip(points, altitude);\n      } else {\n        clipped = {\n          points: points,\n          altitude: altitude\n        };\n      }\n\n      var clipPoints = clipped.points;\n      altitude = clipped.altitude;\n\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      var alt = altitude;\n      cPoints = [];\n\n      for (var i = 0, l = clipPoints.length; i < l; i++) {\n        var c = clipPoints[i];\n\n        if (Array.isArray(c)) {\n          var cring = [];\n\n          for (var ii = 0, ll = c.length; ii < ll; ii++) {\n            var cc = c[ii];\n\n            if (Array.isArray(altitude)) {\n              if (altitude[i]) {\n                alt = altitude[i][ii];\n              } else {\n                alt = 0;\n              }\n            }\n\n            cring.push(pointContainerPoint(cc, alt));\n          }\n\n          cPoints.push(cring);\n        } else {\n          if (Array.isArray(altitude)) {\n            if (pointPlacement === 'vertex-last') {\n              alt = altitude[altitude.length - 1 - i];\n            } else if (pointPlacement === 'line') {\n              alt = (altitude[i] + altitude[i + 1]) / 2;\n            } else {\n              alt = altitude[i];\n            }\n          }\n\n          cPoints.push(pointContainerPoint(c, alt));\n        }\n      }\n    } else if (points instanceof Point) {\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n\n      if (dx || dy) {\n        cPoints._add(dx, dy);\n      }\n    }\n\n    return cPoints;\n  };\n\n  _proto._clip = function _clip(points, altitude) {\n    var map = this.getMap(),\n        geometry = this.geometry;\n    var lineWidth = this.getSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth)) {\n      lineWidth = 4;\n    }\n\n    var extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n\n    if (map.getPitch() > 0 && altitude) {\n      var c = map.cameraLookAt;\n      var pos = map.cameraPosition;\n      TEMP_POINT0$2.set(pos.x, pos.y);\n      extent2D = extent2D._combine(TEMP_POINT0$2._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n    }\n\n    var e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n    var clipPoints = points;\n\n    if (e.within(extent2D)) {\n      return {\n        points: clipPoints,\n        altitude: altitude\n      };\n    }\n\n    var glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth * map._glScale);\n\n    var smoothness = geometry.options['smoothness'];\n\n    if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipPolygon(points, glExtent2D);\n      } else {\n        clipPoints = [];\n\n        for (var i = 0; i < points.length; i++) {\n          var part = clipPolygon(points[i], glExtent2D);\n\n          if (part.length) {\n            clipPoints.push(part);\n          }\n        }\n      }\n    } else if (geometry.getJSONType() === 'LineString' && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n      } else {\n        clipPoints = [];\n\n        for (var _i = 0; _i < points.length; _i++) {\n          pushIn(clipPoints, clipLine(points[_i], glExtent2D, false, !!smoothness));\n        }\n      }\n\n      return this._interpolateSegAlt(clipPoints, points, altitude);\n    }\n\n    return {\n      points: clipPoints,\n      altitude: altitude\n    };\n  };\n\n  _proto._interpolateSegAlt = function _interpolateSegAlt(clipSegs, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n      var fn = function fn(cc) {\n        return cc.point;\n      };\n\n      return {\n        points: clipSegs.map(function (c) {\n          if (Array.isArray(c)) {\n            return c.map(fn);\n          }\n\n          return c.point;\n        }),\n        altitude: altitude\n      };\n    }\n\n    var segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n    altitude = [];\n    var points = segsWithAlt.map(function (p) {\n      if (Array.isArray(p)) {\n        var alt = [];\n        var cp = p.map(function (pp) {\n          alt.push(pp.altitude);\n          return pp.point;\n        });\n        altitude.push(alt);\n        return cp;\n      }\n\n      altitude.push(p.altitude);\n      return p.point;\n    });\n    return {\n      points: points,\n      altitude: altitude\n    };\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    return this.geometry._getInternalSymbol();\n  };\n\n  _proto.paint = function paint(extent, context, offset) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    if (!renderer || !renderer.context && !context) {\n      return;\n    }\n\n    if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n      return;\n    }\n\n    var map = this.getMap();\n    var minAltitude = this.getMinAltitude();\n    var frustumAlt = map.getFrustumAltitude();\n\n    if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n      return;\n    }\n\n    this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n\n    this._beforePaint();\n\n    var ctx = context || renderer.context;\n    var contexts = [ctx, renderer.resources];\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n      this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n    }\n\n    this._afterPaint();\n\n    this._painted = true;\n\n    this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n  };\n\n  _proto.getSprite = function getSprite(resources, canvasClass) {\n    if (this.geometry.type !== 'Point') {\n      return null;\n    }\n\n    this._spriting = true;\n\n    if (!this._sprite && this.symbolizers.length > 0) {\n      var extent = new PointExtent();\n      this.symbolizers.forEach(function (s) {\n        var markerExtent = s.getFixedExtent(resources);\n\n        extent._combine(markerExtent);\n      });\n      var origin = extent.getMin().multi(-1);\n      var clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n      var canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n      var bak;\n\n      if (this._renderPoints) {\n        bak = this._renderPoints;\n      }\n\n      var ctx = canvas.getContext('2d');\n      var contexts = [ctx, resources];\n\n      for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n        var dxdy = this.symbolizers[i].getDxDy();\n        this._renderPoints = {\n          'center': [[origin.add(dxdy)]]\n        };\n\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n        this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n      }\n\n      if (bak) {\n        this._renderPoints = bak;\n      }\n\n      this._sprite = {\n        'canvas': canvas,\n        'offset': extent.getCenter()\n      };\n    }\n\n    this._spriting = false;\n    return this._sprite;\n  };\n\n  _proto.isSpriting = function isSpriting() {\n    return !!this._spriting;\n  };\n\n  _proto.hitTest = function hitTest(cp, tolerance) {\n    if (!tolerance || tolerance < 0.5) {\n      tolerance = 0.5;\n    }\n\n    if (!testCanvas) {\n      testCanvas = Canvas.createCanvas(1, 1);\n    }\n\n    Canvas.setHitTesting(true);\n    testCanvas.width = testCanvas.height = 2 * tolerance;\n    var ctx = testCanvas.getContext('2d');\n    this._hitPoint = cp.sub(tolerance, tolerance);\n\n    try {\n      this.paint(null, ctx, this._hitPoint);\n    } catch (e) {\n      throw e;\n    } finally {\n      Canvas.setHitTesting(false);\n    }\n\n    delete this._hitPoint;\n    var imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n\n    for (var i = 3, l = imgData.length; i < l; i += 4) {\n      if (imgData[i] > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.isHitTesting = function isHitTesting() {\n    return !!this._hitPoint;\n  };\n\n  _proto._prepareShadow = function _prepareShadow(ctx, symbol) {\n    if (symbol['shadowBlur']) {\n      ctx.shadowBlur = this.isHitTesting() ? 0 : symbol['shadowBlur'];\n      ctx.shadowColor = symbol['shadowColor'] || '#000';\n      ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n      ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n    } else if (ctx.shadowBlur) {\n      ctx.shadowBlur = null;\n      ctx.shadowColor = null;\n      ctx.shadowOffsetX = null;\n      ctx.shadowOffsetY = null;\n    }\n  };\n\n  _proto._eachSymbolizer = function _eachSymbolizer(fn, context) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    if (!context) {\n      context = this;\n    }\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      fn.apply(context, [this.symbolizers[i]]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    this._verifyProjection();\n\n    var map = this.getMap();\n    resources = resources || this.getLayer()._getRenderer().resources;\n    var zoom = map.getZoom();\n\n    var isDynamicSize = this._isDynamicSize();\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom || !this._fixedExtent) {\n      if (this._extent2D && this._extent2D._zoom !== zoom) {\n        delete this._extent2D;\n      }\n\n      if (this.symbolizers) {\n        if (!this._extent2D) {\n          this._extent2D = this._computeExtent2D(new PointExtent());\n          this._extent2D._zoom = zoom;\n        }\n\n        if (!this._fixedExtent) {\n          this._fixedExtent = this._computeFixedExtent(resources, new PointExtent());\n        }\n      }\n    }\n\n    if (!this._extent2D) {\n      if (isDynamicSize) {\n        delete this._fixedExtent;\n      }\n\n      return null;\n    }\n\n    var _this$_fixedExtent = this._fixedExtent,\n        xmin = _this$_fixedExtent.xmin,\n        ymin = _this$_fixedExtent.ymin,\n        xmax = _this$_fixedExtent.xmax,\n        ymax = _this$_fixedExtent.ymax;\n\n    if (isDynamicSize) {\n      delete this._fixedExtent;\n    }\n\n    TEMP_FIXED_EXTENT.set(xmin, -ymax, xmax, -ymin);\n\n    if (out) {\n      out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n\n      out._add(TEMP_FIXED_EXTENT);\n\n      return out;\n    }\n\n    return this._extent2D.add(TEMP_FIXED_EXTENT);\n  };\n\n  _proto._computeExtent2D = function _computeExtent2D(extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      extent._combine(symbolizer.get2DExtent());\n    }\n\n    return extent;\n  };\n\n  _proto._computeFixedExtent = function _computeFixedExtent(resources, extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.getFixedExtent) {\n        extent._combine(symbolizer.getFixedExtent(resources));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.isDynamicSize()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    this._verifyProjection();\n\n    var map = this.getMap();\n    var zoom = map.getZoom();\n    var glScale = map._glScale;\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_EXTENT$1);\n    }\n\n    var altitude = this.getMinAltitude();\n\n    var extent = this._extent2D.convertTo(function (c) {\n      return map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0$2);\n    }, out);\n\n    var maxAltitude = this.getMaxAltitude();\n\n    if (maxAltitude !== altitude) {\n      var extent2 = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(extent2);\n    }\n\n    var layer = this.geometry.getLayer();\n\n    if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n      var groundExtent = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(groundExtent);\n    }\n\n    if (extent) {\n      extent._add(this._fixedExtent || this._computeFixedExtent(null, new PointExtent()));\n    }\n\n    var smoothness = this.geometry.options['smoothness'];\n\n    if (smoothness) {\n      extent._expand(extent.getWidth() * 0.15);\n    }\n\n    return extent;\n  };\n\n  _proto._aboveCamera = function _aboveCamera() {\n    var altitude = this.getMinAltitude();\n    var map = this.getMap();\n    var frustumAlt = map.getFrustumAltitude();\n    return altitude && frustumAlt && frustumAlt < altitude;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var map = this.getMap();\n    var zoom = map.getZoom();\n\n    if (this._isDynamicSize()) {\n      return this._computeFixedExtent(null, new PointExtent());\n    }\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_FIXED_EXTENT);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto.setZIndex = function setZIndex(change) {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.setZIndex(change);\n    });\n  };\n\n  _proto.show = function show() {\n    if (!this._painted) {\n      var layer = this.getLayer();\n\n      if (!layer.isCanvasRender()) {\n        this.paint();\n      }\n    } else {\n      this.removeCache();\n\n      this._eachSymbolizer(function (symbolizer) {\n        symbolizer.show();\n      });\n    }\n  };\n\n  _proto.hide = function hide() {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.hide();\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    this._altAtGLZoom = this._getGeometryAltitude();\n    this.removeCache();\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    var renderer = layer.getRenderer();\n\n    if (!renderer || !renderer.setToRedraw()) {\n      return;\n    }\n\n    renderer.setToRedraw();\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n\n    this.symbolizers = this._createSymbolizers();\n  };\n\n  _proto.remove = function remove() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n  };\n\n  _proto._removeSymbolizers = function _removeSymbolizers() {\n    this._eachSymbolizer(function (symbolizer) {\n      delete symbolizer.painter;\n      symbolizer.remove();\n    });\n\n    delete this.symbolizers;\n  };\n\n  _proto.removeCache = function removeCache() {\n    delete this._renderPoints;\n    delete this._paintParams;\n    delete this._sprite;\n    delete this._extent2D;\n    delete this._fixedExtent;\n    delete this._cachedParams;\n    delete this._unsimpledParams;\n\n    if (this.geometry) {\n      delete this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n    }\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var propAlt = this.geometry.getAltitude();\n\n    if (propAlt !== this._propAlt) {\n      this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    if (!this._altAtGLZoom) {\n      return 0;\n    }\n\n    return this._altAtGLZoom;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (!this.minAltitude) {\n      return 0;\n    }\n\n    return this.minAltitude;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (!this.maxAltitude) {\n      return 0;\n    }\n\n    return this.maxAltitude;\n  };\n\n  _proto._getGeometryAltitude = function _getGeometryAltitude() {\n    var _this2 = this;\n\n    var map = this.getMap();\n\n    if (!map) {\n      return 0;\n    }\n\n    var altitude = this.geometry.getAltitude();\n    this._propAlt = altitude;\n\n    if (!altitude) {\n      this.minAltitude = this.maxAltitude = 0;\n      return 0;\n    }\n\n    var center = this.geometry.getCenter();\n\n    if (!center) {\n      return 0;\n    }\n\n    if (Array.isArray(altitude)) {\n      this.minAltitude = Number.MAX_VALUE;\n      this.maxAltitude = Number.MIN_VALUE;\n      return altitude.map(function (alt) {\n        var a = _this2._meterToPoint(center, alt);\n\n        if (a < _this2.minAltitude) {\n          _this2.minAltitude = a;\n        }\n\n        if (a > _this2.maxAltitude) {\n          _this2.maxAltitude = a;\n        }\n\n        return a;\n      });\n    } else {\n      this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n      return this.minAltitude;\n    }\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    var z = map.getGLZoom();\n    return map.distanceToPoint(altitude, 0, z, center).x * sign(altitude);\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this.geometry._getProjection();\n\n    if (this._projCode && this._projCode !== projection.code) {\n      this.removeCache();\n    }\n\n    this._projCode = projection.code;\n  };\n\n  _proto._beforePaint = function _beforePaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        textcache[p].active = false;\n      }\n    }\n  };\n\n  _proto._afterPaint = function _afterPaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        if (!textcache[p].active) {\n          delete textcache[p];\n        }\n      }\n    }\n  };\n\n  return Painter;\n}(Class);\n\nfunction interpolateAlt(points, orig, altitude) {\n  if (!Array.isArray(altitude)) {\n    return points;\n  }\n\n  var parts = [];\n\n  for (var i = 0, l = points.length; i < l; i++) {\n    if (Array.isArray(points[i])) {\n      parts.push(interpolateAlt(points[i], orig, altitude));\n    } else {\n      var p = points[i];\n\n      if (!p.point.equals(orig[p.index])) {\n        var w0 = void 0,\n            w1 = void 0;\n\n        if (p.index === 0) {\n          w0 = p.index;\n          w1 = p.index + 1;\n        } else {\n          w0 = p.index - 1;\n          w1 = p.index;\n        }\n\n        var t0 = p.point.distanceTo(orig[w1]);\n        var t = t0 / (t0 + orig[w0].distanceTo(p.point));\n        var alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n        p.altitude = alt;\n        parts.push(p);\n      } else {\n        p.altitude = altitude[p.index];\n        parts.push(p);\n      }\n    }\n  }\n\n  return parts;\n}\n\nvar TEMP_EXTENT$2 = new PointExtent();\n\nvar CollectionPainter = function (_Class) {\n  _inheritsLoose(CollectionPainter, _Class);\n\n  function CollectionPainter(geometry, isMask) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.isMask = isMask;\n    return _this;\n  }\n\n  var _proto = CollectionPainter.prototype;\n\n  _proto._eachPainter = function _eachPainter(fn) {\n    var geometries = this.geometry.getGeometries();\n    var painter;\n\n    for (var i = 0, len = geometries.length; i < len; i++) {\n      painter = this.isMask ? geometries[i]._getMaskPainter() : geometries[i]._getPainter();\n\n      if (!painter) {\n        continue;\n      }\n\n      if (painter) {\n        if (fn.call(this, painter) === false) {\n          break;\n        }\n      }\n    }\n  };\n\n  _proto.paint = function paint(extent) {\n    if (!this.geometry) {\n      return;\n    }\n\n    this._eachPainter(function (painter) {\n      painter.paint(extent);\n    });\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    if (out) {\n      out.set(null, null, null, null);\n    }\n\n    var extent = out || new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT$2));\n    });\n\n    return extent;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var extent = new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent.combine(painter.getContainerExtent());\n    });\n\n    return extent;\n  };\n\n  _proto.remove = function remove() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.remove.apply(painter, args);\n    });\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.setZIndex.apply(painter, args);\n    });\n  };\n\n  _proto.show = function show() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.show.apply(painter, args);\n    });\n  };\n\n  _proto.hide = function hide() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.hide.apply(painter, args);\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.repaint.apply(painter, args);\n    });\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.refreshSymbol.apply(painter, args);\n    });\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    var result = false;\n\n    this._eachPainter(function (painter) {\n      if (painter.hasPoint()) {\n        result = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    return result;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    var first = true;\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMinAltitude();\n\n      if (first || alt < result) {\n        first = false;\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMaxAltitude();\n\n      if (alt > result) {\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  return CollectionPainter;\n}(Class);\n\nvar DefaultSpatialReference = {\n  'EPSG:3857': {\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 2 * 6378137 * Math.PI;\n\n      for (var i = 0; i < 21; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  },\n  'EPSG:4326': {\n    'fullExtent': {\n      'top': 90,\n      'left': -180,\n      'bottom': -90,\n      'right': 180\n    },\n    'resolutions': function () {\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = 180 / (Math.pow(2, i) * 128);\n      }\n\n      return resolutions;\n    }()\n  },\n  'BAIDU': {\n    'resolutions': function () {\n      var res = Math.pow(2, 18);\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 33554432,\n      'left': -33554432,\n      'bottom': -33554432,\n      'right': 33554432\n    }\n  },\n  'IDENTITY': {\n    'resolutions': function () {\n      var res = Math.pow(2, 8);\n      var resolutions = [];\n\n      for (var i = 0; i < 18; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 200000,\n      'left': -200000,\n      'bottom': -200000,\n      'right': 200000\n    }\n  }\n};\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nvar SpatialReference = function () {\n  function SpatialReference(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.options = options;\n\n    this._initSpatialRef();\n  }\n\n  SpatialReference.getProjectionInstance = function getProjectionInstance(prjName) {\n    if (!prjName) {\n      return null;\n    }\n\n    if (isObject(prjName)) {\n      return prjName;\n    }\n\n    prjName = (prjName + '').toLowerCase();\n\n    for (var p in projections) {\n      if (hasOwn(projections, p)) {\n        var code = projections[p]['code'];\n\n        if (code && code.toLowerCase() === prjName) {\n          return projections[p];\n        }\n      }\n    }\n\n    return null;\n  };\n\n  SpatialReference.equals = function equals(sp1, sp2) {\n    if (!sp1 && !sp2) {\n      return true;\n    } else if (!sp1 || !sp2) {\n      return false;\n    }\n\n    if (sp1.projection !== sp2.projection) {\n      return false;\n    }\n\n    var f1 = sp1.fullExtent,\n        f2 = sp2.fullExtent;\n\n    if (f1 && !f2 || !f1 && f2) {\n      return false;\n    }\n\n    if (f1 && f2) {\n      if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n        return false;\n      }\n    }\n\n    var r1 = sp1.resolutions,\n        r2 = sp2.resolutions;\n\n    if (r1 && r2) {\n      if (r1.length !== r2.length) {\n        return false;\n      }\n\n      for (var i = 0; i < r1.length; i++) {\n        if (r1[i] !== r2[i]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var _proto = SpatialReference.prototype;\n\n  _proto._initSpatialRef = function _initSpatialRef() {\n    var projection = this.options['projection'];\n\n    if (projection) {\n      projection = SpatialReference.getProjectionInstance(projection);\n    } else {\n      projection = DEFAULT$1;\n    }\n\n    if (!projection) {\n      throw new Error('must provide a valid projection in map\\'s spatial reference.');\n    }\n\n    projection = extend({}, Common, projection);\n\n    if (!projection.measureLength) {\n      extend(projection, Measurer.DEFAULT);\n    }\n\n    this._projection = projection;\n    var defaultSpatialRef,\n        resolutions = this.options['resolutions'];\n\n    if (!resolutions) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          resolutions = defaultSpatialRef['resolutions'];\n          this.isEPSG = projection['code'] !== 'IDENTITY';\n        }\n      }\n\n      if (!resolutions) {\n        throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n      }\n    }\n\n    this._resolutions = resolutions;\n    var fullExtent = this.options['fullExtent'];\n\n    if (!fullExtent) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          fullExtent = defaultSpatialRef['fullExtent'];\n        }\n      }\n\n      if (!fullExtent) {\n        throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n      }\n    }\n\n    if (!isNil(fullExtent['left'])) {\n      this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']), new Coordinate(fullExtent['right'], fullExtent['bottom']));\n    } else {\n      this._fullExtent = new Extent(fullExtent);\n      fullExtent['left'] = fullExtent['xmin'];\n      fullExtent['right'] = fullExtent['xmax'];\n      fullExtent['top'] = fullExtent['ymax'];\n      fullExtent['bottom'] = fullExtent['ymin'];\n    }\n\n    if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n      throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n    }\n\n    extend(this._fullExtent, fullExtent);\n    this._projection.fullExtent = fullExtent;\n    var a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n    this._transformation = new Transformation([a, b, 0, 0]);\n  };\n\n  _proto.getResolutions = function getResolutions() {\n    return this._resolutions || [];\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    var z = zoom | 0;\n\n    if (z < 0) {\n      z = 0;\n    } else if (z > this._resolutions.length - 1) {\n      z = this._resolutions.length - 1;\n    }\n\n    var res = this._resolutions[z];\n\n    if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n      var next = this._resolutions[z + 1];\n      return res + (next - res) * (zoom - z);\n    }\n\n    return res;\n  };\n\n  _proto.getProjection = function getProjection() {\n    return this._projection;\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    return this._fullExtent;\n  };\n\n  _proto.getTransformation = function getTransformation() {\n    return this._transformation;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    for (var i = 0; i < this._resolutions.length; i++) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return 0;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    for (var i = this._resolutions.length - 1; i >= 0; i--) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return this._resolutions.length - 1;\n  };\n\n  _proto.getZoomDirection = function getZoomDirection() {\n    return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n  };\n\n  _proto.toJSON = function toJSON() {\n    if (!this.json) {\n      this.json = {\n        'resolutions': this._resolutions,\n        'fullExtent': {\n          'top': this._fullExtent.top,\n          'left': this._fullExtent.left,\n          'bottom': this._fullExtent.bottom,\n          'right': this._fullExtent.right\n        },\n        'projection': this._projection.code\n      };\n    }\n\n    return this.json;\n  };\n\n  return SpatialReference;\n}();\n\nvar options = {\n  'id': null,\n  'visible': true,\n  'interactive': true,\n  'editable': true,\n  'cursor': null,\n  'defaultProjection': 'EPSG:4326'\n};\n\nvar Geometry = function (_JSONAble) {\n  _inheritsLoose(Geometry, _JSONAble);\n\n  function Geometry(options) {\n    var _this;\n\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    _this = _JSONAble.call(this, opts) || this;\n\n    if (symbol) {\n      _this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      _this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      _this.setId(id);\n    }\n\n    return _this;\n  }\n\n  var _proto = Geometry.prototype;\n\n  _proto.getFirstCoordinate = function getFirstCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[0].getFirstCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[0];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.getLastCoordinate = function getLastCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[geometries.length - 1].getLastCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[coordinates.length - 1];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.addTo = function addTo(layer, fitview) {\n    layer.addGeometry(this, fitview);\n    return this;\n  };\n\n  _proto.getLayer = function getLayer() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer.getMap();\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var oldId = this.getId();\n    this._id = id;\n\n    this._fireEvent('idchange', {\n      'old': oldId,\n      'new': id\n    });\n\n    return this;\n  };\n\n  _proto.getProperties = function getProperties() {\n    if (!this.properties) {\n      if (this._getParent()) {\n        return this._getParent().getProperties();\n      }\n\n      return null;\n    }\n\n    return this.properties;\n  };\n\n  _proto.setProperties = function setProperties(properties) {\n    var old = this.properties;\n    this.properties = isObject(properties) ? extend({}, properties) : properties;\n\n    this._repaint();\n\n    this._fireEvent('propertieschange', {\n      'old': old,\n      'new': properties\n    });\n\n    return this;\n  };\n\n  _proto.getType = function getType() {\n    return this.type;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = this._symbol;\n\n    if (s) {\n      if (!Array.isArray(s)) {\n        return extend({}, s);\n      } else {\n        return extendSymbol(s);\n      }\n    }\n\n    return null;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    this._symbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto.updateSymbol = function updateSymbol(props) {\n    if (!props) {\n      return this;\n    }\n\n    var s = this._getSymbol();\n\n    if (s) {\n      s = extendSymbol(s, props);\n    } else {\n      s = extendSymbol(this._getInternalSymbol(), props);\n    }\n\n    this._eventSymbolProperties = props;\n    return this.setSymbol(s);\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this._computeCenter(this._getMeasurer());\n  };\n\n  _proto.getExtent = function getExtent() {\n    var prjExt = this._getPrjExtent();\n\n    var projection = this._getProjection();\n\n    if (prjExt && projection) {\n      var min = projection.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n          max = projection.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n      return new Extent(min, max, projection);\n    } else {\n      return this._computeExtent(this._getMeasurer());\n    }\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var painter = this._getPainter();\n\n    return painter ? painter.getContainerExtent(out) : null;\n  };\n\n  _proto.getSize = function getSize() {\n    var extent = this.getContainerExtent();\n    return extent ? extent.getSize() : null;\n  };\n\n  _proto.containsPoint = function containsPoint(containerPoint, t) {\n    if (!this.getMap()) {\n      throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n    }\n\n    if (containerPoint instanceof Coordinate) {\n      containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n    }\n\n    return this._containsPoint(containerPoint, t);\n  };\n\n  _proto._containsPoint = function _containsPoint(containerPoint, t) {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return false;\n    }\n\n    if (isNil(t) && this._hitTestTolerance) {\n      t = this._hitTestTolerance();\n    }\n\n    return painter.hitTest(containerPoint, t);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n\n    if (this.getMap()) {\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.show();\n      }\n\n      this._fireEvent('show');\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n\n    if (this.getMap()) {\n      this.onHide();\n\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.hide();\n      }\n\n      this._fireEvent('hide');\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      return true;\n    }\n\n    if (Array.isArray(symbol)) {\n      if (!symbol.length) {\n        return true;\n      }\n\n      for (var i = 0, l = symbol.length; i < l; i++) {\n        if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      return isNil(symbol['opacity']) || isNumber(symbol['opacity']) && symbol['opacity'] > 0;\n    }\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this.options['zIndex'] || 0;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    var old = this.options['zIndex'];\n    this.options['zIndex'] = zIndex;\n\n    this._fireEvent('zindexchange', {\n      'old': old,\n      'new': zIndex\n    });\n\n    return this;\n  };\n\n  _proto.setZIndexSilently = function setZIndexSilently(zIndex) {\n    this.options['zIndex'] = zIndex;\n    return this;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMaxZIndex) {\n      return this;\n    }\n\n    var topZ = layer.getGeoMaxZIndex();\n    this.setZIndex(topZ + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMinZIndex) {\n      return this;\n    }\n\n    var bottomZ = layer.getGeoMinZIndex();\n    this.setZIndex(bottomZ - 1);\n    return this;\n  };\n\n  _proto.translate = function translate(x, y) {\n    if (isNil(x)) {\n      return this;\n    }\n\n    var offset = new Coordinate(x, y);\n\n    if (offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates) {\n      if (Array.isArray(coordinates)) {\n        var translated = forEachCoord(coordinates, function (coord) {\n          return coord.add(offset);\n        });\n        this.setCoordinates(translated);\n      } else {\n        this.setCoordinates(coordinates.add(offset));\n      }\n    }\n\n    return this;\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.copy = function copy() {\n    var json = this.toJSON();\n    var ret = Geometry.fromJSON(json);\n    ret.options['visible'] = true;\n    return ret;\n  };\n\n  _proto.remove = function remove() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._unbind();\n\n    this._fireEvent('removeend');\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto.toGeoJSONGeometry = function toGeoJSONGeometry() {\n    var gJson = this._exportGeoJSONGeometry();\n\n    return gJson;\n  };\n\n  _proto.toGeoJSON = function toGeoJSON(opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var feature = {\n      'type': 'Feature',\n      'geometry': null\n    };\n\n    if (isNil(opts['geometry']) || opts['geometry']) {\n      var geoJSON = this._exportGeoJSONGeometry();\n\n      feature['geometry'] = geoJSON;\n    }\n\n    var id = this.getId();\n\n    if (!isNil(id)) {\n      feature['id'] = id;\n    }\n\n    var properties;\n\n    if (isNil(opts['properties']) || opts['properties']) {\n      properties = this._exportProperties();\n    }\n\n    feature['properties'] = properties;\n    return feature;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = this._toJSON(options);\n\n    var other = this._exportGraphicOptions(options);\n\n    extend(json, other);\n    return json;\n  };\n\n  _proto.getLength = function getLength() {\n    return this._computeGeodesicLength(this._getMeasurer());\n  };\n\n  _proto.getArea = function getArea() {\n    return this._computeGeodesicArea(this._getMeasurer());\n  };\n\n  _proto.rotate = function rotate(angle, pivot) {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n      geometries.forEach(function (g) {\n        return g.rotate(angle, pivot);\n      });\n      return this;\n    }\n\n    if (!pivot) {\n      pivot = this.getCenter();\n    } else {\n      pivot = new Coordinate(pivot);\n    }\n\n    var measurer = this._getMeasurer();\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n        var c = measurer._rotate(coordinates, pivot, angle);\n\n        this.setCoordinates(c);\n      }\n\n      return this;\n    }\n\n    forEachCoord(coordinates, function (c) {\n      return measurer._rotate(c, pivot, angle);\n    });\n    this.setCoordinates(coordinates);\n    return this;\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    return [this.getCenter()];\n  };\n\n  _proto._initOptions = function _initOptions(options) {\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    this.setOptions(opts);\n\n    if (symbol) {\n      this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      this.setId(id);\n    }\n  };\n\n  _proto._bindLayer = function _bindLayer(layer) {\n    if (this.getLayer()) {\n      throw new Error('Geometry cannot be added to two or more layers at the same time.');\n    }\n\n    this._layer = layer;\n\n    this._clearCache();\n  };\n\n  _proto._prepareSymbol = function _prepareSymbol(symbol) {\n    if (Array.isArray(symbol)) {\n      var cookedSymbols = [];\n\n      for (var i = 0; i < symbol.length; i++) {\n        cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n      }\n\n      return cookedSymbols;\n    } else if (symbol) {\n      symbol = this._checkAndCopySymbol(symbol);\n      return convertResourceUrl(symbol);\n    }\n\n    return null;\n  };\n\n  _proto._checkAndCopySymbol = function _checkAndCopySymbol(symbol) {\n    var s = {};\n\n    for (var i in symbol) {\n      if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n        s[i] = +symbol[i];\n      } else {\n        s[i] = symbol[i];\n      }\n    }\n\n    return s;\n  };\n\n  _proto._getSymbol = function _getSymbol() {\n    return this._symbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    this._eventSymbolProperties = symbol;\n    this._externSymbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    if (this._symbol) {\n      return this._symbol;\n    } else if (this._externSymbol) {\n      return this._externSymbol;\n    } else if (this.options['symbol']) {\n      return this.options['symbol'];\n    }\n\n    return null;\n  };\n\n  _proto._getPrjExtent = function _getPrjExtent() {\n    var p = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._extent && p) {\n      this._extent = this._computePrjExtent(p);\n    }\n\n    return this._extent;\n  };\n\n  _proto._unbind = function _unbind() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    this._clearHandlers();\n\n    this._unbindMenu();\n\n    this._unbindInfoWindow();\n\n    if (this.isEditing()) {\n      this.endEdit();\n    }\n\n    this._removePainter();\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (layer.onRemoveGeometry) {\n      layer.onRemoveGeometry(this);\n    }\n\n    delete this._layer;\n    delete this._internalId;\n    delete this._extent;\n  };\n\n  _proto._getInternalId = function _getInternalId() {\n    return this._internalId;\n  };\n\n  _proto._setInternalId = function _setInternalId(id) {\n    this._internalId = id;\n  };\n\n  _proto._getMeasurer = function _getMeasurer() {\n    if (this._getProjection()) {\n      return this._getProjection();\n    }\n\n    return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n  };\n\n  _proto._getProjection = function _getProjection() {\n    var map = this.getMap();\n\n    if (map) {\n      return map.getProjection();\n    }\n\n    return null;\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this._getProjection();\n\n    if (this._projCode && projection && this._projCode !== projection.code) {\n      this._clearProjection();\n    }\n\n    this._projCode = projection ? projection.code : this._projCode;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    var symbol = this._getInternalSymbol();\n\n    return getExternalResources(symbol);\n  };\n\n  _proto._getPainter = function _getPainter() {\n    var layer = this.getLayer();\n\n    if (!this._painter && layer) {\n      if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n        if (layer.constructor.getCollectionPainterClass) {\n          var clazz = layer.constructor.getCollectionPainterClass();\n          this._painter = new clazz(this);\n        }\n      } else if (layer.constructor.getPainterClass) {\n        var _clazz = layer.constructor.getPainterClass();\n\n        this._painter = new _clazz(this);\n      }\n    }\n\n    return this._painter;\n  };\n\n  _proto._getMaskPainter = function _getMaskPainter() {\n    if (this._maskPainter) {\n      return this._maskPainter;\n    }\n\n    this._maskPainter = this.getGeometries && this.getGeometries() ? new CollectionPainter(this, true) : new Painter(this);\n    return this._maskPainter;\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n  };\n\n  _proto._paint = function _paint(extent) {\n    if (this._painter) {\n      this._painter.paint(extent);\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._extent;\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    delete this._extent;\n  };\n\n  _proto._repaint = function _repaint() {\n    if (this._painter) {\n      this._painter.repaint();\n    }\n  };\n\n  _proto.onHide = function onHide() {\n    this.closeMenu();\n    this.closeInfoWindow();\n  };\n\n  _proto.onShapeChanged = function onShapeChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('shapechange');\n  };\n\n  _proto.onPositionChanged = function onPositionChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('positionchange');\n  };\n\n  _proto.onSymbolChanged = function onSymbolChanged() {\n    if (this._painter) {\n      this._painter.refreshSymbol();\n    }\n\n    var e = {};\n\n    if (this._eventSymbolProperties) {\n      e.properties = extend({}, this._eventSymbolProperties);\n      delete this._eventSymbolProperties;\n    }\n\n    this._fireEvent('symbolchange', e);\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var properties;\n\n    if (conf['properties']) {\n      properties = conf['properties'];\n      delete conf['properties'];\n    }\n\n    var needRepaint = false;\n\n    for (var p in conf) {\n      if (conf.hasOwnProperty(p)) {\n        var prefix = p.slice(0, 5);\n\n        if (prefix === 'arrow' || prefix === 'smoot') {\n          needRepaint = true;\n          break;\n        }\n      }\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n\n      this._repaint();\n    } else if (needRepaint) {\n      this._repaint();\n    }\n  };\n\n  _proto._setParent = function _setParent(geometry) {\n    if (geometry) {\n      this._parent = geometry;\n    }\n  };\n\n  _proto._getParent = function _getParent() {\n    return this._parent;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventName;\n      param['target'] = this;\n\n      this.getLayer()._onGeometryEvent(param);\n    }\n\n    this.fire(eventName, param);\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options)\n    };\n  };\n\n  _proto._exportGraphicOptions = function _exportGraphicOptions(options) {\n    var json = {};\n\n    if (isNil(options['options']) || options['options']) {\n      json['options'] = this.config();\n    }\n\n    if (isNil(options['symbol']) || options['symbol']) {\n      json['symbol'] = this.getSymbol();\n    }\n\n    if (isNil(options['infoWindow']) || options['infoWindow']) {\n      if (this._infoWinOptions) {\n        json['infoWindow'] = this._infoWinOptions;\n      }\n    }\n\n    return json;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._exportProperties = function _exportProperties() {\n    var properties = null;\n    var geoProperties = this.getProperties();\n\n    if (!isNil(geoProperties)) {\n      if (isObject(geoProperties)) {\n        properties = extend({}, geoProperties);\n      } else {\n        properties = geoProperties;\n      }\n    }\n\n    return properties;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return 0;\n    }\n\n    var layerOpts = layer.options,\n        properties = this.getProperties();\n    var altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n    var layerAltitude = layer.getAltitude ? layer.getAltitude() : 0;\n\n    if (Array.isArray(altitude)) {\n      return altitude.map(function (alt) {\n        return alt + layerAltitude;\n      });\n    }\n\n    return altitude + layerAltitude;\n  };\n\n  return Geometry;\n}(JSONAble(Eventable(Handlerable(Class))));\n\nGeometry.mergeOptions(options);\n\nvar options$1 = {\n  'attribution': null,\n  'minZoom': null,\n  'maxZoom': null,\n  'visible': true,\n  'opacity': 1,\n  'globalCompositeOperation': null,\n  'renderer': 'canvas',\n  'debugOutline': '#0f0',\n  'cssFilter': null,\n  'forceRenderOnMoving': false,\n  'forceRenderOnZooming': false,\n  'forceRenderOnRotating': false,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }()\n};\n\nvar Layer = function (_JSONAble) {\n  _inheritsLoose(Layer, _JSONAble);\n\n  function Layer(id, options) {\n    var _this;\n\n    var canvas;\n\n    if (options) {\n      canvas = options.canvas;\n      delete options.canvas;\n    }\n\n    _this = _JSONAble.call(this, options) || this;\n    _this._canvas = canvas;\n\n    _this.setId(id);\n\n    if (options) {\n      _this.setZIndex(options.zIndex);\n\n      if (options.mask) {\n        _this.setMask(Geometry.fromJSON(options.mask));\n      }\n    }\n\n    return _this;\n  }\n\n  var _proto = Layer.prototype;\n\n  _proto.load = function load() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (this.onLoad()) {\n      this._initRenderer();\n\n      var zIndex = this.getZIndex();\n\n      if (!isNil(zIndex)) {\n        this._renderer.setZIndex(zIndex);\n\n        if (!this.isCanvasRender()) {\n          this._renderer.render();\n        }\n      }\n\n      this.onLoadEnd();\n    }\n\n    return this;\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var old = this._id;\n\n    if (!isNil(id)) {\n      id = id + '';\n    }\n\n    this._id = id;\n    this.fire('idchange', {\n      'old': old,\n      'new': id\n    });\n    return this;\n  };\n\n  _proto.addTo = function addTo(map) {\n    map.addLayer(this);\n    return this;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    this._zIndex = zIndex;\n\n    if (isNil(zIndex)) {\n      delete this.options['zIndex'];\n    } else {\n      this.options.zIndex = zIndex;\n    }\n\n    if (this.map) {\n      this.map._sortLayersByZIndex();\n    }\n\n    if (this._renderer) {\n      this._renderer.setZIndex(zIndex);\n    }\n\n    return this;\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this._zIndex || 0;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    var map = this.getMap();\n    var minZoom = this.options['minZoom'];\n    return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    var map = this.getMap();\n    var maxZoom = this.options['maxZoom'];\n    return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n  };\n\n  _proto.getOpacity = function getOpacity() {\n    return this.options['opacity'];\n  };\n\n  _proto.setOpacity = function setOpacity(op) {\n    this.config('opacity', op);\n    return this;\n  };\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    var renderer = this._getRenderer();\n\n    return renderer && renderer instanceof CanvasRenderer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (this.map) {\n      return this.map;\n    }\n\n    return null;\n  };\n\n  _proto.getProjection = function getProjection() {\n    var map = this.getMap();\n    return map ? map.getProjection() : null;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var topLayer = layers[layers.length - 1];\n\n    if (layers.length === 1 || topLayer === this) {\n      return this;\n    }\n\n    var max = topLayer.getZIndex();\n    this.setZIndex(max + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var bottomLayer = layers[0];\n\n    if (layers.length === 1 || bottomLayer === this) {\n      return this;\n    }\n\n    var min = bottomLayer.getZIndex();\n    this.setZIndex(min - 1);\n    return this;\n  };\n\n  _proto.show = function show() {\n    var _this2 = this;\n\n    if (!this.options['visible']) {\n      this.options['visible'] = true;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.show();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this2.fire('show');\n        });\n      } else {\n        this.fire('show');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this3 = this;\n\n    if (this.options['visible']) {\n      this.options['visible'] = false;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.hide();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this3.fire('hide');\n        });\n      } else {\n        this.fire('hide');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n      return false;\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      var zoom = map.getZoom();\n\n      if (!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom || !isNil(this.options['minZoom']) && this.options['minZoom'] > zoom) {\n        return false;\n      }\n    }\n\n    if (isNil(this.options['visible'])) {\n      this.options['visible'] = true;\n    }\n\n    return this.options['visible'];\n  };\n\n  _proto.remove = function remove() {\n    if (this.map) {\n      this.map.removeLayer(this);\n    }\n\n    return this;\n  };\n\n  _proto.getMask = function getMask() {\n    return this._mask;\n  };\n\n  _proto.setMask = function setMask(mask) {\n    if (!(mask.type === 'Point' && mask._isVectorMarker() || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n      throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n    }\n\n    mask._bindLayer(this);\n\n    if (mask.type === 'Point') {\n      mask.updateSymbol({\n        'markerLineColor': 'rgba(0, 0, 0, 0)',\n        'markerFillOpacity': 0\n      });\n    } else {\n      mask.setSymbol({\n        'lineColor': 'rgba(0, 0, 0, 0)',\n        'polygonOpacity': 0\n      });\n    }\n\n    this._mask = mask;\n    this.options.mask = mask.toJSON();\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.removeMask = function removeMask() {\n    delete this._mask;\n    delete this.options.mask;\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.onLoad = function onLoad() {\n    return true;\n  };\n\n  _proto.onLoadEnd = function onLoadEnd() {};\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    if (isNumber(conf['opacity']) || conf['cssFilter']) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.onRendererCreate = function onRendererCreate() {};\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto._bindMap = function _bindMap(map, zIndex) {\n    if (!map) {\n      return;\n    }\n\n    this.map = map;\n\n    if (!isNil(zIndex)) {\n      this.setZIndex(zIndex);\n    }\n\n    this._switchEvents('on', this);\n\n    this.onAdd();\n    this.fire('add');\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n\n    if (!this.constructor.getRendererClass) {\n      return;\n    }\n\n    var clazz = this.constructor.getRendererClass(renderer);\n\n    if (!clazz) {\n      throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n    }\n\n    this._renderer = new clazz(this);\n    this._renderer.layer = this;\n\n    this._renderer.setZIndex(this.getZIndex());\n\n    this._switchEvents('on', this._renderer);\n\n    if (this._renderer.onAdd) {\n      this._renderer.onAdd();\n    }\n\n    this.onRendererCreate();\n    this.fire('renderercreate', {\n      'renderer': this._renderer\n    });\n  };\n\n  _proto._doRemove = function _doRemove() {\n    this._loaded = false;\n    this.onRemove();\n\n    this._switchEvents('off', this);\n\n    if (this._renderer) {\n      this._switchEvents('off', this._renderer);\n\n      this._renderer.remove();\n\n      delete this._renderer;\n    }\n\n    delete this.map;\n  };\n\n  _proto._switchEvents = function _switchEvents(to, emitter) {\n    if (emitter && emitter.getEvents) {\n      this.getMap()[to](emitter.getEvents(), emitter);\n    }\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._getLayerList = function _getLayerList() {\n    if (!this.map) {\n      return [];\n    }\n\n    return this.map._layers;\n  };\n\n  _proto._getMask2DExtent = function _getMask2DExtent() {\n    if (!this._mask || !this.getMap()) {\n      return null;\n    }\n\n    var painter = this._mask._getMaskPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    return painter.get2DExtent();\n  };\n\n  return Layer;\n}(JSONAble(Eventable(Renderable(Class))));\n\nLayer.mergeOptions(options$1);\nvar fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n  if (eventType === 'layerload') {\n    this._loaded = true;\n  }\n\n  if (this.map) {\n    if (!param) {\n      param = {};\n    }\n\n    param['type'] = eventType;\n    param['target'] = this;\n\n    this.map._onLayerEvent(param);\n  }\n\n  return fire.apply(this, arguments);\n};\n\nvar options$2 = {\n  'maxVisualPitch': 70,\n  'maxPitch': 80,\n  'centerCross': false,\n  'zoomInCenter': false,\n  'zoomOrigin': null,\n  'zoomAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomAnimationDuration': 330,\n  'panAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'panAnimationDuration': 600,\n  'zoomable': true,\n  'enableInfoWindow': true,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }(),\n  'hitDetectLimit': 5,\n  'fpsOnInteracting': 25,\n  'layerCanvasLimitOnInteracting': -1,\n  'maxZoom': null,\n  'minZoom': null,\n  'maxExtent': null,\n  'fixCenterOnResize': true,\n  'checkSize': true,\n  'checkSizeInterval': 1000,\n  'renderer': 'canvas',\n  'cascadePitches': [10, 60]\n};\n\nvar Map$1 = function (_Handlerable) {\n  _inheritsLoose(Map, _Handlerable);\n\n  function Map(container, options) {\n    var _this;\n\n    if (!options) {\n      throw new Error('Invalid options when creating map.');\n    }\n\n    if (!options['center']) {\n      throw new Error('Invalid center when creating map.');\n    }\n\n    var opts = extend({}, options);\n    var zoom = opts['zoom'];\n    delete opts['zoom'];\n    var center = new Coordinate(opts['center']);\n    delete opts['center'];\n    var baseLayer = opts['baseLayer'];\n    delete opts['baseLayer'];\n    var layers = opts['layers'];\n    delete opts['layers'];\n    _this = _Handlerable.call(this, opts) || this;\n    _this.VERSION = Map.VERSION;\n    Object.defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), 'id', {\n      value: UID(),\n      writable: false\n    });\n    _this._loaded = false;\n\n    _this._initContainer(container);\n\n    _this._panels = {};\n    _this._baseLayer = null;\n    _this._layers = [];\n    _this._zoomLevel = zoom;\n    _this._center = center;\n\n    _this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n    _this.setMaxExtent(opts['maxExtent']);\n\n    _this._mapViewPoint = new Point(0, 0);\n\n    _this._initRenderer();\n\n    _this._updateMapSize(_this._getContainerDomSize());\n\n    if (baseLayer) {\n      _this.setBaseLayer(baseLayer);\n    }\n\n    if (layers) {\n      _this.addLayer(layers);\n    }\n\n    _this._Load();\n\n    return _this;\n  }\n\n  Map.addOnLoadHook = function addOnLoadHook(fn) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var onload = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n\n    this.prototype._onLoadHooks.push(onload);\n\n    return this;\n  };\n\n  var _proto = Map.prototype;\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this._containerDOM;\n  };\n\n  _proto.getSpatialReference = function getSpatialReference() {\n    return this._spatialReference;\n  };\n\n  _proto.setSpatialReference = function setSpatialReference(ref) {\n    var oldRef = this.options['spatialReference'];\n\n    if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n      return this;\n    }\n\n    this._updateSpatialReference(ref, oldRef);\n\n    return this;\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference(ref, oldRef) {\n    ref = extend({}, ref);\n    this._center = this.getCenter();\n    this.options['spatialReference'] = ref;\n    this._spatialReference = new SpatialReference(ref);\n\n    if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n      var projection = this._spatialReference.getProjection();\n\n      this.options['spatialReference']['projection'] = projection['code'];\n    }\n\n    this._resetMapStatus();\n\n    this._fireEvent('spatialreferencechange', {\n      'old': oldRef,\n      'new': extend({}, this.options['spatialReference'])\n    });\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var ref = conf['spatialReference'] || conf['view'];\n\n    if (!isNil(ref)) {\n      this._updateSpatialReference(ref, null);\n    }\n\n    return this;\n  };\n\n  _proto.getProjection = function getProjection() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getProjection();\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getFullExtent();\n  };\n\n  _proto.setCursor = function setCursor(cursor) {\n    delete this._cursor;\n\n    this._trySetCursor(cursor);\n\n    this._cursor = cursor;\n    return this;\n  };\n\n  _proto.resetCursor = function resetCursor() {\n    return this.setCursor(null);\n  };\n\n  _proto.getCenter = function getCenter() {\n    if (!this._loaded || !this._prjCenter) {\n      return this._center;\n    }\n\n    var projection = this.getProjection();\n    return projection.unproject(this._prjCenter);\n  };\n\n  _proto.setCenter = function setCenter(center) {\n    if (!center) {\n      return this;\n    }\n\n    center = new Coordinate(center);\n    var projection = this.getProjection();\n    var pcenter = projection.project(center);\n\n    if (!this._verifyExtent(pcenter)) {\n      return this;\n    }\n\n    if (!this._loaded) {\n      this._center = center;\n      return this;\n    }\n\n    this.onMoveStart();\n\n    this._setPrjCenter(pcenter);\n\n    this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return this._getContainerDomSize();\n    }\n\n    return new Size(this.width, this.height);\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var visualHeight = this.height;\n    var pitch = this.getPitch(),\n        maxVisualPitch = this.options['maxVisualPitch'];\n\n    if (maxVisualPitch && pitch > maxVisualPitch) {\n      visualHeight = this._getVisualHeight(maxVisualPitch);\n    }\n\n    return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n  };\n\n  _proto._getVisualHeight = function _getVisualHeight(visualPitch) {\n    visualPitch = visualPitch || 1E-2;\n    var pitch = (90 - this.getPitch()) * Math.PI / 180;\n    var fov = this.getFov() * Math.PI / 180;\n    visualPitch *= Math.PI / 180;\n    var cameraToCenter = this.cameraCenterDistance / this.getGLScale();\n    var tanB = Math.tan(fov / 2);\n    var tanP = Math.tan(visualPitch);\n    var visualDistance = cameraToCenter * tanB / (1 / tanP - tanB) / Math.sin(visualPitch);\n    var x = cameraToCenter * (Math.sin(pitch) * visualDistance / (cameraToCenter + Math.cos(pitch) * visualDistance));\n    return this.height / 2 + x;\n  };\n\n  _proto.getExtent = function getExtent() {\n    return this._pointToExtent(this._get2DExtent());\n  };\n\n  _proto.getProjExtent = function getProjExtent() {\n    var extent2D = this._get2DExtent();\n\n    return new Extent(this._pointToPrj(extent2D.getMin()), this._pointToPrj(extent2D.getMax()));\n  };\n\n  _proto.getPrjExtent = function getPrjExtent() {\n    return this.getProjExtent();\n  };\n\n  _proto.getMaxExtent = function getMaxExtent() {\n    if (!this.options['maxExtent']) {\n      return null;\n    }\n\n    return new Extent(this.options['maxExtent'], this.getProjection());\n  };\n\n  _proto.setMaxExtent = function setMaxExtent(extent) {\n    if (extent) {\n      var maxExt = new Extent(extent, this.getProjection());\n      this.options['maxExtent'] = maxExt;\n\n      if (!this._verifyExtent(this._getPrjCenter())) {\n        this._panTo(this._prjMaxExtent().getCenter());\n      }\n\n      var projection = this.getProjection();\n      this._prjMaxExtent = maxExt.convertTo(function (c) {\n        return projection.project(c);\n      });\n    } else {\n      delete this.options['maxExtent'];\n      delete this._prjMaxExtent;\n    }\n\n    return this;\n  };\n\n  _proto.getZoom = function getZoom() {\n    return this._zoomLevel;\n  };\n\n  _proto.getZoomForScale = function getZoomForScale(scale, fromZoom, isFraction) {\n    var zoom = this.getZoom();\n\n    if (isNil(fromZoom)) {\n      fromZoom = zoom;\n    }\n\n    if (scale === 1 && fromZoom === zoom) {\n      return zoom;\n    }\n\n    var res = this._getResolution(fromZoom),\n        targetRes = res / scale;\n\n    var scaleZoom = this.getZoomFromRes(targetRes);\n\n    if (isFraction) {\n      return scaleZoom;\n    } else {\n      var delta = 1E-6;\n      return this.getSpatialReference().getZoomDirection() < 0 ? Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n    }\n  };\n\n  _proto.getZoomFromRes = function getZoomFromRes(res) {\n    var resolutions = this._getResolutions(),\n        minRes = this._getResolution(this.getMinZoom()),\n        maxRes = this._getResolution(this.getMaxZoom());\n\n    if (minRes <= maxRes) {\n      if (res <= minRes) {\n        return this.getMinZoom();\n      } else if (res >= maxRes) {\n        return this.getMaxZoom();\n      }\n    } else if (res >= minRes) {\n      return this.getMinZoom();\n    } else if (res <= maxRes) {\n      return this.getMaxZoom();\n    }\n\n    var l = resolutions.length;\n\n    for (var i = 0; i < l - 1; i++) {\n      if (!resolutions[i]) {\n        continue;\n      }\n\n      var gap = resolutions[i + 1] - resolutions[i];\n      var test = res - resolutions[i];\n\n      if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n        return i + test / gap;\n      }\n    }\n\n    return l - 1;\n  };\n\n  _proto.setZoom = function setZoom(zoom, options) {\n    if (options === void 0) {\n      options = {\n        'animation': true\n      };\n    }\n\n    if (isNaN(zoom) || isNil(zoom)) {\n      return this;\n    }\n\n    zoom = +zoom;\n\n    if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n      this._zoomAnimation(zoom);\n    } else {\n      this._zoom(zoom);\n    }\n\n    return this;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    if (!isNil(this.options['maxZoom'])) {\n      return this.options['maxZoom'];\n    }\n\n    return this.getMaxNativeZoom();\n  };\n\n  _proto.setMaxZoom = function setMaxZoom(maxZoom) {\n    var viewMaxZoom = this.getMaxNativeZoom();\n\n    if (maxZoom > viewMaxZoom) {\n      maxZoom = viewMaxZoom;\n    }\n\n    if (maxZoom !== null && maxZoom < this._zoomLevel) {\n      this.setZoom(maxZoom);\n      maxZoom = +maxZoom;\n    }\n\n    this.options['maxZoom'] = maxZoom;\n    return this;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    if (!isNil(this.options['minZoom'])) {\n      return this.options['minZoom'];\n    }\n\n    return this._spatialReference.getMinZoom();\n  };\n\n  _proto.setMinZoom = function setMinZoom(minZoom) {\n    if (minZoom !== null) {\n      minZoom = +minZoom;\n\n      var viewMinZoom = this._spatialReference.getMinZoom();\n\n      if (minZoom < viewMinZoom) {\n        minZoom = viewMinZoom;\n      }\n\n      if (minZoom > this._zoomLevel) {\n        this.setZoom(minZoom);\n      }\n    }\n\n    this.options['minZoom'] = minZoom;\n    return this;\n  };\n\n  _proto.getMaxNativeZoom = function getMaxNativeZoom() {\n    var ref = this.getSpatialReference();\n\n    if (!ref) {\n      return null;\n    }\n\n    return ref.getMaxZoom();\n  };\n\n  _proto.getGLZoom = function getGLZoom() {\n    return this.getMaxNativeZoom() / 2;\n  };\n\n  _proto.getGLScale = function getGLScale(zoom) {\n    if (isNil(zoom)) {\n      zoom = this.getZoom();\n    }\n\n    return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n  };\n\n  _proto.zoomIn = function zoomIn() {\n    return this.setZoom(this.getZoom() + 1);\n  };\n\n  _proto.zoomOut = function zoomOut() {\n    return this.setZoom(this.getZoom() - 1);\n  };\n\n  _proto.isZooming = function isZooming() {\n    return !!this._zooming;\n  };\n\n  _proto.isInteracting = function isInteracting() {\n    return this.isZooming() || this.isMoving() || this.isRotating();\n  };\n\n  _proto.setCenterAndZoom = function setCenterAndZoom(center, zoom) {\n    if (!isNil(zoom) && this._zoomLevel !== zoom) {\n      this.setCenter(center);\n      this.setZoom(zoom, {\n        animation: false\n      });\n    } else {\n      this.setCenter(center);\n    }\n\n    return this;\n  };\n\n  _proto.getFitZoom = function getFitZoom(extent, isFraction) {\n    var _this2 = this;\n\n    if (!extent || !(extent instanceof Extent)) {\n      return this._zoomLevel;\n    }\n\n    if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n      return this.getMaxZoom();\n    }\n\n    var size = this.getSize();\n    var containerExtent = extent.convertTo(function (p) {\n      return _this2.coordToContainerPoint(p);\n    });\n    var w = containerExtent.getWidth(),\n        h = containerExtent.getHeight();\n    var scaleX = size['width'] / w,\n        scaleY = size['height'] / h;\n    var scale = this.getSpatialReference().getZoomDirection() < 0 ? Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n    var zoom = this.getZoomForScale(scale, null, isFraction);\n    return zoom;\n  };\n\n  _proto.getView = function getView() {\n    return {\n      'center': this.getCenter().toArray(),\n      'zoom': this.getZoom(),\n      'pitch': this.getPitch(),\n      'bearing': this.getBearing()\n    };\n  };\n\n  _proto.setView = function setView(view) {\n    if (!view) {\n      return this;\n    }\n\n    if (view['center']) {\n      this.setCenter(view['center']);\n    }\n\n    if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n      this.setZoom(+view['zoom'], {\n        'animation': false\n      });\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n      this.setPitch(+view['pitch']);\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n      this.setBearing(+view['bearing']);\n    }\n\n    return this;\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    return this._getResolution(zoom);\n  };\n\n  _proto.getScale = function getScale(zoom) {\n    var z = isNil(zoom) ? this.getZoom() : zoom;\n\n    var max = this._getResolution(this.getMaxNativeZoom()),\n        res = this._getResolution(z);\n\n    return res / max;\n  };\n\n  _proto.fitExtent = function fitExtent(extent, zoomOffset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!extent) {\n      return this;\n    }\n\n    extent = new Extent(extent, this.getProjection());\n    var zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n    var center = extent.getCenter();\n    if (typeof options['animation'] === 'undefined' || options['animation']) return this._animateTo({\n      center: center,\n      zoom: zoom\n    }, {\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'easing': options['easing'] || 'out'\n    }, step);else return this.setCenterAndZoom(center, zoom);\n  };\n\n  _proto.getBaseLayer = function getBaseLayer() {\n    return this._baseLayer;\n  };\n\n  _proto.setBaseLayer = function setBaseLayer(baseLayer) {\n    var isChange = false;\n\n    if (this._baseLayer) {\n      isChange = true;\n\n      this._fireEvent('baselayerchangestart');\n\n      this._baseLayer.remove();\n    }\n\n    if (!baseLayer) {\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerchangeend');\n\n      this._fireEvent('setbaselayer');\n\n      return this;\n    }\n\n    this._baseLayer = baseLayer;\n\n    baseLayer._bindMap(this, -1);\n\n    function onbaseLayerload() {\n      this._fireEvent('baselayerload');\n\n      if (isChange) {\n        isChange = false;\n\n        this._fireEvent('baselayerchangeend');\n      }\n    }\n\n    this._baseLayer.on('layerload', onbaseLayerload, this);\n\n    if (this._loaded) {\n      this._baseLayer.load();\n    }\n\n    this._fireEvent('setbaselayer');\n\n    return this;\n  };\n\n  _proto.removeBaseLayer = function removeBaseLayer() {\n    if (this._baseLayer) {\n      this._baseLayer.remove();\n\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerremove');\n    }\n\n    return this;\n  };\n\n  _proto.getLayers = function getLayers(filter) {\n    return this._getLayers(function (layer) {\n      if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        return false;\n      }\n\n      if (filter) {\n        return filter(layer);\n      }\n\n      return true;\n    });\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    if (!id) {\n      return null;\n    }\n\n    var layer = this._layerCache ? this._layerCache[id] : null;\n\n    if (layer) {\n      return layer;\n    }\n\n    var baseLayer = this.getBaseLayer();\n\n    if (baseLayer && baseLayer.getId() === id) {\n      return baseLayer;\n    }\n\n    return null;\n  };\n\n  _proto.addLayer = function addLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      layers = Array.prototype.slice.call(arguments, 0);\n      return this.addLayer(layers);\n    }\n\n    if (!this._layerCache) {\n      this._layerCache = {};\n    }\n\n    var mapLayers = this._layers;\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n      var id = layer.getId();\n\n      if (isNil(id)) {\n        throw new Error('Invalid id for the layer: ' + id);\n      }\n\n      if (layer.getMap() === this) {\n        continue;\n      }\n\n      if (this._layerCache[id]) {\n        throw new Error('Duplicate layer id in the map: ' + id);\n      }\n\n      this._layerCache[id] = layer;\n\n      layer._bindMap(this);\n\n      mapLayers.push(layer);\n\n      if (this._loaded) {\n        layer.load();\n      }\n    }\n\n    this._sortLayersByZIndex();\n\n    this._fireEvent('addlayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.removeLayer = function removeLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      return this.removeLayer([layers]);\n    }\n\n    var removed = [];\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n\n      if (!(layer instanceof Layer)) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!layer) {\n        continue;\n      }\n\n      var map = layer.getMap();\n\n      if (!map || map !== this) {\n        continue;\n      }\n\n      removed.push(layer);\n\n      this._removeLayer(layer, this._layers);\n\n      if (this._loaded) {\n        layer._doRemove();\n      }\n\n      var id = layer.getId();\n\n      if (this._layerCache) {\n        delete this._layerCache[id];\n      }\n    }\n\n    if (removed.length > 0) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setLayerCanvasUpdated();\n      }\n\n      this.once('frameend', function () {\n        removed.forEach(function (layer) {\n          layer.fire('remove');\n        });\n      });\n    }\n\n    this._fireEvent('removelayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.sortLayers = function sortLayers(layers) {\n    if (!layers || !Array.isArray(layers)) {\n      return this;\n    }\n\n    var layersToOrder = [];\n    var minZ = Number.MAX_VALUE;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (isString(layers[i])) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n        throw new Error('It must be a layer added to this map to order.');\n      }\n\n      if (layer.getZIndex() < minZ) {\n        minZ = layer.getZIndex();\n      }\n\n      layersToOrder.push(layer);\n    }\n\n    for (var _i = 0, _l = layersToOrder.length; _i < _l; _i++) {\n      layersToOrder[_i].setZIndex(minZ + _i);\n    }\n\n    return this;\n  };\n\n  _proto.toDataURL = function toDataURL(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var mimeType = options['mimeType'];\n\n    if (!mimeType) {\n      mimeType = 'image/png';\n    }\n\n    var save = options['save'];\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.toDataURL) {\n      var file = options['fileName'];\n\n      if (!file) {\n        file = 'export';\n      }\n\n      var dataURL = renderer.toDataURL(mimeType);\n\n      if (save && dataURL) {\n        var imgURL;\n\n        if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n          var blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n          imgURL = URL.createObjectURL(blob);\n        } else {\n          imgURL = dataURL;\n        }\n\n        var dlLink = document.createElement('a');\n        dlLink.download = file;\n        dlLink.href = imgURL;\n        document.body.appendChild(dlLink);\n        dlLink.click();\n        document.body.removeChild(dlLink);\n      }\n\n      return dataURL;\n    }\n\n    return null;\n  };\n\n  _proto.coordToPoint = function coordToPoint(coordinate, zoom, out) {\n    return this.coordinateToPoint(coordinate, zoom, out);\n  };\n\n  _proto.pointToCoord = function pointToCoord(point, zoom, out) {\n    return this.pointToCoordinate(point, zoom, out);\n  };\n\n  _proto.coordToViewPoint = function coordToViewPoint(coordinate, out, altitude) {\n    return this.coordinateToViewPoint(coordinate, out, altitude);\n  };\n\n  _proto.viewPointToCoord = function viewPointToCoord(viewPoint, out) {\n    return this.viewPointToCoordinate(viewPoint, out);\n  };\n\n  _proto.coordToContainerPoint = function coordToContainerPoint(coordinate, zoom, out) {\n    return this.coordinateToContainerPoint(coordinate, zoom, out);\n  };\n\n  _proto.containerPointToCoord = function containerPointToCoord(containerPoint, out) {\n    return this.containerPointToCoordinate(containerPoint, out);\n  };\n\n  _proto.containerPointToViewPoint = function containerPointToViewPoint(containerPoint, out) {\n    if (out) {\n      out.set(containerPoint.x, containerPoint.y);\n    } else {\n      out = containerPoint.copy();\n    }\n\n    return out._sub(this.getViewPoint());\n  };\n\n  _proto.viewPointToContainerPoint = function viewPointToContainerPoint(viewPoint, out) {\n    if (out) {\n      out.set(viewPoint.x, viewPoint.y);\n    } else {\n      out = viewPoint.copy();\n    }\n\n    return out._add(this.getViewPoint());\n  };\n\n  _proto.checkSize = function checkSize() {\n    var justStart = now() - this._initTime < 1500 && this.width === 0 || this.height === 0;\n\n    var watched = this._getContainerDomSize(),\n        oldHeight = this.height,\n        oldWidth = this.width;\n\n    if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n      return this;\n    }\n\n    var center = this.getCenter();\n\n    if (!this.options['fixCenterOnResize']) {\n      var vh = this._getVisualHeight(this.getPitch());\n\n      var nwCP = new Point(0, this.height - vh);\n\n      var nwCoord = this._containerPointToPrj(nwCP);\n\n      this._updateMapSize(watched);\n\n      var vhAfter = this._getVisualHeight(this.getPitch());\n\n      var nwCPAfter = new Point(0, this.height - vhAfter);\n\n      this._setPrjCoordAtContainerPoint(nwCoord, nwCPAfter);\n\n      this._mapViewCoord = this._getPrjCenter();\n    } else {\n      this._updateMapSize(watched);\n    }\n\n    var hided = watched['width'] === 0 || watched['height'] === 0 || oldWidth === 0 || oldHeight === 0;\n\n    if (justStart || hided) {\n      this._eventSilence = true;\n      this.setCenter(center);\n      delete this._eventSilence;\n    }\n\n    this._fireEvent('resize');\n\n    return this;\n  };\n\n  _proto.locate = function locate(coordinate, dx, dy) {\n    return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    return this._getRenderer().getMainPanel();\n  };\n\n  _proto.getPanels = function getPanels() {\n    return this._panels;\n  };\n\n  _proto.remove = function remove() {\n    var _this3 = this;\n\n    if (this.isRemoved()) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._removeDomEvents();\n\n    this._clearHandlers();\n\n    this.removeBaseLayer();\n    var layers = this.getLayers();\n\n    for (var i = 0; i < layers.length; i++) {\n      layers[i].remove();\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().remove();\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      Array.prototype.slice.call(this._containerDOM.childNodes, 0).filter(function (node) {\n        return node.className === 'maptalks-wrapper';\n      }).forEach(function (node) {\n        return _this3._containerDOM.removeChild(node);\n      });\n    }\n\n    delete this._panels;\n    delete this._containerDOM;\n    delete this.renderer;\n\n    this._fireEvent('removeend');\n\n    this._clearAllListeners();\n\n    return this;\n  };\n\n  _proto.isRemoved = function isRemoved() {\n    return !this._containerDOM;\n  };\n\n  _proto.isMoving = function isMoving() {\n    return !!this._moving;\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    var prjCenter = this._getPrjCenter();\n\n    if (!this._originCenter || this._verifyExtent(prjCenter)) {\n      this._originCenter = prjCenter;\n    }\n\n    this._moving = true;\n\n    this._trySetCursor('move');\n\n    this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this._moving = false;\n\n    this._trySetCursor('default');\n\n    this._fireEvent('moveend', param && param['domEvent'] ? this._parseEvent(param['domEvent'], 'moveend') : param);\n\n    if (!this._verifyExtent(this._getPrjCenter()) && this._originCenter) {\n      var moveTo = this._originCenter;\n\n      this._panTo(moveTo);\n    }\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart(param) {\n    this._dragRotating = true;\n\n    this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n  };\n\n  _proto.onDragRotating = function onDragRotating(param) {\n    this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n  };\n\n  _proto.onDragRotateEnd = function onDragRotateEnd(param) {\n    this._dragRotating = false;\n\n    this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n  };\n\n  _proto.isDragRotating = function isDragRotating() {\n    return !!this._dragRotating;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.getDevicePixelRatio = function getDevicePixelRatio() {\n    return this.options['devicePixelRatio'] || Browser$1.devicePixelRatio || 1;\n  };\n\n  _proto._initContainer = function _initContainer(container) {\n    if (isString(container)) {\n      this._containerDOM = document.getElementById(container);\n\n      if (!this._containerDOM) {\n        throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n      }\n    } else {\n      this._containerDOM = container;\n\n      if (IS_NODE) {\n        this.CanvasClass = this._containerDOM.constructor;\n      }\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n        throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n      }\n    }\n  };\n\n  _proto._trySetCursor = function _trySetCursor(cursor) {\n    if (!this._cursor && !this._priorityCursor) {\n      if (!cursor) {\n        cursor = 'default';\n      }\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setPriorityCursor = function _setPriorityCursor(cursor) {\n    if (!cursor) {\n      var hasCursor = false;\n\n      if (this._priorityCursor) {\n        hasCursor = true;\n      }\n\n      delete this._priorityCursor;\n\n      if (hasCursor) {\n        this.setCursor(this._cursor);\n      }\n    } else {\n      this._priorityCursor = cursor;\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setCursorToPanel = function _setCursorToPanel(cursor) {\n    var panel = this.getMainPanel();\n\n    if (panel && panel.style && panel.style.cursor !== cursor) {\n      panel.style.cursor = cursor;\n    }\n  };\n\n  _proto._removeLayer = function _removeLayer(layer, layerList) {\n    if (!layer || !layerList) {\n      return;\n    }\n\n    var index = layerList.indexOf(layer);\n\n    if (index > -1) {\n      layerList.splice(index, 1);\n    }\n  };\n\n  _proto._sortLayersByZIndex = function _sortLayersByZIndex() {\n    if (!this._layers) {\n      return;\n    }\n\n    for (var i = 0, l = this._layers.length; i < l; i++) {\n      this._layers[i]._order = i;\n    }\n\n    this._layers.sort(function (a, b) {\n      var c = a.getZIndex() - b.getZIndex();\n\n      if (c === 0) {\n        return a._order - b._order;\n      }\n\n      return c;\n    });\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._eventSilence) {\n      return;\n    }\n\n    this.fire('_' + eventName, param);\n    this.fire(eventName, param);\n  };\n\n  _proto._Load = function _Load() {\n    this._resetMapStatus();\n\n    if (this.options['pitch']) {\n      this.setPitch(this.options['pitch']);\n      delete this.options['pitch'];\n    }\n\n    if (this.options['bearing']) {\n      this.setBearing(this.options['bearing']);\n      delete this.options['bearing'];\n    }\n\n    this._loadAllLayers();\n\n    this._getRenderer().onLoad();\n\n    this._loaded = true;\n\n    this._callOnLoadHooks();\n\n    this._initTime = now();\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n    var clazz = Map.getRendererClass(renderer);\n    this._renderer = new clazz(this);\n\n    this._renderer.load();\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._loadAllLayers = function _loadAllLayers() {\n    function loadLayer(layer) {\n      if (layer) {\n        layer.load();\n      }\n    }\n\n    if (this._baseLayer) {\n      this._baseLayer.load();\n    }\n\n    this._eachLayer(loadLayer, this.getLayers());\n  };\n\n  _proto._getLayers = function _getLayers(filter) {\n    var layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n    var result = [];\n\n    for (var i = 0; i < layers.length; i++) {\n      if (!filter || filter.call(this, layers[i])) {\n        result.push(layers[i]);\n      }\n    }\n\n    return result;\n  };\n\n  _proto._eachLayer = function _eachLayer(fn) {\n    if (arguments.length < 2) {\n      return;\n    }\n\n    var layerLists = Array.prototype.slice.call(arguments, 1);\n\n    if (layerLists && !Array.isArray(layerLists)) {\n      layerLists = [layerLists];\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = layerLists.length; i < len; i++) {\n      layers = layers.concat(layerLists[i]);\n    }\n\n    for (var j = 0, jlen = layers.length; j < jlen; j++) {\n      fn.call(fn, layers[j]);\n    }\n  };\n\n  _proto._onLayerEvent = function _onLayerEvent(param) {\n    if (!param) {\n      return;\n    }\n\n    if (param['type'] === 'idchange') {\n      delete this._layerCache[param['old']];\n      this._layerCache[param['new']] = param['target'];\n    }\n  };\n\n  _proto._resetMapStatus = function _resetMapStatus() {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    var viewMaxZoom = this._spatialReference.getMaxZoom(),\n        viewMinZoom = this._spatialReference.getMinZoom();\n\n    if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n      this.setMaxZoom(viewMaxZoom);\n    }\n\n    if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n      this.setMinZoom(viewMinZoom);\n    }\n\n    maxZoom = this.getMaxZoom();\n    minZoom = this.getMinZoom();\n\n    if (maxZoom < minZoom) {\n      this.setMaxZoom(minZoom);\n    }\n\n    if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n      this._zoomLevel = maxZoom;\n    }\n\n    if (this._zoomLevel < minZoom) {\n      this._zoomLevel = minZoom;\n    }\n\n    delete this._prjCenter;\n    var projection = this.getProjection();\n    this._prjCenter = projection.project(this._center);\n\n    this._calcMatrices();\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.resetContainer();\n    }\n  };\n\n  _proto._getContainerDomSize = function _getContainerDomSize() {\n    if (!this._containerDOM) {\n      return null;\n    }\n\n    var containerDOM = this._containerDOM;\n    var width, height;\n\n    if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n      width = containerDOM.width;\n      height = containerDOM.height;\n      var dpr = this.getDevicePixelRatio();\n\n      if (dpr !== 1 && containerDOM['layer']) {\n        width /= dpr;\n        height /= dpr;\n      }\n    } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n      width = parseInt(containerDOM.clientWidth, 0);\n      height = parseInt(containerDOM.clientHeight, 0);\n    } else {\n      throw new Error('can not get size of container');\n    }\n\n    return new Size(width, height);\n  };\n\n  _proto._updateMapSize = function _updateMapSize(mSize) {\n    this.width = mSize['width'];\n    this.height = mSize['height'];\n\n    this._getRenderer().updateMapSize(mSize);\n\n    this._calcMatrices();\n\n    return this;\n  };\n\n  _proto._getPrjCenter = function _getPrjCenter() {\n    return this._prjCenter;\n  };\n\n  _proto._setPrjCenter = function _setPrjCenter(pcenter) {\n    this._prjCenter = pcenter;\n\n    if (this.isInteracting() && !this.isMoving()) {\n      this._mapViewCoord = pcenter;\n    }\n\n    this._calcMatrices();\n  };\n\n  _proto._setPrjCoordAtContainerPoint = function _setPrjCoordAtContainerPoint(coordinate, point) {\n    if (point.x === this.width / 2 && point.y === this.height / 2) {\n      return this;\n    }\n\n    var t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n\n    var pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n\n    this._setPrjCenter(pcenter);\n\n    return this;\n  };\n\n  _proto._verifyExtent = function _verifyExtent(prjCenter) {\n    if (!prjCenter) {\n      return false;\n    }\n\n    var maxExt = this._prjMaxExtent;\n\n    if (!maxExt) {\n      return true;\n    }\n\n    return maxExt.contains(prjCenter);\n  };\n\n  _proto._offsetCenterByPixel = function _offsetCenterByPixel(pixel) {\n    var pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n\n    var pCenter = this._containerPointToPrj(pos);\n\n    this._setPrjCenter(pCenter);\n\n    return pCenter;\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset) {\n    if (!offset) {\n      return this._mapViewPoint;\n    } else {\n      this._getRenderer().offsetPlatform(offset);\n\n      this._mapViewCoord = this._getPrjCenter();\n      this._mapViewPoint = this._mapViewPoint.add(offset);\n      return this;\n    }\n  };\n\n  _proto.getViewPoint = function getViewPoint() {\n    var offset = this._getViewPointFrameOffset();\n\n    var panelOffset = this.offsetPlatform();\n\n    if (offset) {\n      panelOffset = panelOffset.add(offset);\n    }\n\n    return panelOffset;\n  };\n\n  _proto._resetMapViewPoint = function _resetMapViewPoint() {\n    this._mapViewPoint = new Point(0, 0);\n    this._mapViewCoord = this._getPrjCenter();\n  };\n\n  _proto._getResolution = function _getResolution(zoom) {\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n      return this._mapRes;\n    } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n      return this._mapGlRes;\n    }\n\n    if (isNil(zoom)) {\n      zoom = this._zoomLevel;\n    }\n\n    return this._spatialReference.getResolution(zoom);\n  };\n\n  _proto._getResolutions = function _getResolutions() {\n    return this._spatialReference.getResolutions();\n  };\n\n  _proto._prjToPoint = function _prjToPoint(pCoord, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPrj = function _pointToPrj(point, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPoint = function _pointToPoint(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution(zoom) / this._getResolution());\n    }\n\n    return out;\n  };\n\n  _proto._pointToPointAtZoom = function _pointToPointAtZoom(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution() / this._getResolution(zoom));\n    }\n\n    return out;\n  };\n\n  _proto._containerPointToPrj = function _containerPointToPrj(containerPoint, out) {\n    return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n  };\n\n  _proto._callOnLoadHooks = function _callOnLoadHooks() {\n    var proto = Map.prototype;\n\n    if (!proto._onLoadHooks) {\n      return;\n    }\n\n    for (var i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n      proto._onLoadHooks[i].call(this);\n    }\n  };\n\n  return Map;\n}(Handlerable(Eventable(Renderable(Class))));\n\nMap$1.include({\n  coordinateToPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var prjCoord = this.getProjection().project(coordinate, COORD);\n      return this._prjToPoint(prjCoord, zoom, out);\n    };\n  }(),\n  pointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      var prjCoord = this._pointToPrj(point, zoom, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  coordinateToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, out, altitude) {\n      return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out, altitude);\n    };\n  }(),\n  viewPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (viewPoint, out) {\n      return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n    };\n  }(),\n  coordinateToContainerPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var pCoordinate = this.getProjection().project(coordinate, COORD);\n      return this._prjToContainerPoint(pCoordinate, zoom, out);\n    };\n  }(),\n  containerPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (containerPoint, out) {\n      var pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n\n      return this.getProjection().unproject(pCoordinate, out);\n    };\n  }(),\n  containerToExtent: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (containerExtent) {\n      var extent2D = new PointExtent(this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0), this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1));\n      return this._pointToExtent(extent2D);\n    };\n  }(),\n  distanceToPixel: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (xDist, yDist, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var scale = this.getScale() / this.getScale(zoom);\n      var center = this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToContainerPoint(center, undefined, POINT0),\n          p1 = this.coordToContainerPoint(target, undefined, POINT1);\n\n      p1._sub(p0)._multi(scale)._abs();\n\n      return new Size(p1.x, p1.y);\n    };\n  }(),\n  distanceToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (xDist, yDist, zoom, paramCenter) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var center = paramCenter || this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToPoint(center, zoom, POINT),\n          p1 = this.coordToPoint(target, zoom);\n\n      p1._sub(p0)._abs();\n\n      return p1;\n    };\n  }(),\n  pixelToDistance: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (width, height) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var fullExt = this.getFullExtent();\n      var d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n      var target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n      var coord = this.containerPointToCoord(target, COORD1);\n      return projection.measureLength(this.getCenter(), coord);\n    };\n  }(),\n  pointToDistance: function () {\n    var POINT = new Point(0, 0);\n    var COORD = new Coordinate(0, 0);\n    return function (dx, dy, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var c = this._prjToPoint(this._getPrjCenter(), zoom, POINT);\n\n      c._add(dx, dy);\n\n      var target = this.pointToCoord(c, zoom, COORD);\n      return projection.measureLength(this.getCenter(), target);\n    };\n  }(),\n  locateByPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (coordinate, px, py) {\n      var point = this.coordToContainerPoint(coordinate, undefined, POINT);\n      return this.containerPointToCoord(point._add(px, py));\n    };\n  }(),\n  _get2DExtent: function () {\n    var POINT = new Point(0, 0);\n    return function (zoom, out) {\n      var _this4 = this;\n\n      var cached;\n\n      if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n        cached = this._mapExtent2D;\n      } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n        cached = this._mapGlExtent2D;\n      }\n\n      if (cached) {\n        if (out) {\n          out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n          return out;\n        }\n\n        return cached.copy();\n      }\n\n      var cExtent = this.getContainerExtent();\n      return cExtent.convertTo(function (c) {\n        return _this4._containerPointToPoint(c, zoom, POINT);\n      }, out);\n    };\n  }(),\n  _pointToExtent: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (extent2D) {\n      var min2d = extent2D.getMin(),\n          max2d = extent2D.getMax();\n      var fullExtent = this.getFullExtent();\n\n      var _ref = !fullExtent || fullExtent.left <= fullExtent.right ? [min2d.x, max2d.x] : [max2d.x, min2d.x],\n          minx = _ref[0],\n          maxx = _ref[1];\n\n      var _ref2 = !fullExtent || fullExtent.top > fullExtent.bottom ? [max2d.y, min2d.y] : [min2d.y, max2d.y],\n          miny = _ref2[0],\n          maxy = _ref2[1];\n\n      var min = min2d.set(minx, maxy);\n      var max = max2d.set(maxx, miny);\n      return new Extent(this.pointToCoord(min, undefined, COORD0), this.pointToCoord(max, undefined, COORD1), this.getProjection());\n    };\n  }(),\n  _getViewPointFrameOffset: function () {\n    var POINT = new Point(0, 0);\n    return function () {\n      if (this.isZooming()) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCenter();\n\n      if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n        return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n      }\n\n      return null;\n    };\n  }(),\n  _viewPointToPrj: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, out) {\n      return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n    };\n  }(),\n  _prjToContainerPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, zoom, out, altitude) {\n      return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom, POINT), zoom, altitude || 0, out);\n    };\n  }(),\n  _prjToViewPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, out, altitude) {\n      var containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT, altitude);\n\n      return this.containerPointToViewPoint(containerPoint, out);\n    };\n  }(),\n  _viewPointToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, zoom, out) {\n      return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n    };\n  }(),\n  _pointToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n    };\n  }()\n});\nMap$1.mergeOptions(options$2);\n\nvar MapDoubleClickZoomHandler = function (_Handler) {\n  _inheritsLoose(MapDoubleClickZoomHandler, _Handler);\n\n  function MapDoubleClickZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDoubleClickZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto._onDoubleClick = function _onDoubleClick(param) {\n    var map = this.target;\n\n    if (map.options['doubleClickZoom']) {\n      var oldZoom = map.getZoom(),\n          zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n      map._zoomAnimation(zoom, param['containerPoint']);\n    }\n  };\n\n  return MapDoubleClickZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'doubleClickZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nvar MapDragHandler = function (_Handler) {\n  _inheritsLoose(MapDragHandler, _Handler);\n\n  function MapDragHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n\n    if (!map) {\n      return;\n    }\n\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    this._dragHandler = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'rightclick': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this).on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this).enable();\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._dragHandler.off('mousedown', this._onMouseDown, this).off('dragstart', this._onDragStart, this).off('dragging', this._onDragging, this).off('dragend', this._onDragEnd, this);\n\n    this._dragHandler.remove();\n\n    delete this._dragHandler;\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    if (this.target.isZooming() || this._ignore(domEvent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._ignore = function _ignore(param) {\n    if (!param) {\n      return false;\n    }\n\n    if (param.domEvent) {\n      param = param.domEvent;\n    }\n\n    return this.target._ignoreEvent(param);\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    delete this.startDragTime;\n    delete this._mode;\n\n    if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n      if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n        this._mode = 'rotatePitch';\n      }\n    } else if (this.target.options['dragPan']) {\n      this._mode = 'move';\n    }\n\n    this.target._stopAnim(this.target._mapAnimPlayer);\n\n    preventDefault(param['domEvent']);\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this.startDragTime = now();\n\n    if (this._mode === 'move') {\n      this._moveStart(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateStart(param);\n    }\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var map = this.target;\n\n    if (map._isEventOutMap(param['domEvent'])) {\n      return;\n    }\n\n    if (this._mode === 'move') {\n      this._moving(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotating(param);\n    }\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    if (this._mode === 'move') {\n      this._moveEnd(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateEnd(param);\n    }\n\n    delete this.startDragTime;\n    delete this.startBearing;\n  };\n\n  _proto._start = function _start(param) {\n    this.preX = param['mousePos'].x;\n    this.preY = param['mousePos'].y;\n    this.startX = this.preX;\n    this.startY = this.preY;\n  };\n\n  _proto._moveStart = function _moveStart(param) {\n    this._start(param);\n\n    var map = this.target;\n    map.onMoveStart(param);\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n    this.startPrjCoord = map._containerPointToPrj(p);\n  };\n\n  _proto._moving = function _moving(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n\n    map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n\n    map.onMoving(param);\n  };\n\n  _proto._moveEnd = function _moveEnd(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var t = now() - this.startDragTime;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var dx = mx - this.startX;\n    var dy = my - this.startY;\n\n    this._clear();\n\n    if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map._getPrjCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n      t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n      map.panBy(new Point(dx, dy), {\n        'duration': t\n      });\n    } else {\n      map.onMoveEnd(param);\n    }\n  };\n\n  _proto._rotateStart = function _rotateStart(param) {\n    this._start(param);\n\n    delete this._rotateMode;\n    this.startBearing = this.target.getBearing();\n    this.target.onDragRotateStart(param);\n    this._db = 0;\n  };\n\n  _proto._rotating = function _rotating(param) {\n    var map = this.target;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var prePitch = map.getPitch(),\n        preBearing = map.getBearing();\n    var dx = Math.abs(mx - this.preX),\n        dy = Math.abs(my - this.preY);\n\n    if (!this._rotateMode) {\n      if (map.options['dragRotatePitch']) {\n        this._rotateMode = 'rotate_pitch';\n      } else if (dx > dy) {\n        this._rotateMode = 'rotate';\n      } else if (dx < dy) {\n        this._rotateMode = 'pitch';\n      } else {\n        this._rotateMode = 'rotate';\n      }\n    }\n\n    if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n      return;\n    }\n\n    if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n      var db = 0;\n\n      if (map.options['dragPitch'] || dx > dy) {\n        db = -0.6 * (this.preX - mx);\n      } else if (mx > map.width / 2) {\n        db = 0.6 * (this.preY - my);\n      } else {\n        db = -0.6 * (this.preY - my);\n      }\n\n      var bearing = map.getBearing() + db;\n      this._db = this._db || 0;\n      this._db += db;\n      map.setBearing(bearing);\n    }\n\n    if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n      map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n    }\n\n    this.preX = mx;\n    this.preY = my;\n\n    if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n      map.onDragRotating(param);\n    }\n  };\n\n  _proto._rotateEnd = function _rotateEnd(param) {\n    var map = this.target;\n    var bearing = map.getBearing();\n\n    this._clear();\n\n    var t = now() - this.startDragTime;\n    map.onDragRotateEnd(param);\n\n    if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n      var _bearing = map.getBearing();\n\n      map._animateTo({\n        'bearing': _bearing + this._db / 2\n      }, {\n        'easing': 'out',\n        'duration': 800\n      });\n    }\n  };\n\n  _proto._clear = function _clear() {\n    delete this.startPrjCoord;\n    delete this.preX;\n    delete this.preY;\n    delete this.startX;\n    delete this.startY;\n  };\n\n  return MapDragHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'draggable': true,\n  'dragPan': true,\n  'dragRotatePitch': true,\n  'dragRotate': true,\n  'dragPitch': true\n});\nMap$1.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\n\nvar EVENTS = 'mousedown ' + 'mouseup ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar MapGeometryEventsHandler = function (_Handler) {\n  _inheritsLoose(MapGeometryEventsHandler, _Handler);\n\n  function MapGeometryEventsHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapGeometryEventsHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    on(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    off(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto._identifyGeometryEvents = function _identifyGeometryEvents(domEvent, type) {\n    var map = this.target;\n\n    if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n      return;\n    }\n\n    var layers = map._getLayers(function (layer) {\n      if (layer.identify && layer.options['geometryEvents']) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (!layers.length) {\n      return;\n    }\n\n    var oneMoreEvent = null;\n    var eventType = type || domEvent.type;\n\n    if (eventType === 'mousedown' || eventType === 'touchstart' && domEvent.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n      var downTime = this._mouseDownTime;\n      delete this._mouseDownTime;\n      var time = now();\n\n      if (time - downTime > 300) {\n        if (eventType === 'click') {\n          return;\n        }\n      } else if (eventType === 'touchend') {\n        oneMoreEvent = 'click';\n      }\n    }\n\n    var actual = domEvent.touches && domEvent.touches.length > 0 ? domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ? domEvent.changedTouches[0] : domEvent;\n\n    if (!actual) {\n      return;\n    }\n\n    var containerPoint = getEventContainerPoint(actual, map._containerDOM),\n        coordinate = map.containerPointToCoordinate(containerPoint);\n\n    if (eventType === 'touchstart') {\n      preventDefault(domEvent);\n    }\n\n    var geometryCursorStyle = null;\n    var identifyOptions = {\n      'includeInternals': true,\n      'filter': function filter(geometry) {\n        if (!(geometry instanceof Geometry)) {\n          return false;\n        }\n\n        var eventToFire = geometry._getEventTypeToFire(domEvent);\n\n        if (eventType === 'mousemove') {\n          if (!geometryCursorStyle && geometry.options['cursor']) {\n            geometryCursorStyle = geometry.options['cursor'];\n          }\n\n          if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n            return false;\n          }\n        } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n          return false;\n        }\n\n        return true;\n      },\n      'count': 1,\n      'coordinate': coordinate,\n      'onlyVisible': map.options['onlyVisibleGeometryEvents'],\n      'layers': layers\n    };\n    var callback = fireGeometryEvent.bind(this);\n\n    if (eventType === 'mousemove' || eventType === 'touchmove') {\n      this._queryIdentifyTimeout = map.getRenderer().callInNextFrame(function () {\n        if (map.isInteracting()) {\n          return;\n        }\n\n        map.identify(identifyOptions, callback);\n      });\n    } else {\n      map.identify(identifyOptions, callback);\n    }\n\n    function fireGeometryEvent(geometries) {\n      var propagation = true;\n\n      if (eventType === 'mousemove') {\n        var geoMap = {};\n\n        if (geometries.length > 0) {\n          for (var i = geometries.length - 1; i >= 0; i--) {\n            var geo = geometries[i];\n\n            if (!(geo instanceof Geometry)) {\n              continue;\n            }\n\n            var iid = geo._getInternalId();\n\n            geoMap[iid] = geo;\n\n            geo._onEvent(domEvent);\n\n            if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n              geo._onEvent(domEvent, 'mouseenter');\n            }\n\n            propagation = geo._onEvent(domEvent, 'mouseover');\n          }\n        }\n\n        map._setPriorityCursor(geometryCursorStyle);\n\n        var oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n        this._prevOverGeos = {\n          'geos': geometries,\n          'geomap': geoMap\n        };\n\n        if (oldTargets && oldTargets.length > 0) {\n          for (var _i = oldTargets.length - 1; _i >= 0; _i--) {\n            var oldTarget = oldTargets[_i];\n\n            if (!(oldTarget instanceof Geometry)) {\n              continue;\n            }\n\n            var oldTargetId = oldTargets[_i]._getInternalId();\n\n            if (!geoMap[oldTargetId]) {\n              propagation = oldTarget._onEvent(domEvent, 'mouseout');\n            }\n          }\n        }\n      } else {\n        if (!geometries || !geometries.length) {\n          return;\n        }\n\n        for (var _i2 = geometries.length - 1; _i2 >= 0; _i2--) {\n          if (!(geometries[_i2] instanceof Geometry)) {\n            continue;\n          }\n\n          propagation = geometries[_i2]._onEvent(domEvent);\n\n          if (oneMoreEvent) {\n            geometries[_i2]._onEvent(domEvent, oneMoreEvent);\n          }\n\n          break;\n        }\n      }\n\n      if (propagation === false) {\n        stopPropagation(domEvent);\n      }\n    }\n  };\n\n  return MapGeometryEventsHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'geometryEvents': true,\n  'onlyVisibleGeometryEvents': true\n});\nMap$1.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\n\nvar wheelZoomDelta = 4.000244140625;\nvar defaultZoomRate = 1 / 100;\nvar wheelZoomRate = 1 / 450;\nvar maxScalePerFrame = 2;\n\nvar MapScrollWheelZoomHandler = function (_Handler) {\n  _inheritsLoose(MapScrollWheelZoomHandler, _Handler);\n\n  function MapScrollWheelZoomHandler(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this._thisScrollZoom = _this._scrollZoom.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this._wheelZoomRate = wheelZoomRate;\n    _this._defaultZoomRate = defaultZoomRate;\n    _this._delta = 0;\n    return _this;\n  }\n\n  var _proto = MapScrollWheelZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll);\n  };\n\n  _proto._onWheelScroll = function _onWheelScroll(evt) {\n    preventDefault(evt);\n    stopPropagation(evt);\n    var map = this.target;\n\n    if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n      return false;\n    }\n\n    var container = map._containerDOM;\n\n    var origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n\n    if (map.options['seamlessZoom']) {\n      if (!this._zooming) {\n        this._trackPadSuspect = 0;\n        this._ensureTrackpad = false;\n      }\n\n      return this._seamless(evt, origin);\n    } else {\n      return this._interval(evt, origin);\n    }\n  };\n\n  _proto._seamless = function _seamless(evt, origin) {\n    var value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n\n    if (value % wheelZoomDelta !== 0) {\n      if (!this._ensureTrackpad) {\n        if (Math.abs(value) < 60) {\n          this._trackPadSuspect++;\n        } else {\n          this._trackPadSuspect = 0;\n        }\n\n        if (this._trackPadSuspect >= 2) {\n          this._ensureTrackpad = true;\n        }\n      }\n\n      if (this._ensureTrackpad) {\n        value *= 14;\n      }\n    }\n\n    if (evt.shiftKey && value) value = value / 4;\n    this._lastWheelEvent = evt;\n    this._delta -= value;\n\n    if (!this._zooming && this._delta) {\n      var map = this.target;\n      this._zoomOrigin = origin;\n      map.onZoomStart(null, origin);\n    }\n\n    this._start();\n  };\n\n  _proto._start = function _start() {\n    if (!this._delta) return;\n    this._zooming = true;\n    var map = this.target;\n\n    if (!this._active) {\n      map.getRenderer().callInNextFrame(this._thisScrollZoom);\n      this._active = true;\n    }\n  };\n\n  _proto._scrollZoom = function _scrollZoom() {\n    var _this2 = this;\n\n    this._active = false;\n\n    if (!this._delta) {\n      return;\n    }\n\n    var zoomRate = Math.abs(this._delta) > wheelZoomDelta ? this._wheelZoomRate : this._defaultZoomRate;\n    var scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n\n    if (this._delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    var map = this.target;\n    var zoom = map.getZoom();\n    var targetZoom = map.getZoomForScale(scale, zoom, true);\n    this._delta = 0;\n    map.onZooming(targetZoom, this._zoomOrigin);\n\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n\n    this._timeout = setTimeout(function () {\n      _this2._zooming = false;\n      delete _this2._timeout;\n      map.onZoomEnd(map.getZoom(), _this2._zoomOrigin);\n    }, 210);\n  };\n\n  _proto._interval = function _interval(evt, origin) {\n    var _this3 = this;\n\n    var map = this.target;\n\n    if (this._zooming) {\n      this._requesting++;\n      return false;\n    }\n\n    this._requesting = 0;\n    var levelValue = (evt.deltaY ? evt.deltaY * -1 : evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n\n    if (evt.detail) {\n      levelValue *= -1;\n    }\n\n    var zoom = map.getZoom();\n    var nextZoom = zoom + levelValue;\n    nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n\n    if (nextZoom === zoom) {\n      return false;\n    }\n\n    this._zooming = true;\n\n    if (!this._delta) {\n      map.onZoomStart(null, origin);\n      this._origin = origin;\n      this._delta = levelValue;\n      this._startZoom = map.getZoom();\n    }\n\n    var duration = 90;\n\n    map._animateTo({\n      'zoom': nextZoom - this._delta * 1 / 2,\n      'around': this._origin\n    }, {\n      'continueOnViewChanged': true,\n      'easing': 'linear',\n      'duration': duration,\n      'wheelZoom': true\n    }, function (frame) {\n      if (frame.state.playState !== 'finished') {\n        if (frame.state.playState !== 'running') {\n          delete _this3._zooming;\n          delete _this3._requesting;\n        }\n\n        return;\n      }\n\n      if (_this3._requesting < 1 || Math.abs(nextZoom - _this3._startZoom) > 2 || nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n        map._animateTo({\n          'zoom': nextZoom,\n          'around': _this3._origin\n        }, {\n          'continueOnViewChanged': true,\n          'duration': 100\n        }, function (frame) {\n          if (frame.state.playState !== 'running') {\n            delete _this3._zooming;\n            delete _this3._requesting;\n          }\n        });\n\n        delete _this3._startZoom;\n        delete _this3._origin;\n        delete _this3._delta;\n        _this3._requesting = 0;\n      } else if (!isNil(_this3._requesting)) {\n        delete _this3._zooming;\n\n        _this3._onWheelScroll(evt);\n      }\n    });\n\n    return false;\n  };\n\n  return MapScrollWheelZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'scrollWheelZoom': true,\n  'seamlessZoom': false\n});\nMap$1.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nvar MapTouchZoomHandler = function (_Handler) {\n  _inheritsLoose(MapTouchZoomHandler, _Handler);\n\n  function MapTouchZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTouchZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n  };\n\n  _proto._onTouchStart = function _onTouchStart(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer();\n    var p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container);\n    this.preY = p1.y;\n    this._startP1 = p1;\n    this._startP2 = p2;\n    this._startDist = p1.distanceTo(p2);\n    this._startVector = p1.sub(p2);\n    this._startZoom = map.getZoom();\n    this._startBearing = map.getBearing();\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n    addDomEvent(document, 'touchmove', this._onTouchMove, this);\n    addDomEvent(document, 'touchend', this._onTouchEnd, this);\n    preventDefault(event);\n\n    map._fireEvent('touchactstart');\n  };\n\n  _proto._onTouchMove = function _onTouchMove(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer(),\n        p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container),\n        d1 = p1.sub(this._startP1),\n        d2 = p2.sub(this._startP2),\n        vector = p1.sub(p2),\n        scale = p1.distanceTo(p2) / this._startDist,\n        bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n        preY = this.preY || p1.y,\n        pitch = (preY - p1.y) * 0.4;\n\n    this.preY = p1.y;\n    var param = {\n      'domEvent': event,\n      'mousePos': [p1, p2]\n    };\n\n    if (!this.mode) {\n      if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n        this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n      } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n        this.mode = 'pitch';\n      } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n        this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n      }\n\n      this._startTouching(param);\n    }\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      this._scale = scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZooming(zoom, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.setBearing(this._startBearing + bearing);\n      map.onDragRotating(param);\n    } else if (this.mode === 'pitch') {\n      map.setPitch(map.getPitch() + pitch);\n      map.onDragRotating(param);\n    }\n\n    map._fireEvent('touchactinging');\n  };\n\n  _proto._startTouching = function _startTouching(param) {\n    var map = this.target;\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var size = map.getSize();\n      this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n      map.onZoomStart(null, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n      map.onDragRotateStart(param);\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    delete this.preY;\n    var map = this.target;\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var scale = this._scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZoomEnd(zoom, this._Origin);\n    }\n\n    if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.onDragRotateEnd({\n        'domEvent': event\n      });\n    }\n\n    delete this.mode;\n\n    map._fireEvent('touchactend');\n  };\n\n  return MapTouchZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'touchGesture': true,\n  'touchZoom': true,\n  'touchPitch': true,\n  'touchRotate': true,\n  'touchZoomRotate': false\n});\nMap$1.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\n\nvar KEY = '__anim_player';\nvar Easing = {\n  in: function _in(t) {\n    return Math.pow(t, 2);\n  },\n  out: function out(t) {\n    return 1 - Easing.in(1 - t);\n  },\n  inAndOut: function inAndOut(t) {\n    return 3 * t * t - 2 * t * t * t;\n  },\n  linear: function linear(t) {\n    return t;\n  },\n  upAndDown: function upAndDown(t) {\n    if (t < 0.5) {\n      return Easing.inAndOut(2 * t);\n    } else {\n      return 1 - Easing.inAndOut(2 * (t - 0.5));\n    }\n  }\n};\n\nvar Frame = function Frame(state, styles) {\n  this.state = state;\n  this.styles = styles;\n};\n\nvar Player = function Player(animation, options, onFrame, target) {\n  this._animation = animation;\n  this.options = options;\n  this._onFrame = onFrame;\n  this.playState = 'idle';\n  this.ready = true;\n  this.finished = false;\n  this.target = target;\n};\n\nvar Animation = {\n  speed: {\n    'slow': 2000,\n    'normal': 1000,\n    'fast': 500\n  },\n  _resolveStyles: function _resolveStyles(styles) {\n    if (!styles) {\n      return null;\n    }\n\n    function resolveChild(child) {\n      if (!Array.isArray(child)) {\n        return Animation._resolveStyles(child);\n      }\n\n      var start = [],\n          d = [],\n          dest = [];\n\n      for (var i = 0; i < child.length; i++) {\n        var _styles = Animation._resolveStyles(child[i]);\n\n        if (_styles) {\n          start.push(_styles[0]);\n          d.push(_styles[1]);\n          dest.push(_styles[2]);\n        }\n      }\n\n      if (!start.length) {\n        return null;\n      } else {\n        return [start, d, dest];\n      }\n    }\n\n    function resolveVal(val) {\n      var values = val;\n      var clazz;\n\n      if (!Array.isArray(val)) {\n        if (isNumber(val)) {\n          values = [0, val];\n        } else if (val instanceof Point || val instanceof Coordinate) {\n          clazz = val.constructor;\n          values = [new clazz(0, 0), val];\n        } else {\n          values = [val, val];\n        }\n      }\n\n      var v1 = values[0],\n          v2 = values[1];\n\n      if (isNumber(v1) && isNumber(v2)) {\n        if (v1 === v2) {\n          return null;\n        }\n\n        return [v1, v2 - v1, v2];\n      } else if (Array.isArray(v1) && isNumber(v1[0]) || v1 instanceof Coordinate || v1 instanceof Point) {\n        if (Array.isArray(v1)) {\n          v1 = new Coordinate(v1);\n          v2 = new Coordinate(v2);\n        } else {\n          clazz = v1.constructor;\n          v1 = new clazz(v1);\n          v2 = new clazz(v2);\n        }\n\n        if (v1.equals(v2)) {\n          return null;\n        }\n\n        return [v1, v2.sub(v1), v2];\n      } else {\n        return [v1, v2, v2];\n      }\n    }\n\n    function isChild(val) {\n      if (!Array.isArray(val) && val.constructor === Object) {\n        return true;\n      } else if (Array.isArray(val) && val[0].constructor === Object) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var d = {},\n        start = {},\n        dest = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var values = styles[p];\n\n        if (!values) {\n          continue;\n        } else if (Array.isArray(values)) {\n          if (isNil(values[0]) || isNil(values[1])) {\n            continue;\n          }\n        }\n\n        var childStyles = void 0;\n\n        if (isChild(values)) {\n          childStyles = resolveChild(values);\n        } else {\n          childStyles = resolveVal(values);\n        }\n\n        if (childStyles) {\n          start[p] = childStyles[0];\n          d[p] = childStyles[1];\n          dest[p] = childStyles[2];\n        }\n      }\n    }\n\n    return [start, d, dest];\n  },\n  framing: function framing(styles, options) {\n    if (!options) {\n      options = {};\n    }\n\n    var easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n\n    if (!easing) {\n      easing = Easing.linear;\n    }\n\n    var dStyles, startStyles, destStyles;\n    styles = Animation._resolveStyles(styles);\n\n    if (styles) {\n      startStyles = styles[0];\n      dStyles = styles[1];\n      destStyles = styles[2];\n    }\n\n    var deltaStyles = function deltaStyles(delta, _startStyles, _dStyles) {\n      if (!_startStyles || !_dStyles) {\n        return null;\n      }\n\n      var result = {};\n\n      for (var p in _dStyles) {\n        if (_dStyles.hasOwnProperty(p)) {\n          if (_startStyles[p] === destStyles[p]) {\n            result[p] = _startStyles[p];\n            continue;\n          }\n\n          var s = _startStyles[p],\n              d = _dStyles[p];\n\n          if (isNumber(d)) {\n            result[p] = s + delta * d;\n          } else if (Array.isArray(d)) {\n            var children = [];\n\n            for (var i = 0; i < d.length; i++) {\n              children.push(deltaStyles(delta, s[i], d[i]));\n            }\n\n            result[p] = children;\n          } else {\n            var clazz = d.constructor;\n\n            if (clazz === Object) {\n              result[p] = deltaStyles(delta, s, d);\n            } else if (s instanceof Point || s instanceof Coordinate) {\n              result[p] = s.add(d.multi(delta));\n            } else {\n              result[p] = d;\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    return function (elapsed, duration) {\n      var state, d;\n\n      if (elapsed < 0) {\n        state = {\n          'playState': 'idle',\n          'delta': 0\n        };\n        d = startStyles;\n      } else if (elapsed < duration) {\n        var delta = easing(elapsed / duration);\n        state = {\n          'playState': 'running',\n          'delta': delta\n        };\n        d = deltaStyles(delta, startStyles, dStyles);\n      } else {\n        state = {\n          'playState': 'finished',\n          'delta': 1\n        };\n        d = destStyles;\n      }\n\n      state['startStyles'] = startStyles;\n      state['destStyles'] = destStyles;\n      state['progress'] = elapsed;\n      state['remainingMs'] = duration - elapsed;\n      return new Frame(state, d);\n    };\n  },\n  _requestAnimFrame: function _requestAnimFrame(fn) {\n    if (!this._frameQueue) {\n      this._frameQueue = [];\n    }\n\n    this._frameQueue.push(fn);\n\n    this._a();\n  },\n  _a: function _a() {\n    if (!this._animationFrameId) {\n      this._animationFrameId = requestAnimFrame(Animation._frameFn);\n    }\n  },\n  _run: function _run() {\n    if (this._frameQueue.length) {\n      var running = this._frameQueue;\n      this._frameQueue = [];\n\n      for (var i = 0, len = running.length; i < len; i++) {\n        running[i]();\n      }\n\n      if (this._frameQueue.length) {\n        this._animationFrameId = requestAnimFrame(Animation._frameFn);\n      } else {\n        delete this._animationFrameId;\n      }\n    }\n  },\n  animate: function animate(styles, options, step, target) {\n    if (!options) {\n      options = {};\n    }\n\n    var animation = Animation.framing(styles, options);\n    var player = new Player(animation, options, step, target);\n    return player;\n  }\n};\nAnimation._frameFn = Animation._run.bind(Animation);\nextend(Player.prototype, {\n  _prepare: function _prepare() {\n    var options = this.options;\n    var duration = options['speed'] || options['duration'];\n\n    if (isString(duration)) {\n      duration = Animation.speed[duration];\n\n      if (!duration) {\n        duration = +duration;\n      }\n    }\n\n    if (!duration) {\n      duration = Animation.speed['normal'];\n    }\n\n    this.duration = duration;\n    this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n  },\n  play: function play() {\n    if (this.playState !== 'idle' && this.playState !== 'paused' || this.target && this.target[KEY]) {\n      return this;\n    }\n\n    if (this.target) {\n      this.target[KEY] = 1;\n    }\n\n    if (this.playState === 'idle') {\n      this.currentTime = 0;\n\n      this._prepare();\n    }\n\n    var t = now();\n\n    if (!this.startTime) {\n      var options = this.options;\n      this.startTime = options['startTime'] ? options['startTime'] : t;\n    }\n\n    this._playStartTime = Math.max(t, this.startTime);\n\n    if (this.playState === 'paused') {\n      this._playStartTime -= this.currentTime;\n    }\n\n    this.playState = 'running';\n\n    this._run();\n\n    return this;\n  },\n  pause: function pause() {\n    if (this.playState === 'paused') {\n      return this;\n    }\n\n    this.playState = 'paused';\n\n    this._run();\n\n    return this;\n  },\n  cancel: function cancel() {\n    if (this.playState === 'idle') {\n      return this;\n    }\n\n    this.playState = 'idle';\n    this.finished = false;\n\n    this._run();\n\n    return this;\n  },\n  finish: function finish() {\n    if (this.playState === 'finished') {\n      return this;\n    }\n\n    this.playState = 'finished';\n    this.finished = true;\n\n    this._run();\n\n    return this;\n  },\n  reverse: function reverse() {},\n  _run: function _run() {\n    var _this = this;\n\n    var onFrame = this._onFrame;\n    var t = now();\n    var elapsed = t - this._playStartTime;\n\n    if (this.options['repeat'] && elapsed >= this.duration) {\n      this._playStartTime = t;\n      elapsed = 0;\n    }\n\n    if (this.playState !== 'running') {\n      if (this.target) {\n        delete this.target[KEY];\n      }\n\n      if (onFrame) {\n        if (this.playState === 'finished') {\n          elapsed = this.duration;\n        } else if (this.playState === 'idle') {\n          elapsed = 0;\n        }\n\n        var _frame = this._animation(elapsed, this.duration);\n\n        _frame.state.playState = this.playState;\n        onFrame(_frame);\n      }\n\n      return;\n    }\n\n    var frame = this._animation(elapsed, this.duration);\n\n    this.playState = frame.state['playState'];\n\n    if (this.playState !== 'running' && this.target) {\n      delete this.target[KEY];\n    }\n\n    if (this.playState === 'idle') {\n      if (this.startTime > t) {\n        setTimeout(this._run.bind(this), this.startTime - t);\n      }\n    } else if (this.playState === 'running') {\n      this._framer(function () {\n        if (_this.playState !== 'running') {\n          return;\n        }\n\n        _this.currentTime = elapsed;\n\n        if (onFrame) {\n          onFrame(frame);\n        }\n\n        _this._run();\n      });\n    } else if (this.playState === 'finished') {\n      this.finished = true;\n\n      if (onFrame) {\n        onFrame(frame);\n      }\n    }\n  }\n});\n\nvar Animation$1 = /*#__PURE__*/Object.freeze({\n  Animation: Animation,\n  Easing: Easing,\n  Player: Player,\n  Frame: Frame\n});\n\nvar simplify = createCommonjsModule(function (module) {\n  (function () {\n\n    function getSqDist(p1, p2) {\n      var dx = p1.x - p2.x,\n          dy = p1.y - p2.y;\n      return dx * dx + dy * dy;\n    }\n\n    function getSqSegDist(p, p1, p2) {\n      var x = p1.x,\n          y = p1.y,\n          dx = p2.x - x,\n          dy = p2.y - y;\n\n      if (dx !== 0 || dy !== 0) {\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n          x = p2.x;\n          y = p2.y;\n        } else if (t > 0) {\n          x += dx * t;\n          y += dy * t;\n        }\n      }\n\n      dx = p.x - x;\n      dy = p.y - y;\n      return dx * dx + dy * dy;\n    }\n\n    function simplifyRadialDist(points, sqTolerance) {\n      var prevPoint = points[0],\n          newPoints = [prevPoint],\n          point;\n\n      for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n          newPoints.push(point);\n          prevPoint = point;\n        }\n      }\n\n      if (prevPoint !== point) newPoints.push(point);\n      return newPoints;\n    }\n\n    function simplifyDPStep(points, first, last, sqTolerance, simplified) {\n      var maxSqDist = sqTolerance,\n          index;\n\n      for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n          index = i;\n          maxSqDist = sqDist;\n        }\n      }\n\n      if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n      }\n    }\n\n    function simplifyDouglasPeucker(points, sqTolerance) {\n      var last = points.length - 1;\n      var simplified = [points[0]];\n      simplifyDPStep(points, 0, last, sqTolerance, simplified);\n      simplified.push(points[last]);\n      return simplified;\n    }\n\n    function simplify(points, tolerance, highestQuality) {\n      if (points.length <= 2) return points;\n      var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n      points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n      points = simplifyDouglasPeucker(points, sqTolerance);\n      return points;\n    }\n\n    {\n      module.exports = simplify;\n      module.exports.default = simplify;\n    }\n  })();\n});\n\nvar options$3 = {\n  'smoothness': 0,\n  'enableClip': true,\n  'enableSimplify': true,\n  'simplifyTolerance': 2,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 1,\n    'opacity': 1\n  }\n};\n\nvar Path = function (_Geometry) {\n  _inheritsLoose(Path, _Geometry);\n\n  function Path() {\n    return _Geometry.apply(this, arguments) || this;\n  }\n\n  var _proto = Path.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var extent = this.getExtent();\n    return new Polygon(extent.toArray(), {\n      symbol: {\n        'lineWidth': 1,\n        'lineColor': '6b707b'\n      }\n    });\n  };\n\n  _proto.animateShow = function animateShow(options, cb) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._showPlayer) {\n      this._showPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      options = {};\n      cb = options;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates.length === 0) {\n      return this;\n    }\n\n    this._animIdx = 0;\n    this._animLenSoFar = 0;\n    this.show();\n    var isPolygon = !!this.getShell;\n    var animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n\n    var projection = this._getProjection();\n\n    var prjAnimCoords = projection.projectCoords(animCoords);\n    this._prjAniShowCenter = this._getPrjExtent().getCenter();\n    this._aniShowCenter = projection.unproject(this._prjAniShowCenter);\n    var duration = options['duration'] || 1000,\n        easing = options['easing'] || 'out';\n    this.setCoordinates([]);\n    var length = 0;\n\n    for (var i = 1; i < prjAnimCoords.length; i++) {\n      length += prjAnimCoords[i].distanceTo(prjAnimCoords[i - 1]);\n    }\n\n    var player = this._showPlayer = Animation.animate({\n      't': duration\n    }, {\n      'duration': duration,\n      'easing': easing\n    }, function (frame) {\n      if (!_this.getMap()) {\n        if (player.playState !== 'finished') {\n          player.finish();\n\n          if (cb) {\n            var _coordinates = _this.getCoordinates();\n\n            cb(frame, _coordinates[_coordinates.length - 1]);\n          }\n        }\n\n        return;\n      }\n\n      var currentCoord = _this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords, prjAnimCoords);\n\n      if (frame.state.playState === 'finished') {\n        delete _this._showPlayer;\n        delete _this._aniShowCenter;\n        delete _this._prjAniShowCenter;\n        delete _this._animIdx;\n        delete _this._animLenSoFar;\n        delete _this._animTailRatio;\n\n        _this.setCoordinates(coordinates);\n      }\n\n      if (cb) {\n        cb(frame, currentCoord);\n      }\n    }, this);\n    player.play();\n    return player;\n  };\n\n  _proto._drawAnimShowFrame = function _drawAnimShowFrame(t, duration, length, coordinates, prjCoords) {\n    if (t === 0) {\n      return coordinates[0];\n    }\n\n    var projection = this._getProjection();\n\n    var targetLength = t / duration * length;\n    var segLen = 0;\n    var i, l;\n\n    for (i = this._animIdx, l = prjCoords.length; i < l - 1; i++) {\n      segLen = prjCoords[i].distanceTo(prjCoords[i + 1]);\n\n      if (this._animLenSoFar + segLen > targetLength) {\n        break;\n      }\n\n      this._animLenSoFar += segLen;\n    }\n\n    this._animIdx = i;\n\n    if (this._animIdx >= l - 1) {\n      this.setCoordinates(coordinates);\n      return coordinates[coordinates.length - 1];\n    }\n\n    var idx = this._animIdx;\n    var p1 = prjCoords[idx],\n        p2 = prjCoords[idx + 1],\n        span = targetLength - this._animLenSoFar,\n        r = span / segLen;\n    this._animTailRatio = r;\n    var x = p1.x + (p2.x - p1.x) * r,\n        y = p1.y + (p2.y - p1.y) * r,\n        lastCoord = new Coordinate(x, y);\n    var targetCoord = projection.unproject(lastCoord);\n    var isPolygon = !!this.getShell;\n\n    if (!isPolygon && this.options['smoothness'] > 0) {\n      var animCoords = coordinates.slice(0, this._animIdx + 3);\n      this.setCoordinates(animCoords);\n      var prjAnimCoords = prjCoords.slice(0, this._animIdx + 3);\n\n      this._setPrjCoordinates(prjAnimCoords);\n    } else {\n      var _animCoords = coordinates.slice(0, this._animIdx + 1);\n\n      _animCoords.push(targetCoord);\n\n      var _prjAnimCoords = prjCoords.slice(0, this._animIdx + 1);\n\n      _prjAnimCoords.push(lastCoord);\n\n      if (isPolygon) {\n        this.setCoordinates([this._aniShowCenter].concat(_animCoords));\n\n        this._setPrjCoordinates([this._prjAniShowCenter].concat(_prjAnimCoords));\n      } else {\n        this.setCoordinates(_animCoords);\n\n        this._setPrjCoordinates(_prjAnimCoords);\n      }\n    }\n\n    return targetCoord;\n  };\n\n  _proto._getCenterInExtent = function _getCenterInExtent(extent, coordinates, clipFn) {\n    var meExtent = this.getExtent();\n\n    if (!extent.intersects(meExtent)) {\n      return null;\n    }\n\n    var clipped = clipFn(coordinates, extent);\n\n    if (clipped.length === 0) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    clipped.forEach(function (part) {\n      if (Array.isArray(part)) {\n        part.forEach(function (c) {\n          if (c.point) {\n            c = c.point;\n          }\n\n          sumx += c.x;\n          sumy += c.y;\n          counter++;\n        });\n      } else {\n        if (part.point) {\n          part = part.point;\n        }\n\n        sumx += part.x;\n        sumy += part.y;\n        counter++;\n      }\n    });\n\n    var c = new Coordinate(sumx, sumy)._multi(1 / counter);\n\n    c.count = counter;\n    return c;\n  };\n\n  _proto._getPath2DPoints = function _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n    if (!isArrayHasData(prjCoords)) {\n      return [];\n    }\n\n    var map = this.getMap(),\n        isSimplify = !disableSimplify && this._shouldSimplify(),\n        tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n        isMulti = Array.isArray(prjCoords[0]);\n\n    delete this._simplified;\n\n    if (isSimplify && !isMulti) {\n      var count = prjCoords.length;\n      prjCoords = simplify(prjCoords, tolerance, false);\n      this._simplified = prjCoords.length < count;\n    }\n\n    if (isNil(zoom)) {\n      zoom = map.getZoom();\n    }\n\n    return forEachCoord(prjCoords, function (c) {\n      return map._prjToPoint(c, zoom);\n    });\n  };\n\n  _proto._shouldSimplify = function _shouldSimplify() {\n    var layer = this.getLayer(),\n        properties = this.getProperties();\n    var hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n    return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjPoints) {\n    this._prjCoords = prjPoints;\n    this.onShapeChanged();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    this._verifyProjection();\n\n    if (!this._prjCoords && this._getProjection()) {\n      this._prjCoords = this._projectCoords(this._coordinates);\n    }\n\n    return this._prjCoords;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (!projection) {\n      return;\n    }\n\n    if (this._prjCoords) {\n      this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._prjCoords = null;\n\n    _Geometry.prototype._clearProjection.call(this);\n  };\n\n  _proto._projectCoords = function _projectCoords(points) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.projectCoords(points);\n    }\n\n    return [];\n  };\n\n  _proto._unprojectCoords = function _unprojectCoords(prjPoints) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.unprojectCoords(prjPoints);\n    }\n\n    return [];\n  };\n\n  _proto._computeCenter = function _computeCenter() {\n    var ring = this._coordinates;\n\n    if (!isArrayHasData(ring)) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    var size = ring.length;\n\n    for (var i = 0; i < size; i++) {\n      if (ring[i]) {\n        if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n          sumx += ring[i].x;\n          sumy += ring[i].y;\n          counter++;\n        }\n      }\n    }\n\n    return new Coordinate(sumx / counter, sumy / counter);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    var shell = this._coordinates;\n\n    if (!isArrayHasData(shell)) {\n      return null;\n    }\n\n    var rings = [shell];\n\n    if (this.hasHoles && this.hasHoles()) {\n      rings.push.apply(rings, this.getHoles());\n    }\n\n    return this._coords2Extent(rings, this._getProjection());\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    var coords = [this._getPrjCoordinates()];\n\n    if (this.hasHoles && this.hasHoles()) {\n      coords.push.apply(coords, this._getPrjHoles());\n    }\n\n    return this._coords2Extent(coords);\n  };\n\n  _proto._get2DLength = function _get2DLength() {\n    var vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n\n    var len = 0;\n\n    for (var i = 1, l = vertexes.length; i < l; i++) {\n      len += vertexes[i].distanceTo(vertexes[i - 1]);\n    }\n\n    return len;\n  };\n\n  _proto._hitTestTolerance = function _hitTestTolerance() {\n    var symbol = this._getInternalSymbol();\n\n    var w;\n\n    if (Array.isArray(symbol)) {\n      w = 0;\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (isNumber(symbol[i]['lineWidth'])) {\n          if (symbol[i]['lineWidth'] > w) {\n            w = symbol[i]['lineWidth'];\n          }\n        }\n      }\n    } else {\n      w = symbol['lineWidth'];\n    }\n\n    return isNumber(w) ? w / 2 : 1.5;\n  };\n\n  _proto._coords2Extent = function _coords2Extent(coords, proj) {\n    var result = new Extent(proj);\n\n    for (var i = 0, l = coords.length; i < l; i++) {\n      for (var j = 0, ll = coords[i].length; j < ll; j++) {\n        result._combine(coords[i][j]);\n      }\n    }\n\n    return result;\n  };\n\n  return Path;\n}(Geometry);\n\nPath.mergeOptions(options$3);\n\nvar JSON_TYPE = 'Polygon';\n\nvar Polygon = function (_Path) {\n  _inheritsLoose(Polygon, _Path);\n\n  function Polygon(coordinates, opts) {\n    var _this;\n\n    _this = _Path.call(this, opts) || this;\n    _this.type = 'Polygon';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Polygon.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n      this._holes = null;\n\n      this._projectRings();\n\n      return this;\n    }\n\n    var rings = Coordinate.toCoordinates(coordinates);\n    var len = rings.length;\n\n    if (!Array.isArray(rings[0])) {\n      this._coordinates = this._trimRing(rings);\n    } else {\n      this._coordinates = this._trimRing(rings[0]);\n\n      if (len > 1) {\n        var holes = [];\n\n        for (var i = 1; i < len; i++) {\n          if (!rings[i]) {\n            continue;\n          }\n\n          holes.push(this._trimRing(rings[i]));\n        }\n\n        this._holes = holes;\n      }\n    }\n\n    this._projectRings();\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    if (!this._coordinates) {\n      return [];\n    }\n\n    var holes = this.getHoles();\n    var rings = [this._copyAndCloseRing(this._coordinates)];\n\n    for (var i = 0, l = holes.length; i < l; i++) {\n      rings.push(this._copyAndCloseRing(holes[i]));\n    }\n\n    return rings;\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n  };\n\n  _proto.getShell = function getShell() {\n    return this._coordinates || [];\n  };\n\n  _proto.getHoles = function getHoles() {\n    return this._holes || [];\n  };\n\n  _proto.hasHoles = function hasHoles() {\n    return this.getHoles().length > 0;\n  };\n\n  _proto._projectRings = function _projectRings() {\n    if (!this.getMap()) {\n      this.onShapeChanged();\n      return;\n    }\n\n    this._prjCoords = this._projectCoords(this._coordinates);\n    this._prjHoles = this._projectCoords(this._holes);\n    this.onShapeChanged();\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjCoords) {\n    this._prjCoords = prjCoords;\n    this.onShapeChanged();\n  };\n\n  _proto._cleanRing = function _cleanRing(ring) {\n    for (var i = ring.length - 1; i >= 0; i--) {\n      if (!ring[i]) {\n        ring.splice(i, 1);\n      }\n    }\n  };\n\n  _proto._checkRing = function _checkRing(ring) {\n    this._cleanRing(ring);\n\n    if (!ring || !isArrayHasData(ring)) {\n      return false;\n    }\n\n    var lastPoint = ring[ring.length - 1];\n    var isClose = true;\n\n    if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n      isClose = false;\n    }\n\n    return isClose;\n  };\n\n  _proto._trimRing = function _trimRing(ring) {\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && isClose) {\n      ring.splice(ring.length - 1, 1);\n    }\n\n    return ring;\n  };\n\n  _proto._copyAndCloseRing = function _copyAndCloseRing(ring) {\n    ring = ring.slice(0);\n\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && !isClose) {\n      ring.push(ring[0].copy());\n      return ring;\n    } else {\n      return ring;\n    }\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    if (this.getJSONType() === JSON_TYPE) {\n      return this._getPrjCoordinates();\n    }\n\n    this._verifyProjection();\n\n    if (this._getProjection() && !this._prjShell) {\n      this._prjShell = this._projectCoords(this.getShell());\n    }\n\n    return this._prjShell;\n  };\n\n  _proto._getPrjHoles = function _getPrjHoles() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (projection && !this._prjHoles) {\n      this._prjHoles = this._projectCoords(this.getHoles());\n    }\n\n    return this._prjHoles;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = 0;\n\n    for (var i = 0, len = rings.length; i < len; i++) {\n      result += measurer.measureLength(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = measurer.measureArea(rings[0]);\n\n    for (var i = 1, len = rings.length; i < len; i++) {\n      result -= measurer.measureArea(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    _Path.prototype._updateCache.call(this);\n\n    if (this._prjHoles) {\n      this._holes = this._unprojectCoords(this._getPrjHoles());\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._prjShell;\n    return _Path.prototype._clearCache.call(this);\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this._prjHoles) {\n      this._prjHoles = null;\n    }\n\n    if (this._prjShell) {\n      this._prjShell = null;\n    }\n\n    _Path.prototype._clearProjection.call(this);\n  };\n\n  return Polygon;\n}(Path);\n\nPolygon.registerJSONType(JSON_TYPE);\n\nfunction CenterMixin (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.getCoordinates = function getCoordinates() {\n      return this._coordinates;\n    };\n\n    _proto.setCoordinates = function setCoordinates(coordinates) {\n      var center = coordinates instanceof Coordinate ? coordinates : new Coordinate(coordinates);\n\n      if (center.equals(this._coordinates)) {\n        return this;\n      }\n\n      this._coordinates = center;\n\n      if (!this.getMap()) {\n        this.onPositionChanged();\n        return this;\n      }\n\n      var projection = this._getProjection();\n\n      this._setPrjCoordinates(projection.project(this._coordinates));\n\n      return this;\n    };\n\n    _proto._getCenter2DPoint = function _getCenter2DPoint(zoom) {\n      var map = this.getMap();\n\n      if (!map) {\n        return null;\n      }\n\n      var z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n\n      var pcenter = this._getPrjCoordinates();\n\n      if (!pcenter) {\n        return null;\n      }\n\n      return map._prjToPoint(pcenter, z);\n    };\n\n    _proto._getPrjCoordinates = function _getPrjCoordinates() {\n      var projection = this._getProjection();\n\n      this._verifyProjection();\n\n      if (!this._pcenter && projection) {\n        if (this._coordinates) {\n          this._pcenter = projection.project(this._coordinates);\n        }\n      }\n\n      return this._pcenter;\n    };\n\n    _proto._setPrjCoordinates = function _setPrjCoordinates(pcenter) {\n      this._pcenter = pcenter;\n      this.onPositionChanged();\n    };\n\n    _proto._updateCache = function _updateCache() {\n      this._clearCache();\n\n      var projection = this._getProjection();\n\n      if (this._pcenter && projection) {\n        this._coordinates = projection.unproject(this._pcenter);\n      }\n    };\n\n    _proto._clearProjection = function _clearProjection() {\n      this._pcenter = null;\n\n      _Base.prototype._clearProjection.call(this);\n    };\n\n    _proto._computeCenter = function _computeCenter() {\n      return this._coordinates ? this._coordinates.copy() : null;\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar options$4 = {\n  'symbol': {\n    'markerType': 'path',\n    'markerPath': [{\n      'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n      'fill': '#DE3333'\n    }],\n    'markerPathWidth': 16,\n    'markerPathHeight': 23,\n    'markerWidth': 24,\n    'markerHeight': 34\n  },\n  'hitTestForEvent': false\n};\n\nvar Marker = function (_CenterMixin) {\n  _inheritsLoose(Marker, _CenterMixin);\n\n  function Marker(coordinates, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, opts) || this;\n    _this.type = 'Point';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Marker.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var coord = this.getCoordinates();\n    var extent = painter.getContainerExtent();\n    var anchor = this.getMap().coordToContainerPoint(coord);\n    return new Marker(coord, {\n      'symbol': {\n        'markerType': 'square',\n        'markerWidth': extent.getWidth(),\n        'markerHeight': extent.getHeight(),\n        'markerLineWidth': 1,\n        'markerLineColor': '6b707b',\n        'markerFill': 'rgba(0, 0, 0, 0)',\n        'markerDx': extent.xmin - (anchor.x - extent.getWidth() / 2),\n        'markerDy': extent.ymin - (anchor.y - extent.getHeight() / 2)\n      }\n    });\n  };\n\n  _proto._isVectorMarker = function _isVectorMarker() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._canEdit = function _canEdit() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol) || ImageMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    var extent = this.getContainerExtent();\n\n    if (t) {\n      extent = extent.expand(t);\n    }\n\n    if (extent.contains(point)) {\n      if (this.options['hitTestForEvent']) {\n        return _CenterMixin.prototype._containsPoint.call(this, point, t);\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return computeExtent.call(this, 'getCenter');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return computeExtent.call(this, '_getPrjCoordinates');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    return 0;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  _proto._getSprite = function _getSprite(resources, canvasClass) {\n    if (this._getPainter()) {\n      return this._getPainter().getSprite(resources, canvasClass);\n    }\n\n    return new Painter(this).getSprite(resources, canvasClass);\n  };\n\n  return Marker;\n}(CenterMixin(Geometry));\n\nMarker.mergeOptions(options$4);\nMarker.registerJSONType('Marker');\n\nfunction computeExtent(fn) {\n  var coordinates = this[fn]();\n\n  if (!coordinates) {\n    return null;\n  }\n\n  return new Extent(coordinates, coordinates, this._getProjection());\n}\n\nvar options$5 = {\n  'arrowStyle': null,\n  'arrowPlacement': 'vertex-last'\n};\n\nvar LineString = function (_Path) {\n  _inheritsLoose(LineString, _Path);\n\n  function LineString(coordinates, options) {\n    var _this;\n\n    _this = _Path.call(this, options) || this;\n    _this.type = 'LineString';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = LineString.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n\n      this._setPrjCoordinates(null);\n\n      return this;\n    }\n\n    this._coordinates = Coordinate.toCoordinates(coordinates);\n\n    if (this.getMap()) {\n      this._setPrjCoordinates(this._projectCoords(this._coordinates));\n    } else {\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates || [];\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    return measurer.measureLength(this.getCoordinates());\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  return LineString;\n}(Path);\n\nLineString.mergeOptions(options$5);\nLineString.registerJSONType('LineString');\n\nvar GeometryCollection = function (_Geometry) {\n  _inheritsLoose(GeometryCollection, _Geometry);\n\n  function GeometryCollection(geometries, opts) {\n    var _this;\n\n    _this = _Geometry.call(this, opts) || this;\n    _this.type = 'GeometryCollection';\n\n    _this.setGeometries(geometries);\n\n    return _this;\n  }\n\n  var _proto = GeometryCollection.prototype;\n\n  _proto.setGeometries = function setGeometries(_geometries) {\n    var geometries = this._checkGeometries(_geometries || []);\n\n    var symbol = this._getSymbol();\n\n    var options = this.config();\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      geometries[i]._initOptions(options);\n\n      geometries[i]._setParent(this);\n\n      geometries[i]._setEventParent(this);\n\n      if (symbol) {\n        geometries[i].setSymbol(symbol);\n      }\n    }\n\n    this._geometries = geometries;\n\n    if (this.getLayer()) {\n      this._bindGeometriesToLayer();\n\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getGeometries = function getGeometries() {\n    return this._geometries || [];\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      if (!context) {\n        fn(geometries[i], i);\n      } else {\n        fn.call(context, geometries[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    if (!fn) {\n      return new GeometryCollection();\n    }\n\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return new GeometryCollection(selected);\n  };\n\n  _proto.translate = function translate(offset) {\n    if (!offset) {\n      return this;\n    }\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var args = arguments;\n    this.forEach(function (geometry) {\n      if (geometry && geometry.translate) {\n        geometry.translate.apply(geometry, args);\n      }\n    });\n    return this;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !isArrayHasData(this.getGeometries());\n  };\n\n  _proto.remove = function remove() {\n    this.forEach(function (geometry) {\n      geometry._unbind();\n    });\n    return Geometry.prototype.remove.apply(this, arguments);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n    this.forEach(function (geometry) {\n      geometry.show();\n    });\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n    this.forEach(function (geometry) {\n      geometry.hide();\n    });\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(config) {\n    this.forEach(function (geometry) {\n      geometry.config(config);\n    });\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = _Geometry.prototype.getSymbol.call(this);\n\n    if (!s) {\n      var symbols = [];\n      var is = false;\n      this.forEach(function (g) {\n        var symbol = g.getSymbol();\n\n        if (symbol && !is) {\n          is = true;\n        }\n\n        symbols.push(g.getSymbol());\n      });\n\n      if (is) {\n        s = {\n          'children': symbols\n        };\n      }\n    }\n\n    return s;\n  };\n\n  _proto.setSymbol = function setSymbol(s) {\n    if (s && s['children']) {\n      this._symbol = null;\n      this.forEach(function (g, i) {\n        g.setSymbol(s['children'][i]);\n      });\n    } else {\n      var symbol = this._prepareSymbol(s);\n\n      this._symbol = symbol;\n      this.forEach(function (g) {\n        g.setSymbol(symbol);\n      });\n    }\n\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    symbol = this._prepareSymbol(symbol);\n    this._externSymbol = symbol;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(symbol);\n    });\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._bindLayer = function _bindLayer() {\n    _Geometry.prototype._bindLayer.apply(this, arguments);\n\n    this._bindGeometriesToLayer();\n  };\n\n  _proto._bindGeometriesToLayer = function _bindGeometriesToLayer() {\n    var layer = this.getLayer();\n    this.forEach(function (geometry) {\n      geometry._bindLayer(layer);\n    });\n  };\n\n  _proto._checkGeometries = function _checkGeometries(geometries) {\n    var invalidGeoError = 'The geometry added to collection is invalid.';\n\n    if (geometries && !Array.isArray(geometries)) {\n      if (geometries instanceof Geometry) {\n        return [geometries];\n      } else {\n        throw new Error(invalidGeoError);\n      }\n    } else {\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!this._checkGeo(geometries[i])) {\n          throw new Error(invalidGeoError + ' Index: ' + i);\n        }\n      }\n\n      return geometries;\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof Geometry;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    if (this.isEmpty()) {\n      return;\n    }\n\n    this.forEach(function (geometry) {\n      if (geometry && geometry._updateCache) {\n        geometry._updateCache();\n      }\n    });\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n    this.forEach(function (geometry) {\n      geometry._removePainter();\n    });\n  };\n\n  _proto._computeCenter = function _computeCenter(projection) {\n    if (!projection || this.isEmpty()) {\n      return null;\n    }\n\n    var sumX = 0,\n        sumY = 0,\n        counter = 0;\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      var center = geometries[i]._computeCenter(projection);\n\n      if (center) {\n        sumX += center.x;\n        sumY += center.y;\n        counter++;\n      }\n    }\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumX / counter, sumY / counter);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    if (this.isEmpty()) {\n      return false;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (geometries[i]._containsPoint(point, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._computeExtent = function _computeExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computeExtent');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computePrjExtent');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicLength(projection);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicArea(projection);\n    }\n\n    return result;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var children = [];\n\n    if (!this.isEmpty()) {\n      var geometries = this.getGeometries();\n\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!geometries[i]) {\n          continue;\n        }\n\n        children.push(geometries[i]._exportGeoJSONGeometry());\n      }\n    }\n\n    return {\n      'type': 'GeometryCollection',\n      'geometries': children\n    };\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      geometries[i]._clearProjection();\n    }\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var extent = this.getExtent();\n    var anchors = [new Coordinate(extent.xmin, extent.ymax), new Coordinate(extent.xmax, extent.ymin), new Coordinate(extent.xmin, extent.ymin), new Coordinate(extent.xmax, extent.ymax)];\n    return anchors;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    if (this.isEmpty()) {\n      return [];\n    }\n\n    var geometries = this.getGeometries(),\n        resources = [];\n    var cache = {};\n    var symbol, res, key;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      symbol = geometries[i]._getInternalSymbol();\n      res = getExternalResources(symbol);\n\n      for (var ii = 0, ll = res.length; ii < ll; ii++) {\n        key = res[ii].join();\n\n        if (!cache[key]) {\n          resources.push(res[ii]);\n          cache[key] = 1;\n        }\n      }\n    }\n\n    return resources;\n  };\n\n  _proto.startEdit = function startEdit(opts) {\n    var _this2 = this;\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (opts['symbol']) {\n      this._originalSymbol = this.getSymbol();\n      this.setSymbol(opts['symbol']);\n    }\n\n    this._draggbleBeforeEdit = this.options['draggable'];\n    this.config('draggable', false);\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].startEdit(opts);\n    }\n\n    this._editing = true;\n    this.hide();\n    setTimeout(function () {\n      _this2.fire('editstart');\n    }, 1);\n    return this;\n  };\n\n  _proto.endEdit = function endEdit() {\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].endEdit();\n    }\n\n    if (this._originalSymbol) {\n      this.setSymbol(this._originalSymbol);\n      delete this._originalSymbol;\n    }\n\n    this._editing = false;\n    this.show();\n    this.config('draggable', this._draggbleBeforeEdit);\n    this.fire('editend');\n    return this;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (!this._editing) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return GeometryCollection;\n}(Geometry);\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nfunction computeExtent$1(projection, fn) {\n  if (this.isEmpty()) {\n    return null;\n  }\n\n  var geometries = this.getGeometries();\n  var result = null;\n\n  for (var i = 0, l = geometries.length; i < l; i++) {\n    var geo = geometries[i];\n\n    if (!geo) {\n      continue;\n    }\n\n    var geoExtent = geo[fn](projection);\n\n    if (geoExtent) {\n      result = geoExtent.combine(result);\n    }\n  }\n\n  return result;\n}\n\nvar MultiGeometry = function (_GeometryCollection) {\n  _inheritsLoose(MultiGeometry, _GeometryCollection);\n\n  function MultiGeometry(geoType, type, data, options) {\n    var _this;\n\n    _this = _GeometryCollection.call(this, null, options) || this;\n    _this.GeometryType = geoType;\n    _this.type = type;\n\n    _this._initData(data);\n\n    return _this;\n  }\n\n  var _proto = MultiGeometry.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    var coordinates = [];\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var child = geometries[i];\n      coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n    }\n\n    return coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    coordinates = coordinates || [];\n    var geometries = [];\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var g = new this.GeometryType(coordinates[i], this.config());\n      geometries.push(g);\n    }\n\n    this.setGeometries(geometries);\n    return this;\n  };\n\n  _proto._initData = function _initData(data) {\n    data = data || [];\n\n    if (data.length) {\n      if (data[0] instanceof this.GeometryType) {\n        this.setGeometries(data);\n      } else {\n        this.setCoordinates(data);\n      }\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof this.GeometryType;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  return MultiGeometry;\n}(GeometryCollection);\n\nvar MultiPoint = function (_MultiGeometry) {\n  _inheritsLoose(MultiPoint, _MultiGeometry);\n\n  function MultiPoint(data, opts) {\n    return _MultiGeometry.call(this, Marker, 'MultiPoint', data, opts) || this;\n  }\n\n  var _proto = MultiPoint.prototype;\n\n  _proto.findClosest = function findClosest(coordinate) {\n    if (!coordinate) {\n      return null;\n    }\n\n    var coords = this.getCoordinates();\n    var hit = null;\n    var max = Infinity;\n    coords.forEach(function (c) {\n      var dist = distanceTo(c, coordinate);\n\n      if (dist < max) {\n        hit = c;\n        max = dist;\n      }\n    });\n    return hit;\n  };\n\n  return MultiPoint;\n}(MultiGeometry);\n\nMultiPoint.registerJSONType('MultiPoint');\n\nfunction distanceTo(p0, p1) {\n  var x = p1.x - p0.x,\n      y = p1.y - p0.y;\n  return Math.sqrt(x * x + y * y);\n}\n\nvar MultiPath = function (_MultiGeometry) {\n  _inheritsLoose(MultiPath, _MultiGeometry);\n\n  function MultiPath() {\n    return _MultiGeometry.apply(this, arguments) || this;\n  }\n\n  var _proto = MultiPath.prototype;\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    var children = this.getGeometries();\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    children.forEach(function (l) {\n      var c = l.getCenterInExtent(extent);\n\n      if (c) {\n        sumx += c.x * c.count;\n        sumy += c.y * c.count;\n        counter += c.count;\n      }\n    });\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumx, sumy)._multi(1 / counter);\n  };\n\n  return MultiPath;\n}(MultiGeometry);\n\nvar MultiLineString = function (_MultiPath) {\n  _inheritsLoose(MultiLineString, _MultiPath);\n\n  function MultiLineString(data, options) {\n    return _MultiPath.call(this, LineString, 'MultiLineString', data, options) || this;\n  }\n\n  return MultiLineString;\n}(MultiPath);\n\nMultiLineString.registerJSONType('MultiLineString');\n\nvar MultiPolygon = function (_MultiPath) {\n  _inheritsLoose(MultiPolygon, _MultiPath);\n\n  function MultiPolygon(data, opts) {\n    return _MultiPath.call(this, Polygon, 'MultiPolygon', data, opts) || this;\n  }\n\n  return MultiPolygon;\n}(MultiPath);\n\nMultiPolygon.registerJSONType('MultiPolygon');\n\nvar types$1 = {\n  'Marker': Marker,\n  'LineString': LineString,\n  'Polygon': Polygon,\n  'MultiPoint': MultiPoint,\n  'MultiLineString': MultiLineString,\n  'MultiPolygon': MultiPolygon\n};\nvar GeoJSON = {\n  toGeometry: function toGeometry(geoJSON, foreachFn) {\n    if (isString(geoJSON)) {\n      geoJSON = parseJSON(geoJSON);\n    }\n\n    if (Array.isArray(geoJSON)) {\n      var resultGeos = [];\n\n      for (var i = 0, len = geoJSON.length; i < len; i++) {\n        var geo = GeoJSON._convert(geoJSON[i], foreachFn);\n\n        if (Array.isArray(geo)) {\n          pushIn(resultGeos, geo);\n        } else {\n          resultGeos.push(geo);\n        }\n      }\n\n      return resultGeos;\n    } else {\n      var resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n\n      return resultGeo;\n    }\n  },\n  _convert: function _convert(json, foreachFn) {\n    if (!json || isNil(json['type'])) {\n      return null;\n    }\n\n    var type = json['type'];\n\n    if (type === 'Feature') {\n      var g = json['geometry'];\n\n      var geometry = GeoJSON._convert(g);\n\n      if (!geometry) {\n        return null;\n      }\n\n      geometry.setId(json['id']);\n      geometry.setProperties(json['properties']);\n\n      if (foreachFn) {\n        foreachFn(geometry);\n      }\n\n      return geometry;\n    } else if (type === 'FeatureCollection') {\n      var features = json['features'];\n\n      if (!features) {\n        return null;\n      }\n\n      return GeoJSON.toGeometry(features, foreachFn);\n    } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n      var clazz = type === 'Point' ? 'Marker' : type;\n      var result = new types$1[clazz](json['coordinates']);\n\n      if (foreachFn) {\n        foreachFn(result);\n      }\n\n      return result;\n    } else if (type === 'GeometryCollection') {\n      var geometries = json['geometries'];\n\n      if (!isArrayHasData(geometries)) {\n        var _result2 = new GeometryCollection();\n\n        if (foreachFn) {\n          foreachFn(_result2);\n        }\n\n        return _result2;\n      }\n\n      var mGeos = [];\n      var size = geometries.length;\n\n      for (var i = 0; i < size; i++) {\n        mGeos.push(GeoJSON._convert(geometries[i]));\n      }\n\n      var _result = new GeometryCollection(mGeos);\n\n      if (foreachFn) {\n        foreachFn(_result);\n      }\n\n      return _result;\n    }\n\n    return null;\n  }\n};\n\nvar options$6 = {\n  'numberOfShellPoints': 60\n};\n\nvar Circle = function (_CenterMixin) {\n  _inheritsLoose(Circle, _CenterMixin);\n\n  Circle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var circle = new Circle(json['coordinates'], json['radius'], json['options']);\n    circle.setProperties(feature['properties']);\n    return circle;\n  };\n\n  function Circle(coordinates, radius, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._radius = radius;\n    return _this;\n  }\n\n  var _proto = Circle.prototype;\n\n  _proto.getRadius = function getRadius() {\n    return this._radius;\n  };\n\n  _proto.setRadius = function setRadius(radius) {\n    this._radius = radius;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        radius = this.getRadius();\n\n    var shell = [];\n    var rad, dx, dy;\n\n    for (var i = 0, len = numberOfPoints - 1; i < len; i++) {\n      rad = 360 * i / len * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(shell[0]);\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        size = this.getSize(),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        se = center.add(size.width / 2, size.height / 2);\n\n    return withInEllipse(point, center, se, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var minmax = this._getMinMax(projection);\n\n    if (!minmax) {\n      return null;\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pminmax = minmax.map(function (c) {\n      return projection.project(c);\n    });\n    var leftx = pminmax[0].x - pcenter.x;\n    var rightx = pminmax[1].x - pcenter.x;\n    var topy = pminmax[2].y - pcenter.y;\n    var bottomy = pminmax[3].y - pcenter.y;\n    return new Extent(pcenter.add(leftx, topy), pcenter.add(rightx, bottomy));\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var minmax = this._getMinMax(measurer);\n\n    if (!minmax) {\n      return null;\n    }\n\n    return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._radius)) {\n      return null;\n    }\n\n    var radius = this._radius;\n    var p1 = measurer.locate(this._coordinates, -radius, 0),\n        p2 = measurer.locate(this._coordinates, radius, 0),\n        p3 = measurer.locate(this._coordinates, 0, radius),\n        p4 = measurer.locate(this._coordinates, 0, -radius);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2);\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var center = this.getCenter();\n    var opts = extend({}, options);\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Circle',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius()\n    };\n  };\n\n  return Circle;\n}(CenterMixin(Polygon));\n\nCircle.mergeOptions(options$6);\nCircle.registerJSONType('Circle');\n\nvar options$7 = {\n  'numberOfShellPoints': 80\n};\n\nvar Ellipse = function (_CenterMixin) {\n  _inheritsLoose(Ellipse, _CenterMixin);\n\n  Ellipse.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n    ellipse.setProperties(feature['properties']);\n    return ellipse;\n  };\n\n  function Ellipse(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this.width = width;\n    _this.height = height;\n    return _this;\n  }\n\n  var _proto = Ellipse.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this.width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this.width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this.height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this.height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        width = this.getWidth(),\n        height = this.getHeight();\n\n    var shell = [];\n    var s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n        sx = Math.pow(width / 2, 2),\n        sy = Math.pow(height / 2, 2);\n    var deg, rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      deg = 360 * i / numberOfPoints;\n      rad = deg * Math.PI / 180;\n      dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n      dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n\n      if (deg > 90 && deg < 270) {\n        dx *= -1;\n      }\n\n      if (deg > 180 && deg < 360) {\n        dy *= -1;\n      }\n\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var projection = map.getProjection();\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n        p0 = map._prjToContainerPoint(pps[0]),\n        p1 = map._prjToContainerPoint(pps[1]);\n\n    return withInEllipse(point, p0, p1, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return Circle.prototype._computePrjExtent.apply(this, arguments);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return Circle.prototype._computeExtent.apply(this, arguments);\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var p1 = measurer.locate(this._coordinates, -width / 2, 0),\n        p2 = measurer.locate(this._coordinates, width / 2, 0),\n        p3 = measurer.locate(this._coordinates, 0, -height / 2),\n        p4 = measurer.locate(this._coordinates, 0, height / 2);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    var longer = this.width > this.height ? this.width : this.height;\n    return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    return Math.PI * this.width * this.height / 4;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Ellipse',\n      'coordinates': [center.x, center.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Ellipse;\n}(CenterMixin(Polygon));\n\nEllipse.mergeOptions(options$7);\nEllipse.registerJSONType('Ellipse');\n\nvar Rectangle = function (_Polygon) {\n  _inheritsLoose(Rectangle, _Polygon);\n\n  Rectangle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n    rect.setProperties(feature['properties']);\n    return rect;\n  };\n\n  function Rectangle(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _Polygon.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._width = width;\n    _this._height = height;\n    return _this;\n  }\n\n  var _proto = Rectangle.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(nw) {\n    this._coordinates = nw instanceof Coordinate ? nw : new Coordinate(nw);\n\n    if (!this._coordinates || !this.getMap()) {\n      this.onPositionChanged();\n      return this;\n    }\n\n    var projection = this._getProjection();\n\n    this._setPrjCoordinates(projection.project(this._coordinates));\n\n    return this;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer();\n\n    var nw = this._coordinates;\n    var map = this.getMap();\n    var sx = 1,\n        sy = -1;\n\n    if (map) {\n      var fExt = map.getFullExtent();\n\n      if (fExt['left'] > fExt['right']) {\n        sx = -1;\n      }\n\n      if (fExt['bottom'] > fExt['top']) {\n        sy = 1;\n      }\n    }\n\n    var points = [];\n    points.push(nw);\n    points.push(measurer.locate(nw, sx * this._width, 0));\n    points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n    points.push(measurer.locate(nw, 0, sy * this._height));\n    points.push(nw);\n    return points;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._pnw && projection) {\n      if (this._coordinates) {\n        this._pnw = projection.project(this._coordinates);\n      }\n    }\n\n    return this._pnw;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(pnw) {\n    this._pnw = pnw;\n    this.onPositionChanged();\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    var shell = _Polygon.prototype._getPrjShell.call(this);\n\n    var projection = this._getProjection();\n\n    if (!projection.isSphere()) {\n      return shell;\n    }\n\n    var sphereExtent = projection.getSphereExtent(),\n        sx = sphereExtent.sx,\n        sy = sphereExtent.sy;\n\n    var circum = this._getProjection().getCircum();\n\n    var nw = shell[0];\n\n    for (var i = 1, l = shell.length; i < l; i++) {\n      var p = shell[i];\n      var dx = 0,\n          dy = 0;\n\n      if (sx * (nw.x - p.x) > 0) {\n        dx = circum.x * sx;\n      }\n\n      if (sy * (nw.y - p.y) < 0) {\n        dy = circum.y * sy;\n      }\n\n      shell[i]._add(dx, dy);\n    }\n\n    return shell;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (this._pnw && projection) {\n      this._coordinates = projection.unproject(this._pnw);\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._pnw = null;\n\n    _Polygon.prototype._clearProjection.call(this);\n  };\n\n  _proto._computeCenter = function _computeCenter(measurer) {\n    return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Polygon.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        r = map._getResolution() * t;\n\n    var extent = this._getPrjExtent().expand(r);\n\n    var p = map._containerPointToPrj(point);\n\n    return extent.contains(p);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var se = this._getSouthEast(projection);\n\n    if (!se) {\n      return null;\n    }\n\n    var prjs = projection.projectCoords([new Coordinate(this._coordinates.x, se.y), new Coordinate(se.x, this._coordinates.y)]);\n    return new Extent(prjs[0], prjs[1]);\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var se = this._getSouthEast(measurer);\n\n    if (!se) {\n      return null;\n    }\n\n    return new Extent(this._coordinates, se, this._getProjection());\n  };\n\n  _proto._getSouthEast = function _getSouthEast(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var w = width,\n        h = -height;\n\n    if (measurer.fullExtent) {\n      var fullExtent = measurer.fullExtent,\n          sx = fullExtent.right > fullExtent.left ? 1 : -1,\n          sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n      w *= sx;\n      h *= sy;\n    }\n\n    var se = measurer.locate(this._coordinates, w, h);\n    return se;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return 2 * (this._width + this._height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return this._width * this._height;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var nw = this.getCoordinates();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Rectangle',\n      'coordinates': [nw.x, nw.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Rectangle;\n}(Polygon);\n\nRectangle.registerJSONType('Rectangle');\n\nvar options$8 = {\n  'numberOfShellPoints': 60\n};\n\nvar Sector = function (_Circle) {\n  _inheritsLoose(Sector, _Circle);\n\n  Sector.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n    sector.setProperties(feature['properties']);\n    return sector;\n  };\n\n  function Sector(coordinates, radius, startAngle, endAngle, opts) {\n    var _this;\n\n    _this = _Circle.call(this, coordinates, radius, opts) || this;\n    _this.startAngle = startAngle;\n    _this.endAngle = endAngle;\n    return _this;\n  }\n\n  var _proto = Sector.prototype;\n\n  _proto.getStartAngle = function getStartAngle() {\n    return this.startAngle;\n  };\n\n  _proto.setStartAngle = function setStartAngle(startAngle) {\n    this.startAngle = startAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getEndAngle = function getEndAngle() {\n    return this.endAngle;\n  };\n\n  _proto.setEndAngle = function setEndAngle(endAngle) {\n    this.endAngle = endAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'] - 2,\n        radius = this.getRadius(),\n        shell = [center.copy()],\n        startAngle = this.getStartAngle(),\n        angle = this.getEndAngle() - startAngle;\n\n    var rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(center.copy());\n    return shell;\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Circle.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        size = this.getSize(),\n        pc = center,\n        pp = point,\n        x = pp.x - pc.x,\n        y = pc.y - pp.y,\n        atan2 = Math.atan2(y, x),\n        angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) : atan2 * 360 / (2 * Math.PI);\n\n    var sAngle = this.startAngle % 360,\n        eAngle = this.endAngle % 360;\n    var between = false;\n\n    if (sAngle > eAngle) {\n      between = !(angle > eAngle && angle < sAngle);\n    } else {\n      between = angle >= sAngle && angle <= eAngle;\n    }\n\n    return pp.distanceTo(pc) <= size.width / 2 + t && between;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Sector',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius(),\n      'startAngle': this.getStartAngle(),\n      'endAngle': this.getEndAngle()\n    };\n  };\n\n  return Sector;\n}(Circle);\n\nSector.mergeOptions(options$8);\nSector.registerJSONType('Sector');\n\nvar options$9 = {\n  'enableSimplify': false,\n  'enableClip': false\n};\n\nvar Curve = function (_LineString) {\n  _inheritsLoose(Curve, _LineString);\n\n  function Curve() {\n    return _LineString.apply(this, arguments) || this;\n  }\n\n  var _proto = Curve.prototype;\n\n  _proto._arc = function _arc(ctx, points, lineOpacity) {\n    var degree = this.options['arcDegree'] * Math.PI / 180;\n\n    for (var i = 1, l = points.length; i < l; i++) {\n      var c = Canvas._arcBetween(ctx, points[i - 1], points[i], degree);\n\n      var ctrlPoint = [points[i - 1].x + points[i].x - c[0], points[i - 1].y + points[i].y - c[1]];\n      points[i - 1].nextCtrlPoint = ctrlPoint;\n      points[i].prevCtrlPoint = ctrlPoint;\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n  };\n\n  _proto._quadraticCurve = function _quadraticCurve(ctx, points) {\n    if (points.length <= 2) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 2, l = points.length; i < l; i += 2) {\n      ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n    }\n\n    i -= 1;\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._bezierCurve = function _bezierCurve(ctx, points) {\n    if (points.length <= 3) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 1, l = points.length; i + 2 < l; i += 3) {\n      ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n    }\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._getCurveArrowPoints = function _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n    var l = segments.length;\n    var i;\n\n    for (i = step; i < l; i += step) {\n      var arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n\n    i -= step;\n\n    if (i < l - 1) {\n      for (i += 1; i < l; i++) {\n        var _arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      }\n    }\n  };\n\n  return Curve;\n}(LineString);\n\nCurve.mergeOptions(options$9);\n\nvar options$a = {\n  'arcDegree': 90\n};\n\nvar ArcCurve = function (_Curve) {\n  _inheritsLoose(ArcCurve, _Curve);\n\n  function ArcCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  var _proto = ArcCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'ArcCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n\n    this._arc(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  ArcCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n    arc.setProperties(feature['properties']);\n    return arc;\n  };\n\n  return ArcCurve;\n}(Curve);\n\nArcCurve.registerJSONType('ArcCurve');\nArcCurve.mergeOptions(options$a);\n\nvar CubicBezierCurve = function (_Curve) {\n  _inheritsLoose(CubicBezierCurve, _Curve);\n\n  function CubicBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  CubicBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = CubicBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'CubicBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._bezierCurve(ctx, points);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n  };\n\n  return CubicBezierCurve;\n}(Curve);\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nvar QuadBezierCurve = function (_Curve) {\n  _inheritsLoose(QuadBezierCurve, _Curve);\n\n  function QuadBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  QuadBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = QuadBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'QuadBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._quadraticCurve(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n  };\n\n  return QuadBezierCurve;\n}(Curve);\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\n\nvar defaultSymbol$1 = {\n  'textFaceName': 'monospace',\n  'textSize': 12,\n  'textLineSpacing': 8,\n  'textWrapCharacter': '\\n',\n  'textHorizontalAlignment': 'middle',\n  'textVerticalAlignment': 'middle'\n};\nvar defaultBoxSymbol = {\n  'markerType': 'square',\n  'markerLineColor': '#000',\n  'markerLineWidth': 2,\n  'markerLineOpacity': 1,\n  'markerFill': '#fff',\n  'markerOpacity': 1\n};\n\nvar TextMarker = function (_Marker) {\n  _inheritsLoose(TextMarker, _Marker);\n\n  function TextMarker() {\n    return _Marker.apply(this, arguments) || this;\n  }\n\n  var _proto = TextMarker.prototype;\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this._content;\n    this._content = escapeSpecialChars(content);\n\n    this._refresh();\n\n    this._fireEvent('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    return this;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._refresh();\n  };\n\n  _proto.toJSON = function toJSON() {\n    var json = _Marker.prototype.toJSON.call(this);\n\n    delete json['symbol'];\n    return json;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (this._refreshing || !symbol) {\n      return _Marker.prototype.setSymbol.call(this, symbol);\n    }\n\n    var s = this._parseSymbol(symbol);\n\n    if (this.setTextStyle) {\n      var style = this.getTextStyle() || {};\n      style.symbol = s[0];\n      this.setTextStyle(style);\n    } else if (this.setTextSymbol) {\n      this.setTextSymbol(s[0]);\n    }\n\n    if (this.setBoxStyle) {\n      var _style = this.getBoxStyle() || {};\n\n      _style.symbol = s[1];\n      this.setBoxStyle(_style);\n    } else if (this.setBoxSymbol) {\n      this.setBoxSymbol(s[1]);\n    }\n\n    return this;\n  };\n\n  _proto._parseSymbol = function _parseSymbol(symbol) {\n    var t = {};\n    var b = {};\n\n    for (var p in symbol) {\n      if (hasOwn(symbol, p)) {\n        if (p.indexOf('text') === 0) {\n          t[p] = symbol[p];\n        } else {\n          b[p] = symbol[p];\n        }\n      }\n    }\n\n    return [t, b];\n  };\n\n  _proto._getTextSize = function _getTextSize(symbol) {\n    return splitTextToRow(this._content, symbol)['size'];\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    return this._symbol;\n  };\n\n  _proto._getDefaultTextSymbol = function _getDefaultTextSymbol() {\n    return extend({}, defaultSymbol$1);\n  };\n\n  _proto._getDefaultBoxSymbol = function _getDefaultBoxSymbol() {\n    return extend({}, defaultBoxSymbol);\n  };\n\n  _proto._getDefaultPadding = function _getDefaultPadding() {\n    return [12, 8];\n  };\n\n  return TextMarker;\n}(Marker);\n\nvar options$b = {\n  'textStyle': {\n    'wrap': true,\n    'padding': [12, 8],\n    'verticalAlignment': 'middle',\n    'horizontalAlignment': 'middle'\n  },\n  'boxSymbol': null\n};\n\nvar TextBox = function (_TextMarker) {\n  _inheritsLoose(TextBox, _TextMarker);\n\n  function TextBox(content, coordinates, width, height, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n    _this._content = escapeSpecialChars(content);\n    _this._width = isNil(width) ? 100 : width;\n    _this._height = isNil(height) ? 40 : height;\n\n    if (options.boxSymbol) {\n      _this.setBoxSymbol(options.boxSymbol);\n    }\n\n    if (options.textStyle) {\n      _this.setTextStyle(options.textStyle);\n    }\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = TextBox.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getBoxSymbol = function getBoxSymbol() {\n    return extend({}, this.options.boxSymbol);\n  };\n\n  _proto.setBoxSymbol = function setBoxSymbol(symbol) {\n    this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  _proto.getTextStyle = function getTextStyle() {\n    if (!this.options.textStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.textStyle);\n  };\n\n  _proto.setTextStyle = function setTextStyle(style) {\n    this.options.textStyle = style ? extend({}, style) : style;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  TextBox.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n    textBox.setProperties(feature['properties']);\n    textBox.setId(feature['id']);\n\n    if (json['symbol']) {\n      textBox.setSymbol(json['symbol']);\n    }\n\n    return textBox;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'width': this.getWidth(),\n      'height': this.getHeight(),\n      'subType': 'TextBox',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var textStyle = this.getTextStyle() || {},\n        padding = textStyle['padding'] || [12, 8],\n        maxWidth = this._width - 2 * padding[0],\n        maxHeight = this._height - 2 * padding[1];\n    var symbol = extend({}, textStyle.symbol || this._getDefaultTextSymbol(), this.options.boxSymbol || this._getDefaultBoxSymbol(), {\n      'textName': this._content,\n      'markerWidth': this._width,\n      'markerHeight': this._height,\n      'textHorizontalAlignment': 'middle',\n      'textVerticalAlignment': 'middle',\n      'textMaxWidth': maxWidth,\n      'textMaxHeight': maxHeight\n    });\n\n    if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n      symbol['textWrapWidth'] = maxWidth;\n    }\n\n    var hAlign = textStyle['horizontalAlignment'];\n    symbol['textDx'] = symbol['markerDx'] || 0;\n    var offsetX = symbol['markerWidth'] / 2 - padding[0];\n\n    if (hAlign === 'left') {\n      symbol['textHorizontalAlignment'] = 'right';\n      symbol['textDx'] = symbol['textDx'] - offsetX;\n    } else if (hAlign === 'right') {\n      symbol['textHorizontalAlignment'] = 'left';\n      symbol['textDx'] = symbol['textDx'] + offsetX;\n    }\n\n    var vAlign = textStyle['verticalAlignment'];\n    symbol['textDy'] = symbol['markerDy'] || 0;\n    var offsetY = symbol['markerHeight'] / 2 - padding[1];\n\n    if (vAlign === 'top') {\n      symbol['textVerticalAlignment'] = 'bottom';\n      symbol['textDy'] -= offsetY;\n    } else if (vAlign === 'bottom') {\n      symbol['textVerticalAlignment'] = 'top';\n      symbol['textDy'] += offsetY;\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  return TextBox;\n}(TextMarker);\n\nTextBox.mergeOptions(options$b);\nTextBox.registerJSONType('TextBox');\n\nvar options$c = {\n  'boxStyle': null,\n  textSymbol: null\n};\n\nvar Label = function (_TextMarker) {\n  _inheritsLoose(Label, _TextMarker);\n\n  function Label(content, coordinates, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n\n    if (options.textSymbol) {\n      _this.setTextSymbol(options.textSymbol);\n    }\n\n    if (options.boxStyle) {\n      _this.setBoxStyle(options.boxStyle);\n    }\n\n    _this._content = escapeSpecialChars(content);\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getBoxStyle = function getBoxStyle() {\n    if (!this.options.boxStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.boxStyle);\n  };\n\n  _proto.setBoxStyle = function setBoxStyle(style) {\n    this.options.boxStyle = style ? extend({}, style) : style;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getTextSymbol = function getTextSymbol() {\n    return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n  };\n\n  _proto.setTextSymbol = function setTextSymbol(symbol) {\n    this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n\n    this._refresh();\n\n    return this;\n  };\n\n  Label.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n    label.setProperties(feature['properties']);\n    label.setId(feature['id']);\n\n    if (json['symbol']) {\n      label.setSymbol(json['symbol']);\n    }\n\n    return label;\n  };\n\n  _proto._canEdit = function _canEdit() {\n    return false;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'Label',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var symbol = extend({}, this.getTextSymbol(), {\n      'textName': this._content\n    });\n    var boxStyle = this.getBoxStyle();\n\n    if (boxStyle) {\n      extend(symbol, boxStyle.symbol);\n\n      var sizes = this._getBoxSize(symbol),\n          textSize = sizes[1],\n          padding = boxStyle['padding'] || this._getDefaultPadding();\n\n      var boxSize = sizes[0];\n      symbol['markerWidth'] = boxSize['width'];\n      symbol['markerHeight'] = boxSize['height'];\n\n      var dx = symbol['textDx'] || 0,\n          dy = symbol['textDy'] || 0,\n          textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])._add(dx, dy);\n\n      var hAlign = boxStyle['horizontalAlignment'] || 'middle';\n      symbol['markerDx'] = textAlignPoint.x;\n\n      if (hAlign === 'left') {\n        symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n      } else if (hAlign === 'right') {\n        symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n      } else {\n        symbol['markerDx'] += textSize['width'] / 2;\n      }\n\n      var vAlign = boxStyle['verticalAlignment'] || 'middle';\n      symbol['markerDy'] = textAlignPoint.y;\n\n      if (vAlign === 'top') {\n        symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n      } else if (vAlign === 'bottom') {\n        symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1];\n      } else {\n        symbol['markerDy'] += textSize['height'] / 2;\n      }\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  _proto._getBoxSize = function _getBoxSize(symbol) {\n    if (!symbol['markerType']) {\n      symbol['markerType'] = 'square';\n    }\n\n    var boxStyle = this.getBoxStyle();\n\n    var size = this._getTextSize(symbol);\n\n    var width, height;\n\n    var padding = boxStyle['padding'] || this._getDefaultPadding();\n\n    width = size['width'] + padding[0] * 2;\n    height = size['height'] + padding[1] * 2;\n\n    if (boxStyle['minWidth']) {\n      if (!width || width < boxStyle['minWidth']) {\n        width = boxStyle['minWidth'];\n      }\n    }\n\n    if (boxStyle['minHeight']) {\n      if (!height || height < boxStyle['minHeight']) {\n        height = boxStyle['minHeight'];\n      }\n    }\n\n    return [new Size(width, height), size];\n  };\n\n  return Label;\n}(TextMarker);\n\nLabel.mergeOptions(options$c);\nLabel.registerJSONType('Label');\n\nvar Connectable = function Connectable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class._hasConnectors = function _hasConnectors(geometry) {\n      return !isNil(geometry.__connectors) && geometry.__connectors.length > 0;\n    };\n\n    _class._getConnectors = function _getConnectors(geometry) {\n      return geometry.__connectors;\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getConnectSource = function getConnectSource() {\n      return this._connSource;\n    };\n\n    _proto.setConnectSource = function setConnectSource(src) {\n      var target = this._connTarget;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n      this.onAdd();\n      return this;\n    };\n\n    _proto.getConnectTarget = function getConnectTarget() {\n      return this._connTarget;\n    };\n\n    _proto.setConnectTarget = function setConnectTarget(target) {\n      var src = this._connSource;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n\n      this._updateCoordinates();\n\n      this._registerEvents();\n\n      return this;\n    };\n\n    _proto._updateCoordinates = function _updateCoordinates() {\n      var map = this.getMap();\n\n      if (!map && this._connSource) {\n        map = this._connSource.getMap();\n      }\n\n      if (!map && this._connTarget) {\n        map = this._connTarget.getMap();\n      }\n\n      if (!map) {\n        return;\n      }\n\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      var srcPoints = this._connSource._getConnectPoints();\n\n      var targetPoints = this._connTarget._getConnectPoints();\n\n      var minDist = 0;\n      var oldCoordinates = this.getCoordinates();\n      var c1, c2;\n\n      for (var i = 0, len = srcPoints.length; i < len; i++) {\n        var p1 = srcPoints[i];\n\n        for (var j = 0, length = targetPoints.length; j < length; j++) {\n          var p2 = targetPoints[j];\n          var dist = map.computeLength(p1, p2);\n\n          if (i === 0 && j === 0) {\n            c1 = p1;\n            c2 = p2;\n            minDist = dist;\n          } else if (dist < minDist) {\n            c1 = p1;\n            c2 = p2;\n          }\n        }\n      }\n\n      if (!isArrayHasData(oldCoordinates) || !oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2)) {\n        this.setCoordinates([c1, c2]);\n      }\n    };\n\n    _proto.onAdd = function onAdd() {\n      this._registerEvents();\n\n      this._updateCoordinates();\n    };\n\n    _proto.onRemove = function onRemove() {\n      if (this._connSource) {\n        if (this._connSource.__connectors) {\n          removeFromArray(this, this._connSource.__connectors);\n        }\n\n        this._connSource.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n\n        this._connSource.off('dragend mouseup mouseout', this.hide, this);\n\n        this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connSource;\n      }\n\n      if (this._connTarget) {\n        removeFromArray(this, this._connTarget.__connectors);\n\n        this._connTarget.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connTarget;\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    _proto._showConnect = function _showConnect() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n        this._updateCoordinates();\n\n        this.show();\n      }\n    };\n\n    _proto._registerEvents = function _registerEvents() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (!this._connSource.__connectors) {\n        this._connSource.__connectors = [];\n      }\n\n      if (!this._connTarget.__connectors) {\n        this._connTarget.__connectors = [];\n      }\n\n      this._connSource.__connectors.push(this);\n\n      this._connTarget.__connectors.push(this);\n\n      this._connSource.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connTarget.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      var trigger = this.options['showOn'];\n      this.hide();\n\n      if (trigger === 'moving') {\n        this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n\n        this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n      } else if (trigger === 'click') {\n        this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n\n        this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n      } else if (trigger === 'mouseover') {\n        this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n\n        this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n      } else {\n        this._showConnect();\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar options$d = {\n  showOn: 'always'\n};\n\nvar ConnectorLine = function (_Connectable) {\n  _inheritsLoose(ConnectorLine, _Connectable);\n\n  function ConnectorLine(src, target, options) {\n    var _this;\n\n    _this = _Connectable.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this._connSource = src;\n    _this._connTarget = target;\n    return _this;\n  }\n\n  return ConnectorLine;\n}(Connectable(LineString));\n\nConnectorLine.mergeOptions(options$d);\nConnectorLine.registerJSONType('ConnectorLine');\n\nvar ArcConnectorLine = function (_Connectable2) {\n  _inheritsLoose(ArcConnectorLine, _Connectable2);\n\n  function ArcConnectorLine(src, target, options) {\n    var _this2;\n\n    _this2 = _Connectable2.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this2._connSource = src;\n    _this2._connTarget = target;\n    return _this2;\n  }\n\n  return ArcConnectorLine;\n}(Connectable(ArcCurve));\n\nArcConnectorLine.mergeOptions(options$d);\nArcConnectorLine.registerJSONType('ArcConnectorLine');\n\nvar options$e = {\n  'drawImmediate': false\n};\n\nvar OverlayLayer = function (_Layer) {\n  _inheritsLoose(OverlayLayer, _Layer);\n\n  function OverlayLayer(id, geometries, options) {\n    var _this;\n\n    if (geometries && !(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0) {\n      options = geometries;\n      geometries = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._maxZIndex = 0;\n    _this._minZIndex = 0;\n\n    _this._initCache();\n\n    if (geometries) {\n      _this.addGeometry(geometries);\n    }\n\n    var style = _this.options['style'];\n\n    if (style) {\n      _this.setStyle(style);\n    }\n\n    return _this;\n  }\n\n  var _proto = OverlayLayer.prototype;\n\n  _proto.getGeometryById = function getGeometryById(id) {\n    if (isNil(id) || id === '') {\n      return null;\n    }\n\n    if (!this._geoMap[id]) {\n      return null;\n    }\n\n    return this._geoMap[id];\n  };\n\n  _proto.getGeometries = function getGeometries(filter, context) {\n    if (!filter) {\n      return this._geoList.slice(0);\n    }\n\n    var result = [];\n    var geometry, filtered;\n\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      geometry = this._geoList[i];\n\n      if (context) {\n        filtered = filter.call(context, geometry);\n      } else {\n        filtered = filter(geometry);\n      }\n\n      if (filtered) {\n        result.push(geometry);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getFirstGeometry = function getFirstGeometry() {\n    if (!this._geoList.length) {\n      return null;\n    }\n\n    return this._geoList[0];\n  };\n\n  _proto.getLastGeometry = function getLastGeometry() {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return null;\n    }\n\n    return this._geoList[len - 1];\n  };\n\n  _proto.getCount = function getCount() {\n    return this._geoList.length;\n  };\n\n  _proto.getExtent = function getExtent() {\n    if (this.getCount() === 0) {\n      return null;\n    }\n\n    var extent = new Extent(this.getProjection());\n    this.forEach(function (g) {\n      extent._combine(g.getExtent());\n    });\n    return extent;\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var copyOnWrite = this._geoList.slice(0);\n\n    for (var i = 0, l = copyOnWrite.length; i < l; i++) {\n      if (!context) {\n        fn(copyOnWrite[i], i);\n      } else {\n        fn.call(context, copyOnWrite[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return selected;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !this._geoList.length;\n  };\n\n  _proto.addGeometry = function addGeometry(geometries, fitView) {\n    if (!geometries) {\n      return this;\n    }\n\n    if (geometries.type === 'FeatureCollection') {\n      return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n    } else if (!Array.isArray(geometries)) {\n      var count = arguments.length;\n      var last = arguments[count - 1];\n      geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n      fitView = last;\n\n      if (last && isObject(last) && ('type' in last || last instanceof Geometry)) {\n        geometries.push(last);\n        fitView = false;\n      }\n\n      return this.addGeometry(geometries, fitView);\n    } else if (geometries.length === 0) {\n      return this;\n    }\n\n    this._initCache();\n\n    var extent;\n\n    if (fitView) {\n      extent = new Extent();\n    }\n\n    this._toSort = this._maxZIndex > 0;\n    var geos = [];\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var geo = geometries[i];\n\n      if (!geo) {\n        throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n      }\n\n      if (!(geo instanceof Geometry)) {\n        geo = Geometry.fromJSON(geo);\n\n        if (Array.isArray(geo)) {\n          for (var ii = 0, ll = geo.length; ii < ll; ii++) {\n            this._add(geo[ii], extent, i);\n\n            geos.push(geo[ii]);\n          }\n        }\n      }\n\n      if (!Array.isArray(geo)) {\n        this._add(geo, extent, i);\n\n        geos.push(geo);\n      }\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      this._getRenderer().onGeometryAdd(geos);\n\n      if (extent && !isNil(extent.xmin)) {\n        var center = extent.getCenter();\n        var z = map.getFitZoom(extent);\n\n        if (isObject(fitView)) {\n          var step = isFunction(fitView.step) ? fitView.step : function () {\n            return undefined;\n          };\n          map.animateTo({\n            center: center,\n            zoom: z\n          }, extend({\n            duration: map.options.zoomAnimationDuration,\n            easing: 'out'\n          }, fitView), step);\n        } else if (fitView === true) {\n          map.setCenterAndZoom(center, z);\n        }\n      }\n    }\n\n    this.fire('addgeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.getGeoMinZIndex = function getGeoMinZIndex() {\n    return this._minZIndex;\n  };\n\n  _proto.getGeoMaxZIndex = function getGeoMaxZIndex() {\n    return this._maxZIndex;\n  };\n\n  _proto._add = function _add(geo, extent, i) {\n    if (!this._toSort) {\n      this._toSort = geo.getZIndex() !== 0;\n    }\n\n    this._updateZIndex(geo.getZIndex());\n\n    var geoId = geo.getId();\n\n    if (!isNil(geoId)) {\n      if (!isNil(this._geoMap[geoId])) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n      }\n\n      this._geoMap[geoId] = geo;\n    }\n\n    var internalId = UID();\n\n    geo._setInternalId(internalId);\n\n    this._geoList.push(geo);\n\n    this.onAddGeometry(geo);\n\n    geo._bindLayer(this);\n\n    if (geo.onAdd) {\n      geo.onAdd();\n    }\n\n    if (extent) {\n      extent._combine(geo.getExtent());\n    }\n\n    geo._fireEvent('add', {\n      'layer': this\n    });\n\n    if (this._cookedStyles) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.removeGeometry = function removeGeometry(geometries) {\n    if (!Array.isArray(geometries)) {\n      return this.removeGeometry([geometries]);\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      if (!(geometries[i] instanceof Geometry)) {\n        geometries[i] = this.getGeometryById(geometries[i]);\n      }\n\n      if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n      geometries[i].remove();\n    }\n\n    this.fire('removegeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._clearing = true;\n    this.forEach(function (geo) {\n      geo.remove();\n    });\n    this._geoMap = {};\n    var old = this._geoList;\n    this._geoList = [];\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove(old);\n    }\n\n    this._clearing = false;\n    this.fire('clear');\n    return this;\n  };\n\n  _proto.onRemoveGeometry = function onRemoveGeometry(geometry) {\n    if (!geometry || this._clearing) {\n      return;\n    }\n\n    if (this !== geometry.getLayer()) {\n      return;\n    }\n\n    var internalId = geometry._getInternalId();\n\n    if (isNil(internalId)) {\n      return;\n    }\n\n    var geoId = geometry.getId();\n\n    if (!isNil(geoId)) {\n      delete this._geoMap[geoId];\n    }\n\n    var idx = this._findInList(geometry);\n\n    if (idx >= 0) {\n      this._geoList.splice(idx, 1);\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove([geometry]);\n    }\n  };\n\n  _proto.getStyle = function getStyle() {\n    if (!this.options['style']) {\n      return null;\n    }\n\n    return this.options['style'];\n  };\n\n  _proto.setStyle = function setStyle(style) {\n    this.options.style = style;\n    style = parseStyleRootPath(style);\n    this._cookedStyles = compileStyle(style);\n    this.forEach(function (geometry) {\n      this._styleGeometry(geometry);\n    }, this);\n    this.fire('setstyle', {\n      'style': style\n    });\n    return this;\n  };\n\n  _proto._styleGeometry = function _styleGeometry(geometry) {\n    if (!this._cookedStyles) {\n      return false;\n    }\n\n    var g = getFilterFeature(geometry);\n\n    for (var i = 0, len = this._cookedStyles.length; i < len; i++) {\n      if (this._cookedStyles[i]['filter'](g) === true) {\n        geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.removeStyle = function removeStyle() {\n    if (!this.options.style) {\n      return this;\n    }\n\n    delete this.options.style;\n    delete this._cookedStyles;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(null);\n    }, this);\n    this.fire('removestyle');\n    return this;\n  };\n\n  _proto.onAddGeometry = function onAddGeometry(geo) {\n    var style = this.getStyle();\n\n    if (style) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.hide = function hide() {\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      this._geoList[i].onHide();\n    }\n\n    return Layer.prototype.hide.call(this);\n  };\n\n  _proto._initCache = function _initCache() {\n    if (!this._geoList) {\n      this._geoList = [];\n      this._geoMap = {};\n    }\n  };\n\n  _proto._updateZIndex = function _updateZIndex() {\n    for (var _len = arguments.length, zIndex = new Array(_len), _key = 0; _key < _len; _key++) {\n      zIndex[_key] = arguments[_key];\n    }\n\n    this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n    this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n  };\n\n  _proto._sortGeometries = function _sortGeometries() {\n    var _this2 = this;\n\n    if (!this._toSort) {\n      return;\n    }\n\n    this._maxZIndex = 0;\n    this._minZIndex = 0;\n\n    this._geoList.sort(function (a, b) {\n      _this2._updateZIndex(a.getZIndex(), b.getZIndex());\n\n      return _this2._compare(a, b);\n    });\n\n    this._toSort = false;\n  };\n\n  _proto._compare = function _compare(a, b) {\n    if (a.getZIndex() === b.getZIndex()) {\n      return a._getInternalId() - b._getInternalId();\n    }\n\n    return a.getZIndex() - b.getZIndex();\n  };\n\n  _proto._findInList = function _findInList(geo) {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return -1;\n    }\n\n    var low = 0,\n        high = len - 1,\n        middle;\n\n    while (low <= high) {\n      middle = Math.floor((low + high) / 2);\n\n      if (this._geoList[middle] === geo) {\n        return middle;\n      } else if (this._compare(this._geoList[middle], geo) > 0) {\n        high = middle - 1;\n      } else {\n        low = middle + 1;\n      }\n    }\n\n    return -1;\n  };\n\n  _proto._onGeometryEvent = function _onGeometryEvent(param) {\n    if (!param || !param['target']) {\n      return;\n    }\n\n    var type = param['type'];\n\n    if (type === 'idchange') {\n      this._onGeometryIdChange(param);\n    } else if (type === 'zindexchange') {\n      this._onGeometryZIndexChange(param);\n    } else if (type === 'positionchange') {\n      this._onGeometryPositionChange(param);\n    } else if (type === 'shapechange') {\n      this._onGeometryShapeChange(param);\n    } else if (type === 'symbolchange') {\n      this._onGeometrySymbolChange(param);\n    } else if (type === 'show') {\n      this._onGeometryShow(param);\n    } else if (type === 'hide') {\n      this._onGeometryHide(param);\n    } else if (type === 'propertieschange') {\n      this._onGeometryPropertiesChange(param);\n    }\n  };\n\n  _proto._onGeometryIdChange = function _onGeometryIdChange(param) {\n    if (param['new'] === param['old']) {\n      if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n        return;\n      }\n    }\n\n    if (!isNil(param['new'])) {\n      if (this._geoMap[param['new']]) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n      }\n\n      this._geoMap[param['new']] = param['target'];\n    }\n\n    if (!isNil(param['old']) && param['new'] !== param['old']) {\n      delete this._geoMap[param['old']];\n    }\n  };\n\n  _proto._onGeometryZIndexChange = function _onGeometryZIndexChange(param) {\n    if (param['old'] !== param['new']) {\n      this._updateZIndex(param['new']);\n\n      this._toSort = true;\n\n      if (this._getRenderer()) {\n        this._getRenderer().onGeometryZIndexChange(param);\n      }\n    }\n  };\n\n  _proto._onGeometryPositionChange = function _onGeometryPositionChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPositionChange(param);\n    }\n  };\n\n  _proto._onGeometryShapeChange = function _onGeometryShapeChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShapeChange(param);\n    }\n  };\n\n  _proto._onGeometrySymbolChange = function _onGeometrySymbolChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometrySymbolChange(param);\n    }\n  };\n\n  _proto._onGeometryShow = function _onGeometryShow(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShow(param);\n    }\n  };\n\n  _proto._onGeometryHide = function _onGeometryHide(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryHide(param);\n    }\n  };\n\n  _proto._onGeometryPropertiesChange = function _onGeometryPropertiesChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPropertiesChange(param);\n    }\n  };\n\n  return OverlayLayer;\n}(Layer);\n\nOverlayLayer.mergeOptions(options$e);\n\nvar TEMP_EXTENT$3 = new PointExtent();\nvar options$f = {\n  'debug': false,\n  'enableSimplify': true,\n  'geometryEvents': true,\n  'defaultIconSize': [20, 20],\n  'cacheVectorOnCanvas': true,\n  'cacheSvgOnCanvas': Browser$1.gecko,\n  'enableAltitude': false,\n  'altitudeProperty': 'altitude',\n  'drawAltitude': false,\n  'altitude': 0\n};\n\nvar VectorLayer = function (_OverlayLayer) {\n  _inheritsLoose(VectorLayer, _OverlayLayer);\n\n  function VectorLayer(id, geometries, options) {\n    return _OverlayLayer.call(this, id, geometries, options) || this;\n  }\n\n  var _proto = VectorLayer.prototype;\n\n  _proto.onConfig = function onConfig(conf) {\n    _OverlayLayer.prototype.onConfig.call(this, conf);\n\n    if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n      var renderer = this.getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (options['onlyVisible'] && renderer && renderer.identify) {\n      return renderer.identify(coordinate, options);\n    }\n\n    if (!(coordinate instanceof Coordinate)) {\n      coordinate = new Coordinate(coordinate);\n    }\n\n    return this._hitGeos(this._geoList, coordinate, options);\n  };\n\n  _proto._hitGeos = function _hitGeos(geometries, coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var filter = options['filter'],\n        tolerance = options['tolerance'],\n        hits = [];\n    var map = this.getMap();\n    var point = map.coordToPoint(coordinate);\n\n    var cp = map._pointToContainerPoint(point, undefined, 0, point);\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n        continue;\n      }\n\n      if (!(geo instanceof LineString) || !geo._getArrowStyle() && !(geo instanceof Curve)) {\n        var extent = geo.getContainerExtent(TEMP_EXTENT$3);\n\n        if (tolerance) {\n          extent = extent._expand(tolerance);\n        }\n\n        if (!extent || !extent.contains(cp)) {\n          continue;\n        }\n      }\n\n      if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n        hits.push(geo);\n\n        if (options['count']) {\n          if (hits.length >= options['count']) {\n            break;\n          }\n        }\n      }\n    }\n\n    return hits;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    return this.options['altitude'] || 0;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n\n    if (isNil(options['geometries']) || options['geometries']) {\n      var clipExtent;\n\n      if (options['clipExtent']) {\n        var map = this.getMap();\n        var projection = map ? map.getProjection() : null;\n        clipExtent = new Extent(options['clipExtent'], projection);\n      }\n\n      var geoJSONs = [];\n      var geometries = this.getGeometries();\n\n      for (var i = 0, len = geometries.length; i < len; i++) {\n        var geo = geometries[i];\n        var geoExt = geo.getExtent();\n\n        if (!geoExt || clipExtent && !clipExtent.intersects(geoExt)) {\n          continue;\n        }\n\n        var json = geo.toJSON(options['geometries']);\n        geoJSONs.push(json);\n      }\n\n      profile['geometries'] = geoJSONs;\n    }\n\n    return profile;\n  };\n\n  VectorLayer.fromJSON = function fromJSON(json) {\n    if (!json || json['type'] !== 'VectorLayer') {\n      return null;\n    }\n\n    var layer = new VectorLayer(json['id'], json['options']);\n    var geoJSONs = json['geometries'];\n    var geometries = [];\n\n    for (var i = 0; i < geoJSONs.length; i++) {\n      var geo = Geometry.fromJSON(geoJSONs[i]);\n\n      if (geo) {\n        geometries.push(geo);\n      }\n    }\n\n    layer.addGeometry(geometries);\n    return layer;\n  };\n\n  VectorLayer.getPainterClass = function getPainterClass() {\n    return Painter;\n  };\n\n  VectorLayer.getCollectionPainterClass = function getCollectionPainterClass() {\n    return CollectionPainter;\n  };\n\n  return VectorLayer;\n}(OverlayLayer);\n\nVectorLayer.mergeOptions(options$f);\nVectorLayer.registerJSONType('VectorLayer');\n\nvar key = '_map_tool';\n\nvar MapTool = function (_Eventable) {\n  _inheritsLoose(MapTool, _Eventable);\n\n  function MapTool() {\n    return _Eventable.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTool.prototype;\n\n  _proto.addTo = function addTo(map) {\n    if (!map) {\n      return this;\n    }\n\n    this._map = map;\n\n    if (map[key]) {\n      map[key].disable();\n    }\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.enable();\n    map[key] = this;\n\n    this._fireEvent('add');\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.enable = function enable() {\n    var map = this._map;\n\n    if (!map || this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n\n    this._switchEvents('off');\n\n    this._registerEvents();\n\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this._fireEvent('enable');\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled || !this._map) {\n      return this;\n    }\n\n    this._enabled = false;\n\n    this._switchEvents('off');\n\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this._fireEvent('disable');\n\n    return this;\n  };\n\n  _proto.isEnabled = function isEnabled() {\n    if (!this._enabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    this.disable();\n\n    if (this._map) {\n      delete this._map[key];\n      delete this._map;\n    }\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    this._switchEvents('on');\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var events = this.getEvents();\n\n    if (events) {\n      this._map[to](events, this);\n    }\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    this.fire(eventName, param);\n  };\n\n  return MapTool;\n}(Eventable(Class));\n\nvar options$g = {\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 0.3\n  },\n  'doubleClickZoom': false,\n  'mode': null,\n  'once': false,\n  'autoPanAtEdge': false,\n  'ignoreMouseleave': true\n};\nvar registeredMode = {};\n\nvar DrawTool = function (_MapTool) {\n  _inheritsLoose(DrawTool, _MapTool);\n\n  DrawTool.registerMode = function registerMode(name, modeAction) {\n    registeredMode[name.toLowerCase()] = modeAction;\n  };\n\n  DrawTool.getRegisterMode = function getRegisterMode(name) {\n    return registeredMode[name.toLowerCase()];\n  };\n\n  function DrawTool(options) {\n    var _this;\n\n    _this = _MapTool.call(this, options) || this;\n\n    _this._checkMode();\n\n    _this._events = {\n      'click': _this._clickHandler,\n      'mousemove': _this._mouseMoveHandler,\n      'dblclick': _this._doubleClickHandler,\n      'mousedown': _this._mouseDownHandler,\n      'mouseup': _this._mouseUpHandler\n    };\n    return _this;\n  }\n\n  var _proto = DrawTool.prototype;\n\n  _proto.getMode = function getMode() {\n    if (this.options['mode']) {\n      return this.options['mode'].toLowerCase();\n    }\n\n    return null;\n  };\n\n  _proto.setMode = function setMode(mode) {\n    if (this._geometry) {\n      this._geometry.remove();\n\n      delete this._geometry;\n    }\n\n    this._clearStage();\n\n    this._switchEvents('off');\n\n    this.options['mode'] = mode;\n\n    this._checkMode();\n\n    if (this.isEnabled()) {\n      this._switchEvents('on');\n\n      this._restoreMapCfg();\n\n      this._saveMapCfg();\n    }\n\n    return this;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var symbol = this.options['symbol'];\n\n    if (symbol) {\n      return extendSymbol(symbol);\n    } else {\n      return extendSymbol(this.options['symbol']);\n    }\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (!symbol) {\n      return this;\n    }\n\n    this.options['symbol'] = symbol;\n\n    if (this._geometry) {\n      this._geometry.setSymbol(symbol);\n    }\n\n    return this;\n  };\n\n  _proto.getCurrentGeometry = function getCurrentGeometry() {\n    return this._geometry;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._checkMode();\n  };\n\n  _proto.onEnable = function onEnable() {\n    this._saveMapCfg();\n\n    this._drawToolLayer = this._getDrawLayer();\n\n    this._clearStage();\n\n    this._loadResources();\n\n    if (this.options['autoPanAtEdge']) {\n      var map = this.getMap();\n      this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n\n      if (!this._mapAutoPanAtEdge) {\n        map.config({\n          autoPanAtEdge: true\n        });\n      }\n    }\n\n    return this;\n  };\n\n  _proto.onDisable = function onDisable() {\n    var map = this.getMap();\n\n    this._restoreMapCfg();\n\n    this.endDraw();\n\n    if (this._map) {\n      map.removeLayer(this._getDrawLayer());\n\n      if (this.options['autoPanAtEdge']) {\n        if (!this._mapAutoPanAtEdge) {\n          map.config({\n            autoPanAtEdge: false\n          });\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, --this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, ++this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto._shouldRecordHistory = function _shouldRecordHistory(actions) {\n    return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n  };\n\n  _proto._checkMode = function _checkMode() {\n    this._getRegisterMode();\n  };\n\n  _proto._saveMapCfg = function _saveMapCfg() {\n    var map = this.getMap();\n    this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n    map.config({\n      'doubleClickZoom': this.options['doubleClickZoom']\n    });\n\n    var actions = this._getRegisterMode()['action'];\n\n    if (actions.indexOf('mousedown') > -1) {\n      var _map = this.getMap();\n\n      this._mapDraggable = _map.options['draggable'];\n\n      _map.config({\n        'draggable': false\n      });\n    }\n  };\n\n  _proto._restoreMapCfg = function _restoreMapCfg() {\n    var map = this.getMap();\n    map.config({\n      'doubleClickZoom': this._mapDoubleClickZoom\n    });\n\n    if (!isNil(this._mapDraggable)) {\n      map.config('draggable', this._mapDraggable);\n    }\n\n    delete this._mapDraggable;\n    delete this._mapDoubleClickZoom;\n  };\n\n  _proto._loadResources = function _loadResources() {\n    var symbol = this.getSymbol();\n    var resources = getExternalResources(symbol);\n\n    if (resources.length > 0) {\n      this._drawToolLayer._getRenderer().loadResources(resources);\n    }\n  };\n\n  _proto._getProjection = function _getProjection() {\n    return this._map.getProjection();\n  };\n\n  _proto._getRegisterMode = function _getRegisterMode() {\n    var mode = this.getMode();\n    var registerMode = DrawTool.getRegisterMode(mode);\n\n    if (!registerMode) {\n      throw new Error(mode + ' is not a valid mode of DrawTool.');\n    }\n\n    return registerMode;\n  };\n\n  _proto.getEvents = function getEvents() {\n    var action = this._getRegisterMode()['action'];\n\n    var _events = {};\n\n    if (Array.isArray(action)) {\n      for (var i = 0; i < action.length; i++) {\n        _events[action[i]] = this._events[action[i]];\n      }\n\n      return _events;\n    }\n\n    return null;\n  };\n\n  _proto._mouseDownHandler = function _mouseDownHandler(event) {\n    this._createGeometry(event);\n  };\n\n  _proto._mouseUpHandler = function _mouseUpHandler(event) {\n    this.endDraw(event);\n  };\n\n  _proto._clickHandler = function _clickHandler(event) {\n    var registerMode = this._getRegisterMode();\n\n    if (!this._geometry) {\n      this._createGeometry(event);\n    } else {\n      var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (!isNil(this._historyPointer)) {\n        this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n      }\n\n      this._clickCoords.push(prjCoord);\n\n      this._historyPointer = this._clickCoords.length;\n      event.drawTool = this;\n      registerMode['update'](this.getMap().getProjection(), this._clickCoords, this._geometry, event);\n\n      this._fireEvent('drawvertex', event);\n\n      if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n        this.endDraw(event);\n      }\n    }\n  };\n\n  _proto._createGeometry = function _createGeometry(event) {\n    var mode = this.getMode();\n\n    var registerMode = this._getRegisterMode();\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var symbol = this.getSymbol();\n\n    if (!this._geometry) {\n      this._clickCoords = [prjCoord];\n      event.drawTool = this;\n      this._geometry = registerMode['create'](this.getMap().getProjection(), this._clickCoords, event);\n\n      if (symbol && mode !== 'point') {\n        this._geometry.setSymbol(symbol);\n      } else if (this.options.hasOwnProperty('symbol')) {\n        this._geometry.setSymbol(this.options['symbol']);\n      }\n\n      this._addGeometryToStage(this._geometry);\n\n      this._fireEvent('drawstart', event);\n    }\n\n    if (mode === 'point') {\n      this.endDraw(event);\n    }\n  };\n\n  _proto._mouseMoveHandler = function _mouseMoveHandler(event) {\n    var map = this.getMap();\n\n    if (!this._geometry || !map || map.isInteracting()) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var projection = map.getProjection();\n    event.drawTool = this;\n\n    var registerMode = this._getRegisterMode();\n\n    if (this._shouldRecordHistory(registerMode.action)) {\n      var path = this._clickCoords.slice(0, this._historyPointer);\n\n      if (path && path.length > 0 && prjCoord.equals(path[path.length - 1])) {\n        return;\n      }\n\n      registerMode['update'](projection, path.concat([prjCoord]), this._geometry, event);\n    } else {\n      registerMode['update'](projection, prjCoord, this._geometry, event);\n    }\n\n    this._fireEvent('mousemove', event);\n  };\n\n  _proto._doubleClickHandler = function _doubleClickHandler(event) {\n    if (!this._geometry) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var registerMode = this._getRegisterMode();\n\n    var clickCoords = this._clickCoords;\n\n    if (clickCoords.length < 2) {\n      return;\n    }\n\n    var projection = this.getMap().getProjection();\n    var path = [clickCoords[0]];\n\n    for (var i = 1, len = clickCoords.length; i < len; i++) {\n      if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n        path.push(clickCoords[i]);\n      }\n    }\n\n    if (path.length < 2 || this._geometry && this._geometry instanceof Polygon && path.length < 3) {\n      return;\n    }\n\n    event.drawTool = this;\n    registerMode['update'](projection, path, this._geometry, event);\n    this.endDraw(event);\n  };\n\n  _proto._addGeometryToStage = function _addGeometryToStage(geometry) {\n    var drawLayer = this._getDrawLayer();\n\n    drawLayer.addGeometry(geometry);\n  };\n\n  _proto.endDraw = function endDraw(param) {\n    if (!this._geometry || this._ending) {\n      return this;\n    }\n\n    this._ending = true;\n    var geometry = this._geometry;\n\n    this._clearStage();\n\n    param = param || {};\n    this._geometry = geometry;\n\n    this._fireEvent('drawend', param);\n\n    delete this._geometry;\n\n    if (this.options['once']) {\n      this.disable();\n    }\n\n    delete this._ending;\n    delete this._historyPointer;\n    return this;\n  };\n\n  _proto._clearStage = function _clearStage() {\n    this._getDrawLayer().clear();\n\n    delete this._geometry;\n    delete this._clickCoords;\n  };\n\n  _proto._getMouseContainerPoint = function _getMouseContainerPoint(event) {\n    var action = this._getRegisterMode()['action'];\n\n    if (action === 'mousedown') {\n      stopPropagation(event['domEvent']);\n    }\n\n    return event['containerPoint'];\n  };\n\n  _proto._isValidContainerPoint = function _isValidContainerPoint(containerPoint) {\n    var mapSize = this._map.getSize();\n\n    var w = mapSize['width'],\n        h = mapSize['height'];\n\n    if (containerPoint.x < 0 || containerPoint.y < 0) {\n      return false;\n    } else if (containerPoint.x > w || containerPoint.y > h) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._getDrawLayer = function _getDrawLayer() {\n    var drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n\n    var drawToolLayer = this._map.getLayer(drawLayerId);\n\n    if (!drawToolLayer) {\n      drawToolLayer = new VectorLayer(drawLayerId, {\n        'enableSimplify': false\n      });\n\n      this._map.addLayer(drawToolLayer);\n    }\n\n    return drawToolLayer;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    if (this._geometry) {\n      param['geometry'] = this._getRegisterMode()['generate'](this._geometry, {\n        drawTool: this\n      });\n    }\n\n    MapTool.prototype._fireEvent.call(this, eventName, param);\n  };\n\n  return DrawTool;\n}(MapTool);\n\nDrawTool.mergeOptions(options$g);\n\nvar MapBoxZoomHander = function (_Handler) {\n  _inheritsLoose(MapBoxZoomHander, _Handler);\n\n  function MapBoxZoomHander(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this.drawTool = new DrawTool({\n      'mode': 'boxZoom',\n      'ignoreMouseleave': false\n    });\n    return _this;\n  }\n\n  var _proto = MapBoxZoomHander.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on('_mousedown', this._onMouseDown, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this.target.off('_mousedown', this._onMouseDown, this);\n\n    if (this.drawTool.isEnabled()) {\n      this.drawTool.remove();\n    }\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    if (!this.target.options['boxZoom']) {\n      return;\n    }\n\n    if (param.domEvent.shiftKey) {\n      this.drawTool.setSymbol(this.target.options['boxZoomSymbol']).on('drawend', this._boxZoom, this).addTo(this.target);\n    }\n  };\n\n  _proto._boxZoom = function _boxZoom(param) {\n    var map = this.target;\n    this.drawTool.remove();\n    var geometry = param.geometry,\n        center = geometry.getCenter(),\n        symbol = geometry.getSymbol(),\n        w = symbol.markerWidth,\n        h = symbol.markerHeight;\n    var extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n    var zoom = map.getFitZoom(extent);\n\n    map._animateTo({\n      center: extent.getCenter(),\n      zoom: zoom\n    });\n  };\n\n  return MapBoxZoomHander;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'boxZoom': true,\n  'boxZoomSymbol': {\n    'markerType': 'rectangle',\n    'markerLineWidth': 3,\n    'markerLineColor': '#1bbc9b',\n    'markerLineDasharray': [10, 5],\n    'markerFillOpacity': 0.1,\n    'markerFill': '#1bbc9b',\n    'markerWidth': 1,\n    'markerHeight': 1\n  }\n});\nMap$1.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\n\nvar PANOFFSET = 30;\n\nvar MapAutoPanAtEdgeHandler = function (_Handler) {\n  _inheritsLoose(MapAutoPanAtEdgeHandler, _Handler);\n\n  function MapAutoPanAtEdgeHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapAutoPanAtEdgeHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto._onMouseMove = function _onMouseMove(event) {\n    var map = this.target;\n\n    if (map.options['autoPanAtEdge']) {\n      var containerPoint = event.containerPoint;\n      var containerExtent = map.getContainerExtent();\n\n      if (containerExtent) {\n        var x = containerPoint.x,\n            y = containerPoint.y;\n        var xmax = containerExtent.xmax,\n            ymax = containerExtent.ymax;\n        var p;\n\n        if (x < PANOFFSET) {\n          p = [Math.abs(x - PANOFFSET), 0];\n        }\n\n        if (y < PANOFFSET) {\n          p = [0, Math.abs(y - PANOFFSET)];\n        }\n\n        if (x + PANOFFSET > xmax) {\n          p = [-Math.abs(x + PANOFFSET - xmax), 0];\n        }\n\n        if (y + PANOFFSET > ymax) {\n          p = [0, -Math.abs(y + PANOFFSET - ymax)];\n        }\n\n        if (p) {\n          map.panBy(p, {\n            duration: 1\n          });\n        }\n      }\n    }\n  };\n\n  return MapAutoPanAtEdgeHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'autoPanAtEdge': false\n});\nMap$1.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\n\nMap$1.include({\n  animateTo: function animateTo(view, options, step) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    var projection = this.getProjection(),\n        currView = this.getView(),\n        props = {};\n    var empty = true;\n\n    for (var p in view) {\n      if (hasOwn(view, p) && !isNil(view[p]) && (p === 'prjCenter' || !isNil(currView[p]))) {\n        empty = false;\n\n        if (p === 'center') {\n          var from = new Coordinate(currView[p]).toFixed(7),\n              to = new Coordinate(view[p]).toFixed(7);\n\n          if (!from.equals(to)) {\n            props['center'] = [from, to];\n          }\n        } else if (p === 'prjCenter') {\n          var _from = new Coordinate(this._getPrjCenter());\n\n          var _to = new Coordinate(view[p]);\n\n          if (!_from.equals(_to)) {\n            props['prjCenter'] = [_from, _to];\n          }\n        } else if (currView[p] !== view[p] && p !== 'around') {\n          props[p] = [currView[p], view[p]];\n        }\n      }\n    }\n\n    if (empty) {\n      return null;\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n\n    var renderer = this._getRenderer(),\n        framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate(props, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'framer': framer\n    }, function (frame) {\n      if (_this.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (player.playState === 'running') {\n        if (frame.styles['center']) {\n          var center = frame.styles['center'];\n\n          _this._setPrjCenter(projection.project(center));\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        } else if (frame.styles['prjCenter']) {\n          var _center = frame.styles['prjCenter'];\n\n          _this._setPrjCenter(_center);\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        }\n\n        if (!isNil(frame.styles['zoom'])) {\n          _this.onZooming(frame.styles['zoom'], zoomOrigin);\n        }\n\n        if (!isNil(frame.styles['pitch'])) {\n          _this.setPitch(frame.styles['pitch']);\n        }\n\n        if (!isNil(frame.styles['bearing'])) {\n          _this.setBearing(frame.styles['bearing']);\n        }\n\n        _this._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['center']) {\n            _this._setPrjCenter(projection.project(props['center'][1]));\n          } else if (props['prjCenter']) {\n            _this._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (!isNil(props['pitch'])) {\n            _this.setPitch(props['pitch'][1]);\n          }\n\n          if (!isNil(props['bearing'])) {\n            _this.setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n\n    this._startAnim(props, zoomOrigin);\n\n    return player;\n  },\n  _animateTo: function _animateTo(view, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._isInternalAnimation = true;\n    this._mapAnimPlayer = this.animateTo(view, options, step);\n    delete this._isInternalAnimation;\n    return this._mapAnimPlayer;\n  },\n  isAnimating: function isAnimating() {\n    return !!this._animPlayer;\n  },\n  isRotating: function isRotating() {\n    return this.isDragRotating() || !!this._animRotating;\n  },\n  _endAnim: function _endAnim(player, props, zoomOrigin, options) {\n    delete this._animRotating;\n    var evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n\n    if (props['center']) {\n      var endCoord;\n\n      if (player._interupted) {\n        endCoord = this.getCenter();\n      } else {\n        endCoord = props['center'][1];\n      }\n\n      this.onMoveEnd(this._parseEventFromCoord(endCoord));\n    } else if (props['prjCenter']) {\n      var _endCoord;\n\n      if (player._interupted) {\n        _endCoord = this._getPrjCenter();\n      } else {\n        _endCoord = props['prjCenter'][1];\n      }\n\n      var event = this._parseEventFromCoord(this.getProjection().unproject(_endCoord));\n\n      event['point2d'] = this._prjToPoint(_endCoord);\n      this.onMoveEnd(event);\n    }\n\n    if (!isNil(props['zoom'])) {\n      if (player._interupted) {\n        this.onZoomEnd(this.getZoom(), zoomOrigin);\n      } else if (!options['wheelZoom']) {\n        this.onZoomEnd(props['zoom'][1], zoomOrigin);\n      } else {\n        this.onZooming(props['zoom'][1], zoomOrigin);\n      }\n    }\n\n    if (evtType) {\n      this._fireEvent(evtType);\n    }\n\n    if (!isNil(props['pitch']) && !this.getPitch()) {\n      this.getRenderer().setToRedraw();\n    }\n\n    this._resumePrev(player);\n  },\n  _startAnim: function _startAnim(props, zoomOrigin) {\n    if (!this._animPlayer) {\n      return;\n    }\n\n    if (props['center']) {\n      this.onMoveStart();\n    }\n\n    if (props['zoom'] && !this.isZooming()) {\n      this.onZoomStart(props['zoom'][1], zoomOrigin);\n    }\n\n    if (props['pitch'] || props['bearing']) {\n      this._animRotating = true;\n    }\n\n    this._fireEvent('animatestart');\n\n    this._animPlayer.play();\n  },\n  _stopAnim: function _stopAnim(player) {\n    if (!player) {\n      return;\n    }\n\n    delete this._animRotating;\n\n    if (player.playState !== 'finished') {\n      player._interupted = true;\n      player.cancel();\n    }\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n  },\n  _resumePrev: function _resumePrev(player) {\n    if (!this._prevAnimPlayer) {\n      return;\n    }\n\n    var prevPlayer = this._prevAnimPlayer;\n\n    if (prevPlayer.playState !== 'paused') {\n      delete this._prevAnimPlayer;\n    }\n\n    if (player !== prevPlayer) {\n      this._animPlayer = prevPlayer;\n      prevPlayer.play();\n    }\n  }\n});\n\nvar events = 'mousedown ' + 'mouseup ' + 'mouseover ' + 'mouseout ' + 'mouseenter ' + 'mouseleave ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend ';\nMap$1.include({\n  _registerDomEvents: function _registerDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    addDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _removeDomEvents: function _removeDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    removeDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _handleDOMEvent: function _handleDOMEvent(e) {\n    var type = e.type;\n\n    if (type === 'contextmenu') {\n      preventDefault(e);\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    var mimicClick = false;\n\n    if (type === 'mousedown' || type === 'touchstart' && e.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if (type === 'click' || type === 'touchend' || type === 'contextmenu') {\n      if (!this._mouseDownTime) {\n        return;\n      } else {\n        var downTime = this._mouseDownTime;\n        delete this._mouseDownTime;\n        var time = now();\n\n        if (time - downTime > 300) {\n          if (type === 'click' || type === 'contextmenu') {\n            return;\n          }\n        } else if (type === 'touchend') {\n          mimicClick = true;\n        }\n      }\n    }\n\n    this._fireDOMEvent(this, e, type);\n\n    if (mimicClick) {\n      if (this._clickTime && now() - this._clickTime <= 300) {\n        delete this._clickTime;\n\n        this._fireDOMEvent(this, e, 'dblclick');\n      } else {\n        this._clickTime = now();\n\n        this._fireDOMEvent(this, e, 'click');\n      }\n    }\n  },\n  _ignoreEvent: function _ignoreEvent(domEvent) {\n    if (!domEvent || !this._panels.control) {\n      return false;\n    }\n\n    if (this._isEventOutMap(domEvent)) {\n      return true;\n    }\n\n    var target = domEvent.srcElement || domEvent.target;\n    var preTarget;\n\n    if (target) {\n      while (target && target !== this._containerDOM) {\n        if (target.className && target.className.indexOf && (target.className.indexOf('maptalks-control') >= 0 || target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation'])) {\n          return true;\n        }\n\n        preTarget = target;\n        target = target.parentNode;\n      }\n    }\n\n    return false;\n  },\n  _isEventOutMap: function _isEventOutMap(domEvent) {\n    if (this.getPitch() > this.options['maxVisualPitch']) {\n      var actualEvent = this._getActualEvent(domEvent);\n\n      var eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n\n      if (!this.getContainerExtent().contains(eventPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _parseEvent: function _parseEvent(e, type) {\n    if (!e) {\n      return null;\n    }\n\n    var eventParam = {\n      'domEvent': e\n    };\n\n    if (type !== 'keypress') {\n      var actual = this._getActualEvent(e);\n\n      if (actual) {\n        var containerPoint = getEventContainerPoint(actual, this._containerDOM);\n        eventParam = extend(eventParam, {\n          'coordinate': this.containerPointToCoord(containerPoint),\n          'containerPoint': containerPoint,\n          'viewPoint': this.containerPointToViewPoint(containerPoint),\n          'point2d': this._containerPointToPoint(containerPoint)\n        });\n      }\n    }\n\n    return eventParam;\n  },\n  _parseEventFromCoord: function _parseEventFromCoord(coord) {\n    var containerPoint = this.coordToContainerPoint(coord),\n        viewPoint = this.containerPointToViewPoint(containerPoint);\n    var e = {\n      'coordinate': coord,\n      'containerPoint': containerPoint,\n      'viewPoint': viewPoint,\n      'point2d': this.coordToPoint(coord)\n    };\n    return e;\n  },\n  _getActualEvent: function _getActualEvent(e) {\n    return e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n  },\n  _fireDOMEvent: function _fireDOMEvent(target, e, type) {\n    if (this.isRemoved()) {\n      return;\n    }\n\n    var eventParam = this._parseEvent(e, type);\n\n    this._fireEvent(type, eventParam);\n  }\n});\nMap$1.addOnLoadHook('_registerDomEvents');\n\nMap$1.include({\n  isFullScreen: function isFullScreen() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\n  },\n  requestFullScreen: function requestFullScreen(dom) {\n    this._fireEvent('fullscreenstart');\n\n    this._requestFullScreen(dom || this._containerDOM);\n\n    this._fireEvent('fullscreenend');\n\n    return this;\n  },\n  cancelFullScreen: function cancelFullScreen() {\n    this._cancelFullScreen();\n\n    this._fireEvent('cancelfullscreen');\n\n    return this;\n  },\n  _requestFullScreen: function _requestFullScreen(dom) {\n    if (dom.requestFullscreen) {\n      dom.requestFullscreen();\n    } else if (dom.mozRequestFullScreen) {\n      dom.mozRequestFullScreen();\n    } else if (dom.webkitRequestFullScreen) {\n      dom.webkitRequestFullScreen();\n    } else if (dom.msRequestFullScreen) {\n      dom.msRequestFullScreen();\n    } else {\n      var features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' + 'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' + 'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  },\n  _cancelFullScreen: function _cancelFullScreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitCancelFullScreen) {\n      document.webkitCancelFullScreen();\n    } else {\n      var features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' + 'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  }\n});\n\nMap$1.include({\n  panTo: function panTo(coordinate, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!coordinate) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    coordinate = new Coordinate(coordinate);\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      var prjCoord = this.getProjection().project(coordinate);\n      return this._panAnimation(prjCoord, options['duration'], step);\n    } else {\n      this.setCenter(coordinate);\n    }\n\n    return this;\n  },\n  _panTo: function _panTo(prjCoord, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      return this._panAnimation(prjCoord, options['duration']);\n    } else {\n      this.onMoveStart();\n\n      this._setPrjCenter(prjCoord);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n      return this;\n    }\n  },\n  panBy: function panBy(offset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!offset) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    offset = new Point(offset);\n    var containerExtent = this.getContainerExtent();\n    var ymin = containerExtent.ymin;\n\n    if (ymin > 0 && offset.y > 30) {\n      var y = offset.y;\n      offset.y = 30;\n      offset.x = offset.x * 30 / y;\n      console.warn('offset is limited to panBy when pitch is above maxPitch');\n    }\n\n    this.onMoveStart();\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      offset = offset.multi(-1);\n\n      var target = this._containerPointToPrj(new Point(this.width / 2 + offset.x, this.height / 2 + offset.y));\n\n      this._panAnimation(target, options['duration'], step);\n    } else {\n      this._offsetCenterByPixel(offset);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    }\n\n    return this;\n  },\n  _panAnimation: function _panAnimation(target, t, cb) {\n    return this._animateTo({\n      'prjCenter': target\n    }, {\n      'duration': t || this.options['panAnimationDuration']\n    }, cb);\n  }\n});\n\nGeometry.fromJSON = function (json) {\n  if (Array.isArray(json)) {\n    var result = [];\n\n    for (var i = 0, len = json.length; i < len; i++) {\n      var c = Geometry.fromJSON(json[i]);\n\n      if (Array.isArray(json)) {\n        result = result.concat(c);\n      } else {\n        result.push(c);\n      }\n    }\n\n    return result;\n  }\n\n  if (json && !json['feature']) {\n    return GeoJSON.toGeometry(json);\n  }\n\n  var geometry;\n\n  if (json['subType']) {\n    geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n\n    if (!isNil(json['feature']['id'])) {\n      geometry.setId(json['feature']['id']);\n    }\n  } else {\n    geometry = GeoJSON.toGeometry(json['feature']);\n\n    if (json['options']) {\n      geometry.config(json['options']);\n    }\n  }\n\n  if (json['symbol']) {\n    geometry.setSymbol(json['symbol']);\n  }\n\n  if (json['infoWindow']) {\n    geometry.setInfoWindow(json['infoWindow']);\n  }\n\n  return geometry;\n};\n\nLayer.fromJSON = function (layerJSON) {\n  if (!layerJSON) {\n    return null;\n  }\n\n  var layerType = layerJSON['type'];\n  var clazz = Layer.getJSONClass(layerType);\n\n  if (!clazz || !clazz.fromJSON) {\n    throw new Error('unsupported layer type:' + layerType);\n  }\n\n  return clazz.fromJSON(layerJSON);\n};\n\nMap$1.include({\n  'JSON_VERSION': '1.0',\n  toJSON: function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = {\n      'jsonVersion': this['JSON_VERSION'],\n      'version': this.VERSION,\n      'extent': this.getExtent().toJSON()\n    };\n    json['options'] = this.config();\n    json['options']['center'] = this.getCenter();\n    json['options']['zoom'] = this.getZoom();\n    json['options']['bearing'] = this.getBearing();\n    json['options']['pitch'] = this.getPitch();\n    var baseLayer = this.getBaseLayer();\n\n    if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n      json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n    }\n\n    var extraLayerOptions = {};\n\n    if (options['clipExtent']) {\n      if (options['clipExtent'] === true) {\n        extraLayerOptions['clipExtent'] = this.getExtent();\n      } else {\n        extraLayerOptions['clipExtent'] = options['clipExtent'];\n      }\n    }\n\n    var layersJSON = [];\n\n    if (isNil(options['layers']) || options['layers'] && !Array.isArray(options['layers'])) {\n      var layers = this.getLayers();\n\n      for (var i = 0, len = layers.length; i < len; i++) {\n        if (!layers[i].toJSON) {\n          continue;\n        }\n\n        var opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n        layersJSON.push(layers[i].toJSON(opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else if (isArrayHasData(options['layers'])) {\n      var _layers = options['layers'];\n\n      for (var _i = 0; _i < _layers.length; _i++) {\n        var exportOption = _layers[_i];\n        var layer = this.getLayer(exportOption['id']);\n\n        if (!layer.toJSON) {\n          continue;\n        }\n\n        var _opts = extend({}, exportOption['options'], extraLayerOptions);\n\n        layersJSON.push(layer.toJSON(_opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else {\n      json['layers'] = [];\n    }\n\n    return json;\n  }\n});\n\nMap$1.fromJSON = function (container, profile, options) {\n  if (!container || !profile) {\n    return null;\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  var map = new Map$1(container, profile['options']);\n\n  if (isNil(options['baseLayer']) || options['baseLayer']) {\n    var baseLayer = Layer.fromJSON(profile['baseLayer']);\n\n    if (baseLayer) {\n      map.setBaseLayer(baseLayer);\n    }\n  }\n\n  if (isNil(options['layers']) || options['layers']) {\n    var layers = [];\n    var layerJSONs = profile['layers'];\n\n    for (var i = 0; i < layerJSONs.length; i++) {\n      var layer = Layer.fromJSON(layerJSONs[i]);\n      layers.push(layer);\n    }\n\n    map.addLayer(layers);\n  }\n\n  return map;\n};\n\nMap$1.include({\n  computeLength: function computeLength(coord1, coord2) {\n    if (!this.getProjection()) {\n      return null;\n    }\n\n    var p1 = new Coordinate(coord1),\n        p2 = new Coordinate(coord2);\n\n    if (p1.equals(p2)) {\n      return 0;\n    }\n\n    return this.getProjection().measureLength(p1, p2);\n  },\n  computeGeometryLength: function computeGeometryLength(geometry) {\n    return geometry._computeGeodesicLength(this.getProjection());\n  },\n  computeGeometryArea: function computeGeometryArea(geometry) {\n    return geometry._computeGeodesicArea(this.getProjection());\n  },\n  identify: function identify(opts, callback) {\n    if (!opts) {\n      return this;\n    }\n\n    var reqLayers = opts['layers'];\n\n    if (!isArrayHasData(reqLayers)) {\n      return this;\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = reqLayers.length; i < len; i++) {\n      if (isString(reqLayers[i])) {\n        layers.push(this.getLayer(reqLayers[i]));\n      } else {\n        layers.push(reqLayers[i]);\n      }\n    }\n\n    var coordinate = new Coordinate(opts['coordinate']);\n    var options = extend({}, opts);\n    var hits = [];\n\n    for (var _i = layers.length - 1; _i >= 0; _i--) {\n      if (opts['count'] && hits.length >= opts['count']) {\n        break;\n      }\n\n      var layer = layers[_i];\n\n      if (!layer || !layer.getMap() || !opts['includeInvisible'] && !layer.isVisible() || !opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        continue;\n      }\n\n      var layerHits = layer.identify(coordinate, options);\n\n      if (layerHits) {\n        if (Array.isArray(layerHits)) {\n          pushIn(hits, layerHits);\n        } else {\n          hits.push(layerHits);\n        }\n      }\n    }\n\n    callback.call(this, hits);\n    return this;\n  }\n});\n\nMap$1.include({\n  _zoom: function _zoom(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n    nextZoom = this._checkZoom(nextZoom);\n    this.onZoomStart(nextZoom, origin);\n    this._frameZoom = this.getZoom();\n    this.onZoomEnd(nextZoom, origin);\n  },\n  _zoomAnimation: function _zoomAnimation(nextZoom, origin, startScale) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    nextZoom = this._checkZoom(nextZoom);\n\n    if (this.getZoom() === nextZoom) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n\n    this._startZoomAnim(nextZoom, origin, startScale);\n  },\n  _checkZoomOrigin: function _checkZoomOrigin(origin) {\n    if (!origin || this.options['zoomInCenter']) {\n      origin = new Point(this.width / 2, this.height / 2);\n    }\n\n    if (this.options['zoomOrigin']) {\n      origin = new Point(this.options['zoomOrigin']);\n    }\n\n    return origin;\n  },\n  _startZoomAnim: function _startZoomAnim(nextZoom, origin, startScale) {\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    var endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n\n    var duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n    this._frameZoom = this._startZoomVal;\n\n    this._animateTo({\n      'zoom': nextZoom,\n      'around': origin\n    }, {\n      'continueOnViewChanged': true,\n      'duration': duration\n    });\n  },\n  onZoomStart: function onZoomStart(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._zooming = true;\n    this._startZoomVal = this.getZoom();\n    this._startZoomCoord = this._containerPointToPrj(origin);\n\n    this._fireEvent('zoomstart', {\n      'from': this._startZoomVal,\n      'to': nextZoom\n    });\n  },\n  onZooming: function onZooming(nextZoom, origin, startScale) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var frameZoom = this._frameZoom;\n\n    if (frameZoom === nextZoom) {\n      return;\n    }\n\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    this._zoomTo(nextZoom, origin);\n\n    var res = this.getResolution(nextZoom),\n        fromRes = this.getResolution(this._startZoomVal),\n        scale = fromRes / res / startScale,\n        startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n\n    var offset = this.getViewPoint();\n\n    if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n      var pitch = this.getPitch();\n\n      var originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n\n      if (pitch) {\n        originOffset.y /= Math.cos(pitch * Math.PI / 180);\n      }\n\n      origin = origin.add(originOffset);\n    }\n\n    var matrix = {\n      'view': [scale, 0, 0, scale, (origin.x - offset.x) * (1 - scale), (origin.y - offset.y) * (1 - scale)]\n    };\n    var dpr = this.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      origin = origin.multi(dpr);\n    }\n\n    matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y * (1 - scale)];\n\n    this._fireEvent('zooming', {\n      'from': this._startZoomVal,\n      'to': nextZoom,\n      'origin': origin,\n      'matrix': matrix\n    });\n\n    this._frameZoom = nextZoom;\n  },\n  onZoomEnd: function onZoomEnd(nextZoom, origin) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var startZoomVal = this._startZoomVal;\n\n    this._zoomTo(nextZoom, origin);\n\n    this._zooming = false;\n\n    this._getRenderer().onZoomEnd();\n\n    this._fireEvent('zoomend', {\n      'from': startZoomVal,\n      'to': nextZoom\n    });\n\n    if (!this._verifyExtent(this._getPrjCenter())) {\n      this._panTo(this._prjMaxExtent.getCenter());\n    }\n  },\n  _zoomTo: function _zoomTo(nextZoom, origin) {\n    this._zoomLevel = nextZoom;\n\n    this._calcMatrices();\n\n    if (origin) {\n      this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n    }\n  },\n  _checkZoom: function _checkZoom(nextZoom) {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    if (nextZoom < minZoom) {\n      nextZoom = minZoom;\n    }\n\n    if (nextZoom > maxZoom) {\n      nextZoom = maxZoom;\n    }\n\n    return nextZoom;\n  }\n});\n\nfunction perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 2 * far * near * nf;\n  out[15] = 0;\n  return out;\n}\nfunction translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2],\n      a00,\n      a01,\n      a02,\n      a03,\n      a10,\n      a11,\n      a12,\n      a13,\n      a20,\n      a21,\n      a22,\n      a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\nfunction scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\nfunction rotateX(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n\n  if (a !== out) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\nfunction rotateZ(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n\n  if (a !== out) {\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\nfunction multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\nfunction invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15],\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction set$2(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\nfunction length(a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n\n  return out;\n}\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\nfunction distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot ? Math.hypot(x, y, z) : hypot(x, y, z);\n}\nfunction transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\nfunction hypot() {\n  var y = 0;\n  var i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n}\n\nfunction applyMatrix(out, v, e) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n  out[0] = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n  out[1] = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n  out[2] = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n  return out;\n}\nfunction matrixToQuaternion(out, te) {\n  var m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n  var s;\n\n  if (trace > 0) {\n    s = 0.5 / Math.sqrt(trace + 1.0);\n    out.w = 0.25 / s;\n    out.x = (m32 - m23) * s;\n    out.y = (m13 - m31) * s;\n    out.z = (m21 - m12) * s;\n  } else if (m11 > m22 && m11 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n    out.w = (m32 - m23) / s;\n    out.x = 0.25 * s;\n    out.y = (m12 + m21) / s;\n    out.z = (m13 + m31) / s;\n  } else if (m22 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n    out.w = (m13 - m31) / s;\n    out.x = (m12 + m21) / s;\n    out.y = 0.25 * s;\n    out.z = (m23 + m32) / s;\n  } else {\n    s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n    out.w = (m21 - m12) / s;\n    out.x = (m13 + m31) / s;\n    out.y = (m23 + m32) / s;\n    out.z = 0.25 * s;\n  }\n\n  return this;\n}\nfunction quaternionToMatrix(out, q) {\n  var te = out;\n  var x = q.x,\n      y = q.y,\n      z = q.z,\n      w = q.w;\n  var x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n  var xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n  var yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n  var wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  te[0] = 1 - (yy + zz);\n  te[4] = xy - wz;\n  te[8] = xz + wy;\n  te[1] = xy + wz;\n  te[5] = 1 - (xx + zz);\n  te[9] = yz - wx;\n  te[2] = xz - wy;\n  te[6] = yz + wx;\n  te[10] = 1 - (xx + yy);\n  te[3] = 0;\n  te[7] = 0;\n  te[11] = 0;\n  te[12] = 0;\n  te[13] = 0;\n  te[14] = 0;\n  te[15] = 1;\n  return te;\n}\nfunction setPosition(out, v) {\n  var te = out;\n  te[12] = v[0];\n  te[13] = v[1];\n  te[14] = v[2];\n  return out;\n}\nfunction lookAt(te, eye, target, up) {\n  var x = [0, 0, 0];\n  var y = [0, 0, 0];\n  var z = [0, 0, 0];\n  subtract(z, eye, target);\n\n  if (length(z) === 0) {\n    z[2] = 1;\n  }\n\n  normalize(z, z);\n  cross(x, up, z);\n\n  if (length(z) === 0) {\n    if (Math.abs(up[2]) === 1) {\n      z[0] += 0.0001;\n    } else {\n      z[2] += 0.0001;\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n  }\n\n  normalize(x, x);\n  cross(y, z, x);\n  te[0] = x[0];\n  te[4] = y[0];\n  te[8] = z[0];\n  te[1] = x[1];\n  te[5] = y[1];\n  te[9] = z[1];\n  te[2] = x[2];\n  te[6] = y[2];\n  te[10] = z[2];\n  return te;\n}\n\nvar RADIAN$1 = Math.PI / 180;\nvar DEFAULT_FOV = 0.6435011087932844;\nvar TEMP_COORD = new Coordinate(0, 0);\nMap$1.include({\n  getFov: function getFov() {\n    if (!this._fov) {\n      this._fov = DEFAULT_FOV;\n    }\n\n    return this._fov / RADIAN$1;\n  },\n  setFov: function setFov(fov) {\n    if (this.isZooming()) {\n      return this;\n    }\n\n    fov = Math.max(0.01, Math.min(60, fov));\n    if (this._fov === fov) return this;\n    var from = this.getFov();\n    this._fov = fov * RADIAN$1;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('fovchange', {\n      'from': from,\n      'to': this.getFov()\n    });\n\n    return this;\n  },\n  getBearing: function getBearing() {\n    if (!this._angle) {\n      return 0;\n    }\n\n    return -this._angle / RADIAN$1;\n  },\n  setBearing: function setBearing(bearing) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t rotate in IE9.');\n    }\n\n    var b = -wrap(bearing, -180, 180) * RADIAN$1;\n    if (this._angle === b) return this;\n    var from = this.getBearing();\n\n    this._fireEvent('rotatestart', {\n      'from': from,\n      'to': b\n    });\n\n    this._angle = b;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('rotate', {\n      'from': from,\n      'to': b\n    });\n\n    this._fireEvent('rotateend', {\n      'from': from,\n      'to': b\n    });\n\n    return this;\n  },\n  getPitch: function getPitch() {\n    if (!this._pitch) {\n      return 0;\n    }\n\n    return this._pitch / Math.PI * 180;\n  },\n  setPitch: function setPitch(pitch) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t tilt in IE9.');\n    }\n\n    var p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN$1;\n    if (this._pitch === p) return this;\n    var from = this.getPitch();\n\n    this._fireEvent('pitchstart', {\n      'from': from,\n      'to': p\n    });\n\n    this._pitch = p;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('pitch', {\n      'from': from,\n      'to': p\n    });\n\n    this._fireEvent('pitchend', {\n      'from': from,\n      'to': p\n    });\n\n    return this;\n  },\n  isTransforming: function isTransforming() {\n    return !!(this._pitch || this._angle);\n  },\n  getFrustumAltitude: function getFrustumAltitude() {\n    return this._frustumAltitude;\n  },\n  _calcFrustumAltitude: function _calcFrustumAltitude() {\n    var pitch = 90 - this.getPitch();\n    var fov = this.getFov() / 2;\n    var cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n\n    if (fov <= pitch) {\n      return cameraAlt;\n    }\n\n    fov = Math.PI * fov / 180;\n    var d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n        d2 = cameraAlt * Math.tan(fov * 2);\n    var d = Math.tan(fov) * (d1 + d2);\n    return cameraAlt + d;\n  },\n  _pointToContainerPoint: function () {\n    var a = [0, 0, 0];\n    return function (point, zoom, altitude, out) {\n      if (altitude === void 0) {\n        altitude = 0;\n      }\n\n      point = this._pointToPoint(point, zoom, out);\n\n      if (this.isTransforming() || altitude) {\n        altitude *= this._getResolution(zoom) / this._getResolution();\n        var _scale = this._glScale;\n        set$2(a, point.x * _scale, point.y * _scale, altitude * _scale);\n\n        var t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n\n        applyMatrix(t, t, this.projViewMatrix);\n        var w2 = this.width / 2,\n            h2 = this.height / 2;\n        t[0] = t[0] * w2 + w2;\n        t[1] = -(t[1] * h2) + h2;\n\n        if (out) {\n          out.x = t[0];\n          out.y = t[1];\n          return out;\n        }\n\n        return new Point(t[0], t[1]);\n      } else {\n        var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n\n        if (out) {\n          out.x = point.x;\n          out.y = point.y;\n        } else {\n          out = point;\n        }\n\n        out._sub(centerPoint.x, centerPoint.y);\n\n        out.set(out.x, -out.y);\n        return out._add(this.width / 2, this.height / 2);\n      }\n    };\n  }(),\n  _projIfBehindCamera: function () {\n    var vectorFromCam = new Array(3);\n    var proj = new Array(3);\n    var sub = new Array(3);\n    return function (position, cameraPos, camForward) {\n      subtract(vectorFromCam, position, cameraPos);\n      var camNormDot = dot(camForward, vectorFromCam);\n\n      if (camNormDot <= 0) {\n        scale$1(proj, camForward, camNormDot * 1.01);\n        add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n      }\n\n      return position;\n    };\n  }(),\n  _containerPointToPoint: function () {\n    var cp = [0, 0, 0],\n        coord0 = [0, 0, 0, 1],\n        coord1 = [0, 0, 0, 1];\n    return function (p, zoom, out) {\n      if (this.isTransforming()) {\n        var w2 = this.width / 2 || 1,\n            h2 = this.height / 2 || 1;\n        set$2(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n        set$2(coord0, cp[0], cp[1], 0);\n        set$2(coord1, cp[0], cp[1], 1);\n        coord0[3] = coord1[3] = 1;\n        applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n        applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n        var x0 = coord0[0];\n        var x1 = coord1[0];\n        var y0 = coord0[1];\n        var y1 = coord1[1];\n        var z0 = coord0[2];\n        var z1 = coord1[2];\n        var t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n\n        var _x = interpolate(x0, x1, t);\n\n        var _y = interpolate(y0, y1, t);\n\n        if (out) {\n          out.x = _x;\n          out.y = _y;\n        } else {\n          out = new Point(_x, _y);\n        }\n\n        out._multi(1 / this._glScale);\n\n        return zoom === undefined || this.getZoom() === zoom ? out : this._pointToPointAtZoom(out, zoom, out);\n      }\n\n      var centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n          scale$$1 = zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1;\n\n      var x = scale$$1 * (p.x - this.width / 2),\n          y = scale$$1 * (p.y - this.height / 2);\n      return centerPoint._add(x, -y);\n    };\n  }(),\n  _calcMatrices: function () {\n    var m0 = createMat4(),\n        m1 = createMat4();\n    return function () {\n      delete this._mapRes;\n      delete this._mapGlRes;\n      delete this._mapExtent2D;\n      delete this._mapGlExtent2D;\n      var size = this.getSize();\n      var w = size.width || 1,\n          h = size.height || 1;\n      this._glScale = this.getGLScale();\n      var pitch = this.getPitch() * Math.PI / 180;\n\n      var worldMatrix = this._getCameraWorldMatrix();\n\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, this.getPitch());\n\n      this.cameraFar = farZ;\n      this.cameraNear = Math.max(this._glScale * this.getResolution(this.getGLZoom()) * Math.cos(pitch), 0.1);\n      var projMatrix = this.projMatrix || createMat4();\n      perspective(projMatrix, fov, w / h, this.cameraNear, farZ);\n      this.projMatrix = projMatrix;\n      this.viewMatrix = invert(m0, worldMatrix);\n      this.projViewMatrix = multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n\n      this._calcCascadeMatrixes();\n\n      this.projViewMatrixInverse = multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, invert(m1, projMatrix));\n      this.domCssMatrix = this._calcDomMatrix();\n      this._frustumAltitude = this._calcFrustumAltitude();\n      this._mapRes = this._getResolution();\n      this._mapGlRes = this._getResolution(this.getGLZoom());\n      this._mapExtent2D = this._get2DExtent();\n      this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n    };\n  }(),\n  _getCameraFar: function _getCameraFar(fov, pitch) {\n    var cameraCenterDistance = this.cameraCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n    var farZ = cameraCenterDistance;\n\n    if (pitch > 0) {\n      pitch = pitch * Math.PI / 180;\n      var y;\n\n      if (2 / Math.PI - pitch <= fov / 2) {\n        y = 4 * cameraCenterDistance;\n      } else {\n        var tanFov = Math.tan(fov / 2);\n        var tanP = Math.tan(pitch);\n        y = cameraCenterDistance * tanFov / (1 / tanP - tanFov);\n      }\n\n      farZ += y;\n    }\n\n    return farZ + 1.0;\n  },\n  _calcCascadeMatrixes: function () {\n    var projMatrix = createMat4();\n\n    function cal(curPitch, pitch, out) {\n      var w = this.width;\n      var h = this.height;\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, pitch);\n\n      var cameraCenterDistance = this.cameraCenterDistance;\n      farZ = cameraCenterDistance + (farZ - cameraCenterDistance) / Math.cos((90 - pitch) * Math.PI / 180) * Math.cos((90 - curPitch) * Math.PI / 180);\n      perspective(projMatrix, fov, w / h, 0.1, farZ);\n      var viewMatrix = this.viewMatrix;\n      return multiply(out, projMatrix, viewMatrix);\n    }\n\n    return function () {\n      var pitch = this.getPitch();\n      var cascadePitch0 = this.options['cascadePitches'][0];\n      var cascadePitch1 = this.options['cascadePitches'][1];\n      var projViewMatrix0 = this.cascadeFrustumMatrix0 = this.cascadeFrustumMatrix0 || createMat4();\n      var projViewMatrix1 = this.cascadeFrustumMatrix1 = this.cascadeFrustumMatrix1 || createMat4();\n\n      if (pitch > cascadePitch0) {\n        cal.call(this, pitch, cascadePitch0, projViewMatrix0);\n      } else {\n        copy(this.cascadeFrustumMatrix0, this.projViewMatrix);\n      }\n\n      if (pitch > cascadePitch1) {\n        cal.call(this, pitch, cascadePitch1, projViewMatrix1);\n      } else {\n        copy(this.cascadeFrustumMatrix1, this.cascadeFrustumMatrix0);\n      }\n    };\n  }(),\n  _calcDomMatrix: function () {\n    var m = createMat4(),\n        m1 = createMat4(),\n        minusY = [1, -1, 1],\n        arr = [0, 0, 0];\n    return function () {\n      var width = this.width || 1;\n      var height = this.height || 1;\n      var cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * height;\n      scale(m, this.projMatrix, minusY);\n      translate(m, m, set$2(arr, 0, 0, -cameraToCenterDistance));\n\n      if (this._pitch) {\n        rotateX(m, m, this._pitch);\n      }\n\n      if (this._angle) {\n        rotateZ(m, m, this._angle);\n      }\n\n      identity(m1);\n      scale(m1, m1, set$2(arr, width / 2, -height / 2, 1));\n      return multiply(this.domCssMatrix || createMat4(), m1, m);\n    };\n  }(),\n  _getCameraWorldMatrix: function () {\n    var q = {};\n    return function () {\n      var targetZ = this.getGLZoom();\n      var size = this.getSize(),\n          scale$$1 = this.getGLScale();\n\n      var center2D = this._prjToPoint(this._prjCenter, targetZ);\n\n      this.cameraLookAt = set$2(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n      var pitch = this.getPitch() * RADIAN$1;\n      var bearing = this.getBearing() * RADIAN$1;\n\n      var ratio = this._getFovRatio();\n\n      var z = scale$$1 * (size.height || 1) / 2 / ratio;\n      var cz = z * Math.cos(pitch);\n      var dist = Math.sin(pitch) * z;\n      var cx = center2D.x - dist * Math.sin(bearing);\n      var cy = center2D.y - dist * Math.cos(bearing);\n      this.cameraPosition = set$2(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n      var d = dist || 1;\n      var up = this.cameraUp = set$2(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n      var m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n      lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n      var cameraForward = this.cameraForward || [0, 0, 0];\n      subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n      this.cameraForward = normalize(cameraForward, cameraForward);\n      matrixToQuaternion(q, m);\n      quaternionToMatrix(m, q);\n      setPosition(m, this.cameraPosition);\n      return m;\n    };\n  }(),\n  _getFovRatio: function _getFovRatio() {\n    var fov = this.getFov();\n    return Math.tan(fov / 2 * RADIAN$1);\n  },\n  _renderLayers: function _renderLayers() {\n    if (this.isInteracting()) {\n      return;\n    }\n\n    var layers = this._getLayers();\n\n    layers.forEach(function (layer) {\n      if (!layer) {\n        return;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    });\n  }\n});\n\nfunction createMat4() {\n  return identity(new Array(16));\n}\n\nMap$1.include({\n  _onViewChange: function _onViewChange(view) {\n    if (!this._viewHistory) {\n      this._viewHistory = [];\n      this._viewHistoryPointer = 0;\n    }\n\n    var old = this._getCurrentView();\n\n    for (var i = this._viewHistory.length - 1; i >= 0; i--) {\n      if (equalMapView(view, this._viewHistory[i])) {\n        this._viewHistoryPointer = i;\n\n        this._fireViewChange(old, view);\n\n        return;\n      }\n    }\n\n    if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n      this._viewHistory.splice(this._viewHistoryPointer + 1);\n    }\n\n    this._viewHistory.push(view);\n\n    var count = this.options['viewHistoryCount'];\n\n    if (count > 0 && this._viewHistory.length > count) {\n      this._viewHistory.splice(0, this._viewHistory.length - count);\n    }\n\n    this._viewHistoryPointer = this._viewHistory.length - 1;\n\n    this._fireViewChange(old, view);\n  },\n  zoomToPreviousView: function zoomToPreviousView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasPreviousView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[--this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasPreviousView: function hasPreviousView() {\n    if (!this._viewHistory || this._viewHistoryPointer === 0) {\n      return false;\n    }\n\n    return true;\n  },\n  zoomToNextView: function zoomToNextView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasNextView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[++this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasNextView: function hasNextView() {\n    if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _zoomToView: function _zoomToView(view, options) {\n    var _this = this;\n\n    var old = this.getView();\n\n    if (options['animation']) {\n      this._animateTo(view, {\n        'duration': options['duration']\n      }, function (frame) {\n        if (frame.state.playState === 'finished') {\n          _this._fireViewChange(old, view);\n        }\n      });\n    } else {\n      this.setView(view);\n\n      this._fireViewChange(old, view);\n    }\n  },\n  getViewHistory: function getViewHistory() {\n    return this._viewHistory;\n  },\n  _fireViewChange: function _fireViewChange(old, view) {\n    this._fireEvent('viewchange', {\n      'old': old,\n      'new': view\n    });\n  },\n  _getCurrentView: function _getCurrentView() {\n    if (!this._viewHistory) {\n      return null;\n    }\n\n    return this._viewHistory[this._viewHistoryPointer];\n  }\n});\nMap$1.mergeOptions({\n  'viewHistory': true,\n  'viewHistoryCount': 10\n});\n\nvar options$h = {\n  'mode': 'LineString',\n  'language': 'zh-CN',\n  'metric': true,\n  'imperial': false,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 3,\n    'lineOpacity': 1\n  },\n  'vertexSymbol': {\n    'markerType': 'ellipse',\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 3,\n    'markerWidth': 11,\n    'markerHeight': 11\n  },\n  'labelOptions': {\n    'textSymbol': {\n      'textFaceName': 'monospace',\n      'textLineSpacing': 1,\n      'textHorizontalAlignment': 'right',\n      'textDx': 15\n    },\n    'boxStyle': {\n      'padding': [6, 2],\n      'symbol': {\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerFillOpacity': 0.9,\n        'markerLineColor': '#b4b3b3'\n      }\n    }\n  },\n  'clearButtonSymbol': [{\n    'markerType': 'square',\n    'markerFill': '#fff',\n    'markerLineColor': '#b4b3b3',\n    'markerLineWidth': 2,\n    'markerWidth': 15,\n    'markerHeight': 15,\n    'markerDx': 20\n  }, {\n    'markerType': 'x',\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'markerDx': 20\n  }]\n};\n\nvar DistanceTool = function (_DrawTool) {\n  _inheritsLoose(DistanceTool, _DrawTool);\n\n  function DistanceTool(options) {\n    var _this;\n\n    _this = _DrawTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = DistanceTool.prototype;\n\n  _proto.clear = function clear() {\n    if (isArrayHasData(this._measureLayers)) {\n      for (var i = 0; i < this._measureLayers.length; i++) {\n        this._measureLayers[i].remove();\n      }\n    }\n\n    delete this._lastMeasure;\n    delete this._lastVertex;\n    this._measureLayers = [];\n    return this;\n  };\n\n  _proto.getMeasureLayers = function getMeasureLayers() {\n    return this._measureLayers;\n  };\n\n  _proto.getLastMeasure = function getLastMeasure() {\n    if (!this._lastMeasure) {\n      return 0;\n    }\n\n    return this._lastMeasure;\n  };\n\n  _proto.undo = function undo() {\n    _DrawTool.prototype.undo.call(this);\n\n    var pointer = this._historyPointer;\n\n    if (pointer !== this._vertexes.length) {\n      for (var i = pointer; i < this._vertexes.length; i++) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.remove();\n        }\n\n        this._vertexes[i].marker.remove();\n      }\n    }\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    _DrawTool.prototype.redo.call(this);\n\n    var i = this._historyPointer - 1;\n\n    if (this._vertexes[i]) {\n      if (!this._vertexes[i].marker.getLayer()) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.addTo(this._measureMarkerLayer);\n        }\n\n        this._vertexes[i].marker.addTo(this._measureMarkerLayer);\n      }\n    }\n\n    return this;\n  };\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var length;\n\n    if (toMeasure instanceof Geometry) {\n      length = map.computeGeometryLength(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      length = map.getProjection().measureLength(toMeasure);\n    }\n\n    this._lastMeasure = length;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 米', ' 公里', ' 英尺', ' 英里'];\n    } else {\n      units = [' m', ' km', ' feet', ' mile'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      length *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._registerMeasureEvents = function _registerMeasureEvents() {\n    this.on('drawstart', this._msOnDrawStart, this).on('drawvertex', this._msOnDrawVertex, this).on('mousemove', this._msOnMouseMove, this).on('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._afterEnable = function _afterEnable() {\n    this._registerMeasureEvents();\n  };\n\n  _proto._afterDisable = function _afterDisable() {\n    this.off('drawstart', this._msOnDrawStart, this).off('drawvertex', this._msOnDrawVertex, this).off('mousemove', this._msOnMouseMove, this).off('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._msOnDrawStart = function _msOnDrawStart(param) {\n    var map = this.getMap();\n\n    var prjCoord = map._pointToPrj(param['point2d']);\n\n    var uid = UID();\n    var layerId = 'distancetool_' + uid;\n    var markerLayerId = 'distancetool_markers_' + uid;\n\n    if (!map.getLayer(layerId)) {\n      this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n      this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n    } else {\n      this._measureLineLayer = map.getLayer(layerId);\n      this._measureMarkerLayer = map.getLayer(markerLayerId);\n    }\n\n    this._measureLayers.push(this._measureLineLayer);\n\n    this._measureLayers.push(this._measureMarkerLayer);\n\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    marker._setPrjCoordinates(prjCoord);\n\n    var content = this.options['language'] === 'zh-CN' ? '起点' : 'start';\n    var startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n\n    startLabel._setPrjCoordinates(prjCoord);\n\n    this._lastVertex = startLabel;\n\n    this._addVertexMarker(marker, startLabel);\n  };\n\n  _proto._msOnMouseMove = function _msOnMouseMove(param) {\n    var ms = this._measure(this._msGetCoordsToMeasure(param));\n\n    if (!this._tailMarker) {\n      var symbol = extendSymbol(this.options['vertexSymbol']);\n      symbol['markerWidth'] /= 2;\n      symbol['markerHeight'] /= 2;\n      this._tailMarker = new Marker(param['coordinate'], {\n        'symbol': symbol\n      }).addTo(this._measureMarkerLayer);\n      this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n    }\n\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n\n    this._tailMarker.setCoordinates(param['coordinate']);\n\n    this._tailMarker._setPrjCoordinates(lastCoord);\n\n    this._tailLabel.setContent(ms);\n\n    this._tailLabel.setCoordinates(param['coordinate']);\n\n    this._tailLabel._setPrjCoordinates(lastCoord);\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getCoordinates().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n    var geometry = param['geometry'];\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    var length = this._measure(geometry);\n\n    var vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n\n    this._addVertexMarker(marker, vertexLabel);\n\n    vertexLabel._setPrjCoordinates(lastCoord);\n\n    marker._setPrjCoordinates(lastCoord);\n\n    this._lastVertex = vertexLabel;\n  };\n\n  _proto._addVertexMarker = function _addVertexMarker(marker, vertexLabel) {\n    if (!this._vertexes) {\n      this._vertexes = [];\n    }\n\n    this._vertexes.push({\n      label: vertexLabel,\n      marker: marker\n    });\n\n    if (this._historyPointer !== undefined) {\n      this._vertexes.length = this._historyPointer;\n    }\n\n    this._measureMarkerLayer.addGeometry(marker);\n\n    if (vertexLabel) {\n      this._measureMarkerLayer.addGeometry(vertexLabel);\n    }\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var size = this._lastVertex.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(this._lastVertex.getCoordinates(), this._lastVertex._getPrjCoordinates(), size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getLength();\n  };\n\n  _proto._addClearMarker = function _addClearMarker(coordinates, prjCoord, dx) {\n    var symbol = this.options['clearButtonSymbol'];\n    var dxSymbol = {\n      'markerDx': (symbol['markerDx'] || 0) + dx,\n      'textDx': (symbol['textDx'] || 0) + dx\n    };\n\n    if (Array.isArray(symbol)) {\n      dxSymbol = symbol.map(function (s) {\n        if (s) {\n          return {\n            'markerDx': (s['markerDx'] || 0) + dx,\n            'textDx': (s['textDx'] || 0) + dx\n          };\n        }\n\n        return null;\n      });\n    }\n\n    symbol = extendSymbol(symbol, dxSymbol);\n    var endMarker = new Marker(coordinates, {\n      'symbol': symbol\n    });\n    var measureLineLayer = this._measureLineLayer,\n        measureMarkerLayer = this._measureMarkerLayer;\n    endMarker.on('click', function () {\n      measureLineLayer.remove();\n      measureMarkerLayer.remove();\n      return false;\n    }, this);\n    endMarker.addTo(this._measureMarkerLayer);\n\n    endMarker._setPrjCoordinates(prjCoord);\n  };\n\n  _proto._clearTailMarker = function _clearTailMarker() {\n    if (this._tailMarker) {\n      this._tailMarker.remove();\n\n      delete this._tailMarker;\n    }\n\n    if (this._tailLabel) {\n      this._tailLabel.remove();\n\n      delete this._tailLabel;\n    }\n  };\n\n  return DistanceTool;\n}(DrawTool);\n\nDistanceTool.mergeOptions(options$h);\n\nvar options$i = {\n  'mode': 'Polygon',\n  'symbol': {\n    'lineColor': '#000000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'lineDasharray': '',\n    'polygonFill': '#ffffff',\n    'polygonOpacity': 0.5\n  }\n};\n\nvar AreaTool = function (_DistanceTool) {\n  _inheritsLoose(AreaTool, _DistanceTool);\n\n  function AreaTool(options) {\n    var _this;\n\n    _this = _DistanceTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = AreaTool.prototype;\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var area;\n\n    if (toMeasure instanceof Geometry) {\n      area = map.computeGeometryArea(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      area = map.getProjection().measureArea(toMeasure);\n    }\n\n    this._lastMeasure = area;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n    } else {\n      units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      area *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      var sqmi = 5280 * 5280;\n      content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getShell().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var vertexMarker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    vertexMarker._setPrjCoordinates(prjCoord);\n\n    this._measure(param['geometry']);\n\n    this._lastVertex = vertexMarker;\n\n    this._addVertexMarker(vertexMarker);\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var ms = this._measure(param['geometry']);\n\n    var endLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n\n    endLabel._setPrjCoordinates(prjCoord);\n\n    var size = endLabel.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(param['coordinate'], prjCoord, size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getArea();\n  };\n\n  return AreaTool;\n}(DistanceTool);\n\nAreaTool.mergeOptions(options$i);\n\nvar circleHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var circle = new Circle(center, 0);\n\n    circle._setPrjCoordinates(prjCoord[0]);\n\n    return circle;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var radius = map.computeLength(geometry.getCenter(), nextCoord);\n    geometry.setRadius(radius);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('circle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, circleHooks));\nDrawTool.registerMode('freeHandCircle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, circleHooks));\nvar ellipseHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var ellipse = new Ellipse(center, 0, 0);\n\n    ellipse._setPrjCoordinates(prjCoord[0]);\n\n    return ellipse;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var center = geometry.getCenter();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var rx = map.computeLength(center, new Coordinate({\n      x: nextCoord.x,\n      y: center.y\n    }));\n    var ry = map.computeLength(center, new Coordinate({\n      x: center.x,\n      y: nextCoord.y\n    }));\n    geometry.setWidth(rx * 2);\n    geometry.setHeight(ry * 2);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('ellipse', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, ellipseHooks));\nDrawTool.registerMode('freeHandEllipse', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, ellipseHooks));\nvar rectangleHooks = {\n  'create': function create(projection, prjCoords) {\n    var rect = new Polygon([]);\n    rect._firstClick = prjCoords[0];\n    return rect;\n  },\n  'update': function update(projection, prjCoords, geometry, param) {\n    var map = geometry.getMap();\n    var containerPoint = param['containerPoint'];\n\n    var firstClick = map._prjToContainerPoint(geometry._firstClick);\n\n    var ring = [[firstClick.x, firstClick.y], [containerPoint.x, firstClick.y], [containerPoint.x, containerPoint.y], [firstClick.x, containerPoint.y]];\n    geometry.setCoordinates(ring.map(function (c) {\n      return map.containerPointToCoord(new Point(c));\n    }));\n\n    geometry._setPrjCoordinates(ring.map(function (c) {\n      return map._containerPointToPrj(new Point(c));\n    }));\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('rectangle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, rectangleHooks));\nDrawTool.registerMode('freeHandRectangle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, rectangleHooks));\nDrawTool.registerMode('point', {\n  'clickLimit': 1,\n  'action': ['click'],\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var marker = new Marker(center);\n\n    marker._setPrjCoordinates(prjCoord[0]);\n\n    return marker;\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nvar polygonHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, path, geometry) {\n    var symbol = geometry.getSymbol();\n    var prjCoords;\n\n    if (Array.isArray(path)) {\n      prjCoords = path;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(path);\n    }\n\n    var coordinates = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(coordinates);\n\n    geometry._setPrjCoordinates(prjCoords);\n\n    var layer = geometry.getLayer();\n\n    if (layer) {\n      var polygon = layer.getGeometryById('polygon');\n\n      if (!polygon && prjCoords.length >= 3) {\n        polygon = new Polygon([coordinates], {\n          'id': 'polygon'\n        });\n\n        if (symbol) {\n          var pSymbol = extendSymbol(symbol, {\n            'lineOpacity': 0\n          });\n          polygon.setSymbol(pSymbol);\n        }\n\n        polygon.addTo(layer);\n      }\n\n      if (polygon) {\n        polygon._setPrjCoordinates(prjCoords);\n      }\n    }\n  },\n  'generate': function generate(geometry) {\n    var polygon = new Polygon(geometry.getCoordinates(), {\n      'symbol': geometry.getSymbol()\n    });\n\n    polygon._setPrjCoordinates(geometry._getPrjCoordinates());\n\n    polygon._projCode = geometry._projCode;\n    return polygon;\n  }\n};\nDrawTool.registerMode('polygon', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, polygonHooks));\nDrawTool.registerMode('freeHandPolygon', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, polygonHooks));\nvar lineStringHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var prjCoords;\n\n    if (Array.isArray(prjPath)) {\n      prjCoords = prjPath;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(prjPath);\n    }\n\n    var path = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(path);\n\n    geometry._setPrjCoordinates(prjCoords);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('linestring', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, lineStringHooks));\nDrawTool.registerMode('freeHandLinestring', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, lineStringHooks));\nDrawTool.registerMode('arccurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var arc = new ArcCurve(path);\n\n    arc._setPrjCoordinates(prjPath);\n\n    return arc;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('quadbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new QuadBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('cubicbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new CubicBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('boxZoom', {\n  'action': ['mousedown', 'mousemove', 'mouseup'],\n  'create': function create(projection, prjCoord) {\n    prjCoord = prjCoord[0];\n    var center = projection.unproject(prjCoord);\n    var marker = new Marker(center);\n    marker._firstClick = prjCoord;\n    return marker;\n  },\n  'update': function update(projection, prjCoord, geometry, param) {\n    var map = geometry.getMap();\n\n    var p1 = map._prjToContainerPoint(geometry._firstClick),\n        p2 = param['containerPoint'];\n\n    prjCoord = map._containerPointToPrj(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n    var center = projection.unproject(prjCoord);\n\n    geometry.setCoordinates(center)._setPrjCoordinates(prjCoord);\n\n    geometry.updateSymbol({\n      markerWidth: Math.abs(p1.x - p2.x),\n      markerHeight: Math.abs(p1.y - p2.y)\n    });\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\n\nfunction parse(arcConf) {\n  var tileInfo = arcConf['tileInfo'],\n      tileSize = [tileInfo['cols'], tileInfo['rows']],\n      resolutions = [],\n      lods = tileInfo['lods'];\n\n  for (var i = 0, len = lods.length; i < len; i++) {\n    resolutions.push(lods[i]['resolution']);\n  }\n\n  var fullExtent = arcConf['fullExtent'],\n      origin = tileInfo['origin'],\n      tileSystem = [1, -1, origin['x'], origin['y']];\n  delete fullExtent['spatialReference'];\n  return {\n    'spatialReference': {\n      'resolutions': resolutions,\n      'fullExtent': fullExtent\n    },\n    'tileSystem': tileSystem,\n    'tileSize': tileSize\n  };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url) && url.substring(0, 1) !== '{') {\n    Ajax.getJSON(url, function (err, json) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var spatialRef = parse(json);\n      cb(null, spatialRef);\n    }, options);\n  } else {\n    if (isString(url)) {\n      url = parseJSON(url);\n    }\n\n    var spatialRef = parse(url);\n    cb(null, spatialRef);\n  }\n\n  return this;\n};\n\nfunction getProjection(projection) {\n  var prj = projection.indexOf('EPSG') > -1 ? projection : 'EPSG:' + projection;\n  prj = strReplace(prj, [['4490', '4326'], ['102100', '3857'], ['900913', '3857']]);\n  return prj;\n}\n\nfunction strReplace(str, repArray) {\n  if (repArray === void 0) {\n    repArray = [];\n  }\n\n  repArray.forEach(function (rep) {\n    var template = rep[0],\n        value = rep[1];\n    str = str.replace(template, value);\n  });\n  return str;\n}\n\nfunction parseWMTSXML(str, requestUrl, options) {\n  var parser = new DOMParser();\n  var xmlDoc = parser.parseFromString(str, 'text/xml');\n  var content = xmlDoc.querySelectorAll('Contents')[0];\n\n  if (!content) {\n    return [];\n  }\n\n  var layers = content.getElementsByTagName('Layer');\n\n  if (!layers.length) {\n    return [];\n  }\n\n  var TileMatrixSets = [];\n\n  for (var i = 0, len = content.childNodes.length; i < len; i++) {\n    if (content.childNodes[i].nodeName === 'TileMatrixSet') {\n      TileMatrixSets.push(content.childNodes[i]);\n    }\n  }\n\n  if (!TileMatrixSets.length) {\n    return [];\n  }\n\n  var result = [];\n\n  for (var _i = 0, _len = layers.length; _i < _len; _i++) {\n    var layer = layers[_i];\n    var style = layer.querySelectorAll('Style')[0];\n\n    if (style) {\n      style = style.getElementsByTagName('ows:Identifier')[0];\n\n      if (style) {\n        style = style.textContent;\n      }\n    }\n\n    var layerName = layer.getElementsByTagName('ows:Identifier')[0];\n\n    if (layerName) {\n      layerName = layerName.textContent;\n    }\n\n    var resourceURL = layer.querySelectorAll('ResourceURL')[0];\n    var url = '';\n\n    if (resourceURL) {\n      url = resourceURL.attributes.template.value;\n    }\n\n    var _parseTileMatrixSet = parseTileMatrixSet(TileMatrixSets, _i, options),\n        resolutions = _parseTileMatrixSet.resolutions,\n        tileSize = _parseTileMatrixSet.tileSize,\n        tileSystem = _parseTileMatrixSet.tileSystem,\n        projection = _parseTileMatrixSet.projection,\n        TileMatrixSet = _parseTileMatrixSet.TileMatrixSet;\n\n    if (!url.length) {\n      url = requestUrl.substr(0, requestUrl.lastIndexOf('?'));\n      url += '?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT=tiles&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}';\n    }\n\n    var urlTemplate = strReplace(url, [['{LAYER}', layerName], ['{Layer}', layerName], ['{layer}', layerName], ['{STYLE}', style], ['{Style}', style], ['{style}', style], ['{TileMatrixSet}', TileMatrixSet], ['{TileMatrix}', '{z}'], ['{TileRow}', '{y}'], ['{TileCol}', '{x}']]);\n    result.push({\n      tileSize: tileSize,\n      tileSystem: tileSystem,\n      spatialReference: {\n        resolutions: resolutions,\n        projection: projection\n      },\n      urlTemplate: urlTemplate,\n      info: {\n        layerName: layerName,\n        TileMatrixSet: TileMatrixSet,\n        style: style,\n        tileSize: tileSize,\n        tileSystem: tileSystem,\n        resolutions: resolutions,\n        projection: projection,\n        urlTemplate: urlTemplate\n      }\n    });\n  }\n\n  return result;\n}\n\nfunction parseTileMatrixSet(TileMatrixSets, index, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var TileMatrixSet = TileMatrixSets[index];\n  var TileMatrixs = TileMatrixSet.getElementsByTagName('TileMatrix');\n  var resolutions = [],\n      tileSystem = [],\n      tileSize = [];\n  var projection, tset;\n\n  if (!projection) {\n    var supportedCRS = TileMatrixSet.getElementsByTagName('ows:SupportedCRS')[0];\n\n    if (supportedCRS) {\n      projection = supportedCRS.textContent;\n      projection = projection.split('EPSG')[1];\n\n      while (projection.indexOf(':') > -1) {\n        projection = projection.replace(':', '');\n      }\n\n      projection = getProjection(projection);\n    }\n  }\n\n  if (!tset) {\n    tset = TileMatrixSet.getElementsByTagName('ows:Identifier')[0];\n\n    if (tset) {\n      tset = tset.textContent;\n    }\n  }\n\n  var transformValue = 0.0002645833333333333;\n\n  if (options.isArcgis) {\n    transformValue = 0.00028;\n  }\n\n  if (projection && projection.indexOf('4326') > -1) {\n    transformValue = 2.3767925226029154e-9;\n\n    if (options.isArcgis) {\n      transformValue = 2.518101729011901e-9;\n    }\n  }\n\n  var minLevel = Infinity;\n\n  for (var _index = 0; _index < TileMatrixs.length; _index++) {\n    var TileMatrix = TileMatrixs[_index];\n    var level = TileMatrix.getElementsByTagName('ows:Identifier')[0].textContent;\n    level = parseInt(level);\n    minLevel = Math.min(minLevel, level);\n    var ScaleDenominator = TileMatrix.getElementsByTagName('ScaleDenominator')[0].textContent;\n    var TopLeftCorner = TileMatrix.getElementsByTagName('TopLeftCorner')[0].textContent;\n    var TileWidth = TileMatrix.getElementsByTagName('TileWidth')[0].textContent;\n    var TileHeight = TileMatrix.getElementsByTagName('TileHeight')[0].textContent;\n\n    if (tileSize.length === 0) {\n      tileSize.push(parseInt(TileWidth), parseInt(TileHeight));\n    }\n\n    if (tileSystem.length === 0) {\n      var _TopLeftCorner$split$ = TopLeftCorner.split(' ').filter(function (s) {\n        return s !== '';\n      }).map(function (v) {\n        return parseFloat(v);\n      }),\n          x = _TopLeftCorner$split$[0],\n          y = _TopLeftCorner$split$[1];\n\n      if (x > 0) {\n        tileSystem.push(1, -1, y, x);\n      } else {\n        tileSystem.push(1, -1, x, y);\n      }\n    }\n\n    var res = parseFloat(ScaleDenominator) * transformValue;\n    resolutions.push(res);\n  }\n\n  if (minLevel > 0) {\n    var _res = resolutions[0];\n\n    for (var i = minLevel - 1; i >= 0; i--) {\n      _res = _res * 2;\n      resolutions.splice(0, 0, _res);\n    }\n  }\n\n  return {\n    resolutions: resolutions,\n    tileSize: tileSize,\n    tileSystem: tileSystem,\n    projection: projection,\n    TileMatrixSet: tset\n  };\n}\n\nSpatialReference.loadWMTS = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url)) {\n    Ajax.get(url, function (err, xml) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var layers = parseWMTSXML(xml, url, options);\n      cb(null, layers);\n    }, options);\n  }\n\n  return this;\n};\n\nvar options$j = {\n  'eventsPropagation': false,\n  'eventsToStop': null,\n  'dx': 0,\n  'dy': 0,\n  'autoPan': false,\n  'autoPanDuration': 600,\n  'single': true,\n  'animation': 'scale',\n  'animationOnHide': true,\n  'animationDuration': 500,\n  'pitchWithMap': false,\n  'rotateWithMap': false\n};\n\nvar UIComponent = function (_Eventable) {\n  _inheritsLoose(UIComponent, _Eventable);\n\n  function UIComponent(options) {\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = UIComponent.prototype;\n\n  _proto.addTo = function addTo(owner) {\n    this._owner = owner;\n\n    this._switchEvents('on');\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add');\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._owner) {\n      return null;\n    }\n\n    if (this._owner.getBaseLayer) {\n      return this._owner;\n    }\n\n    return this._owner.getMap();\n  };\n\n  _proto.show = function show(coordinate) {\n    var map = this.getMap();\n\n    if (!map) {\n      return this;\n    }\n\n    if (!this._mapEventsOn) {\n      this._switchMapEvents('on');\n    }\n\n    coordinate = coordinate || this._coordinate || this._owner.getCenter();\n    var visible = this.isVisible();\n    this.fire('showstart');\n\n    var container = this._getUIContainer();\n\n    this._coordinate = coordinate;\n\n    this._removePrevDOM();\n\n    var dom = this.__uiDOM = this.buildOn(map);\n    dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n    if (!dom) {\n      this.fire('showend');\n      return this;\n    }\n\n    this._measureSize(dom);\n\n    if (this._singleton()) {\n      map[this._uiDomKey()] = dom;\n    }\n\n    this._setPosition();\n\n    dom.style[TRANSITION] = null;\n    container.appendChild(dom);\n\n    var anim = this._getAnimation();\n\n    if (visible) {\n      anim.ok = false;\n    }\n\n    if (anim.ok) {\n      if (anim.fade) {\n        dom.style.opacity = 0;\n      }\n\n      if (anim.scale) {\n        if (this.getTransformOrigin) {\n          var origin = this.getTransformOrigin();\n          dom.style[TRANSFORMORIGIN] = origin;\n        }\n\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n      }\n    }\n\n    dom.style.display = '';\n\n    if (this.options['eventsToStop']) {\n      on(dom, this.options['eventsToStop'], stopPropagation);\n    }\n\n    if (this.options['autoPan']) {\n      this._autoPan();\n    }\n\n    var transition = anim.transition;\n\n    if (anim.ok && transition) {\n      dom.offsetHeight;\n\n      if (transition) {\n        dom.style[TRANSITION] = transition;\n      }\n\n      if (anim.fade) {\n        dom.style.opacity = 1;\n      }\n\n      if (anim.scale) {\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n      }\n    }\n\n    this.fire('showend');\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this = this;\n\n    if (!this.getDOM() || !this.getMap()) {\n      return this;\n    }\n\n    var anim = this._getAnimation(),\n        dom = this.getDOM();\n\n    if (!this.options['animationOnHide']) {\n      anim.ok = false;\n    }\n\n    if (!anim.ok) {\n      dom.style.display = 'none';\n      this.fire('hide');\n    } else {\n      dom.offsetHeight;\n      dom.style[TRANSITION] = anim.transition;\n      setTimeout(function () {\n        dom.style.display = 'none';\n\n        _this.fire('hide');\n      }, this.options['animationDuration']);\n    }\n\n    if (anim.fade) {\n      dom.style.opacity = 0;\n    }\n\n    if (anim.scale) {\n      dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    var dom = this.getDOM();\n    return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n  };\n\n  _proto.remove = function remove() {\n    delete this._mapEventsOn;\n\n    if (!this._owner) {\n      return this;\n    }\n\n    this.hide();\n\n    this._switchEvents('off');\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (!this._singleton() && this.__uiDOM) {\n      this._removePrevDOM();\n    }\n\n    delete this._owner;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (this._size) {\n      return this._size.copy();\n    } else {\n      return null;\n    }\n  };\n\n  _proto.getOwner = function getOwner() {\n    return this._owner;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this.__uiDOM;\n  };\n\n  _proto.getPosition = function getPosition() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var p = this._getViewPoint()._round();\n\n    if (this.getOffset) {\n      var o = this.getOffset()._round();\n\n      if (o) {\n        p._add(o);\n      }\n    }\n\n    return p;\n  };\n\n  _proto._getAnimation = function _getAnimation() {\n    var anim = {\n      'fade': false,\n      'scale': false\n    };\n    var animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n\n    for (var i = 0; i < animations.length; i++) {\n      var trimed = trim(animations[i]);\n\n      if (trimed === 'fade') {\n        anim.fade = true;\n      } else if (trimed === 'scale') {\n        anim.scale = true;\n      }\n    }\n\n    var transition = null;\n\n    if (anim.fade) {\n      transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n    }\n\n    if (anim.scale) {\n      transition = transition ? transition + ',' : '';\n      transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n    }\n\n    anim.transition = transition;\n    anim.ok = transition !== null;\n    return anim;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner && this._owner.getAltitude) {\n      var altitude = this._owner.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    return map.distanceToPoint(altitude, 0, undefined, center).x * sign(altitude);\n  };\n\n  _proto._autoPan = function _autoPan() {\n    var map = this.getMap(),\n        dom = this.getDOM();\n\n    if (map.isMoving()) {\n      return;\n    }\n\n    var point = this._pos;\n    var mapSize = map.getSize(),\n        mapWidth = mapSize['width'],\n        mapHeight = mapSize['height'];\n    var containerPoint = map.viewPointToContainerPoint(point);\n    var clientWidth = parseInt(dom.clientWidth),\n        clientHeight = parseInt(dom.clientHeight);\n    var left = 0,\n        top = 0;\n\n    if (containerPoint.x < 0) {\n      left = -(containerPoint.x - clientWidth / 2);\n    } else if (containerPoint.x + clientWidth - 35 > mapWidth) {\n      left = mapWidth - (containerPoint.x + clientWidth * 3 / 2);\n    }\n\n    if (containerPoint.y - clientHeight < 0) {\n      top = -(containerPoint.y - clientHeight) + 50;\n    } else if (containerPoint.y > mapHeight) {\n      top = mapHeight - containerPoint.y - clientHeight - 30;\n    }\n\n    if (top !== 0 || left !== 0) {\n      map.panBy(new Point(left, top), {\n        'duration': this.options['autoPanDuration']\n      });\n    }\n  };\n\n  _proto._measureSize = function _measureSize(dom) {\n    var container = this._getUIContainer();\n\n    dom.style.position = 'absolute';\n    dom.style.left = -99999 + 'px';\n    var anchor = dom.style.bottom ? 'bottom' : 'top';\n    dom.style[anchor] = -99999 + 'px';\n    dom.style.display = '';\n    container.appendChild(dom);\n    this._size = new Size(dom.clientWidth, dom.clientHeight);\n    dom.style.display = 'none';\n    dom.style.left = '0px';\n    dom.style[anchor] = '0px';\n    return this._size;\n  };\n\n  _proto._removePrevDOM = function _removePrevDOM() {\n    if (this.onDomRemove) {\n      this.onDomRemove();\n    }\n\n    var eventsToStop = this.options['eventsToStop'];\n\n    if (this._singleton()) {\n      var map = this.getMap(),\n          key = this._uiDomKey();\n\n      if (map[key]) {\n        if (eventsToStop) {\n          off(map[key], eventsToStop, stopPropagation);\n        }\n\n        removeDomNode(map[key]);\n        delete map[key];\n      }\n\n      delete this.__uiDOM;\n    } else if (this.__uiDOM) {\n      if (eventsToStop) {\n        off(this.__uiDOM, eventsToStop, stopPropagation);\n      }\n\n      removeDomNode(this.__uiDOM);\n      delete this.__uiDOM;\n    }\n  };\n\n  _proto._uiDomKey = function _uiDomKey() {\n    return '__ui_' + this._getClassName();\n  };\n\n  _proto._singleton = function _singleton() {\n    return this.options['single'];\n  };\n\n  _proto._getUIContainer = function _getUIContainer() {\n    return this.getMap()._panels['ui'];\n  };\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIComponent';\n  };\n\n  _proto._switchMapEvents = function _switchMapEvents(to) {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this._mapEventsOn = to === 'on';\n\n    var events = this._getDefaultEvents();\n\n    if (this.getEvents) {\n      extend(events, this.getEvents());\n    }\n\n    if (events) {\n      for (var p in events) {\n        if (events.hasOwnProperty(p)) {\n          map[to](p, events[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    this._switchMapEvents(to);\n\n    var ownerEvents = this._getOwnerEvents();\n\n    if (this._owner) {\n      for (var p in ownerEvents) {\n        if (ownerEvents.hasOwnProperty(p)) {\n          this._owner[to](p, ownerEvents[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return {\n      'zooming rotate pitch': this.onEvent,\n      'zoomend': this.onZoomEnd,\n      'moving': this.onMoving,\n      'resize': this.onResize\n    };\n  };\n\n  _proto._getOwnerEvents = function _getOwnerEvents() {\n    var events = {};\n\n    if (this._owner && this._owner instanceof Geometry) {\n      events.positionchange = this.onGeometryPositionChange;\n    }\n\n    if (this.getOwnerEvents) {\n      extend(events, this.getOwnerEvents());\n    }\n\n    return events;\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange(param) {\n    if (this._owner && this.isVisible()) {\n      this.show(param['target'].getCenter());\n    }\n  };\n\n  _proto.onMoving = function onMoving() {\n    if (this.isVisible() && this.getMap().isTransforming()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onEvent = function onEvent() {\n    if (this.isVisible()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto.onResize = function onResize() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var renderer = this.getMap()._getRenderer();\n\n    renderer.callInNextFrame(this._setPosition.bind(this));\n  };\n\n  _proto._setPosition = function _setPosition() {\n    var dom = this.getDOM();\n    if (!dom) return;\n    dom.style[TRANSITION] = null;\n    var p = this.getPosition();\n    this._pos = p;\n    dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n  };\n\n  _proto._toCSSTranslate = function _toCSSTranslate(p) {\n    if (!p) {\n      return '';\n    }\n\n    if (Browser$1.any3d) {\n      var map = this.getMap(),\n          bearing = map ? map.getBearing() : 0,\n          pitch = map ? map.getPitch() : 0;\n      var r = '';\n\n      if (this.options['pitchWithMap'] && pitch) {\n        r += \" rotateX(\" + Math.round(pitch) + \"deg)\";\n      }\n\n      if (this.options['rotateWithMap'] && bearing) {\n        r += \" rotateZ(\" + Math.round(-bearing) + \"deg)\";\n      }\n\n      return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n    } else {\n      return 'translate(' + p.x + 'px,' + p.y + 'px)';\n    }\n  };\n\n  UIComponent.isSupport = function isSupport(owner) {\n    if (owner && isFunction(owner.on) && isFunction(owner.off) && isFunction(owner.getCenter)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return UIComponent;\n}(Eventable(Class));\n\nUIComponent.mergeOptions(options$j);\n\nvar options$k = {\n  'containerClass': null,\n  'eventsPropagation': true,\n  'draggable': false,\n  'single': false,\n  'content': null\n};\nvar domEvents = 'mousedown ' + 'mouseup ' + 'mouseenter ' + 'mouseover ' + 'mouseout ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar UIMarker = function (_Handlerable) {\n  _inheritsLoose(UIMarker, _Handlerable);\n\n  function UIMarker(coordinate, options) {\n    var _this;\n\n    _this = _Handlerable.call(this, options) || this;\n    _this._markerCoord = new Coordinate(coordinate);\n    return _this;\n  }\n\n  var _proto = UIMarker.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIMarker';\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    this._markerCoord = coordinates;\n    this.fire('positionchange');\n\n    if (this.isVisible()) {\n      this._coordinate = this._markerCoord;\n\n      this._setPosition();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._markerCoord;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.show();\n  };\n\n  _proto.show = function show() {\n    return _Handlerable.prototype.show.call(this, this._markerCoord);\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (isString(this.options['content'])) {\n      dom = createEl('div');\n      dom.innerHTML = this.options['content'];\n    } else {\n      dom = this.options['content'];\n    }\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    this._registerDOMEvents(dom);\n\n    return dom;\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    return new Point(-size.width / 2, -size.height / 2);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    return 'center center';\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    var dom = this.getDOM();\n\n    this._removeDOMEvents(dom);\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  };\n\n  _proto._registerDOMEvents = function _registerDOMEvents(dom) {\n    on(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._onDomEvents = function _onDomEvents(e) {\n    var event = this.getMap()._parseEvent(e, e.type);\n\n    this.fire(e.type, event);\n  };\n\n  _proto._removeDOMEvents = function _removeDOMEvents(dom) {\n    off(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = map.coordToContainerPoint(this.getCoordinates());\n    var size = this.getSize(),\n        width = size.width,\n        height = size.height;\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(-width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(0, height / 2)), map.containerPointToCoordinate(containerPoint.add(0, -height / 2))];\n    return anchors;\n  };\n\n  return UIMarker;\n}(Handlerable(UIComponent));\n\nUIMarker.mergeOptions(options$k);\nvar EVENTS$1 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar UIMarkerDragHandler = function (_Handler) {\n  _inheritsLoose(UIMarkerDragHandler, _Handler);\n\n  function UIMarkerDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto2 = UIMarkerDragHandler.prototype;\n\n  _proto2.addHooks = function addHooks() {\n    this.target.on(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2.removeHooks = function removeHooks() {\n    this.target.off(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2._startDrag = function _startDrag(param) {\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = param['coordinate'];\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    this.target.fire('dragstart', param);\n  };\n\n  _proto2._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.target.getDOM(), {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this);\n\n    this._dragHandler.on('dragging', this._dragging, this);\n\n    this._dragHandler.on('mouseup', this._endDrag, this);\n\n    this._dragHandler.enable();\n  };\n\n  _proto2._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2._onMouseDown = function _onMouseDown(param) {\n    stopPropagation(param['domEvent']);\n  };\n\n  _proto2._dragging = function _dragging(param) {\n    var target = this.target,\n        map = target.getMap(),\n        eventParam = map._parseEvent(param['domEvent']),\n        domEvent = eventParam['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._isDragging) {\n      this._isDragging = true;\n      return;\n    }\n\n    var coord = eventParam['coordinate'],\n        point = eventParam['containerPoint'];\n\n    if (!this._lastCoord) {\n      this._lastCoord = coord;\n    }\n\n    if (!this._lastPoint) {\n      this._lastPoint = point;\n    }\n\n    var coordOffset = coord.sub(this._lastCoord),\n        pointOffset = point.sub(this._lastPoint);\n    this._lastCoord = coord;\n    this._lastPoint = point;\n    this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n    eventParam['coordOffset'] = coordOffset;\n    eventParam['pointOffset'] = pointOffset;\n    target.fire('dragging', eventParam);\n  };\n\n  _proto2._endDrag = function _endDrag(param) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (this._dragHandler) {\n      target.off('click', this._endDrag, this);\n\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n\n    if (!map) {\n      return;\n    }\n\n    var eventParam = map._parseEvent(param['domEvent']);\n\n    target.fire('dragend', eventParam);\n  };\n\n  _proto2.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return UIMarkerDragHandler;\n}(Handler$1);\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\n\nvar options$l = {\n  'containerClass': 'maptalks-msgBox',\n  'autoPan': true,\n  'autoCloseOn': null,\n  'autoOpenOn': 'click',\n  'width': 300,\n  'minHeight': 120,\n  'custom': false,\n  'title': null,\n  'content': null\n};\n\nvar InfoWindow = function (_UIComponent) {\n  _inheritsLoose(InfoWindow, _UIComponent);\n\n  function InfoWindow() {\n    return _UIComponent.apply(this, arguments) || this;\n  }\n\n  var _proto = InfoWindow.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'InfoWindow';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner instanceof Geometry) {\n      if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n        owner.removeInfoWindow();\n      }\n\n      owner._infoWindow = this;\n    }\n\n    return _UIComponent.prototype.addTo.call(this, owner);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.setTitle = function setTitle(title) {\n    var old = title;\n    this.options['title'] = title;\n    this.fire('contentchange', {\n      'old': old,\n      'new': title\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getTitle = function getTitle() {\n    return this.options['title'];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        var _dom = createEl('div');\n\n        _dom.innerHTML = this.options['content'];\n        return _dom;\n      } else {\n        return this.options['content'];\n      }\n    }\n\n    var dom = createEl('div');\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    dom.style.width = this._getWindowWidth() + 'px';\n    dom.style.bottom = '0px';\n    var content = '<em class=\"maptalks-ico\"></em>';\n\n    if (this.options['title']) {\n      content += '<h2>' + this.options['title'] + '</h2>';\n    }\n\n    content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n    dom.innerHTML = content;\n    var msgContent = dom.querySelector('.maptalks-msgContent');\n\n    if (isString(this.options['content'])) {\n      msgContent.innerHTML = this.options['content'];\n    } else {\n      msgContent.appendChild(this.options['content']);\n    }\n\n    this._onCloseBtnClick = this.hide.bind(this);\n    var closeBtn = dom.querySelector('.maptalks-close');\n    addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n    return dom;\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var size = this.getSize();\n    return size.width / 2 + 'px bottom';\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    var o = new Point(-size['width'] / 2, 0);\n\n    if (!this.options['custom']) {\n      o._sub(4, 12);\n    } else {\n      o._sub(0, size['height']);\n    }\n\n    var owner = this.getOwner();\n\n    if (owner instanceof Marker || owner instanceof MultiPoint) {\n      var painter, markerSize;\n\n      if (owner instanceof Marker) {\n        painter = owner._getPainter();\n        markerSize = owner.getSize();\n      } else {\n        var children = owner.getGeometries();\n\n        if (!children || !children.length) {\n          return o;\n        }\n\n        painter = children[0]._getPainter();\n        markerSize = children[0].getSize();\n      }\n\n      if (painter) {\n        var fixExtent = painter.getFixedExtent();\n\n        o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n      } else {\n        o._add(0, -markerSize.height);\n      }\n    }\n\n    return o;\n  };\n\n  _proto.show = function show(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!this.getMap().options['enableInfoWindow']) {\n      return this;\n    }\n\n    return _UIComponent.prototype.show.call(this, coordinate);\n  };\n\n  _proto.getEvents = function getEvents() {\n    if (!this.options['autoCloseOn']) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoCloseOn']] = this.hide;\n    return events;\n  };\n\n  _proto.getOwnerEvents = function getOwnerEvents() {\n    var owner = this.getOwner();\n\n    if (!this.options['autoOpenOn'] || !owner) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoOpenOn']] = this._onAutoOpen;\n    return events;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.onDomRemove();\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    if (this._onCloseBtnClick) {\n      var dom = this.getDOM();\n      var closeBtn = dom.childNodes[2];\n      removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n      delete this._onCloseBtnClick;\n    }\n  };\n\n  _proto._onAutoOpen = function _onAutoOpen(e) {\n    var _this = this;\n\n    var owner = this.getOwner();\n    setTimeout(function () {\n      if (owner instanceof Marker || owner instanceof UIComponent) {\n        _this.show(owner.getCoordinates());\n      } else if (owner instanceof MultiPoint) {\n        _this.show(owner.findClosest(e.coordinate));\n      } else if (owner instanceof LineString || owner instanceof MultiLineString) {\n        if (_this.getMap().getScale() >= 8) {\n          e.coordinate = _this._rectifyMouseCoordinte(owner, e.coordinate);\n        }\n\n        _this.show(e.coordinate);\n      } else {\n        _this.show(e.coordinate);\n      }\n    }, 1);\n  };\n\n  _proto._rectifyMouseCoordinte = function _rectifyMouseCoordinte(owner, mouseCoordinate) {\n    var _this2 = this;\n\n    if (owner instanceof LineString) {\n      return this._rectifyLineStringMouseCoordinate(owner, mouseCoordinate).coordinate;\n    } else if (owner instanceof MultiLineString) {\n      return owner.getGeometries().map(function (lineString) {\n        return _this2._rectifyLineStringMouseCoordinate(lineString, mouseCoordinate);\n      }).sort(function (a, b) {\n        return a.dis - b.dis;\n      })[0].coordinate;\n    }\n\n    return mouseCoordinate;\n  };\n\n  _proto._rectifyLineStringMouseCoordinate = function _rectifyLineStringMouseCoordinate(lineString, mouseCoordinate) {\n    var _this3 = this;\n\n    var pts = lineString.getCoordinates().map(function (coordinate) {\n      return _this3.getMap().coordToContainerPoint(coordinate);\n    });\n    var mousePt = this.getMap().coordToContainerPoint(mouseCoordinate);\n    var minDis = Infinity,\n        coordinateIndex = -1;\n\n    for (var i = 0, len = pts.length; i < len; i++) {\n      var pt = pts[i];\n      var dis = mousePt.distanceTo(pt);\n\n      if (dis < minDis) {\n        minDis = dis;\n        coordinateIndex = i;\n      }\n    }\n\n    var filterPts = [];\n\n    if (coordinateIndex === 0) {\n      filterPts.push(pts[0], pts[1]);\n    } else if (coordinateIndex === pts.length - 1) {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex]);\n    } else {\n      filterPts.push(pts[coordinateIndex - 1], pts[coordinateIndex], pts[coordinateIndex + 1]);\n    }\n\n    var xys = [];\n\n    var _this$getMap$getSize = this.getMap().getSize(),\n        width = _this$getMap$getSize.width,\n        height = _this$getMap$getSize.height;\n\n    for (var _i = 0, _len = filterPts.length - 1; _i < _len; _i++) {\n      var pt1 = filterPts[_i],\n          pt2 = filterPts[_i + 1];\n\n      if (pt1.x === pt2.x) {\n        var miny = Math.max(0, Math.min(pt1.y, pt2.y));\n        var maxy = Math.min(height, Math.max(pt1.y, pt2.y));\n\n        for (var y = miny; y <= maxy; y++) {\n          xys.push(new Point(pt1.x, y));\n        }\n      } else {\n        var k = (pt2.y - pt1.y) / (pt2.x - pt1.x);\n        var minx = Math.max(0, Math.min(pt1.x, pt2.x));\n        var maxx = Math.min(width, Math.max(pt1.x, pt2.x));\n\n        for (var x = minx; x <= maxx; x++) {\n          var _y = k * (x - pt1.x) + pt1.y;\n\n          xys.push(new Point(x, _y));\n        }\n      }\n    }\n\n    var minPtDis = Infinity,\n        ptIndex = -1;\n\n    for (var _i2 = 0, _len2 = xys.length; _i2 < _len2; _i2++) {\n      var _pt = xys[_i2];\n\n      var _dis = mousePt.distanceTo(_pt);\n\n      if (_dis < minPtDis) {\n        minPtDis = _dis;\n        ptIndex = _i2;\n      }\n    }\n\n    return {\n      dis: minPtDis,\n      coordinate: ptIndex < 0 ? mouseCoordinate : this.getMap().containerPointToCoord(xys[ptIndex])\n    };\n  };\n\n  _proto._getWindowWidth = function _getWindowWidth() {\n    var defaultWidth = 300;\n    var width = this.options['width'];\n\n    if (!width) {\n      width = defaultWidth;\n    }\n\n    return width;\n  };\n\n  return InfoWindow;\n}(UIComponent);\n\nInfoWindow.mergeOptions(options$l);\n\nvar options$m = {\n  'width': 0,\n  'height': 0,\n  'animation': 'fade',\n  'containerClass': 'maptalks-tooltip',\n  'showTimeout': 400\n};\n\nvar ToolTip = function (_UIComponent) {\n  _inheritsLoose(ToolTip, _UIComponent);\n\n  var _proto = ToolTip.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'ToolTip';\n  };\n\n  function ToolTip(content, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _UIComponent.call(this, options) || this;\n    _this._content = content;\n    return _this;\n  }\n\n  _proto.addTo = function addTo(owner) {\n    if (ToolTip.isSupport(owner)) {\n      owner.on('mousemove', this.onMouseMove, this);\n      owner.on('mouseout', this.onMouseOut, this);\n      return _UIComponent.prototype.addTo.call(this, owner);\n    } else {\n      throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n    }\n  };\n\n  _proto.setStyle = function setStyle$$1(cssName) {\n    this.options.containerClass = cssName;\n    return this;\n  };\n\n  _proto.getStyle = function getStyle() {\n    return this.options.containerClass;\n  };\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom = createEl('div');\n    var options = this.options || {};\n\n    if (options.height) {\n      dom.style.height = options.height + 'px';\n    }\n\n    if (options.width) {\n      dom.style.width = options.width + 'px';\n    }\n\n    var cssName = options.containerClass || options.cssName;\n\n    if (!cssName && options.height) {\n      dom.style.lineHeight = options.height + 'px';\n    }\n\n    dom.innerHTML = \"<div class=\\\"\" + cssName + \"\\\">\" + this._content + \"</div>\";\n    return dom;\n  };\n\n  _proto.onMouseOut = function onMouseOut() {\n    clearTimeout(this._timeout);\n\n    if (this.isVisible()) {\n      this._removePrevDOM();\n    }\n  };\n\n  _proto.onMouseMove = function onMouseMove(e) {\n    var _this2 = this;\n\n    clearTimeout(this._timeout);\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var coord = map.locateByPoint(e.coordinate, -5, 25);\n\n    if (this.options['showTimeout'] === 0) {\n      this.show(coord);\n    } else {\n      this._timeout = setTimeout(function () {\n        if (map) {\n          _this2.show(coord);\n        }\n      }, this.options['showTimeout']);\n    }\n  };\n\n  _proto.onRemove = function onRemove() {\n    clearTimeout(this._timeout);\n\n    if (this._owner) {\n      this._owner.off('mouseover', this.onMouseOver, this);\n\n      this._owner.off('mouseout', this.onMouseOut, this);\n    }\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, 0)._add(this.options['dx'], this.options['dy']);\n  };\n\n  return ToolTip;\n}(UIComponent);\n\nToolTip.mergeOptions(options$m);\n\nvar defaultOptions = {\n  'containerClass': 'maptalks-menu',\n  'animation': null,\n  'animationDelay': 10,\n  'animationOnHide': false,\n  'autoPan': false,\n  'width': 160,\n  'maxHeight': 0,\n  'custom': false,\n  'items': []\n};\n\nvar Menu = function (_UIComponent) {\n  _inheritsLoose(Menu, _UIComponent);\n\n  function Menu(options) {\n    return _UIComponent.call(this, options) || this;\n  }\n\n  var _proto = Menu.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'Menu';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner._menu && owner._menu !== this) {\n      owner.removeMenu();\n    }\n\n    owner._menu = this;\n    return UIComponent.prototype.addTo.apply(this, arguments);\n  };\n\n  _proto.setItems = function setItems(items) {\n    this.options['items'] = items;\n    return this;\n  };\n\n  _proto.getItems = function getItems() {\n    return this.options['items'] || [];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['items'])) {\n        var container = createEl('div');\n        container.innerHTML = this.options['items'];\n        return container;\n      } else {\n        return this.options['items'];\n      }\n    } else {\n      var dom = createEl('div');\n\n      if (this.options['containerClass']) {\n        addClass(dom, this.options['containerClass']);\n      }\n\n      dom.style.width = this._getMenuWidth() + 'px';\n\n      var menuItems = this._createMenuItemDom();\n\n      dom.appendChild(menuItems);\n      on(dom, 'contextmenu', preventDefault);\n      return dom;\n    }\n  };\n\n  _proto.getOffset = function getOffset() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var mapSize = this.getMap().getSize(),\n        p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n        size = this.getSize();\n    var dx = 0,\n        dy = 0;\n\n    if (p.x + size['width'] > mapSize['width']) {\n      dx = -size['width'];\n    }\n\n    if (p.y + size['height'] > mapSize['height']) {\n      dy = -size['height'];\n    }\n\n    return new Point(dx, dy);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var p = this.getOffset()._multi(-1);\n\n    return p.x + 'px ' + p.y + 'px';\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart _zoomend _movestart _dblclick _click': this._removePrevDOM\n    };\n  };\n\n  _proto._createMenuItemDom = function _createMenuItemDom() {\n    var me = this;\n    var map = this.getMap();\n    var ul = createEl('ul');\n    addClass(ul, 'maptalks-menu-items');\n    var items = this.getItems();\n\n    function onMenuClick(index) {\n      return function (e) {\n        var param = map._parseEvent(e, 'click');\n\n        param['target'] = me;\n        param['owner'] = me._owner;\n        param['index'] = index;\n\n        var result = this._callback(param);\n\n        if (result === false) {\n          return;\n        }\n\n        me.hide();\n      };\n    }\n\n    var item, itemDOM;\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      item = items[i];\n\n      if (item === '-' || item === '_') {\n        itemDOM = createEl('li');\n        addClass(itemDOM, 'maptalks-menu-splitter');\n      } else {\n        itemDOM = createEl('li');\n        var itemTitle = item['item'];\n\n        if (isFunction(itemTitle)) {\n          itemTitle = itemTitle({\n            'owner': this._owner,\n            'index': i\n          });\n        }\n\n        itemDOM.innerHTML = itemTitle;\n        itemDOM._callback = item['click'];\n        on(itemDOM, 'click', onMenuClick(i));\n      }\n\n      ul.appendChild(itemDOM);\n    }\n\n    var maxHeight = this.options['maxHeight'] || 0;\n\n    if (maxHeight > 0) {\n      setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n    }\n\n    return ul;\n  };\n\n  _proto._getMenuWidth = function _getMenuWidth() {\n    var defaultWidth = 160;\n    var width = this.options['width'] || defaultWidth;\n    return width;\n  };\n\n  return Menu;\n}(UIComponent);\n\nMenu.mergeOptions(defaultOptions);\n\nvar Menuable = {\n  setMenu: function setMenu(options) {\n    this._menuOptions = options;\n\n    if (this._menu) {\n      this._menu.setOptions(options);\n    } else {\n      this.on('contextmenu', this._defaultOpenMenu, this);\n    }\n\n    return this;\n  },\n  openMenu: function openMenu(coordinate) {\n    var map = this instanceof Map$1 ? this : this.getMap();\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._menu) {\n      if (this._menuOptions && map) {\n        this._bindMenu(this._menuOptions);\n\n        this._menu.show(coordinate);\n      }\n    } else {\n      this._menu.show(coordinate);\n    }\n\n    return this;\n  },\n  setMenuItems: function setMenuItems(items) {\n    if (!this._menuOptions) {\n      this._menuOptions = {};\n    }\n\n    if (Array.isArray(items)) {\n      this._menuOptions['custom'] = false;\n    }\n\n    this._menuOptions['items'] = items;\n    this.setMenu(this._menuOptions);\n    return this;\n  },\n  getMenuItems: function getMenuItems() {\n    if (this._menu) {\n      return this._menu.getItems();\n    } else if (this._menuOptions) {\n      return this._menuOptions['items'] || [];\n    }\n\n    return [];\n  },\n  closeMenu: function closeMenu() {\n    if (this._menu) {\n      this._menu.hide();\n    }\n\n    return this;\n  },\n  removeMenu: function removeMenu() {\n    this.off('contextmenu', this._defaultOpenMenu, this);\n\n    this._unbindMenu();\n\n    delete this._menuOptions;\n    return this;\n  },\n  _bindMenu: function _bindMenu(options) {\n    this._menu = new Menu(options);\n\n    this._menu.addTo(this);\n\n    return this;\n  },\n  _unbindMenu: function _unbindMenu() {\n    if (this._menu) {\n      this.closeMenu();\n\n      this._menu.remove();\n\n      delete this._menu;\n    }\n\n    return this;\n  },\n  _defaultOpenMenu: function _defaultOpenMenu(param) {\n    if (this.listens('contextmenu') > 1) {\n      return true;\n    } else {\n      this.openMenu(param['coordinate']);\n      return false;\n    }\n  }\n};\nMap$1.include(Menuable);\nGeometry.include(Menuable);\n\n\n\nvar index$4 = /*#__PURE__*/Object.freeze({\n  UIComponent: UIComponent,\n  UIMarker: UIMarker,\n  InfoWindow: InfoWindow,\n  ToolTip: ToolTip,\n  Menuable: Menuable,\n  Menu: Menu\n});\n\nvar Control = function (_Eventable) {\n  _inheritsLoose(Control, _Eventable);\n\n  function Control(options) {\n    if (options && options['position'] && !isString(options['position'])) {\n      options['position'] = extend({}, options['position']);\n    }\n\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = Control.prototype;\n\n  _proto.addTo = function addTo(map) {\n    this.remove();\n\n    if (!map.options['control']) {\n      return this;\n    }\n\n    this._map = map;\n    var controlContainer = map._panels.control;\n    this.__ctrlContainer = createEl('div');\n    setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n    this.update();\n    controlContainer.appendChild(this.__ctrlContainer);\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add', {\n      'dom': controlContainer\n    });\n    return this;\n  };\n\n  _proto.update = function update() {\n    this.__ctrlContainer.innerHTML = '';\n    this._controlDom = this.buildOn(this.getMap());\n\n    if (this._controlDom) {\n      this._updatePosition();\n\n      this.__ctrlContainer.appendChild(this._controlDom);\n    }\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.getPosition = function getPosition() {\n    return extend({}, this._parse(this.options['position']));\n  };\n\n  _proto.setPosition = function setPosition(position) {\n    if (isString(position)) {\n      this.options['position'] = position;\n    } else {\n      this.options['position'] = extend({}, position);\n    }\n\n    this._updatePosition();\n\n    return this;\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    var position = this.getPosition();\n    var size = this.getMap().getSize();\n    var x, y;\n\n    if (!isNil(position['left'])) {\n      x = parseInt(position['left']);\n    } else if (!isNil(position['right'])) {\n      x = size['width'] - parseInt(position['right']);\n    }\n\n    if (!isNil(position['top'])) {\n      y = parseInt(position['top']);\n    } else if (!isNil(position['bottom'])) {\n      y = size['height'] - parseInt(position['bottom']);\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this.__ctrlContainer;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this._controlDom;\n  };\n\n  _proto.show = function show() {\n    this.__ctrlContainer.style.display = '';\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.__ctrlContainer.style.display = 'none';\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    return this.__ctrlContainer && this.__ctrlContainer.style.display === '';\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    removeDomNode(this.__ctrlContainer);\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    delete this._map;\n    delete this.__ctrlContainer;\n    delete this._controlDom;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto._parse = function _parse(position) {\n    var p = position;\n\n    if (isString(position)) {\n      p = Control['positions'][p];\n    }\n\n    return p;\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var position = this.getPosition();\n\n    if (!position) {\n      position = {\n        'top': 20,\n        'left': 20\n      };\n    }\n\n    for (var p in position) {\n      if (position.hasOwnProperty(p)) {\n        position[p] = parseInt(position[p]);\n        this.__ctrlContainer.style[p] = position[p] + 'px';\n      }\n    }\n\n    this.fire('positionchange', {\n      'position': extend({}, position)\n    });\n  };\n\n  return Control;\n}(Eventable(Class));\n\nControl.positions = {\n  'top-left': {\n    'top': 20,\n    'left': 20\n  },\n  'top-right': {\n    'top': 20,\n    'right': 20\n  },\n  'bottom-left': {\n    'bottom': 20,\n    'left': 20\n  },\n  'bottom-right': {\n    'bottom': 20,\n    'right': 20\n  }\n};\nMap$1.mergeOptions({\n  'control': true\n});\nMap$1.include({\n  addControl: function addControl(control) {\n    if (this._containerDOM.getContext) {\n      return this;\n    }\n\n    control.addTo(this);\n    return this;\n  },\n  removeControl: function removeControl(control) {\n    if (!control || control.getMap() !== this) {\n      return this;\n    }\n\n    control.remove();\n    return this;\n  }\n});\n\nvar options$n = {\n  'position': {\n    'bottom': 0,\n    'left': 0\n  },\n  'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\nvar layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\nvar Attribution = function (_Control) {\n  _inheritsLoose(Attribution, _Control);\n\n  function Attribution() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Attribution.prototype;\n\n  _proto.buildOn = function buildOn() {\n    this._attributionContainer = createEl('div');\n    this._attributionContainer.className = 'maptalks-attribution';\n\n    this._update();\n\n    return this._attributionContainer;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.getMap().on(layerEvents, this._update, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off(layerEvents, this._update, this);\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var attributions = map._getLayers(function (layer) {\n      return layer.options['attribution'];\n    }).reverse().map(function (layer) {\n      return layer.options['attribution'];\n    });\n\n    var content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n    this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n  };\n\n  return Attribution;\n}(Control);\n\nAttribution.mergeOptions(options$n);\nMap$1.mergeOptions({\n  'attribution': true\n});\nMap$1.addOnLoadHook(function () {\n  var a = this.options['attribution'] || this.options['attributionControl'];\n\n  if (a) {\n    this.attributionControl = new Attribution(a);\n    this.addControl(this.attributionControl);\n  }\n});\n\nvar options$o = {\n  'position': 'top-right',\n  'baseTitle': 'Base Layers',\n  'overlayTitle': 'Layers',\n  'excludeLayers': [],\n  'containerClass': 'maptalks-layer-switcher'\n};\n\nvar LayerSwitcher = function (_Control) {\n  _inheritsLoose(LayerSwitcher, _Control);\n\n  function LayerSwitcher() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = LayerSwitcher.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var container = this.container = createEl('div', this.options['containerClass']),\n        panel = this.panel = createEl('div', 'panel'),\n        button = this.button = createEl('button');\n    container.appendChild(button);\n    container.appendChild(panel);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    on(this.button, 'mouseover', this._show, this);\n    on(this.panel, 'mouseleave', this._hide, this);\n    on(this.getMap(), 'click', this._hide, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    if (this.panel) {\n      off(this.button, 'mouseover', this._show, this);\n      off(this.panel, 'mouseleave', this._hide, this);\n      off(this.getMap(), 'click', this._hide, this);\n      removeDomNode(this.panel);\n      removeDomNode(this.button);\n      delete this.panel;\n      delete this.button;\n      delete this.container;\n    }\n  };\n\n  _proto._show = function _show() {\n    if (!hasClass(this.container, 'shown')) {\n      addClass(this.container, 'shown');\n\n      this._createPanel();\n    }\n  };\n\n  _proto._hide = function _hide(e) {\n    if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n      setClass(this.container, this.options['containerClass']);\n    }\n  };\n\n  _proto._createPanel = function _createPanel() {\n    this.panel.innerHTML = '';\n    var ul = createEl('ul');\n    this.panel.appendChild(ul);\n\n    this._renderLayers(this.getMap(), ul);\n  };\n\n  _proto._renderLayers = function _renderLayers(map, elm) {\n    var base = map.getBaseLayer(),\n        layers = map.getLayers(),\n        len = layers.length;\n\n    if (base) {\n      var baseLayers = base.layers || [base],\n          li = createEl('li', 'group'),\n          ul = createEl('ul'),\n          label = createEl('label');\n      label.innerHTML = this.options['baseTitle'];\n      li.appendChild(label);\n\n      for (var i = 0, _len = baseLayers.length; i < _len; i++) {\n        var layer = baseLayers[i];\n\n        if (this._isExcluded(layer)) {\n          ul.appendChild(this._renderLayer(baseLayers[i], true));\n          li.appendChild(ul);\n          elm.appendChild(li);\n        }\n      }\n    }\n\n    if (len) {\n      var _li = createEl('li', 'group'),\n          _ul = createEl('ul'),\n          _label = createEl('label');\n\n      _label.innerHTML = this.options['overlayTitle'];\n\n      _li.appendChild(_label);\n\n      for (var _i = 0; _i < len; _i++) {\n        var _layer = layers[_i];\n\n        if (this._isExcluded(_layer)) {\n          _ul.appendChild(this._renderLayer(_layer));\n        }\n      }\n\n      _li.appendChild(_ul);\n\n      elm.appendChild(_li);\n    }\n  };\n\n  _proto._isExcluded = function _isExcluded(layer) {\n    var id = layer.getId(),\n        excludeLayers = this.options['excludeLayers'];\n    return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n  };\n\n  _proto._renderLayer = function _renderLayer(layer, isBase) {\n    var _this = this;\n\n    var li = createEl('li', 'layer'),\n        label = createEl('label'),\n        input = createEl('input'),\n        map = this.getMap();\n    var visible = layer.options['visible'];\n    layer.options['visible'] = true;\n    var enabled = layer.isVisible();\n    layer.options['visible'] = visible;\n    li.className = 'layer';\n\n    if (isBase) {\n      input.type = 'radio';\n      input.name = 'base';\n    } else {\n      input.type = 'checkbox';\n    }\n\n    input.checked = visible && enabled;\n\n    if (!enabled) {\n      input.setAttribute('disabled', 'disabled');\n    }\n\n    input.onchange = function (e) {\n      if (e.target.type === 'radio') {\n        var baseLayer = map.getBaseLayer(),\n            baseLayers = baseLayer.layers;\n\n        if (baseLayers) {\n          for (var i = 0, len = baseLayers.length; i < len; i++) {\n            var _baseLayer = baseLayers[i];\n\n            _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n          }\n        } else if (!baseLayer.isVisible()) {\n          baseLayer.show();\n        }\n\n        map._fireEvent('setbaselayer');\n      } else {\n        layer[e.target.checked ? 'show' : 'hide']();\n      }\n\n      _this.fire('layerchange', {\n        target: layer\n      });\n    };\n\n    li.appendChild(input);\n    label.innerHTML = layer.getId();\n    li.appendChild(label);\n    return li;\n  };\n\n  return LayerSwitcher;\n}(Control);\n\nLayerSwitcher.mergeOptions(options$o);\nMap$1.mergeOptions({\n  'layerSwitcherControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['layerSwitcherControl']) {\n    this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n    this.addControl(this.layerSwitcherControl);\n  }\n});\n\nvar options$p = {\n  'level': 4,\n  'position': {\n    'right': 1,\n    'bottom': 1\n  },\n  'size': [300, 200],\n  'maximize': true,\n  'symbol': {\n    'lineWidth': 3,\n    'lineColor': '#1bbc9b',\n    'polygonFill': '#1bbc9b',\n    'polygonOpacity': 0.4\n  },\n  'containerClass': 'maptalks-overview',\n  'buttonClass': 'maptalks-overview-button'\n};\n\nvar Overview = function (_Control) {\n  _inheritsLoose(Overview, _Control);\n\n  function Overview() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Overview.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var size = this.options['size'];\n\n    if (!this.options['maximize']) {\n      size = [0, 0];\n    }\n\n    var container = createEl('div');\n    var mapContainer = this.mapContainer = createEl('div');\n    mapContainer.style.width = size[0] + 'px';\n    mapContainer.style.height = size[1] + 'px';\n    mapContainer.className = this.options['containerClass'];\n    var button = this.button = createEl('div');\n    button.className = this.options['buttonClass'];\n    container.appendChild(mapContainer);\n    container.appendChild(button);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    if (this.options['maximize']) {\n      this._createOverview();\n    }\n\n    this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this).on('setbaselayer', this._updateBaseLayer, this).on('spatialreferencechange', this._updateSpatialReference, this);\n    on(this.button, 'click', this._onButtonClick, this);\n\n    this._updateButtonText();\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('resize moving zooming rotate dragrotating viewchange', this._update, this).off('setbaselayer', this._updateBaseLayer, this).off('spatialreferencechange', this._updateSpatialReference, this);\n\n    if (this._overview) {\n      this._overview.remove();\n\n      delete this._overview;\n      delete this._perspective;\n    }\n\n    off(this.button, 'click', this._onButtonClick, this);\n  };\n\n  _proto.maxmize = function maxmize() {\n    var size = this.options['size'];\n    var dom = this.mapContainer;\n    dom.style.width = size[0] + 'px';\n    dom.style.height = size[1] + 'px';\n\n    this._createOverview();\n\n    return this;\n  };\n\n  _proto.minimize = function minimize() {\n    if (this._overview) {\n      this._overview.remove();\n    }\n\n    delete this._overview;\n    delete this._perspective;\n    var dom = this.mapContainer;\n    dom.style.width = 0 + 'px';\n    dom.style.height = 0 + 'px';\n    return this;\n  };\n\n  _proto.getOverviewMap = function getOverviewMap() {\n    return this._overview;\n  };\n\n  _proto._onButtonClick = function _onButtonClick() {\n    if (!this._overview) {\n      this.maxmize();\n    } else {\n      this.minimize();\n    }\n\n    this._updateButtonText();\n  };\n\n  _proto._updateButtonText = function _updateButtonText() {\n    if (this._overview) {\n      this.button.innerHTML = '-';\n    } else {\n      this.button.innerHTML = '+';\n    }\n  };\n\n  _proto._createOverview = function _createOverview() {\n    var map = this.getMap(),\n        dom = this.mapContainer;\n    var options = map.config();\n    extend(options, {\n      'center': map.getCenter(),\n      'zoom': this._getOverviewZoom(),\n      'zoomAnimationDuration': 150,\n      'pitch': 0,\n      'bearing': 0,\n      'scrollWheelZoom': false,\n      'checkSize': false,\n      'doubleClickZoom': false,\n      'touchZoom': false,\n      'control': false,\n      'draggable': false,\n      'maxExtent': null\n    });\n    this._overview = new Map$1(dom, options);\n\n    this._updateBaseLayer();\n\n    this._perspective = new Polygon(this._getPerspectiveCoords(), {\n      'draggable': true,\n      'cursor': 'move',\n      'symbol': this.options['symbol']\n    }).on('dragend', this._onDragEnd, this);\n    new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n    this.fire('load');\n  };\n\n  _proto._getOverviewZoom = function _getOverviewZoom() {\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        minZoom = map.getMinZoom(),\n        level = this.options['level'];\n\n    if (level > 0) {\n      for (var i = level; i > 0; i--) {\n        if (zoom - i >= minZoom) {\n          return zoom - i;\n        }\n      }\n    } else {\n      for (var _i = level; _i < 0; _i++) {\n        if (zoom - _i >= minZoom) {\n          return zoom - _i;\n        }\n      }\n    }\n\n    return zoom;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    var center = this._perspective.getCenter();\n\n    this._overview.setCenter(center);\n\n    this.getMap().panTo(center);\n  };\n\n  _proto._getPerspectiveCoords = function _getPerspectiveCoords() {\n    var map = this.getMap();\n    return map.getContainerExtent().toArray().map(function (c) {\n      return map.containerPointToCoordinate(c);\n    });\n  };\n\n  _proto._update = function _update() {\n    if (!this._overview) {\n      return;\n    }\n\n    computeDomPosition(this._overview._containerDOM);\n\n    var coords = this._getPerspectiveCoords();\n\n    this._perspective.setCoordinates(coords);\n\n    this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap();\n    var spatialRef = map.options['spatialReference'];\n\n    this._overview.setSpatialReference(spatialRef);\n  };\n\n  _proto._updateBaseLayer = function _updateBaseLayer() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap(),\n        baseLayer = map.getBaseLayer();\n\n    if (!baseLayer) {\n      this._overview.setBaseLayer(null);\n\n      return;\n    }\n\n    var layers = baseLayer.layers;\n    var showIndex = 0;\n\n    if (layers) {\n      for (var i = 0, l = layers.length; i < l; i++) {\n        var _layer = layers[i];\n\n        if (_layer.isVisible()) {\n          showIndex = i;\n          break;\n        }\n      }\n    }\n\n    var json = baseLayer.toJSON();\n    var options = null;\n\n    if (layers) {\n      options = json.layers[showIndex].options;\n      options.visible = true;\n    } else {\n      options = json.options;\n    }\n\n    this._overview.setMinZoom(options.minZoom || null).setMaxZoom(options.maxZoom || null);\n\n    delete options.minZoom;\n    delete options.maxZoom;\n    delete json.options.canvas;\n    json.options.visible = true;\n    json.options.renderer = 'canvas';\n    var layer = Layer.fromJSON(json);\n\n    for (var p in baseLayer) {\n      if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n        layer[p] = baseLayer[p];\n      }\n    }\n\n    this._overview.setBaseLayer(layer);\n  };\n\n  return Overview;\n}(Control);\n\nOverview.mergeOptions(options$p);\nMap$1.mergeOptions({\n  'overviewControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['overviewControl']) {\n    this.overviewControl = new Overview(this.options['overviewControl']);\n    this.addControl(this.overviewControl);\n  }\n});\n\nvar options$q = {\n  'position': 'top-right',\n  'draggable': true,\n  'custom': false,\n  'content': '',\n  'closeButton': true\n};\n\nvar Panel = function (_Control) {\n  _inheritsLoose(Panel, _Control);\n\n  function Panel() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Panel.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        dom = createEl('div');\n        dom.innerHTML = this.options['content'];\n      } else {\n        dom = this.options['content'];\n      }\n    } else {\n      dom = createEl('div', 'maptalks-panel');\n\n      if (this.options['closeButton']) {\n        var closeButton = createEl('a', 'maptalks-close');\n        closeButton.href = 'javascript:;';\n\n        closeButton.onclick = function () {\n          dom.style.display = 'none';\n        };\n\n        dom.appendChild(closeButton);\n      }\n\n      var panelContent = createEl('div', 'maptalks-panel-content');\n      panelContent.innerHTML = this.options['content'];\n      dom.appendChild(panelContent);\n    }\n\n    this.draggable = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n    this.draggable.on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this);\n\n    if (this.options['draggable']) {\n      this.draggable.enable();\n    }\n\n    return dom;\n  };\n\n  _proto.update = function update() {\n    if (this.draggable) {\n      this.draggable.disable();\n      delete this.draggable;\n    }\n\n    return Control.prototype.update.call(this);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.update();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this._startPos = param['mousePos'];\n    this._startPosition = extend({}, this.getPosition());\n    this.fire('dragstart', param);\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var pos = param['mousePos'];\n    var offset = pos.sub(this._startPos);\n    var startPosition = this._startPosition;\n    var position = this.getPosition();\n\n    if (!isNil(position['top'])) {\n      position['top'] = parseInt(startPosition['top']) + offset.y;\n    }\n\n    if (!isNil(position['bottom'])) {\n      position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n    }\n\n    if (!isNil(position['left'])) {\n      position['left'] = parseInt(startPosition['left']) + offset.x;\n    }\n\n    if (!isNil(position['right'])) {\n      position['right'] = parseInt(startPosition['right']) - offset.x;\n    }\n\n    this.setPosition(position);\n    this.fire('dragging', param);\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    delete this._startPos;\n    delete this._startPosition;\n    this.fire('dragend', param);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = this.getContainerPoint();\n    var dom = this.getDOM(),\n        width = parseInt(dom.clientWidth),\n        height = parseInt(dom.clientHeight);\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width, height / 2)), map.containerPointToCoordinate(containerPoint.add(width / 2, height)), map.containerPointToCoordinate(containerPoint.add(0, height / 2))];\n    return anchors;\n  };\n\n  return Panel;\n}(Control);\n\nPanel.mergeOptions(options$q);\n\nvar options$r = {\n  'position': 'bottom-left',\n  'maxWidth': 100,\n  'metric': true,\n  'imperial': false,\n  'containerClass': null\n};\n\nvar Scale = function (_Control) {\n  _inheritsLoose(Scale, _Control);\n\n  function Scale() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Scale.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    this._scaleContainer = createEl('div', this.options['containerClass']);\n\n    this._addScales();\n\n    map.on('zoomend', this._update, this);\n\n    if (this._map._loaded) {\n      this._update();\n    }\n\n    return this._scaleContainer;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('zoomend', this._update, this);\n  };\n\n  _proto._addScales = function _addScales() {\n    var css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' + 'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' + ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n\n    if (this.options['metric']) {\n      this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n\n    if (this.options['imperial']) {\n      this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this._map;\n    var maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n\n    this._updateScales(maxMeters);\n  };\n\n  _proto._updateScales = function _updateScales(maxMeters) {\n    if (this.options['metric'] && maxMeters) {\n      this._updateMetric(maxMeters);\n    }\n\n    if (this.options['imperial'] && maxMeters) {\n      this._updateImperial(maxMeters);\n    }\n  };\n\n  _proto._updateMetric = function _updateMetric(maxMeters) {\n    var meters = this._getRoundNum(maxMeters),\n        label = meters < 1000 ? meters + ' m' : meters / 1000 + ' km';\n\n    this._updateScale(this._mScale, label, meters / maxMeters);\n  };\n\n  _proto._updateImperial = function _updateImperial(maxMeters) {\n    var maxFeet = maxMeters * 3.2808399;\n    var maxMiles, miles, feet;\n\n    if (maxFeet > 5280) {\n      maxMiles = maxFeet / 5280;\n      miles = this._getRoundNum(maxMiles);\n\n      this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n    } else {\n      feet = this._getRoundNum(maxFeet);\n\n      this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n    }\n  };\n\n  _proto._updateScale = function _updateScale(scale, text, ratio) {\n    scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n    scale['innerHTML'] = text;\n  };\n\n  _proto._getRoundNum = function _getRoundNum(num) {\n    var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n    var d = num / pow10;\n    d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n    return pow10 * d;\n  };\n\n  return Scale;\n}(Control);\n\nScale.mergeOptions(options$r);\nMap$1.mergeOptions({\n  'scaleControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['scaleControl']) {\n    this.scaleControl = new Scale(this.options['scaleControl']);\n    this.addControl(this.scaleControl);\n  }\n});\n\nvar options$s = {\n  'height': 28,\n  'vertical': false,\n  'position': 'top-right',\n  'reverseMenu': false,\n  'items': {}\n};\n\nvar Toolbar = function (_Control) {\n  _inheritsLoose(Toolbar, _Control);\n\n  function Toolbar() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Toolbar.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    var dom = createEl('div');\n    var ul = createEl('ul', 'maptalks-toolbar-hx');\n    dom.appendChild(ul);\n\n    if (this.options['vertical']) {\n      addClass(dom, 'maptalks-toolbar-vertical');\n    } else {\n      addClass(dom, 'maptalks-toolbar-horizonal');\n    }\n\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex, targetDom) {\n      var item = me._getItems()[index];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex,\n          'dom': targetDom\n        });\n      };\n    }\n\n    var items = this.options['items'];\n\n    if (isArrayHasData(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var li = createEl('li');\n\n        if (this.options['height'] !== 28) {\n          li.style.lineHeight = this.options['height'] + 'px';\n        }\n\n        li.style.height = this.options['height'] + 'px';\n        li.style.cursor = 'pointer';\n\n        if (isHTML(item['item'])) {\n          li.style.textAlign = 'center';\n          var itemSize = measureDom('div', item['item']);\n          li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n        } else {\n          li.innerHTML = item['item'];\n        }\n\n        if (item['click']) {\n          on(li, 'click', onButtonClick(item['click'], i, null, li));\n        }\n\n        if (isArrayHasData(item['children'])) {\n          var dropMenu = this._createDropMenu(i);\n\n          li.appendChild(dropMenu);\n          li._menu = dropMenu;\n          on(li, 'mouseover', function () {\n            this._menu.style.display = '';\n          });\n          on(li, 'mouseout', function () {\n            this._menu.style.display = 'none';\n          });\n        }\n\n        ul.appendChild(li);\n      }\n    }\n\n    return dom;\n  };\n\n  _proto._createDropMenu = function _createDropMenu(index) {\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex) {\n      var item = me._getItems()[index]['children'][childIndex];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex\n        });\n      };\n    }\n\n    var menuDom = createEl('div', 'maptalks-dropMenu'),\n        items = this._getItems(),\n        len = items.length,\n        menuUL = createEl('ul'),\n        children = items[index]['children'];\n\n    if (index === len - 1 && children) {\n      menuDom.style.cssText = 'right: 0px;';\n      menuUL.style.cssText = 'right: 0px;position: absolute;';\n\n      if (this.options['reverseMenu']) {\n        menuUL.style.bottom = 0;\n      }\n    }\n\n    menuDom.appendChild(createEl('em', 'maptalks-ico'));\n    var liWidth = 0;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var size = stringLength(children[i]['item'], '12px');\n\n      if (size.width > liWidth) {\n        liWidth = size.width;\n      }\n    }\n\n    for (var _i = 0, _l = children.length; _i < _l; _i++) {\n      var child = children[_i];\n      var li = createEl('li');\n      li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n      li.style.cursor = 'pointer';\n      li.style.width = liWidth + 24 + 'px';\n      on(li.childNodes[0], 'click', onButtonClick(child['click'], index, _i));\n      menuUL.appendChild(li);\n    }\n\n    if (this.options['vertical']) {\n      var width = liWidth < 95 ? 95 : liWidth;\n\n      if (this.options['reverseMenu']) {\n        menuDom.style.right = -(width + 10 * 2) + 'px';\n      } else {\n        menuDom.style.left = -(width + 10 * 2) + 'px';\n      }\n    } else if (this.options['reverseMenu']) {\n      menuDom.style.bottom = '28px';\n    } else {\n      menuDom.style.top = '28px';\n    }\n\n    menuDom.appendChild(menuUL);\n    menuDom.style.display = 'none';\n    return menuDom;\n  };\n\n  _proto._getItems = function _getItems() {\n    return this.options['items'] || [];\n  };\n\n  return Toolbar;\n}(Control);\n\nToolbar.mergeOptions(options$s);\n\nvar options$t = {\n  'position': 'top-left',\n  'slider': true,\n  'zoomLevel': true,\n  'seamless': false\n};\nvar UNIT = 10;\n\nvar Zoom = function (_Control) {\n  _inheritsLoose(Zoom, _Control);\n\n  function Zoom() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Zoom.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    var options = this.options;\n    var dom = createEl('div', 'maptalks-zoom');\n\n    if (options['zoomLevel']) {\n      var levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n      dom.appendChild(levelDOM);\n      this._levelDOM = levelDOM;\n    }\n\n    var zoomDOM = createEl('div', 'maptalks-zoom-slider');\n    var zoomInButton = createEl('a', 'maptalks-zoom-zoomin');\n    zoomInButton.href = 'javascript:;';\n    zoomInButton.innerHTML = '+';\n    zoomDOM.appendChild(zoomInButton);\n    this._zoomInButton = zoomInButton;\n\n    if (options['slider']) {\n      var box = createEl('div', 'maptalks-zoom-slider-box');\n      var ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n      var reading = createEl('span', 'maptalks-zoom-slider-reading');\n      var dot = createEl('span', 'maptalks-zoom-slider-dot');\n      ruler.appendChild(reading);\n      box.appendChild(ruler);\n      box.appendChild(dot);\n      zoomDOM.appendChild(box);\n      this._sliderBox = box;\n      this._sliderRuler = ruler;\n      this._sliderReading = reading;\n      this._sliderDot = dot;\n    }\n\n    var zoomOutButton = createEl('a', 'maptalks-zoom-zoomout');\n    zoomOutButton.href = 'javascript:;';\n    zoomOutButton.innerHTML = '-';\n    zoomDOM.appendChild(zoomOutButton);\n    this._zoomOutButton = zoomOutButton;\n    dom.appendChild(zoomDOM);\n    map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    this._update();\n\n    this._registerDomEvents();\n\n    return dom;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    if (this._zoomInButton) {\n      off(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      off(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger.disable();\n      delete this.dotDragger;\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (this._sliderBox) {\n      var totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n      this._sliderBox.style.height = totalRange + 16 + 'px';\n      this._sliderRuler.style.height = totalRange + 8 + 'px';\n      this._sliderRuler.style.cursor = 'pointer';\n      var zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n      this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n      this._sliderDot.style.top = zoomRange + 'px';\n    }\n\n    this._updateText();\n  };\n\n  _proto._updateText = function _updateText() {\n    if (this._levelDOM) {\n      var map = this.getMap();\n      var zoom = map.getZoom();\n\n      if (!isInteger(zoom)) {\n        zoom = Math.floor(zoom * 10) / 10;\n      }\n\n      this._levelDOM.innerHTML = zoom;\n    }\n  };\n\n  _proto._registerDomEvents = function _registerDomEvents() {\n    if (this._zoomInButton) {\n      on(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      on(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger = new DragHandler(this._sliderDot, {\n        'ignoreMouseleave': true\n      });\n      this.dotDragger.on('dragstart', this._onDotDragstart, this).on('dragging dragend', this._onDotDrag, this).enable();\n    }\n  };\n\n  _proto._onZoomInClick = function _onZoomInClick(e) {\n    preventDefault(e);\n    this.getMap().zoomIn();\n  };\n\n  _proto._onZoomOutClick = function _onZoomOutClick(e) {\n    preventDefault(e);\n    this.getMap().zoomOut();\n  };\n\n  _proto._onClickRuler = function _onClickRuler(e) {\n    preventDefault(e);\n    var map = this.getMap(),\n        point = getEventContainerPoint(e, this._sliderRuler),\n        h = point.y;\n    var maxZoom = map.getMaxZoom(),\n        zoom = Math.floor(maxZoom - h / UNIT);\n    map.setZoom(zoom);\n  };\n\n  _proto._onDotDragstart = function _onDotDragstart(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2);\n\n    map.onZoomStart(map.getZoom(), origin);\n  };\n\n  _proto._onDotDrag = function _onDotDrag(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2),\n        point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n        maxZoom = map.getMaxZoom(),\n        minZoom = map.getMinZoom();\n\n    var top = point.y,\n        z = maxZoom - top / UNIT;\n\n    if (maxZoom < z) {\n      z = maxZoom;\n      top = 0;\n    } else if (minZoom > z) {\n      z = minZoom;\n      top = (maxZoom - minZoom) * UNIT;\n    }\n\n    if (e.type === 'dragging') {\n      map.onZooming(z, origin, 1);\n    } else if (e.type === 'dragend') {\n      if (this.options['seamless']) {\n        map.onZoomEnd(z, origin);\n      } else {\n        map.onZoomEnd(Math.round(z), origin);\n      }\n    }\n\n    this._sliderDot.style.top = top + 'px';\n    this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n\n    this._updateText();\n  };\n\n  return Zoom;\n}(Control);\n\nZoom.mergeOptions(options$t);\nMap$1.mergeOptions({\n  'zoomControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['zoomControl']) {\n    this.zoomControl = new Zoom(this.options['zoomControl']);\n    this.addControl(this.zoomControl);\n  }\n});\n\n\n\nvar index$5 = /*#__PURE__*/Object.freeze({\n  Control: Control,\n  Attribution: Attribution,\n  LayerSwitcher: LayerSwitcher,\n  Overview: Overview,\n  Panel: Panel,\n  Scale: Scale,\n  Toolbar: Toolbar,\n  Zoom: Zoom\n});\n\nvar TileSystem = function () {\n  function TileSystem(sx, sy, ox, oy) {\n    if (Array.isArray(sx)) {\n      this.scale = {\n        x: sx[0],\n        y: sx[1]\n      };\n      this.origin = {\n        x: sx[2],\n        y: sx[3]\n      };\n    } else {\n      this.scale = {\n        x: sx,\n        y: sy\n      };\n      this.origin = {\n        x: ox,\n        y: oy\n      };\n    }\n  }\n\n  TileSystem.getDefault = function getDefault(projection) {\n    if (projection['code'].toLowerCase() === 'baidu') {\n      return 'baidu';\n    } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n      return 'tms-global-geodetic';\n    } else if (projection['code'].toLowerCase() === 'identity') {\n      return [1, -1, 0, 0];\n    } else {\n      return 'web-mercator';\n    }\n  };\n\n  return TileSystem;\n}();\n\nvar semiCircum = 6378137 * Math.PI;\nextend(TileSystem, {\n  'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n  'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n  'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n  'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nvar TileConfig = function () {\n  function TileConfig(map, tileSystem, fullExtent, tileSize) {\n    this.map = map;\n    this.tileSize = tileSize;\n    this.fullExtent = fullExtent;\n    this.prepareTileInfo(tileSystem, fullExtent);\n    this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n    this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    this._pointOrigin = map._prjToPoint(new Point(this.tileSystem['origin']), map.getGLZoom());\n    this._glRes = map.getResolution(map.getGLZoom());\n  }\n\n  var _proto = TileConfig.prototype;\n\n  _proto.prepareTileInfo = function prepareTileInfo(tileSystem, fullExtent) {\n    if (isString(tileSystem)) {\n      tileSystem = TileSystem[tileSystem.toLowerCase()];\n    } else if (Array.isArray(tileSystem)) {\n      tileSystem = new TileSystem(tileSystem);\n    }\n\n    if (!tileSystem) {\n      throw new Error('Invalid TileSystem');\n    }\n\n    this.tileSystem = tileSystem;\n    var a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n        c = tileSystem['origin']['x'],\n        d = tileSystem['origin']['y'];\n    this.transformation = new Transformation([a, b, c, d]);\n  };\n\n  _proto._getTileNum = function _getTileNum(point, res) {\n    var tileSystem = this.tileSystem,\n        tileSize = this['tileSize'],\n        delta = 1E-7;\n    var tileX = Math.floor(delta * tileSystem['scale']['x'] + point.x / (tileSize['width'] * res));\n    var tileY = Math.ceil(delta * tileSystem['scale']['y'] + point.y / (tileSize['height'] * res));\n    return {\n      'x': tileSystem['scale']['x'] * tileX,\n      'y': tileSystem['scale']['y'] * tileY\n    };\n  };\n\n  _proto.getTileIndex = function getTileIndex(pCoord, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var point = this.transformation.transform(pCoord, 1);\n\n    var tileIndex = this._getTileNum(point, res);\n\n    if (tileSystem['scale']['x'] < 0) {\n      tileIndex['x'] -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      tileIndex['y'] -= 1;\n    }\n\n    return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res, repeatWorld);\n  };\n\n  _proto.getNeighorTileIndex = function getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var x = tileX + tileSystem['scale']['x'] * offsetX;\n    var y = tileY - tileSystem['scale']['y'] * offsetY;\n    var out = false;\n    var idx = x;\n    var idy = y;\n\n    var ext = this._getTileFullIndex(res);\n\n    if (repeatWorld) {\n      if (repeatWorld === true || repeatWorld === 'x') {\n        if (ext['xmax'] === ext['xmin']) {\n          x = ext['xmin'];\n        } else if (x < ext['xmin']) {\n          x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n\n          if (x === ext['xmax']) {\n            x = ext['xmin'];\n          }\n        } else if (x >= ext['xmax']) {\n          x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n        }\n      }\n\n      if (repeatWorld === true || repeatWorld === 'y') {\n        if (ext['ymax'] === ext['ymin']) {\n          y = ext['ymin'];\n        } else if (y >= ext['ymax']) {\n          y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n        } else if (y < ext['ymin']) {\n          y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n\n          if (y === ext['ymax']) {\n            y = ext['ymin'];\n          }\n        }\n      }\n    }\n\n    if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n      out = true;\n    }\n\n    return {\n      'x': x,\n      'y': y,\n      'idx': idx,\n      'idy': idy,\n      out: out\n    };\n  };\n\n  _proto._getTileFullIndex = function _getTileFullIndex(res) {\n    if (!this._tileFullIndex) {\n      this._tileFullIndex = {};\n    }\n\n    if (this._tileFullIndex[res]) {\n      return this._tileFullIndex[res];\n    }\n\n    var ext = this.fullExtent;\n    var transformation = this.transformation;\n\n    var nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n\n    var seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n    var tileSystem = this.tileSystem;\n\n    if (tileSystem['scale']['x'] < 0) {\n      nwIndex.x -= 1;\n      seIndex.x -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      nwIndex.y -= 1;\n      seIndex.y -= 1;\n    }\n\n    this._tileFullIndex[res] = new Extent(nwIndex, seIndex);\n    return this._tileFullIndex[res];\n  };\n\n  _proto.getTilePrjNW = function getTilePrjNW(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointNW = function getTilePointNW(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjSE = function getTilePrjSE(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointSE = function getTilePointSE(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjExtent = function getTilePrjExtent(tileX, tileY, res) {\n    var nw = this.getTilePrjNW(tileX, tileY, res),\n        se = this.getTilePrjSE(tileX, tileY, res);\n    return new Extent(nw, se);\n  };\n\n  return TileConfig;\n}();\n\nvar planes = [];\n\nfor (var i = 0; i < 6; i++) {\n  planes[i] = [];\n}\nvar p = [];\nfunction intersectsBox(matrix, box, mask) {\n  setPlanes(matrix);\n\n  for (var i = 0; i < 6; i++) {\n    if (mask && mask.charAt(i) === '0') {\n      continue;\n    }\n\n    var plane = planes[i];\n    p[0] = plane[0] > 0 ? box[1][0] : box[0][0];\n    p[1] = plane[1] > 0 ? box[1][1] : box[0][1];\n    p[2] = plane[2] > 0 ? box[1][2] : box[0][2];\n\n    if (distanceToPoint(plane, p) < 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction setPlanes(m) {\n  var me = m;\n  var me0 = me[0],\n      me1 = me[1],\n      me2 = me[2],\n      me3 = me[3];\n  var me4 = me[4],\n      me5 = me[5],\n      me6 = me[6],\n      me7 = me[7];\n  var me8 = me[8],\n      me9 = me[9],\n      me10 = me[10],\n      me11 = me[11];\n  var me12 = me[12],\n      me13 = me[13],\n      me14 = me[14],\n      me15 = me[15];\n  setComponents(planes[0], me3 - me0, me7 - me4, me11 - me8, me15 - me12);\n  setComponents(planes[1], me3 + me0, me7 + me4, me11 + me8, me15 + me12);\n  setComponents(planes[2], me3 + me1, me7 + me5, me11 + me9, me15 + me13);\n  setComponents(planes[3], me3 - me1, me7 - me5, me11 - me9, me15 - me13);\n  setComponents(planes[4], me3 - me2, me7 - me6, me11 - me10, me15 - me14);\n  setComponents(planes[5], me3 + me2, me7 + me6, me11 + me10, me15 + me14);\n}\n\nfunction setComponents(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  var length = distance$1(out);\n  out[0] /= length;\n  out[1] /= length;\n  out[2] /= length;\n  out[3] /= length;\n  return out;\n}\n\nfunction distanceToPoint(plane, p) {\n  return plane[0] * p[0] + plane[1] * p[1] + plane[2] * p[2] + plane[3];\n}\n\nfunction distance$1(v3) {\n  return Math.sqrt(v3[0] * v3[0] + v3[1] * v3[1] + v3[2] * v3[2]);\n}\n\nvar isSetAvailable = typeof Set !== 'undefined';\n\nvar TileHashset = function () {\n  function TileHashset() {\n    this._table = isSetAvailable ? new Set() : {};\n  }\n\n  var _proto = TileHashset.prototype;\n\n  _proto.add = function add$$1(key) {\n    if (isSetAvailable) {\n      this._table.add(key);\n    } else {\n      this._table[key] = true;\n    }\n  };\n\n  _proto.has = function has(key) {\n    if (isSetAvailable) {\n      return this._table.has(key);\n    } else {\n      return this._table[key];\n    }\n  };\n\n  _proto.reset = function reset() {\n    if (isSetAvailable) {\n      this._table.clear();\n    } else {\n      this._table = {};\n    }\n  };\n\n  return TileHashset;\n}();\n\nvar options$u = {\n  'urlTemplate': null,\n  'subdomains': null,\n  'repeatWorld': true,\n  'background': true,\n  'backgroundZoomDiff': 6,\n  'loadingLimitOnInteracting': 3,\n  'tileRetryCount': 0,\n  'placeholder': false,\n  'crossOrigin': null,\n  'tileSize': [256, 256],\n  'offset': [0, 0],\n  'tileSystem': null,\n  'fadeAnimation': !IS_NODE,\n  'debug': false,\n  'spatialReference': null,\n  'maxCacheSize': 256,\n  'renderer': function () {\n    return Browser$1.webgl ? 'gl' : 'canvas';\n  }(),\n  'clipByPitch': true,\n  'maxAvailableZoom': null,\n  'cascadeTiles': true,\n  'zoomOffset': 0\n};\nvar URL_PATTERN$1 = /\\{ *([\\w_]+) *\\}/g;\nvar TEMP_POINT = new Point(0, 0);\nvar TEMP_POINT0$3 = new Point(0, 0);\nvar TEMP_POINT1$1 = new Point(0, 0);\nvar TEMP_POINT2 = new Point(0, 0);\nvar TEMP_POINT3 = new Point(0, 0);\nvar TEMP_POINT4 = new Point(0, 0);\nvar TEMP_POINT5 = new Point(0, 0);\nvar TEMP_POINT6 = new Point(0, 0);\nvar TILE_BOX = [[0, 0, 0], [0, 0, 0]];\nvar ARR3 = [];\n\nvar TileLayer = function (_Layer) {\n  _inheritsLoose(TileLayer, _Layer);\n\n  function TileLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  TileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n      return null;\n    }\n\n    return new TileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  var _proto2 = TileLayer.prototype;\n\n  _proto2.getTileSize = function getTileSize() {\n    var size = this.options['tileSize'];\n\n    if (isNumber(size)) {\n      size = [size, size];\n    }\n\n    return new Size(size);\n  };\n\n  _proto2.getTiles = function getTiles(z, parentLayer) {\n    var map = this.getMap();\n    var pitch = map.getPitch();\n    var parentRenderer = parentLayer && parentLayer.getRenderer();\n    var mapExtent = map.getContainerExtent();\n    var tileGrids = [];\n    var count = 0;\n    var minZoom = this.getMinZoom();\n    var cascadePitch0 = map.options['cascadePitches'][0];\n    var cascadePitch1 = map.options['cascadePitches'][1];\n    var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n    var tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n    this._visitedTiles = new TileHashset();\n    this._coordCache = {};\n\n    if (!isNil(z) || !this.options['cascadeTiles'] || pitch <= cascadePitch0 || !isNil(minZoom) && tileZoom <= minZoom) {\n      var containerExtent = pitch <= cascadePitch1 ? mapExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n\n      var _currentTiles = this._getTiles(tileZoom, containerExtent, 2, parentRenderer);\n\n      if (_currentTiles) {\n        count += _currentTiles.tiles.length;\n        tileGrids.push(_currentTiles);\n      }\n\n      return {\n        tileGrids: tileGrids,\n        count: count\n      };\n    }\n\n    var visualHeight0 = Math.floor(map._getVisualHeight(cascadePitch0));\n    var extent0 = new PointExtent(0, map.height - visualHeight0, map.width, map.height);\n\n    var currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n\n    count += currentTiles ? currentTiles.tiles.length : 0;\n    tileGrids.push(currentTiles);\n    var cascadeHeight = extent0.ymin;\n    var d = map.getSpatialReference().getZoomDirection();\n    var cascadeLevels = d;\n    var cascadeTiles1;\n\n    if (pitch > cascadePitch1) {\n      if (tileZoom - cascadeLevels <= minZoom) {\n        cascadeLevels = 0;\n      }\n\n      var extent1 = new PointExtent(0, map.height - visualHeight1, map.width, cascadeHeight);\n      cascadeTiles1 = this._getTiles(tileZoom - cascadeLevels, extent1, 1, parentRenderer);\n      count += cascadeTiles1 ? cascadeTiles1.tiles.length : 0;\n      cascadeHeight = extent1.ymin;\n      cascadeLevels += 4 * d;\n    }\n\n    var cascadeTiles2;\n\n    if (tileZoom - cascadeLevels >= minZoom) {\n      var extent2 = new PointExtent(0, mapExtent.ymin, map.width, cascadeHeight);\n      cascadeTiles2 = this._getTiles(tileZoom - cascadeLevels, extent2, 2, parentRenderer);\n      count += cascadeTiles2 ? cascadeTiles2.tiles.length : 0;\n      tileGrids.push(cascadeTiles2);\n    }\n\n    if (cascadeTiles1 && cascadeTiles2) {\n      tileGrids[1] = cascadeTiles2;\n      tileGrids[2] = cascadeTiles1;\n    }\n\n    return {\n      tileGrids: tileGrids,\n      count: count\n    };\n  };\n\n  _proto2.getTileUrl = function getTileUrl(x, y, z) {\n    var urlTemplate = this.options['urlTemplate'];\n    var domain = '';\n\n    if (this.options['subdomains']) {\n      var subdomains = this.options['subdomains'];\n\n      if (isArrayHasData(subdomains)) {\n        var length$$1 = subdomains.length;\n        var s = (x + y) % length$$1;\n\n        if (s < 0) {\n          s = 0;\n        }\n\n        domain = subdomains[s];\n      }\n    }\n\n    if (isFunction(urlTemplate)) {\n      return urlTemplate(x, y, z, domain);\n    }\n\n    var data = {\n      'x': x,\n      'y': y,\n      'z': z,\n      's': domain\n    };\n    return urlTemplate.replace(URL_PATTERN$1, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        throw new Error('No value provided for variable ' + str);\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return value;\n    });\n  };\n\n  _proto2.clear = function clear() {\n    if (this._renderer) {\n      this._renderer.clear();\n    }\n\n    this.fire('clear');\n    return this;\n  };\n\n  _proto2.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto2.getSpatialReference = function getSpatialReference() {\n    var map = this.getMap();\n\n    if (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n      return map.getSpatialReference();\n    }\n\n    this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n\n    if (this._srMinZoom === undefined) {\n      this._srMinZoom = this._sr.getMinZoom();\n      this._srMaxZoom = this._sr.getMaxZoom();\n    }\n\n    return this._sr;\n  };\n\n  _proto2.getMinZoom = function getMinZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.max(_Layer.prototype.getMinZoom.call(this), this._srMinZoom);\n    }\n\n    return _Layer.prototype.getMinZoom.call(this);\n  };\n\n  _proto2.getMaxZoom = function getMaxZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.min(_Layer.prototype.getMaxZoom.call(this), this._srMaxZoom);\n    }\n\n    return _Layer.prototype.getMaxZoom.call(this);\n  };\n\n  _proto2._getTileZoom = function _getTileZoom(zoom) {\n    if (!isInteger(zoom)) {\n      zoom = Math.round(zoom);\n    }\n\n    var maxZoom = this.options['maxAvailableZoom'];\n\n    if (!isNil(maxZoom) && zoom > maxZoom) {\n      zoom = maxZoom;\n    }\n\n    return zoom;\n  };\n\n  _proto2._getTiles = function _getTiles(tileZoom, containerExtent, cascadeLevel, parentRenderer) {\n    var _this = this;\n\n    var map = this.getMap();\n    var z = tileZoom;\n    var frustumMatrix = map.projViewMatrix;\n\n    if (cascadeLevel < 2) {\n      if (cascadeLevel === 0) {\n        z -= 1;\n      }\n\n      frustumMatrix = cascadeLevel === 0 ? map.cascadeFrustumMatrix0 : cascadeLevel === 1 ? map.cascadeFrustumMatrix1 : map.projViewMatrix;\n    }\n\n    var zoom = z + this.options['zoomOffset'];\n\n    var offset = this._getTileOffset(zoom),\n        hasOffset = offset[0] || offset[1];\n\n    var emptyGrid = {\n      'zoom': z,\n      'extent': null,\n      'offset': offset,\n      'tiles': []\n    };\n\n    if (zoom < 0) {\n      return emptyGrid;\n    }\n\n    var minZoom = this.getMinZoom(),\n        maxZoom = this.getMaxZoom();\n\n    if (!map || !this.isVisible() || !map.width || !map.height) {\n      return emptyGrid;\n    }\n\n    if (!isNil(minZoom) && z < minZoom || !isNil(maxZoom) && z > maxZoom) {\n      return emptyGrid;\n    }\n\n    var tileConfig = this._getTileConfig();\n\n    if (!tileConfig) {\n      return emptyGrid;\n    }\n\n    var sr = this.getSpatialReference();\n    var mapSR = map.getSpatialReference();\n    var res = sr.getResolution(zoom);\n    var glScale = map.getGLScale(z);\n    var repeatWorld = sr === mapSR && this.options['repeatWorld'];\n    var extent2d = containerExtent.convertTo(function (c) {\n      var result;\n\n      if (c.y > 0 && c.y < map.height) {\n        var key = (c.x === 0 ? 0 : 1) + c.y;\n\n        if (!_this._coordCache[key]) {\n          _this._coordCache[key] = map._containerPointToPoint(c);\n        }\n\n        result = _this._coordCache[key];\n      }\n\n      result = map._containerPointToPoint(c, undefined, TEMP_POINT);\n      return result;\n    });\n\n    extent2d._add(offset);\n\n    var maskExtent = this._getMask2DExtent();\n\n    if (maskExtent) {\n      var intersection = maskExtent.intersection(extent2d);\n\n      if (!intersection) {\n        return emptyGrid;\n      }\n\n      containerExtent = intersection.convertTo(function (c) {\n        return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT);\n      });\n    }\n\n    var prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0$3);\n\n    var centerPoint = map._prjToPoint(prjCenter, undefined, TEMP_POINT1$1);\n\n    var c;\n\n    if (hasOffset) {\n      c = this._project(map._pointToPrj(centerPoint._add(offset), undefined, TEMP_POINT1$1), TEMP_POINT1$1);\n    } else {\n      c = this._project(prjCenter, TEMP_POINT1$1);\n    }\n\n    TEMP_POINT2.x = extent2d.xmin;\n    TEMP_POINT2.y = extent2d.ymax;\n    TEMP_POINT3.x = extent2d.xmax;\n    TEMP_POINT3.y = extent2d.ymin;\n\n    var pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n\n    var pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n    var centerTile = tileConfig.getTileIndex(c, res, repeatWorld);\n    var ltTile = tileConfig.getTileIndex(pmin, res, repeatWorld);\n    var rbTile = tileConfig.getTileIndex(pmax, res, repeatWorld);\n    var top = Math.ceil(Math.abs(centerTile.idy - ltTile.idy)),\n        left = Math.ceil(Math.abs(centerTile.idx - ltTile.idx)),\n        bottom = Math.ceil(Math.abs(centerTile.idy - rbTile.idy)),\n        right = Math.ceil(Math.abs(centerTile.idx - rbTile.idx));\n    var allCount = (top + bottom + 1) * (left + right + 1);\n    var tileSize = this.getTileSize();\n\n    var renderer = this.getRenderer() || parentRenderer,\n        scale = this._getTileConfig().tileSystem.scale;\n\n    var tiles = [],\n        extent = new PointExtent();\n\n    for (var i = -top; i <= bottom; i++) {\n      var j = -left;\n      var leftVisitEnd = -Infinity;\n      var rightVisitEnd = false;\n\n      while (j >= leftVisitEnd && j <= right) {\n        var idx = tileConfig.getNeighorTileIndex(centerTile.idx, centerTile.idy, j, i, res, repeatWorld);\n\n        if (leftVisitEnd === -Infinity) {\n          j++;\n        } else {\n          j--;\n        }\n\n        var tileId = this._getTileId(idx.idx, idx.idy, z);\n\n        if (idx.out || this._visitedTiles && this._visitedTiles.has(tileId)) {\n          continue;\n        }\n\n        var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n        if (tileInfo) {\n          tileInfo = tileInfo.info;\n        }\n\n        var p = void 0;\n\n        if (tileInfo) {\n          var _tileInfo = tileInfo,\n              point0 = _tileInfo.point0;\n          p = tileInfo.point.set(point0.x, point0.y);\n        } else if (!this._hasOwnSR) {\n          p = tileConfig.getTilePointNW(idx.x, idx.y, res);\n        } else {\n          var pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n          p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n        }\n\n        var width = void 0,\n            height = void 0;\n\n        if (sr === mapSR) {\n          width = tileSize.width;\n          height = tileSize.height;\n        } else {\n          var pp = void 0;\n\n          if (!this._hasOwnSR) {\n            pp = tileConfig.getTilePointSE(idx.x, idx.y, res);\n          } else {\n            var pse = tileConfig.getTilePrjSE(idx.x, idx.y, res);\n            pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3);\n          }\n\n          width = Math.ceil(Math.abs(pp.x - p.x));\n          height = Math.ceil(Math.abs(pp.y - p.y));\n        }\n\n        var dx = scale.x * (idx.idx - idx.x) * width,\n            dy = scale.y * (idx.idy - idx.y) * height;\n\n        if (dx || dy) {\n          p._add(dx, dy);\n        }\n\n        if (hasOffset) {\n          p._sub(offset);\n        }\n\n        var tileExtent = tileInfo && tileInfo.extent2d || new PointExtent(p.x, p.y, p.x + width, p.y - height);\n\n        if (allCount <= 4 || rightVisitEnd || this._isTileInExtent(frustumMatrix, tileExtent, glScale)) {\n          if (this._visitedTiles && cascadeLevel === 0) {\n            this._visitedTiles.add(tileId);\n          }\n\n          if (cascadeLevel === 0) {\n            this._splitTiles(frustumMatrix, tiles, renderer, idx, z + 1, tileExtent, offset, dx, dy);\n\n            extent._combine(tileExtent);\n          } else {\n            if (!tileInfo) {\n              tileInfo = {\n                'point0': p.add(offset)._sub(dx, dy),\n                'point': p,\n                'z': z,\n                'x': idx.x,\n                'y': idx.y,\n                'extent2d': tileExtent,\n                'mask': cascadeLevel,\n                'size': [width, height],\n                'id': tileId,\n                'dupKey': tileId,\n                'layer': this.getId(),\n                'url': this.getTileUrl(idx.x, idx.y, zoom)\n              };\n            }\n\n            if (hasOffset) {\n              tileExtent.set(p.x, p.y, p.x + width, p.y - height);\n              tileInfo.point = p._add(offset);\n\n              tileExtent._add(offset);\n            }\n\n            tiles.push(tileInfo);\n\n            extent._combine(tileExtent);\n          }\n\n          if (leftVisitEnd === -Infinity) {\n            leftVisitEnd = j;\n            j = right;\n          } else if (!rightVisitEnd) {\n            rightVisitEnd = true;\n          }\n        }\n      }\n    }\n\n    if (tiles.length) {\n      var center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n\n      tiles.sort(function (a, b) {\n        return a.point.distanceTo(center) - b.point.distanceTo(center);\n      });\n    }\n\n    return {\n      'offset': offset,\n      'zoom': tileZoom,\n      'extent': extent,\n      'tiles': tiles\n    };\n  };\n\n  _proto2._splitTiles = function _splitTiles(frustumMatrix, tiles, renderer, tileIdx, z, tileExtent, offset, dx, dy) {\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var glScale = this.getMap().getGLScale(z);\n    var corner = TEMP_POINT4.set(tileExtent.xmin * 2, yOrder < 0 ? tileExtent.ymax * 2 : tileExtent.ymin * 2);\n\n    var corner0 = TEMP_POINT5.set(tileExtent.xmin, yOrder < 0 ? tileExtent.ymax : tileExtent.ymin)._add(offset)._sub(dx, dy)._multi(2);\n\n    var w = tileExtent.getWidth();\n    var h = tileExtent.getHeight();\n    var idx = tileIdx.idx * 2;\n    var idy = tileIdx.idy * 2;\n    var x = tileIdx.x * 2;\n    var y = tileIdx.y * 2;\n\n    var tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 0, w, h, corner, corner0, offset, glScale);\n\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 0, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n  };\n\n  _proto2._checkAndAddTile = function _checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, i, j, w, h, corner, corner0, offset, glScale) {\n    var tileId = this._getTileId(idx + i, idy + j, z);\n\n    if (this._visitedTiles && this._visitedTiles.has(tileId)) {\n      return null;\n    }\n\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var childExtent = new PointExtent(corner.x + i * w, corner.y + yOrder * j * h, corner.x + (i + 1) * w, corner.y + yOrder * (j + 1) * h);\n\n    if (!this._isSplittedTileInExtent(frustumMatrix, childExtent, glScale)) {\n      return null;\n    }\n\n    var hasOffset = offset[0] || offset[1];\n    var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n    if (!tileInfo) {\n      tileInfo = {\n        'point0': corner0.add(i * w, Math.max(yOrder * j * h, yOrder * (j + 1) * h)),\n        'point': new Point(childExtent.xmin, childExtent.ymax),\n        'z': z,\n        'x': x + i,\n        'y': y + j,\n        'extent2d': childExtent,\n        'size': [w, h],\n        'id': tileId,\n        'dupKey': tileId,\n        'layer': this.getId(),\n        'url': this.getTileUrl(x + i, y + j, z + this.options['zoomOffset'])\n      };\n    } else {\n      tileInfo = tileInfo.info;\n    }\n\n    if (hasOffset) {\n      tileInfo.extent2d = childExtent;\n\n      tileInfo.extent2d._add(offset);\n\n      tileInfo.point.set(childExtent.xmin, childExtent.ymax)._add(offset);\n    }\n\n    return tileInfo;\n  };\n\n  _proto2._getTileOffset = function _getTileOffset(z) {\n    var map = this.getMap();\n\n    var scale = map._getResolution() / map._getResolution(z);\n\n    var offset = this.options['offset'];\n\n    if (isFunction(offset)) {\n      offset = offset(this);\n    }\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n    return offset;\n  };\n\n  _proto2._getTileId = function _getTileId(x, y, zoom, id) {\n    return (id || this.getId()) + \"_\" + y + \"_\" + x + \"_\" + zoom;\n  };\n\n  _proto2._project = function _project(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var mapProjection = map.getProjection();\n      var projection = this.getSpatialReference().getProjection();\n      return projection.project(mapProjection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._unproject = function _unproject(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var sr = this.getSpatialReference();\n      var mapProjection = map.getProjection();\n      var projection = sr.getProjection();\n      return mapProjection.project(projection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._initTileConfig = function _initTileConfig() {\n    var map = this.getMap(),\n        tileSize = this.getTileSize();\n    var sr = this.getSpatialReference();\n    var projection = sr.getProjection(),\n        fullExtent = sr.getFullExtent();\n    this._defaultTileConfig = new TileConfig(map, TileSystem.getDefault(projection), fullExtent, tileSize);\n\n    if (this.options['tileSystem']) {\n      this._tileConfig = new TileConfig(map, this.options['tileSystem'], fullExtent, tileSize);\n    }\n\n    if (map && !this._tileConfig && map.getSpatialReference() === sr && map.getBaseLayer() && map.getBaseLayer() !== this && map.getBaseLayer()._getTileConfig) {\n      var base = map.getBaseLayer()._getTileConfig();\n\n      this._tileConfig = new TileConfig(map, base.tileSystem, base.fullExtent, tileSize);\n    }\n\n    this._hasOwnSR = sr !== map.getSpatialReference();\n  };\n\n  _proto2._getTileConfig = function _getTileConfig() {\n    if (!this._defaultTileConfig) {\n      this._initTileConfig();\n    }\n\n    return this._tileConfig || this._defaultTileConfig;\n  };\n\n  _proto2._bindMap = function _bindMap(map) {\n    var baseLayer = map.getBaseLayer();\n\n    if (baseLayer === this) {\n      if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n        this.config({\n          'forceRenderOnMoving': true\n        });\n      }\n    }\n\n    return _Layer.prototype._bindMap.apply(this, arguments);\n  };\n\n  _proto2._isTileInExtent = function _isTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    var matrix;\n\n    if (frustumMatrix !== map.projViewMatrix) {\n      var tileCenter = tileExtent.getCenter(TEMP_POINT6)._multi(glScale);\n\n      set$2(ARR3, tileCenter.x, tileCenter.y, 0);\n      var ndc = transformMat4(ARR3, ARR3, map.projViewMatrix);\n      matrix = ndc[1] < 0 ? map.projViewMatrix : frustumMatrix;\n    } else {\n      matrix = map.projViewMatrix;\n    }\n\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(matrix, TILE_BOX);\n  };\n\n  _proto2._isSplittedTileInExtent = function _isSplittedTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(map.projViewMatrix, TILE_BOX);\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      'spatialreferencechange': this._onSpatialReferenceChange\n    };\n  };\n\n  _proto2._onSpatialReferenceChange = function _onSpatialReferenceChange() {\n    delete this._tileConfig;\n    delete this._defaultTileConfig;\n    delete this._sr;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.clear();\n    }\n  };\n\n  return TileLayer;\n}(Layer);\n\nTileLayer.registerJSONType('TileLayer');\nTileLayer.mergeOptions(options$u);\n\nvar GroupTileLayer = function (_TileLayer) {\n  _inheritsLoose(GroupTileLayer, _TileLayer);\n\n  GroupTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n      return null;\n    }\n\n    var layers = layerJSON['layers'].map(function (json) {\n      return Layer.fromJSON(json);\n    });\n    return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n  };\n\n  function GroupTileLayer(id, layers, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n    _this.layers = layers || [];\n\n    _this._checkChildren();\n\n    _this.layerMap = {};\n    _this._groupChildren = [];\n    return _this;\n  }\n\n  var _proto = GroupTileLayer.prototype;\n\n  _proto.getLayers = function getLayers() {\n    return this.layers;\n  };\n\n  _proto.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'layers': this.layers.map(function (layer) {\n        return layer.toJSON();\n      }),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto.getTiles = function getTiles(z) {\n    var layers = this.layers;\n    var tiles = [];\n    var count = 0;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.options['visible']) {\n        continue;\n      }\n\n      var childGrid = layer.getTiles(z, this);\n\n      if (!childGrid || childGrid.count === 0) {\n        continue;\n      }\n\n      count += childGrid.count;\n      pushIn(tiles, childGrid.tileGrids);\n    }\n\n    return {\n      count: count,\n      tileGrids: tiles\n    };\n  };\n\n  _proto.onAdd = function onAdd() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    this.layers.forEach(function (layer) {\n      _this2.layerMap[layer.getId()] = layer;\n\n      if (layer.getChildLayer) {\n        _this2._groupChildren.push(layer);\n      }\n\n      layer._bindMap(map);\n\n      layer.on('show hide', _this2._onLayerShowHide, _this2);\n    });\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    var _this3 = this;\n\n    this.layers.forEach(function (layer) {\n      layer._doRemove();\n\n      layer.off('show hide', _this3._onLayerShowHide, _this3);\n    });\n    this.layerMap = {};\n    this._groupChildren = [];\n\n    _TileLayer.prototype.onRemove.call(this);\n  };\n\n  _proto.getChildLayer = function getChildLayer(id) {\n    var layer = this.layerMap[id];\n\n    if (layer) {\n      return layer;\n    }\n\n    for (var i = 0; i < this._groupChildren.length; i++) {\n      var child = this._groupChildren[i].getChildLayer(id);\n\n      if (child) {\n        return child;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._onLayerShowHide = function _onLayerShowHide() {\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.setToRedraw();\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!_TileLayer.prototype.isVisible.call(this)) {\n      return false;\n    }\n\n    var children = this.layers;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      if (children[i].isVisible()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._checkChildren = function _checkChildren() {\n    var _this4 = this;\n\n    var ids = {};\n    this.layers.forEach(function (layer) {\n      var layerId = layer.getId();\n\n      if (ids[layerId]) {\n        throw new Error(\"Duplicate child layer id (\" + layerId + \") in the GroupTileLayer (\" + _this4.getId() + \")\");\n      } else {\n        ids[layerId] = 1;\n      }\n    });\n  };\n\n  return GroupTileLayer;\n}(TileLayer);\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\n\nvar options$v = {\n  crs: null,\n  uppercase: false,\n  detectRetina: false\n};\nvar defaultWmsParams = {\n  service: 'WMS',\n  request: 'GetMap',\n  layers: '',\n  styles: '',\n  format: 'image/jpeg',\n  transparent: false,\n  version: '1.1.1'\n};\n\nvar WMSTileLayer = function (_TileLayer) {\n  _inheritsLoose(WMSTileLayer, _TileLayer);\n\n  function WMSTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id) || this;\n    var wmsParams = extend({}, defaultWmsParams);\n\n    for (var p in options) {\n      if (!(p in _this.options)) {\n        wmsParams[p] = options[p];\n      }\n    }\n\n    _this.setOptions(options);\n\n    _this.setZIndex(options.zIndex);\n\n    var tileSize = _this.getTileSize();\n\n    wmsParams.width = tileSize.width;\n    wmsParams.height = tileSize.height;\n    _this.wmsParams = wmsParams;\n    _this._wmsVersion = parseFloat(wmsParams.version);\n    return _this;\n  }\n\n  var _proto = WMSTileLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    var dpr = this.getMap().getDevicePixelRatio();\n    var r = options$v.detectRetina ? dpr : 1;\n    this.wmsParams.width *= r;\n    this.wmsParams.height *= r;\n    var crs = this.options.crs || this.getMap().getProjection().code;\n    var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n    this.wmsParams[projectionKey] = crs;\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.getTileUrl = function getTileUrl(x, y, z) {\n    var res = this.getSpatialReference().getResolution(z),\n        tileConfig = this._getTileConfig(),\n        tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n\n    var max = tileExtent.getMax(),\n        min = tileExtent.getMin();\n    var bbox = (this._wmsVersion >= 1.3 && this.wmsParams.crs === 'EPSG:4326' ? [min.y, min.x, max.y, max.x] : [min.x, min.y, max.x, max.y]).join(',');\n\n    var url = _TileLayer.prototype.getTileUrl.call(this, x, y, z);\n\n    return url + getParamString(this.wmsParams, url, this.options.uppercase) + (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'WMSTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  WMSTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n      return null;\n    }\n\n    return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return WMSTileLayer;\n}(TileLayer);\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\nWMSTileLayer.mergeOptions(options$v);\nfunction getParamString(obj, existingUrl, uppercase) {\n  var params = [];\n\n  for (var i in obj) {\n    params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n  }\n\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n\nvar CanvasTileLayer = function (_TileLayer) {\n  _inheritsLoose(CanvasTileLayer, _TileLayer);\n\n  function CanvasTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n\n    if (!_this.options.hasOwnProperty('forceRenderOnMoving')) {\n      _this.options['forceRenderOnMoving'] = false;\n    }\n\n    return _this;\n  }\n\n  var _proto = CanvasTileLayer.prototype;\n\n  _proto.drawTile = function drawTile() {};\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'CanvasTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  CanvasTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n      return null;\n    }\n\n    return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return CanvasTileLayer;\n}(TileLayer);\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nfunction createGLContext(canvas, options) {\n  var attributes = {\n    'alpha': true,\n    'stencil': true,\n    'preserveDrawingBuffer': true,\n    'antialias': false\n  };\n  var names = ['webgl', 'experimental-webgl'];\n  var context = null;\n\n  for (var i = 0; i < names.length; ++i) {\n    try {\n      context = canvas.getContext(names[i], options || attributes);\n    } catch (e) {}\n\n    if (context) {\n      break;\n    }\n  }\n\n  return context;\n}\nfunction compileShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n  if (!compiled) {\n    var error = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error('Failed to compile shader: ' + error);\n  }\n\n  return shader;\n}\nfunction createProgram(gl, vert, frag) {\n  var vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n  var fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n\n  if (!vertexShader || !fragmentShader) {\n    return null;\n  }\n\n  var program = gl.createProgram();\n\n  if (!program) {\n    return null;\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  return {\n    program: program,\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader\n  };\n}\nfunction enableVertexAttrib(gl, program, attributes) {\n  if (Array.isArray(attributes[0])) {\n    var FSIZE = Float32Array.BYTES_PER_ELEMENT;\n    var STRIDE = 0;\n\n    for (var i = 0; i < attributes.length; i++) {\n      STRIDE += attributes[i][1] || 0;\n    }\n\n    var offset = 0;\n\n    for (var _i = 0; _i < attributes.length; _i++) {\n      var attr = gl.getAttribLocation(program, attributes[_i][0]);\n\n      if (attr < 0) {\n        throw new Error('Failed to get the storage location of ' + attributes[_i][0]);\n      }\n\n      gl.vertexAttribPointer(attr, attributes[_i][1], gl[attributes[_i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n      offset += attributes[_i][1] || 0;\n      gl.enableVertexAttribArray(attr);\n    }\n  } else {\n    var _attr = gl.getAttribLocation(program, attributes[0]);\n\n    gl.vertexAttribPointer(_attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n    gl.enableVertexAttribArray(_attr);\n  }\n}\n\nvar shaders = {\n  'vertexShader': \"\\n        attribute vec2 a_position;\\n\\n        attribute vec2 a_texCoord;\\n\\n        uniform mat4 u_matrix;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\\n\\n            v_texCoord = a_texCoord;\\n        }\\n    \",\n  'fragmentShader': \"\\n        precision mediump float;\\n\\n        uniform sampler2D u_image;\\n\\n        uniform float u_opacity;\\n        uniform float u_debug_line;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            if (u_debug_line == 1.) {\\n                gl_FragColor = vec4(0., 1., 0., 1.);\\n            } else {\\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\\n            }\\n        }\\n    \"\n};\nvar v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\nvar DEBUG_POINT = new Point(20, 20);\n\nvar ImageGLRenderable = function ImageGLRenderable(Base) {\n  var renderable = function (_Base) {\n    _inheritsLoose(renderable, _Base);\n\n    function renderable() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = renderable.prototype;\n\n    _proto.drawGLImage = function drawGLImage(image, x, y, w, h, scale$$1, opacity, debug) {\n      if (this.gl.program !== this.program) {\n        this.useProgram(this.program);\n      }\n\n      var gl = this.gl;\n      this.loadTexture(image);\n      v3[0] = x || 0;\n      v3[1] = y || 0;\n      var uMatrix = identity(arr16);\n      translate(uMatrix, uMatrix, v3);\n      scale(uMatrix, uMatrix, [scale$$1, scale$$1, 1]);\n      multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      var glBuffer = image.glBuffer;\n\n      if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n        this.saveImageBuffer(glBuffer);\n        delete image.glBuffer;\n      }\n\n      if (!image.glBuffer) {\n        image.glBuffer = this.bufferTileData(0, 0, w, h);\n      } else {\n        gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n      }\n\n      v2[0] = 'a_position';\n      v2[1] = 2;\n      v2[2] = image.glBuffer.type;\n      this.enableVertexAttrib(v2);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      if (debug) {\n        this.drawDebug(uMatrix, v2, 0, 0, w, h, debug);\n      }\n    };\n\n    _proto.drawDebug = function drawDebug(uMatrix, attrib, x, y, w, h, debugInfo) {\n      var gl = this.gl;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._debugBuffer);\n      this.enableVertexAttrib(['a_position', 2, 'FLOAT']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([x, y, x + w, y, x + w, y - h, x, y - h, x, y]), gl.DYNAMIC_DRAW);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_debug_line'], 1);\n      gl.drawArrays(gl.LINE_STRIP, 0, 5);\n      var canvas = this._debugInfoCanvas;\n\n      if (!canvas) {\n        var dpr = this.getMap().getDevicePixelRatio() > 1 ? 2 : 1;\n        canvas = this._debugInfoCanvas = document.createElement('canvas');\n        canvas.width = 256 * dpr;\n        canvas.height = 32 * dpr;\n\n        var _ctx = canvas.getContext('2d');\n\n        _ctx.font = '20px monospace';\n\n        _ctx.scale(dpr, dpr);\n      }\n\n      var ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      var color = this.layer.options['debugOutline'];\n      Canvas.fillText(ctx, debugInfo, DEBUG_POINT, color);\n      this.loadTexture(canvas);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n      w = 256;\n      h = 32;\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      gl.bufferData(gl.ARRAY_BUFFER, this.set8(x1, y1, x1, y2, x2, y1, x2, y2), gl.DYNAMIC_DRAW);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    _proto.bufferTileData = function bufferTileData(x, y, w, h, buffer) {\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      var data;\n\n      if (isInteger(x1) && isInteger(x2) && isInteger(y1) && isInteger(y2)) {\n        data = this.set8Int(x1, y1, x1, y2, x2, y1, x2, y2);\n      } else {\n        data = this.set8(x1, y1, x1, y2, x2, y1, x2, y2);\n      }\n\n      var glBuffer = this.loadImageBuffer(data, buffer);\n      glBuffer.width = w;\n      glBuffer.height = h;\n      glBuffer.type = data instanceof Int16Array ? 'SHORT' : 'FLOAT';\n      return glBuffer;\n    };\n\n    _proto.drawTinImage = function drawTinImage(image, vertices, texCoords, indices, opacity) {\n      var gl = this.gl;\n      this.loadTexture(image);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n      this.enableVertexAttrib(['a_position', 3]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n      gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n    };\n\n    _proto.createCanvas2 = function createCanvas2() {\n      this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n    };\n\n    _proto.createGLContext = function createGLContext$$1() {\n      if (this.canvas.gl && this.canvas.gl.wrap) {\n        this.gl = this.canvas.gl.wrap();\n      } else {\n        this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n      }\n\n      var gl = this.gl;\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n      gl.disable(gl.DEPTH_TEST);\n      gl.enable(gl.STENCIL_TEST);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity', 'u_debug_line']);\n      this._debugBuffer = this.createBuffer();\n      this.useProgram(this.program);\n      this.texBuffer = this.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2, 'UNSIGNED_BYTE']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n      this.enableSampler('u_image');\n      gl.activeTexture(gl['TEXTURE0']);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    };\n\n    _proto.resizeGLCanvas = function resizeGLCanvas() {\n      if (this.gl) {\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n      }\n\n      if (!this.canvas2) {\n        return;\n      }\n\n      if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n        this.canvas2.width = this.canvas.width;\n        this.canvas2.height = this.canvas.height;\n      }\n    };\n\n    _proto.clearGLCanvas = function clearGLCanvas() {\n      if (this.gl) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n      }\n    };\n\n    _proto.disposeImage = function disposeImage(image) {\n      if (!image) {\n        return;\n      }\n\n      if (image.texture) {\n        this.saveTexture(image.texture);\n      }\n\n      if (image.glBuffer) {\n        this.saveImageBuffer(image.glBuffer);\n      }\n\n      delete image.texture;\n      delete image.glBuffer;\n    };\n\n    _proto._createTexture = function _createTexture(image) {\n      var gl = this.gl;\n      var texture = this.getTexture() || gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n      if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      return texture;\n    };\n\n    _proto.getTexture = function getTexture() {\n      if (!this._textures) {\n        this._textures = [];\n      }\n\n      var textures = this._textures;\n      return textures && textures.length > 0 ? textures.pop() : null;\n    };\n\n    _proto.saveTexture = function saveTexture(texture) {\n      this._textures.push(texture);\n    };\n\n    _proto.loadTexture = function loadTexture(image) {\n      var gl = this.gl;\n      var texture = image.texture;\n\n      if (!texture) {\n        texture = this._createTexture(image);\n        image.texture = texture;\n      }\n\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      return texture;\n    };\n\n    _proto.getImageBuffer = function getImageBuffer() {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      var imageBuffers = this._imageBuffers;\n      return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n    };\n\n    _proto.saveImageBuffer = function saveImageBuffer(buffer) {\n      this._imageBuffers.push(buffer);\n    };\n\n    _proto.loadImageBuffer = function loadImageBuffer(data, glBuffer) {\n      var gl = this.gl;\n      var buffer = glBuffer || this.createImageBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n      return buffer;\n    };\n\n    _proto.createImageBuffer = function createImageBuffer() {\n      return this.getImageBuffer() || this.createBuffer();\n    };\n\n    _proto.removeGLCanvas = function removeGLCanvas() {\n      var gl = this.gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (this._debugBuffer) {\n        gl.deleteBuffer(this._debugBuffer);\n        delete this._debugBuffer;\n      }\n\n      if (this._buffers) {\n        this._buffers.forEach(function (b) {\n          gl.deleteBuffer(b);\n        });\n\n        delete this._buffers;\n      }\n\n      if (this._textures) {\n        this._textures.forEach(function (t) {\n          return gl.deleteTexture(t);\n        });\n\n        delete this._textures;\n      }\n\n      if (this._debugInfoCanvas) {\n        var texture = this._debugInfoCanvas.texture;\n\n        if (texture) {\n          gl.deleteTexture(texture);\n        }\n\n        delete this._debugInfoCanvas.texture;\n        delete this._debugInfoCanvas;\n      }\n\n      var program = gl.program;\n      gl.deleteShader(program.fragmentShader);\n      gl.deleteShader(program.vertexShader);\n      gl.deleteProgram(program);\n      delete this.gl;\n      delete this.canvas2;\n    };\n\n    _proto.createBuffer = function createBuffer() {\n      var gl = this.gl;\n      var buffer = gl.createBuffer();\n\n      if (!buffer) {\n        throw new Error('Failed to create the buffer object');\n      }\n\n      if (!this._buffers) {\n        this._buffers = [];\n      }\n\n      this._buffers.push(buffer);\n\n      return buffer;\n    };\n\n    _proto.enableVertexAttrib = function enableVertexAttrib$$1(attributes) {\n      enableVertexAttrib(this.gl, this.gl.program, attributes);\n    };\n\n    _proto.createProgram = function createProgram$$1(vert, frag, uniforms) {\n      var gl = this.gl;\n\n      var _createProgram2 = createProgram(gl, vert, frag),\n          program = _createProgram2.program,\n          vertexShader = _createProgram2.vertexShader,\n          fragmentShader = _createProgram2.fragmentShader;\n\n      program.vertexShader = vertexShader;\n      program.fragmentShader = fragmentShader;\n\n      this._initUniforms(program, uniforms);\n\n      return program;\n    };\n\n    _proto.useProgram = function useProgram(program) {\n      var gl = this.gl;\n      gl.useProgram(program);\n      gl.program = program;\n      return this;\n    };\n\n    _proto.enableSampler = function enableSampler(sampler, texIdx) {\n      var gl = this.gl;\n\n      var uSampler = this._getUniform(gl.program, sampler);\n\n      if (!texIdx) {\n        texIdx = 0;\n      }\n\n      gl.uniform1i(uSampler, texIdx);\n      return uSampler;\n    };\n\n    _proto._initUniforms = function _initUniforms(program, uniforms) {\n      for (var i = 0; i < uniforms.length; i++) {\n        var name = uniforms[i];\n        var uniform = uniforms[i];\n        var b = name.indexOf('[');\n\n        if (b >= 0) {\n          name = name.substring(0, b);\n\n          if (!IS_NODE) {\n            uniform = uniform.substring(0, b);\n          }\n        }\n\n        program[name] = this._getUniform(program, uniform);\n      }\n    };\n\n    _proto._getUniform = function _getUniform(program, uniformName) {\n      var gl = this.gl;\n      var uniform = gl.getUniformLocation(program, uniformName);\n\n      if (!uniform) {\n        throw new Error('Failed to get the storage location of ' + uniformName);\n      }\n\n      return uniform;\n    };\n\n    return renderable;\n  }(Base);\n\n  extend(renderable.prototype, {\n    set8: function () {\n      var out = Browser$1.ie9 ? null : new Float32Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }(),\n    set8Int: function () {\n      var out = Browser$1.ie9 ? null : new Int16Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }()\n  });\n  return renderable;\n};\n\nvar options$w = {\n  renderer: Browser$1.webgl ? 'gl' : 'canvas',\n  crossOrigin: null\n};\nvar TEMP_POINT$1 = new Point(0, 0);\n\nvar ImageLayer = function (_Layer) {\n  _inheritsLoose(ImageLayer, _Layer);\n\n  function ImageLayer(id, images, options) {\n    var _this;\n\n    if (images && !Array.isArray(images) && !images.url) {\n      options = images;\n      images = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._images = images;\n    return _this;\n  }\n\n  var _proto = ImageLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    this._prepareImages(this._images);\n  };\n\n  _proto.setImages = function setImages(images) {\n    this._images = images;\n\n    this._prepareImages(images);\n\n    return this;\n  };\n\n  _proto.getImages = function getImages() {\n    return this._images;\n  };\n\n  _proto._prepareImages = function _prepareImages(images) {\n    images = images || [];\n\n    if (!Array.isArray(images)) {\n      images = [images];\n    }\n\n    var map = this.getMap();\n    this._imageData = images.map(function (img) {\n      var extent = new Extent(img.extent);\n      return extend({}, img, {\n        extent: extent,\n        extent2d: extent.convertTo(function (c) {\n          return map.coordToPoint(c, map.getGLZoom());\n        })\n      });\n    });\n    this._images = images;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.refreshImages();\n    }\n  };\n\n  return ImageLayer;\n}(Layer);\n\nImageLayer.mergeOptions(options$w);\nvar EMPTY_ARRAY = [];\nvar ImageLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(ImageLayerCanvasRenderer, _CanvasRenderer);\n\n  function ImageLayerCanvasRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = ImageLayerCanvasRenderer.prototype;\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.checkResources = function checkResources() {\n    var _this2 = this;\n\n    if (this._imageLoaded) {\n      return EMPTY_ARRAY;\n    }\n\n    var layer = this.layer;\n\n    var urls = layer._imageData.map(function (img) {\n      return [img.url, null, null];\n    });\n\n    if (this.resources) {\n      var unloaded = [];\n      var resources = new ResourceCache();\n      urls.forEach(function (url) {\n        if (_this2.resources.isResourceLoaded(url)) {\n          var img = _this2.resources.getImage(url);\n\n          resources.addResource(url, img);\n        } else {\n          unloaded.push(url);\n        }\n      });\n      this.resources.forEach(function (url, res) {\n        if (!resources.isResourceLoaded(url)) {\n          _this2.retireImage(res.image);\n        }\n      });\n      this.resources = resources;\n      urls = unloaded;\n    }\n\n    this._imageLoaded = true;\n    return urls;\n  };\n\n  _proto2.retireImage = function retireImage() {};\n\n  _proto2.refreshImages = function refreshImages() {\n    this._imageLoaded = false;\n    this.setToRedraw();\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isZooming() && !map.getPitch()) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto2.draw = function draw() {\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    this.prepareCanvas();\n    this._painted = false;\n\n    this._drawImages();\n\n    this.completeRender();\n  };\n\n  _proto2._drawImages = function _drawImages() {\n    var imgData = this.layer._imageData;\n    var map = this.getMap();\n\n    var mapExtent = map._get2DExtent(map.getGLZoom());\n\n    if (imgData && imgData.length) {\n      for (var i = 0; i < imgData.length; i++) {\n        var extent = imgData[i].extent2d;\n        var image = this.resources && this.resources.getImage(imgData[i].url);\n\n        if (image && mapExtent.intersects(extent)) {\n          this._painted = true;\n\n          this._drawImage(image, extent, imgData[i].opacity || 1);\n        }\n      }\n    }\n  };\n\n  _proto2._drawImage = function _drawImage(image, extent, opacity) {\n    var globalAlpha = 0;\n    var ctx = this.context;\n\n    if (opacity < 1) {\n      globalAlpha = ctx.globalAlpha;\n      ctx.globalAlpha = opacity;\n    }\n\n    var map = this.getMap();\n    var nw = TEMP_POINT$1.set(extent.xmin, extent.ymax);\n\n    var point = map._pointToContainerPoint(nw, map.getGLZoom());\n\n    var x = point.x,\n        y = point.y;\n    var bearing = map.getBearing();\n\n    if (bearing) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n      }\n\n      x = y = 0;\n    }\n\n    var scale = map.getGLScale();\n    ctx.drawImage(image, x, y, extent.getWidth() / scale, extent.getHeight() / scale);\n\n    if (bearing) {\n      ctx.restore();\n    }\n\n    if (globalAlpha) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  return ImageLayerCanvasRenderer;\n}(CanvasRenderer);\nvar ImageLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(ImageLayerGLRenderer, _ImageGLRenderable);\n\n  function ImageLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto3 = ImageLayerGLRenderer.prototype;\n\n  _proto3.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto3._drawImage = function _drawImage(image, extent, opacity) {\n    this.drawGLImage(image, extent.xmin, extent.ymax, extent.getWidth(), extent.getHeight(), 1, opacity);\n  };\n\n  _proto3.createContext = function createContext() {\n    this.createGLContext();\n  };\n\n  _proto3.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto3.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto3.retireImage = function retireImage(image) {\n    this.disposeImage(image);\n  };\n\n  _proto3.onRemove = function onRemove() {\n    this.removeGLCanvas();\n\n    _ImageGLRenderable.prototype.onRemove.call(this);\n  };\n\n  return ImageLayerGLRenderer;\n}(ImageGLRenderable(ImageLayerCanvasRenderer));\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nvar CanvasLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(CanvasLayerRenderer, _CanvasRenderer);\n\n  function CanvasLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayerRenderer.prototype;\n\n  _proto.getPrepareParams = function getPrepareParams() {\n    return [];\n  };\n\n  _proto.getDrawParams = function getDrawParams() {\n    return [];\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (this.canvas && this.layer.options['doubleBuffer']) {\n      this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n    }\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    if (this.layer.options['animation']) {\n      return true;\n    }\n\n    var map = this.getMap();\n\n    if (map.isInteracting() && !this.layer.drawOnInteracting) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    this.prepareCanvas();\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this._drawLayerOnInteracting();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var canvasImg = _CanvasRenderer.prototype.getCanvasImage.call(this);\n\n    if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n      var canvas = canvasImg.image;\n\n      if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n        this.buffer.width = canvas.width;\n        this.buffer.height = canvas.height;\n      }\n\n      var bufferContext = this.buffer.getContext('2d');\n      var prevent = this.layer.doubleBuffer(bufferContext, this.context);\n\n      if (prevent === undefined || prevent) {\n        Canvas.image(bufferContext, canvas, 0, 0);\n        canvasImg.image = this.buffer;\n      }\n    }\n\n    return canvasImg;\n  };\n\n  _proto.remove = function remove() {\n    delete this._drawContext;\n    return _CanvasRenderer.prototype.remove.call(this);\n  };\n\n  _proto.onZoomStart = function onZoomStart(param) {\n    this.layer.onZoomStart(param);\n\n    _CanvasRenderer.prototype.onZoomStart.call(this, param);\n  };\n\n  _proto.onZooming = function onZooming(param) {\n    this.layer.onZooming(param);\n\n    _CanvasRenderer.prototype.onZooming.call(this, param);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd(param) {\n    this.layer.onZoomEnd(param);\n\n    _CanvasRenderer.prototype.onZoomEnd.call(this, param);\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    this.layer.onMoveStart(param);\n\n    _CanvasRenderer.prototype.onMoveStart.call(this, param);\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this.layer.onMoving(param);\n\n    _CanvasRenderer.prototype.onMoving.call(this, param);\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this.layer.onMoveEnd(param);\n\n    _CanvasRenderer.prototype.onMoveEnd.call(this, param);\n  };\n\n  _proto.onResize = function onResize(param) {\n    this.layer.onResize(param);\n\n    _CanvasRenderer.prototype.onResize.call(this, param);\n  };\n\n  _proto.prepareDrawContext = function prepareDrawContext() {\n    if (!this._predrawed) {\n      var params = ensureParams(this.getPrepareParams());\n      this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n\n      if (!this._drawContext) {\n        this._drawContext = [];\n      }\n\n      if (!Array.isArray(this._drawContext)) {\n        this._drawContext = [this._drawContext];\n      }\n\n      this._predrawed = true;\n    }\n  };\n\n  _proto._prepareDrawParams = function _prepareDrawParams() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var view = this.getViewExtent();\n\n    if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n      this.completeRender();\n      return null;\n    }\n\n    var args = [this.context, view];\n    var params = ensureParams(this.getDrawParams());\n    args.push.apply(args, params);\n    args.push.apply(args, this._drawContext);\n    return args;\n  };\n\n  _proto._drawLayer = function _drawLayer() {\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.draw.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  _proto._drawLayerOnInteracting = function _drawLayerOnInteracting() {\n    if (!this.layer.drawOnInteracting) {\n      return;\n    }\n\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.drawOnInteracting.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  return CanvasLayerRenderer;\n}(CanvasRenderer);\n\nfunction ensureParams(params) {\n  if (!params) {\n    params = [];\n  }\n\n  if (!Array.isArray(params)) {\n    params = [params];\n  }\n\n  return params;\n}\n\nvar options$x = {\n  'doubleBuffer': false,\n  'animation': false\n};\n\nvar CanvasLayer = function (_Layer) {\n  _inheritsLoose(CanvasLayer, _Layer);\n\n  function CanvasLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayer.prototype;\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    return true;\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {};\n\n  _proto.draw = function draw() {};\n\n  _proto.redraw = function redraw() {\n    if (this._getRenderer()) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.play = function play() {\n    this.config('animation', true);\n    return this;\n  };\n\n  _proto.pause = function pause() {\n    this.config('animation', false);\n    return this;\n  };\n\n  _proto.isPlaying = function isPlaying() {\n    return this.options['animation'];\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (this._getRenderer()) {\n      this._getRenderer().clearCanvas();\n    }\n\n    return this;\n  };\n\n  _proto.requestMapToRender = function requestMapToRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().requestMapToRender();\n    }\n\n    return this;\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().completeRender();\n    }\n\n    return this;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    return this;\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {};\n\n  _proto.onResize = function onResize() {};\n\n  _proto.doubleBuffer = function doubleBuffer(bufferContext) {\n    bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n    return this;\n  };\n\n  return CanvasLayer;\n}(Layer);\n\nCanvasLayer.mergeOptions(options$x);\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\n\nvar TEMP_POINT$2 = new Point(0, 0);\nvar options$y = {\n  'animation': true\n};\n\nvar ParticleLayer = function (_CanvasLayer) {\n  _inheritsLoose(ParticleLayer, _CanvasLayer);\n\n  function ParticleLayer() {\n    return _CanvasLayer.apply(this, arguments) || this;\n  }\n\n  var _proto = ParticleLayer.prototype;\n\n  _proto.getParticles = function getParticles() {};\n\n  _proto.draw = function draw(context, view) {\n    var points = this.getParticles(now());\n\n    if (!points || points.length === 0) {\n      var renderer = this._getRenderer();\n\n      if (renderer) {\n        this._getRenderer()._shouldClear = true;\n      }\n\n      return;\n    }\n\n    var map = this.getMap();\n    var extent = view.extent;\n\n    if (view.maskExtent) {\n      extent = view.extent.intersection(view.maskExtent);\n    }\n\n    extent = extent.convertTo(function (c) {\n      return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT$2);\n    });\n    var e = 2 * Math.PI;\n\n    for (var i = 0, l = points.length; i < l; i++) {\n      var pos = points[i].point;\n\n      if (extent.contains(pos)) {\n        var color = points[i].color || this.options['lineColor'] || '#fff',\n            r = points[i].r;\n\n        if (context.fillStyle !== color) {\n          context.fillStyle = color;\n        }\n\n        if (r <= 2) {\n          context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n        } else {\n          context.beginPath();\n          context.arc(pos.x, pos.y, r / 2, 0, e);\n          context.fill();\n        }\n      }\n    }\n\n    this._fillCanvas(context);\n  };\n\n  _proto._fillCanvas = function _fillCanvas(context) {\n    var g = context.globalCompositeOperation;\n    context.globalCompositeOperation = 'destination-out';\n    var trail = this.options['trail'] || 30;\n    context.fillStyle = 'rgba(0, 0, 0, ' + 1 / trail + ')';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    context.globalCompositeOperation = g;\n  };\n\n  return ParticleLayer;\n}(CanvasLayer);\n\nParticleLayer.mergeOptions(options$y);\nParticleLayer.registerRenderer('canvas', function (_CanvasLayerRenderer) {\n  _inheritsLoose(_class, _CanvasLayerRenderer);\n\n  function _class() {\n    return _CanvasLayerRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = _class.prototype;\n\n  _proto2.draw = function draw() {\n    if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n      this.prepareCanvas();\n      this._shouldClear = false;\n    }\n\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n    this._shouldClear = false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {\n    this._shouldClear = true;\n  };\n\n  return _class;\n}(CanvasLayerRenderer));\n\nvar EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n  return {\n    'markerType': markerType,\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'opacity': opacity\n  };\n}\n\nvar options$z = {\n  'fixAspectRatio': false,\n  'symbol': null,\n  'removeVertexOn': 'contextmenu',\n  'centerHandleSymbol': createHandleSymbol('ellipse', 1),\n  'vertexHandleSymbol': createHandleSymbol('square', 1),\n  'newVertexHandleSymbol': createHandleSymbol('square', 0.4)\n};\n\nvar GeometryEditor = function (_Eventable) {\n  _inheritsLoose(GeometryEditor, _Eventable);\n\n  function GeometryEditor(geometry, opts) {\n    var _this;\n\n    _this = _Eventable.call(this, opts) || this;\n    _this._geometry = geometry;\n\n    if (!_this._geometry) {\n      return _assertThisInitialized(_this);\n    }\n\n    return _this;\n  }\n\n  var _proto = GeometryEditor.prototype;\n\n  _proto.getMap = function getMap() {\n    return this._geometry.getMap();\n  };\n\n  _proto.prepare = function prepare() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    if (this.options['symbol']) {\n      this._originalSymbol = this._geometry.getSymbol();\n\n      this._geometry.setSymbol(this.options['symbol']);\n    }\n\n    this._prepareEditStageLayer();\n  };\n\n  _proto._prepareEditStageLayer = function _prepareEditStageLayer() {\n    var map = this.getMap();\n    var uid = UID();\n    var stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n        shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n    this._editStageLayer = map.getLayer(stageId);\n    this._shadowLayer = map.getLayer(shadowId);\n\n    if (!this._editStageLayer) {\n      this._editStageLayer = new VectorLayer(stageId);\n      map.addLayer(this._editStageLayer);\n    }\n\n    if (!this._shadowLayer) {\n      this._shadowLayer = new VectorLayer(shadowId);\n      map.addLayer(this._shadowLayer);\n    }\n  };\n\n  _proto.start = function start() {\n    var _this2 = this;\n\n    if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n      return;\n    }\n\n    var map = this.getMap();\n    this.editing = true;\n    var geometry = this._geometry;\n    this._geometryDraggble = geometry.options['draggable'];\n    geometry.config('draggable', false);\n    this.prepare();\n    var shadow = geometry.copy();\n    shadow.setSymbol(geometry._getInternalSymbol());\n    shadow.copyEventListeners(geometry);\n\n    if (geometry._getParent()) {\n      shadow.copyEventListeners(geometry._getParent());\n    }\n\n    shadow._setEventTarget(geometry);\n\n    shadow.setId(null).config({\n      'draggable': false\n    });\n    this._shadow = shadow;\n\n    this._switchGeometryEvents('on');\n\n    geometry.hide();\n\n    if (geometry instanceof Marker || geometry instanceof Circle || geometry instanceof Rectangle || geometry instanceof Ellipse) {\n      this._createOrRefreshOutline();\n    }\n\n    this._shadowLayer.bringToFront().addGeometry(shadow);\n\n    this._editStageLayer.bringToFront();\n\n    this._addListener([map, 'zoomstart', function () {\n      _this2._editStageLayer.hide();\n    }]);\n\n    this._addListener([map, 'zoomend', function () {\n      _this2._editStageLayer.show();\n    }]);\n\n    if (!(geometry instanceof Marker)) {\n      this._createCenterHandle();\n    } else {\n      shadow.config('draggable', true);\n      shadow.on('dragend', this._onMarkerDragEnd, this);\n    }\n\n    if (geometry instanceof Marker) {\n      this.createMarkerEditor();\n    } else if (geometry instanceof Circle) {\n      this.createCircleEditor();\n    } else if (geometry instanceof Rectangle) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Ellipse) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Sector) ; else if (geometry instanceof Polygon || geometry instanceof LineString) {\n      this.createPolygonEditor();\n    }\n  };\n\n  _proto.stop = function stop() {\n    delete this._history;\n    delete this._historyPointer;\n    delete this._editOutline;\n\n    this._switchGeometryEvents('off');\n\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    delete this._shadow;\n\n    this._geometry.config('draggable', this._geometryDraggble);\n\n    delete this._geometryDraggble;\n\n    this._geometry.show();\n\n    this._editStageLayer.remove();\n\n    this._shadowLayer.remove();\n\n    this._clearAllListeners();\n\n    this._refreshHooks = [];\n\n    if (this.options['symbol']) {\n      this._geometry.setSymbol(this._originalSymbol);\n\n      delete this._originalSymbol;\n    }\n\n    this.editing = false;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (isNil(this.editing)) {\n      return false;\n    }\n\n    return this.editing;\n  };\n\n  _proto._getGeometryEvents = function _getGeometryEvents() {\n    return {\n      'symbolchange': this._onGeoSymbolChange,\n      'positionchange shapechange': this._exeAndReset\n    };\n  };\n\n  _proto._switchGeometryEvents = function _switchGeometryEvents(oper) {\n    if (this._geometry) {\n      var events = this._getGeometryEvents();\n\n      for (var p in events) {\n        this._geometry[oper](p, events[p], this);\n      }\n    }\n  };\n\n  _proto._onGeoSymbolChange = function _onGeoSymbolChange(param) {\n    if (this._shadow) {\n      this._shadow.setSymbol(param.target._getInternalSymbol());\n    }\n  };\n\n  _proto._onMarkerDragEnd = function _onMarkerDragEnd() {\n    this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n\n    this._refresh();\n  };\n\n  _proto._createOrRefreshOutline = function _createOrRefreshOutline() {\n    var geometry = this._geometry;\n    var outline = this._editOutline;\n\n    if (!outline) {\n      outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n\n      this._editOutline = outline;\n\n      this._addRefreshHook(this._createOrRefreshOutline);\n    } else {\n      outline.remove();\n      this._editOutline = outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n    }\n\n    return outline;\n  };\n\n  _proto._createCenterHandle = function _createCenterHandle() {\n    var _this3 = this;\n\n    var center = this._shadow.getCenter();\n\n    var symbol = this.options['centerHandleSymbol'];\n    var shadow;\n    var handle = this.createHandle(center, {\n      'symbol': symbol,\n      'cursor': 'move',\n      onDown: function onDown() {\n        shadow = _this3._shadow.copy();\n        var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n        shadow.setSymbol(symbol).addTo(_this3._editStageLayer);\n      },\n      onMove: function onMove(v, param) {\n        var offset = param['coordOffset'];\n        shadow.translate(offset);\n      },\n      onUp: function onUp() {\n        _this3._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n\n        shadow.remove();\n\n        _this3._refresh();\n      }\n    });\n\n    this._addRefreshHook(function () {\n      var center = _this3._shadow.getCenter();\n\n      handle.setCoordinates(center);\n    });\n  };\n\n  _proto._createHandleInstance = function _createHandleInstance(coordinate, opts) {\n    var symbol = opts['symbol'];\n    var handle = new Marker(coordinate, {\n      'draggable': true,\n      'dragShadow': false,\n      'dragOnAxis': opts['axis'],\n      'cursor': opts['cursor'],\n      'symbol': symbol\n    });\n    return handle;\n  };\n\n  _proto.createHandle = function createHandle(coordinate, opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var map = this.getMap();\n\n    var handle = this._createHandleInstance(coordinate, opts);\n\n    var me = this;\n\n    function onHandleDragstart(param) {\n      if (opts.onDown) {\n        this._geometry.fire('handledragstart');\n\n        opts.onDown.call(me, param['viewPoint'], param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragging(param) {\n      me._hideContext();\n\n      var viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n\n      if (opts.onMove) {\n        this._geometry.fire('handledragging');\n\n        opts.onMove.call(me, viewPoint, param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragEnd(ev) {\n      if (opts.onUp) {\n        this._geometry.fire('handledragend');\n\n        opts.onUp.call(me, ev);\n      }\n\n      return false;\n    }\n\n    function onHandleRemove() {\n      handle.config('draggable', false);\n      handle.off('dragstart', onHandleDragstart, me);\n      handle.off('dragging', onHandleDragging, me);\n      handle.off('dragend', onHandleDragEnd, me);\n      handle.off('removestart', onHandleRemove, me);\n      delete handle['maptalks--editor-refresh-fn'];\n    }\n\n    handle.on('dragstart', onHandleDragstart, this);\n    handle.on('dragging', onHandleDragging, this);\n    handle.on('dragend', onHandleDragEnd, this);\n    handle.on('removestart', onHandleRemove, this);\n\n    if (opts.onRefresh) {\n      handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n    }\n\n    this._editStageLayer.addGeometry(handle);\n\n    return handle;\n  };\n\n  _proto._createResizeHandles = function _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n    var _this4 = this;\n\n    var cursors = ['nw-resize', 'n-resize', 'ne-resize', 'w-resize', 'e-resize', 'sw-resize', 's-resize', 'se-resize'];\n    var axis = [null, 'y', null, 'x', 'x', null, 'y', null];\n    var geometry = this._geometry;\n\n    function getResizeAnchors(ext) {\n      return [new Point(ext['xmin'], ext['ymax']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']), new Point(ext['xmax'], ext['ymax']), new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmin'], ext['ymin']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']), new Point(ext['xmax'], ext['ymin'])];\n    }\n\n    if (!blackList) {\n      blackList = [];\n    }\n\n    var me = this;\n    var resizeHandles = [],\n        anchorIndexes = {},\n        map = this.getMap(),\n        handleSymbol = this.options['vertexHandleSymbol'];\n\n    var fnLocateHandles = function fnLocateHandles() {\n      var pExt = geometry._getPainter().get2DExtent(),\n          anchors = getResizeAnchors(pExt);\n\n      var _loop = function _loop(i) {\n        if (Array.isArray(blackList)) {\n          var isBlack = blackList.some(function (ele) {\n            return ele === i;\n          });\n\n          if (isBlack) {\n            return \"continue\";\n          }\n        }\n\n        var anchor = anchors[i],\n            coordinate = map.pointToCoordinate(anchor);\n\n        if (resizeHandles.length < anchors.length - blackList.length) {\n          var handle = _this4.createHandle(coordinate, {\n            'symbol': handleSymbol,\n            'cursor': cursors[i],\n            'axis': axis[i],\n            onMove: function (_index) {\n              return function (handleViewPoint) {\n                me._updating = true;\n                onHandleMove(handleViewPoint, _index);\n                geometry.fire('resizing');\n              };\n            }(i),\n            onUp: function onUp() {\n              me._updating = false;\n              onHandleUp();\n\n              _this4._refresh();\n            }\n          });\n\n          handle.setId(i);\n          anchorIndexes[i] = resizeHandles.length;\n          resizeHandles.push(handle);\n        } else {\n          resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n        }\n      };\n\n      for (var i = 0; i < anchors.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n    };\n\n    fnLocateHandles();\n\n    this._addRefreshHook(fnLocateHandles);\n\n    return resizeHandles;\n  };\n\n  _proto.createMarkerEditor = function createMarkerEditor() {\n    var _this5 = this;\n\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow,\n        map = this.getMap();\n\n    if (!shadow._canEdit()) {\n      if (console) {\n        console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n      }\n\n      return;\n    }\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var symbol = shadow._getInternalSymbol();\n\n    var dxdy = new Point(0, 0);\n\n    if (isNumber(symbol['markerDx'])) {\n      dxdy.x = symbol['markerDx'];\n    }\n\n    if (isNumber(symbol['markerDy'])) {\n      dxdy.y = symbol['markerDy'];\n    }\n\n    var blackList = null;\n\n    if (VectorMarkerSymbolizer.test(symbol)) {\n      if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n        blackList = [5, 6, 7];\n      }\n    } else if (ImageMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol)) {\n      blackList = [5, 6, 7];\n    }\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      var size = shadow.getSize();\n      aspectRatio = size.width / size.height;\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (handleViewPoint, i) {\n      if (blackList && blackList.indexOf(i) >= 0) {\n        var newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n        var coordinates = shadow.getCoordinates();\n        newCoordinates.x = coordinates.x;\n        shadow.setCoordinates(newCoordinates);\n\n        _this5._updateCoordFromShadow(true);\n\n        var mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n        handleViewPoint = mirrorViewPoint;\n      }\n\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n          symbol = shadow._getInternalSymbol();\n\n      var wh = handleViewPoint.sub(viewCenter);\n\n      if (blackList && handleViewPoint.y > viewCenter.y) {\n        wh.y = 0;\n      }\n\n      var r = blackList ? 1 : 2;\n      var width = Math.abs(wh.x) * 2,\n          height = Math.abs(wh.y) * r;\n\n      if (aspectRatio) {\n        width = Math.max(width, height * aspectRatio);\n        height = width / aspectRatio;\n      }\n\n      var ability = resizeAbilities[i];\n\n      if (!(shadow instanceof TextBox)) {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          symbol['markerWidth'] = width;\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          symbol['markerHeight'] = height;\n        }\n\n        shadow.setSymbol(symbol);\n        geometryToEdit.setSymbol(symbol);\n      } else {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          shadow.setWidth(width);\n          geometryToEdit.setWidth(width);\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          shadow.setHeight(height);\n          geometryToEdit.setHeight(height);\n        }\n      }\n    }, function () {\n      _this5._update(getUpdates());\n    });\n\n    function getUpdates() {\n      var updates = [['setCoordinates', shadow.getCoordinates().toArray()]];\n\n      if (shadow instanceof TextBox) {\n        updates.push(['setWidth', shadow.getWidth()]);\n        updates.push(['setHeight', shadow.getHeight()]);\n      } else {\n        updates.push(['setSymbol', shadow.getSymbol()]);\n      }\n\n      return updates;\n    }\n\n    function onZoomEnd() {\n      this._refresh();\n    }\n\n    this._addListener([map, 'zoomend', onZoomEnd]);\n  };\n\n  _proto.createCircleEditor = function createCircleEditor() {\n    var _this6 = this;\n\n    var circle = this._geometry,\n        shadow = this._shadow;\n    var map = this.getMap();\n\n    if (!this._history) {\n      this._recordHistory([['setCoordinates', shadow.getCoordinates().toArray()], ['setRadius', shadow.getRadius()]]);\n    }\n\n    this._createResizeHandles(null, function (handleViewPoint) {\n      var center = circle.getCenter();\n      var mouseCoordinate = map.viewPointToCoordinate(handleViewPoint);\n      var wline = new LineString([[center.x, center.y], [mouseCoordinate.x, center.y]]);\n      var hline = new LineString([[center.x, center.y], [center.x, mouseCoordinate.y]]);\n      var r = Math.max(map.computeGeometryLength(wline), map.computeGeometryLength(hline));\n      shadow.setRadius(r);\n      circle.setRadius(r);\n    }, function () {\n      _this6._update('setRadius', shadow.getRadius());\n    });\n  };\n\n  _proto.createEllipseOrRectEditor = function createEllipseOrRectEditor() {\n    var _this7 = this;\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow;\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var map = this.getMap();\n    var isRect = this._geometry instanceof Rectangle;\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (mouseViewPoint, i) {\n      var r = isRect ? 1 : 2;\n      var pointSub, w, h;\n      var targetPoint = mouseViewPoint;\n      var ability = resizeAbilities[i];\n\n      if (isRect) {\n        var mirror = resizeHandles[7 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n        pointSub = targetPoint.sub(mirrorViewPoint);\n        var absSub = pointSub.abs();\n        w = map.pixelToDistance(absSub.x, 0);\n        h = map.pixelToDistance(0, absSub.y);\n        var size = geometryToEdit.getSize();\n        var firstMirrorCoordinate = resizeHandles[0].getCoordinates();\n        var mouseCoordinate = map.viewPointToCoordinate(mouseViewPoint);\n        var mirrorCoordinate = mirror.getCoordinates();\n        var wline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mouseCoordinate.x, mirrorCoordinate.y]]);\n        var hline = new LineString([[mirrorCoordinate.x, mirrorCoordinate.y], [mirrorCoordinate.x, mouseCoordinate.y]]);\n        w = map.computeGeometryLength(wline);\n        h = map.computeGeometryLength(hline);\n\n        if (ability === 0) {\n          if (aspectRatio) {\n            absSub.y = absSub.x / aspectRatio;\n            size.height = Math.abs(absSub.y);\n            h = w / aspectRatio;\n          }\n\n          targetPoint.y = mirrorViewPoint.y - size.height / 2;\n          mouseCoordinate.y = firstMirrorCoordinate.y;\n\n          if (i === 4) {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, firstMirrorCoordinate.x);\n          } else {\n            mouseCoordinate.x = Math.min(mouseCoordinate.x, mirrorCoordinate.x);\n          }\n        } else if (ability === 1) {\n          if (aspectRatio) {\n            absSub.x = absSub.y * aspectRatio;\n            size.width = Math.abs(absSub.x);\n            w = h * aspectRatio;\n          }\n\n          targetPoint.x = mirrorViewPoint.x - size.width / 2;\n          mouseCoordinate.x = firstMirrorCoordinate.x;\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        } else {\n          if (aspectRatio) {\n            if (w > h * aspectRatio) {\n              h = w / aspectRatio;\n              targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n            } else {\n              w = h * aspectRatio;\n              targetPoint.x = mirrorViewPoint.x + absSub.y * sign(pointSub.x) * aspectRatio;\n            }\n          }\n\n          mouseCoordinate.x = Math.min(mouseCoordinate.x, mirrorCoordinate.x);\n          mouseCoordinate.y = Math.max(mouseCoordinate.y, mirrorCoordinate.y);\n        }\n\n        shadow.setCoordinates(mouseCoordinate);\n\n        _this7._updateCoordFromShadow(true);\n      } else {\n        var center = geometryToEdit.getCenter();\n\n        var _mouseCoordinate = map.viewPointToCoordinate(targetPoint);\n\n        var _wline = new LineString([[center.x, center.y], [_mouseCoordinate.x, center.y]]);\n\n        var _hline = new LineString([[center.x, center.y], [center.x, _mouseCoordinate.y]]);\n\n        w = map.computeGeometryLength(_wline);\n        h = map.computeGeometryLength(_hline);\n\n        if (aspectRatio) {\n          w = Math.max(w, h * aspectRatio);\n          h = w / aspectRatio;\n        }\n      }\n\n      if (aspectRatio || ability === 0 || ability === 2) {\n        shadow.setWidth(w * r);\n        geometryToEdit.setWidth(w * r);\n      }\n\n      if (aspectRatio || ability === 1 || ability === 2) {\n        shadow.setHeight(h * r);\n        geometryToEdit.setHeight(h * r);\n      }\n    }, function () {\n      _this7._update(getUpdates());\n    });\n\n    function getUpdates() {\n      return [['setCoordinates', shadow.getCoordinates().toArray()], ['setWidth', shadow.getWidth()], ['setHeight', shadow.getHeight()]];\n    }\n  };\n\n  _proto.createPolygonEditor = function createPolygonEditor() {\n    var map = this.getMap(),\n        shadow = this._shadow,\n        me = this,\n        projection = map.getProjection();\n\n    if (!this._history) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n    }\n\n    var verticeLimit = shadow instanceof Polygon ? 3 : 2;\n    var propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n        propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n    var vertexHandles = {\n      0: []\n    },\n        newVertexHandles = {\n      0: []\n    };\n\n    function getVertexCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (shadow instanceof Polygon) {\n        var coordinates = shadow.getCoordinates()[ringIndex] || [];\n        return coordinates.slice(0, coordinates.length - 1);\n      } else {\n        return shadow.getCoordinates();\n      }\n    }\n\n    function getVertexPrjCoordinates(ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      if (ringIndex === 0) {\n        return shadow._getPrjCoordinates();\n      }\n\n      return shadow._getPrjHoles()[ringIndex - 1];\n    }\n\n    function onVertexAddOrRemove() {\n      for (var ringIndex in vertexHandles) {\n        for (var i = vertexHandles[ringIndex].length - 1; i >= 0; i--) {\n          vertexHandles[ringIndex][i][propertyOfVertexIndex] = i;\n        }\n\n        for (var _i = newVertexHandles[ringIndex].length - 1; _i >= 0; _i--) {\n          newVertexHandles[ringIndex][_i][propertyOfVertexIndex] = _i;\n        }\n      }\n\n      me._updateCoordFromShadow();\n    }\n\n    function removeVertex(param) {\n      var handle = param['target'],\n          index = handle[propertyOfVertexIndex];\n      var ringIndex = isNumber(handle._ringIndex) ? handle._ringIndex : 0;\n      var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n\n      if (prjCoordinates.length <= verticeLimit) {\n        return;\n      }\n\n      prjCoordinates.splice(index, 1);\n\n      if (ringIndex > 0) {\n        shadow._prjHoles[ringIndex - 1] = prjCoordinates;\n      } else {\n        shadow._setPrjCoordinates(prjCoordinates);\n      }\n\n      shadow._updateCache();\n\n      vertexHandles[ringIndex].splice(index, 1)[0].remove();\n\n      if (index < newVertexHandles[ringIndex].length) {\n        newVertexHandles[ringIndex].splice(index, 1)[0].remove();\n      }\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      newVertexHandles[ringIndex].splice(nextIndex, 1)[0].remove();\n      newVertexHandles[ringIndex].splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex, ringIndex));\n      onVertexAddOrRemove();\n\n      me._refresh();\n    }\n\n    function moveVertexHandle(handleViewPoint, index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertice = getVertexPrjCoordinates(ringIndex);\n\n      var nVertex = map._viewPointToPrj(handleViewPoint);\n\n      var pVertex = vertice[index];\n      pVertex.x = nVertex.x;\n      pVertex.y = nVertex.y;\n\n      shadow._updateCache();\n\n      shadow.onShapeChanged();\n\n      me._updateCoordFromShadow(true);\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles[ringIndex].length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      if (newVertexHandles[ringIndex][index]) {\n        newVertexHandles[ringIndex][index][propertyOfVertexRefreshFn]();\n      }\n\n      if (newVertexHandles[ringIndex][nextIndex]) {\n        newVertexHandles[ringIndex][nextIndex][propertyOfVertexRefreshFn]();\n      }\n    }\n\n    function createVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertex = getVertexCoordinates(ringIndex)[index];\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['vertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex], ringIndex);\n        },\n        onRefresh: function onRefresh() {\n          vertex = getVertexCoordinates(ringIndex)[handle[propertyOfVertexIndex]];\n          handle.setCoordinates(vertex);\n        },\n        onUp: function onUp() {\n          me._refresh();\n\n          me._updateCoordFromShadow();\n        },\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      handle._ringIndex = ringIndex;\n      handle.on(me.options['removeVertexOn'], removeVertex);\n      return handle;\n    }\n\n    function createNewVertexHandle(index, ringIndex) {\n      if (ringIndex === void 0) {\n        ringIndex = 0;\n      }\n\n      var vertexCoordinates = getVertexCoordinates(ringIndex);\n      var nextVertex;\n\n      if (index + 1 >= vertexCoordinates.length) {\n        nextVertex = vertexCoordinates[0];\n      } else {\n        nextVertex = vertexCoordinates[index + 1];\n      }\n\n      var vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['newVertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var prjCoordinates = getVertexPrjCoordinates(ringIndex);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var pVertex = projection.project(handle.getCoordinates());\n          prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n\n          if (ringIndex > 0) {\n            shadow._prjHoles[ringIndex - 1] = prjCoordinates;\n          } else {\n            shadow._setPrjCoordinates(prjCoordinates);\n          }\n\n          shadow._updateCache();\n\n          var symbol = handle.getSymbol();\n          delete symbol['opacity'];\n          handle.setSymbol(symbol);\n          newVertexHandles[ringIndex].splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex, ringIndex), createNewVertexHandle.call(me, vertexIndex + 1, ringIndex));\n        },\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1, ringIndex);\n        },\n        onUp: function onUp(e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var vertexIndex = handle[propertyOfVertexIndex];\n          removeFromArray(handle, newVertexHandles[ringIndex]);\n          handle.remove();\n          vertexHandles[ringIndex].splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1, ringIndex));\n          onVertexAddOrRemove();\n\n          me._updateCoordFromShadow();\n\n          me._refresh();\n        },\n        onRefresh: function onRefresh() {\n          vertexCoordinates = getVertexCoordinates(ringIndex);\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var nextIndex;\n\n          if (vertexIndex === vertexCoordinates.length - 1) {\n            nextIndex = 0;\n          } else {\n            nextIndex = vertexIndex + 1;\n          }\n\n          var refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n          handle.setCoordinates(refreshVertex);\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      return handle;\n    }\n\n    if (shadow instanceof Polygon) {\n      var rings = shadow.getHoles().length + 1;\n\n      for (var ringIndex = 0; ringIndex < rings; ringIndex++) {\n        vertexHandles[ringIndex] = [];\n        newVertexHandles[ringIndex] = [];\n        var vertexCoordinates = getVertexCoordinates(ringIndex);\n\n        for (var i = 0, len = vertexCoordinates.length; i < len; i++) {\n          vertexHandles[ringIndex].push(createVertexHandle.call(this, i, ringIndex));\n\n          if (i < len - 1) {\n            newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, i, ringIndex));\n          }\n        }\n\n        newVertexHandles[ringIndex].push(createNewVertexHandle.call(this, vertexCoordinates.length - 1, ringIndex));\n      }\n    } else {\n      var _ringIndex = 0;\n\n      var _vertexCoordinates = getVertexCoordinates(_ringIndex);\n\n      for (var _i2 = 0, _len = _vertexCoordinates.length; _i2 < _len; _i2++) {\n        vertexHandles[_ringIndex].push(createVertexHandle.call(this, _i2, _ringIndex));\n\n        if (_i2 < _len - 1) {\n          newVertexHandles[_ringIndex].push(createNewVertexHandle.call(this, _i2, _ringIndex));\n        }\n      }\n    }\n\n    this._addRefreshHook(function () {\n      for (var _ringIndex2 in newVertexHandles) {\n        for (var _i3 = newVertexHandles[_ringIndex2].length - 1; _i3 >= 0; _i3--) {\n          newVertexHandles[_ringIndex2][_i3][propertyOfVertexRefreshFn](_ringIndex2);\n        }\n      }\n\n      for (var _ringIndex3 in vertexHandles) {\n        for (var _i4 = vertexHandles[_ringIndex3].length - 1; _i4 >= 0; _i4--) {\n          vertexHandles[_ringIndex3][_i4][propertyOfVertexRefreshFn](_ringIndex3);\n        }\n      }\n    });\n  };\n\n  _proto._refresh = function _refresh() {\n    if (this._refreshHooks) {\n      for (var i = this._refreshHooks.length - 1; i >= 0; i--) {\n        this._refreshHooks[i].call(this);\n      }\n    }\n  };\n\n  _proto._hideContext = function _hideContext() {\n    if (this._geometry) {\n      this._geometry.closeMenu();\n\n      this._geometry.closeInfoWindow();\n    }\n  };\n\n  _proto._addListener = function _addListener(listener) {\n    if (!this._eventListeners) {\n      this._eventListeners = [];\n    }\n\n    this._eventListeners.push(listener);\n\n    listener[0].on(listener[1], listener[2], this);\n  };\n\n  _proto._clearAllListeners = function _clearAllListeners() {\n    if (this._eventListeners && this._eventListeners.length > 0) {\n      for (var i = this._eventListeners.length - 1; i >= 0; i--) {\n        var listener = this._eventListeners[i];\n        listener[0].off(listener[1], listener[2], this);\n      }\n\n      this._eventListeners = [];\n    }\n  };\n\n  _proto._addRefreshHook = function _addRefreshHook(fn) {\n    if (!fn) {\n      return;\n    }\n\n    if (!this._refreshHooks) {\n      this._refreshHooks = [];\n    }\n\n    this._refreshHooks.push(fn);\n  };\n\n  _proto._update = function _update(method) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key = 1; _key < _len2; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this._exeHistory([method, args]);\n\n    this._recordHistory.apply(this, [method].concat(args));\n  };\n\n  _proto._updateCoordFromShadow = function _updateCoordFromShadow(ignoreRecord) {\n    if (!this._shadow) {\n      return;\n    }\n\n    var coords = this._shadow.getCoordinates();\n\n    var geo = this._geometry;\n    var updating = this._updating;\n    this._updating = true;\n    geo.setCoordinates(coords);\n\n    if (!ignoreRecord) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n    }\n\n    this._updating = updating;\n  };\n\n  _proto._recordHistory = function _recordHistory(method) {\n    if (!this._history) {\n      this._history = [];\n      this._historyPointer = 0;\n    }\n\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key2 = 1; _key2 < _len3; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (this._history.length) {\n      var lastOperation = this._history[this._history.length - 1];\n\n      if (lastOperation[0] === method && JSON.stringify(lastOperation[1]) === JSON.stringify(args)) {\n        return;\n      }\n    }\n\n    if (this._historyPointer < this._history.length - 1) {\n      this._history.splice(this._historyPointer + 1);\n    }\n\n    this._history.push([method, args]);\n\n    this._historyPointer = this._history.length - 1;\n\n    this._geometry.fire('editrecord');\n  };\n\n  _proto.cancel = function cancel() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    this._historyPointer = 0;\n    var record = this._history[0];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    var record = this._history[--this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    if (!this._history || this._historyPointer === this._history.length - 1) {\n      return this;\n    }\n\n    var record = this._history[++this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto._exeAndReset = function _exeAndReset(record) {\n    if (this._updating) {\n      return;\n    }\n\n    this._exeHistory(record);\n\n    var history = this._history,\n        pointer = this._historyPointer;\n    this.stop();\n    this._history = history;\n    this._historyPointer = pointer;\n    this.start();\n  };\n\n  _proto._exeHistory = function _exeHistory(record) {\n    var _this8 = this;\n\n    if (!Array.isArray(record)) {\n      return;\n    }\n\n    var updating = this._updating;\n    this._updating = true;\n    var geo = this._geometry;\n\n    if (Array.isArray(record[0])) {\n      record[0].forEach(function (o) {\n        var m = o[0],\n            args = o.slice(1);\n\n        _this8._shadow[m].apply(_this8._shadow, args);\n\n        geo[m].apply(geo, args);\n      });\n    } else {\n      this._shadow[record[0]].apply(this._shadow, record[1]);\n\n      geo[record[0]].apply(geo, record[1]);\n    }\n\n    this._updating = updating;\n  };\n\n  return GeometryEditor;\n}(Eventable(Class));\n\nGeometryEditor.mergeOptions(options$z);\n\nvar TextEditable = {\n  startEditText: function startEditText() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    this.hide();\n    this.endEditText();\n\n    this._prepareEditor();\n\n    this._fireEvent('edittextstart');\n\n    return this;\n  },\n  endEditText: function endEditText() {\n    if (this._textEditor) {\n      var html = this._textEditor.innerHTML;\n      html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n      this._textEditor.innerHTML = html;\n\n      var content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n\n      this.setContent(content);\n      off(this._textEditor, 'mousedown dblclick', stopPropagation);\n      this.getMap().off('mousedown', this.endEditText, this);\n\n      this._editUIMarker.remove();\n\n      delete this._editUIMarker;\n      this._textEditor.onkeyup = null;\n      delete this._textEditor;\n      this.show();\n\n      this._fireEvent('edittextend');\n    }\n\n    return this;\n  },\n  isEditingText: function isEditingText() {\n    if (this._textEditor) {\n      return true;\n    }\n\n    return false;\n  },\n  getTextEditor: function getTextEditor() {\n    return this._editUIMarker;\n  },\n  _prepareEditor: function _prepareEditor() {\n    var map = this.getMap();\n\n    var editContainer = this._createEditor();\n\n    this._textEditor = editContainer;\n    map.on('mousedown', this.endEditText, this);\n\n    var offset = this._getEditorOffset();\n\n    this._editUIMarker = new UIMarker(this.getCoordinates(), {\n      'animation': null,\n      'content': editContainer,\n      'dx': offset.dx,\n      'dy': offset.dy\n    }).addTo(map);\n\n    this._setCursorToLast(this._textEditor);\n  },\n  _getEditorOffset: function _getEditorOffset() {\n    var symbol = this._getInternalSymbol() || {};\n    var dx = 0,\n        dy = 0;\n    var textAlign = symbol['textHorizontalAlignment'];\n\n    if (textAlign === 'middle' || isNil(textAlign)) {\n      dx = (symbol['textDx'] || 0) - 2;\n      dy = (symbol['textDy'] || 0) - 2;\n    } else {\n      dx = (symbol['markerDx'] || 0) - 2;\n      dy = (symbol['markerDy'] || 0) - 2;\n    }\n\n    return {\n      'dx': dx,\n      'dy': dy\n    };\n  },\n  _createEditor: function _createEditor() {\n    var content = this.getContent();\n    var labelSize = this.getSize(),\n        symbol = this._getInternalSymbol() || {},\n        width = labelSize.width,\n        textColor = symbol['textFill'] || '#000000',\n        textSize = symbol['textSize'] || 12,\n        height = labelSize.height,\n        lineColor = symbol['markerLineColor'] || '#000',\n        fill = symbol['markerFill'] || '#3398CC',\n        spacing = symbol['textLineSpacing'] || 0;\n    var editor = createEl('div');\n    editor.contentEditable = true;\n    editor.style.cssText = \"background:\" + fill + \"; border:1px solid \" + lineColor + \";\\n            color:\" + textColor + \";font-size:\" + textSize + \"px;width:\" + (width - 2) + \"px;height:\" + (height - 2) + \"px;margin: auto;\\n            line-height:\" + (textSize + spacing) + \"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;\";\n    editor.innerText = content;\n    on(editor, 'mousedown dblclick', stopPropagation);\n\n    editor.onkeyup = function (event) {\n      var h = editor.style.height || 0;\n\n      if (event.keyCode === 13) {\n        editor.style.height = parseInt(h) + textSize / 2 + 'px';\n      }\n    };\n\n    return editor;\n  },\n  _setCursorToLast: function _setCursorToLast(obj) {\n    var range;\n\n    if (window.getSelection) {\n      obj.focus();\n      range = window.getSelection();\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    } else if (document.selection) {\n      range = document.selection.createRange();\n      range.moveToElementText(obj);\n      range.collapse(false);\n      range.select();\n    }\n  }\n};\nTextMarker.include(TextEditable);\n\nGeometry.include({\n  animate: function animate(styles, options, step) {\n    var _this = this;\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      step = options;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    var map = this.getMap(),\n        projection = this._getProjection(),\n        symbol = this.getSymbol() || {},\n        stylesToAnimate = this._prepareAnimationStyles(styles);\n\n    var preTranslate;\n    var isFocusing = options['focus'];\n    delete this._animationStarted;\n\n    if (map) {\n      var renderer = map._getRenderer();\n\n      var framer = function framer(fn) {\n        renderer.callInNextFrame(fn);\n      };\n\n      options['framer'] = framer;\n    }\n\n    var player = Animation.animate(stylesToAnimate, options, function (frame) {\n      if (map && map.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (map && !_this._animationStarted && isFocusing) {\n        map.onMoveStart();\n      }\n\n      var styles = frame.styles;\n\n      for (var p in styles) {\n        if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n          var fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n\n          _this[fnName](styles[p]);\n        }\n      }\n\n      var translate = styles['translate'];\n\n      if (translate) {\n        var toTranslate = translate;\n\n        if (preTranslate) {\n          toTranslate = translate.sub(preTranslate);\n        }\n\n        preTranslate = translate;\n\n        _this.translate(toTranslate);\n      }\n\n      var dSymbol = styles['symbol'];\n\n      if (dSymbol) {\n        _this.setSymbol(extendSymbol(symbol, dSymbol));\n      }\n\n      if (map && isFocusing) {\n        var pcenter = projection.project(_this.getCenter());\n\n        map._setPrjCenter(pcenter);\n\n        var e = map._parseEventFromCoord(projection.unproject(pcenter));\n\n        if (player.playState !== 'running') {\n          map.onMoveEnd(e);\n        } else {\n          map.onMoving(e);\n        }\n      }\n\n      _this._fireAnimateEvent(player.playState);\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n    this._animPlayer = player;\n    return this._animPlayer.play();\n  },\n  _prepareAnimationStyles: function _prepareAnimationStyles(styles) {\n    var symbol = this._getInternalSymbol();\n\n    var stylesToAnimate = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var v = styles[p];\n\n        if (p !== 'translate' && p !== 'symbol') {\n          var fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n          var current = this[fnName]();\n          stylesToAnimate[p] = [current, v];\n        } else if (p === 'symbol') {\n          var symbolToAnimate = void 0;\n\n          if (Array.isArray(styles['symbol'])) {\n            if (!Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n            }\n\n            symbolToAnimate = [];\n            var symbolInStyles = styles['symbol'];\n\n            for (var i = 0; i < symbolInStyles.length; i++) {\n              if (!symbolInStyles[i]) {\n                symbolToAnimate.push(null);\n                continue;\n              }\n\n              var a = {};\n\n              for (var sp in symbolInStyles[i]) {\n                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                  a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                }\n              }\n\n              symbolToAnimate.push(a);\n            }\n          } else {\n            if (Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n            }\n\n            symbolToAnimate = {};\n\n            for (var _sp in v) {\n              if (v.hasOwnProperty(_sp)) {\n                symbolToAnimate[_sp] = [symbol[_sp], v[_sp]];\n              }\n            }\n          }\n\n          stylesToAnimate['symbol'] = symbolToAnimate;\n        } else if (p === 'translate') {\n          stylesToAnimate['translate'] = new Coordinate(v);\n        }\n      }\n    }\n\n    return stylesToAnimate;\n  },\n  _fireAnimateEvent: function _fireAnimateEvent(playState) {\n    if (playState === 'finished') {\n      delete this._animationStarted;\n\n      this._fireEvent('animateend');\n    } else if (playState === 'running') {\n      if (this._animationStarted) {\n        this._fireEvent('animating');\n      } else {\n        this._fireEvent('animatestart');\n\n        this._animationStarted = true;\n      }\n    }\n  }\n});\n\nvar DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\nvar EVENTS$2 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar GeometryDragHandler = function (_Handler) {\n  _inheritsLoose(GeometryDragHandler, _Handler);\n\n  function GeometryDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto = GeometryDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on(EVENTS$2, this._startDrag, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._endDrag();\n\n    this.target.off(EVENTS$2, this._startDrag, this);\n    delete this.container;\n  };\n\n  _proto._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.container);\n\n    this._dragHandler.on('dragging', this._dragging, this).on('mouseup', this._endDrag, this).enable();\n  };\n\n  _proto._prepareShadow = function _prepareShadow() {\n    var _this = this;\n\n    var target = this.target;\n\n    this._prepareDragStageLayer();\n\n    if (this._shadow) {\n      this._shadow.remove();\n    }\n\n    var shadow = this._shadow = target.copy();\n\n    if (shadow.getGeometries) {\n      var shadows = shadow.getGeometries();\n      var geos = target.getGeometries();\n      shadows.forEach(function (g, i) {\n        _this._updateShadowSymbol(g, geos[i]);\n      });\n    } else {\n      this._updateShadowSymbol(shadow, target);\n    }\n\n    shadow.setId(null);\n\n    this._prepareShadowConnectors();\n  };\n\n  _proto._updateShadowSymbol = function _updateShadowSymbol(shadow, target) {\n    shadow.setSymbol(target._getInternalSymbol());\n\n    if (target.options['dragShadow']) {\n      var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n      shadow.setSymbol(symbol);\n    }\n  };\n\n  _proto._prepareShadowConnectors = function _prepareShadowConnectors() {\n    var target = this.target;\n    var shadow = this._shadow;\n\n    var resources = this._dragStageLayer._getRenderer().resources;\n\n    var shadowConnectors = [];\n\n    if (ConnectorLine._hasConnectors(target)) {\n      var connectors = ConnectorLine._getConnectors(target);\n\n      for (var i = 0, l = connectors.length; i < l; i++) {\n        var targetConn = connectors[i];\n\n        var connOptions = targetConn.config(),\n            connSymbol = targetConn._getInternalSymbol();\n\n        connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n        var conn = void 0;\n\n        if (targetConn.getConnectSource() === target) {\n          conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n        } else {\n          conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n        }\n\n        shadowConnectors.push(conn);\n\n        if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n          resources.merge(targetConn.getLayer()._getRenderer().resources);\n        }\n      }\n    }\n\n    this._shadowConnectors = shadowConnectors;\n    shadowConnectors.push(shadow);\n\n    this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n  };\n\n  _proto._onTargetUpdated = function _onTargetUpdated() {\n    if (this._shadow) {\n      this._shadow.setSymbol(this.target._getSymbol());\n    }\n  };\n\n  _proto._prepareDragStageLayer = function _prepareDragStageLayer() {\n    var map = this.target.getMap(),\n        layer = this.target.getLayer();\n    this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n\n    if (!this._dragStageLayer) {\n      this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n        enableAltitude: layer.options['enableAltitude'],\n        altitudeProperty: layer.options['altitudeProperty']\n      });\n      map.addLayer(this._dragStageLayer);\n    }\n\n    var resources = new ResourceCache();\n    resources.merge(layer._getRenderer().resources);\n    this._dragStageLayer._getRenderer().resources = resources;\n  };\n\n  _proto._startDrag = function _startDrag(param) {\n    var map = this.target.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var parent = this.target._getParent();\n\n    if (parent) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    this.container = map._panels.mapWrapper || map._containerDOM;\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = this._correctCoord(param['coordinate']);\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    on(this.container, 'mouseleave', this._endDrag, this);\n    this._startParam = param;\n    this._moved = false;\n    return;\n  };\n\n  _proto._dragging = function _dragging(param) {\n    var target = this.target;\n\n    var map = target.getMap(),\n        e = map._parseEvent(param['domEvent']);\n\n    var domEvent = e['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._moved) {\n      this._moved = true;\n      target.on('symbolchange', this._onTargetUpdated, this);\n      this._isDragging = true;\n\n      this._prepareShadow();\n\n      if (!target.options['dragShadow']) {\n        target.hide();\n      }\n\n      this._shadow._fireEvent('dragstart', e);\n\n      this.target._fireEvent('dragstart', this._startParam || e);\n\n      delete this._startParam;\n      return;\n    }\n\n    if (!this._shadow) {\n      return;\n    }\n\n    var axis = this._shadow.options['dragOnAxis'],\n        coord = this._correctCoord(e['coordinate']),\n        point = e['containerPoint'];\n\n    this._lastPoint = this._lastPoint || point;\n    this._lastCoord = this._lastCoord || coord;\n    var pointOffset = point.sub(this._lastPoint);\n    var coordOffset = coord.sub(this._lastCoord);\n\n    if (axis === 'x') {\n      pointOffset.y = coordOffset.y = 0;\n    } else if (axis === 'y') {\n      pointOffset.x = coordOffset.x = 0;\n    }\n\n    this._lastPoint = point;\n    this._lastCoord = coord;\n\n    this._shadow.translate(coordOffset);\n\n    if (!target.options['dragShadow']) {\n      target.translate(coordOffset);\n    }\n\n    e['coordOffset'] = coordOffset;\n    e['pointOffset'] = pointOffset;\n\n    this._shadow._fireEvent('dragging', e);\n\n    target._fireEvent('dragging', e);\n  };\n\n  _proto._endDrag = function _endDrag(param) {\n    if (this._dragHandler) {\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    if (this.container) {\n      off(this.container, 'mouseleave', this._endDrag, this);\n    }\n\n    if (!this.target) {\n      return;\n    }\n\n    var target = this.target;\n    target.off('click', this._endDrag, this);\n    target.off('symbolchange', this._onTargetUpdated, this);\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n    var map = target.getMap();\n\n    if (this.enabled() && map) {\n      var e = map._parseEvent(param ? param['domEvent'] : null);\n\n      this._updateTargetAndRemoveShadow(e);\n\n      if (this._moved) {\n        target._fireEvent('dragend', e);\n      }\n    }\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._updateTargetAndRemoveShadow = function _updateTargetAndRemoveShadow(eventParam) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (!target.options['dragShadow']) {\n      target.show();\n    }\n\n    var shadow = this._shadow;\n\n    if (shadow) {\n      if (target.options['dragShadow']) {\n        if (target.getGeometries) {\n          var shadows = shadow.getGeometries();\n          var geos = target.getGeometries();\n          shadows.forEach(function (g, i) {\n            geos[i].setCoordinates(shadows[i].getCoordinates());\n          });\n        } else {\n          target.setCoordinates(shadow.getCoordinates());\n        }\n      }\n\n      shadow._fireEvent('dragend', eventParam);\n\n      shadow.remove();\n      delete this._shadow;\n    }\n\n    if (this._shadowConnectors) {\n      map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n      delete this._shadowConnectors;\n    }\n\n    if (this._dragStageLayer) {\n      this._dragStageLayer.remove();\n    }\n  };\n\n  _proto._correctCoord = function _correctCoord(coord) {\n    var map = this.target.getMap();\n\n    if (!map.getPitch()) {\n      return coord;\n    }\n\n    var painter = this.target._getPainter();\n\n    if (!painter.getMinAltitude()) {\n      return coord;\n    }\n\n    var alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n    return map.locateByPoint(coord, 0, -alt);\n  };\n\n  return GeometryDragHandler;\n}(Handler$1);\n\nGeometry.mergeOptions({\n  'draggable': false,\n  'dragShadow': true,\n  'dragOnAxis': null\n});\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\nGeometry.include({\n  isDragging: function isDragging() {\n    if (this._getParent()) {\n      return this._getParent().isDragging();\n    }\n\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  startEdit: function startEdit(opts) {\n    if (!this.getMap() || !this.options['editable']) {\n      return this;\n    }\n\n    this.endEdit();\n    this._editor = new GeometryEditor(this, opts);\n\n    this._editor.start();\n\n    this.fire('editstart');\n    return this;\n  },\n  endEdit: function endEdit() {\n    if (this._editor) {\n      this._editor.stop();\n\n      delete this._editor;\n      this.fire('editend');\n    }\n\n    return this;\n  },\n  redoEdit: function redoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.redo();\n\n    this.fire('redoedit');\n    return this;\n  },\n  undoEdit: function undoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.undo();\n\n    this.fire('undoedit');\n    return this;\n  },\n  cancelEdit: function cancelEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.cancel();\n\n    this.fire('canceledit');\n    return this;\n  },\n  isEditing: function isEditing() {\n    if (this._editor) {\n      return this._editor.isEditing();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  _onEvent: function _onEvent(event, type) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var eventType = type || this._getEventTypeToFire(event);\n\n    if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n      stopPropagation(event);\n      preventDefault(event);\n    }\n\n    var params = this._getEventParams(event);\n\n    this._fireEvent(eventType, params);\n  },\n  _getEventTypeToFire: function _getEventTypeToFire(domEvent) {\n    return domEvent.type;\n  },\n  _getEventParams: function _getEventParams(e) {\n    var map = this.getMap();\n    var eventParam = {\n      'domEvent': e\n    };\n    var actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n\n    if (actual) {\n      var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n      eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n      eventParam['containerPoint'] = containerPoint;\n      eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n      eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n    }\n\n    return eventParam;\n  }\n});\n\nGeometry.include({\n  setInfoWindow: function setInfoWindow(options) {\n    this.removeInfoWindow();\n\n    if (options instanceof InfoWindow) {\n      this._infoWindow = options;\n      this._infoWinOptions = extend({}, this._infoWindow.options);\n\n      this._infoWindow.addTo(this);\n\n      return this;\n    }\n\n    this._infoWinOptions = extend({}, options);\n\n    if (this._infoWindow) {\n      this._infoWindow.setOptions(options);\n    } else if (this.getMap()) {\n      this._bindInfoWindow(this._infoWinOptions);\n    }\n\n    return this;\n  },\n  getInfoWindow: function getInfoWindow() {\n    if (!this._infoWindow) {\n      return null;\n    }\n\n    return this._infoWindow;\n  },\n  openInfoWindow: function openInfoWindow(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._infoWindow) {\n      if (this._infoWinOptions && this.getMap()) {\n        this._bindInfoWindow(this._infoWinOptions);\n\n        this._infoWindow.show(coordinate);\n      }\n    } else {\n      this._infoWindow.show(coordinate);\n    }\n\n    return this;\n  },\n  closeInfoWindow: function closeInfoWindow() {\n    if (this._infoWindow) {\n      this._infoWindow.hide();\n    }\n\n    return this;\n  },\n  removeInfoWindow: function removeInfoWindow() {\n    this._unbindInfoWindow();\n\n    delete this._infoWinOptions;\n    delete this._infoWindow;\n    return this;\n  },\n  _bindInfoWindow: function _bindInfoWindow(options) {\n    this._infoWindow = new InfoWindow(options);\n\n    this._infoWindow.addTo(this);\n\n    return this;\n  },\n  _unbindInfoWindow: function _unbindInfoWindow() {\n    if (this._infoWindow) {\n      this.closeInfoWindow();\n\n      this._infoWindow.remove();\n\n      delete this._infoWindow;\n    }\n\n    return this;\n  }\n});\n\nvar LRUCache = function () {\n  function LRUCache(max, onRemove) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  var _proto = LRUCache.prototype;\n\n  _proto.reset = function reset() {\n    for (var key in this.data) {\n      this.onRemove(this.data[key]);\n    }\n\n    this.data = {};\n    this.order = [];\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this.reset();\n    delete this.onRemove;\n  };\n\n  _proto.add = function add(key, data) {\n    if (this.has(key)) {\n      this.order.splice(this.order.indexOf(key), 1);\n      this.data[key] = data;\n      this.order.push(key);\n    } else {\n      this.data[key] = data;\n      this.order.push(key);\n\n      if (this.order.length > this.max) {\n        var removedData = this.getAndRemove(this.order[0]);\n        if (removedData) this.onRemove(removedData);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.has = function has(key) {\n    return key in this.data;\n  };\n\n  _proto.keys = function keys() {\n    return this.order;\n  };\n\n  _proto.getAndRemove = function getAndRemove(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.order.splice(this.order.indexOf(key), 1);\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    return data;\n  };\n\n  _proto.remove = function remove(key) {\n    if (!this.has(key)) {\n      return this;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.onRemove(data);\n    this.order.splice(this.order.indexOf(key), 1);\n    return this;\n  };\n\n  _proto.setMaxSize = function setMaxSize(max) {\n    this.max = max;\n\n    while (this.order.length > this.max) {\n      var removedData = this.getAndRemove(this.order[0]);\n      if (removedData) this.onRemove(removedData);\n    }\n\n    return this;\n  };\n\n  return LRUCache;\n}();\n\nvar TEMP_POINT$3 = new Point(0, 0);\nvar TEMP_POINT1$2 = new Point(0, 0);\nvar TEMP_POINT2$1 = new Point(0, 0);\n\nvar TileLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(TileLayerCanvasRenderer, _CanvasRenderer);\n\n  function TileLayerCanvasRenderer(layer) {\n    var _this;\n\n    _this = _CanvasRenderer.call(this, layer) || this;\n    _this.tilesInView = {};\n    _this.tilesLoading = {};\n    _this._parentTiles = [];\n    _this._childTiles = [];\n    _this.tileCache = new LRUCache(layer.options['maxCacheSize'], _this.deleteTile.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    return _this;\n  }\n\n  var _proto = TileLayerCanvasRenderer.prototype;\n\n  _proto.getCurrentTileZoom = function getCurrentTileZoom() {\n    return this._tileZoom;\n  };\n\n  _proto.draw = function draw() {\n    var map = this.getMap();\n\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    var mask2DExtent = this.prepareCanvas();\n\n    if (mask2DExtent) {\n      if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n        this.completeRender();\n        return;\n      }\n    }\n\n    var layer = this.layer;\n    var tileGrids = layer.getTiles().tileGrids;\n\n    if (!tileGrids || !tileGrids.length) {\n      this.completeRender();\n      return;\n    }\n\n    var loadingCount = 0;\n    var loading = false;\n    var checkedTiles = {};\n    var tiles = [],\n        parentTiles = [],\n        parentKeys = {},\n        childTiles = [],\n        childKeys = {},\n        placeholders = [],\n        placeholderKeys = {};\n    var tileQueue = {};\n\n    var preLoadingCount = this._markTiles(),\n        loadingLimit = this._getLoadLimit();\n\n    var l = tileGrids.length;\n    this._tileZoom = tileGrids[0]['zoom'];\n    this._tileOffset = tileGrids[0]['offset'];\n\n    for (var i = 0; i < l; i++) {\n      var tileGrid = tileGrids[i];\n      var allTiles = tileGrid['tiles'];\n\n      var placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n      for (var _i = 0, _l = allTiles.length; _i < _l; _i++) {\n        var tile = allTiles[_i],\n            tileId = tile['id'];\n        var tileLoading = false;\n\n        if (this._isLoadingTile(tileId)) {\n          tileLoading = loading = true;\n          this.tilesLoading[tileId].current = true;\n        } else {\n          var cached = this._getCachedTile(tileId);\n\n          if (cached) {\n            if (cached.image && this.getTileOpacity(cached.image) < 1) {\n              tileLoading = loading = true;\n            }\n\n            tiles.push(cached);\n          } else {\n            tileLoading = loading = true;\n            var hitLimit = loadingLimit && loadingCount + preLoadingCount[0] > loadingLimit;\n\n            if (!hitLimit && (!map.isInteracting() || map.isMoving() || map.isRotating())) {\n              loadingCount++;\n              tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n            }\n          }\n        }\n\n        if (!tileLoading) continue;\n\n        if (checkedTiles[tileId]) {\n          continue;\n        }\n\n        checkedTiles[tileId] = 1;\n\n        if (placeholder && !placeholderKeys[tileId]) {\n          tile.cache = false;\n          placeholders.push({\n            image: placeholder,\n            info: tile\n          });\n          placeholderKeys[tileId] = 1;\n        }\n\n        var parentTile = this._findParentTile(tile);\n\n        if (parentTile) {\n          var parentId = parentTile.info.id;\n\n          if (parentKeys[parentId] === undefined) {\n            parentKeys[parentId] = parentTiles.length;\n            parentTiles.push(parentTile);\n          }\n        } else if (!parentTiles.length) {\n          var children = this._findChildTiles(tile);\n\n          if (children.length) {\n            children.forEach(function (c) {\n              if (!childKeys[c.info.id]) {\n                childTiles.push(c);\n                childKeys[c.info.id] = 1;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (parentTiles.length) {\n      childTiles.length = 0;\n      this._childTiles.length = 0;\n    }\n\n    this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n\n    if (!loadingCount) {\n      if (!loading) {\n        if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n          this._parentTiles = [];\n          this._childTiles = [];\n          this.setToRedraw();\n        }\n\n        this.completeRender();\n      }\n    } else {\n      this.loadTileQueue(tileQueue);\n    }\n\n    this._retireTiles();\n  };\n\n  _proto.isTileCachedOrLoading = function isTileCachedOrLoading(tileId) {\n    return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n  };\n\n  _proto._drawTiles = function _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n    var _this2 = this;\n\n    if (parentTiles.length) {\n      parentTiles.sort(function (t1, t2) {\n        return Math.abs(t2.info.z - _this2._tileZoom) - Math.abs(t1.info.z - _this2._tileZoom);\n      });\n      this._parentTiles = parentTiles;\n    }\n\n    if (childTiles.length) {\n      this._childTiles = childTiles;\n    }\n\n    var context = {\n      tiles: tiles,\n      parentTiles: this._parentTiles,\n      childTiles: this._childTiles\n    };\n    this.onDrawTileStart(context);\n\n    this._parentTiles.forEach(function (t) {\n      return _this2._drawTileAndCache(t);\n    });\n\n    this._childTiles.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n\n    placeholders.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n    var layer = this.layer,\n        map = this.getMap();\n\n    if (!layer.options['cascadeTiles'] || map.getPitch() <= map.options['cascadePitches'][0]) {\n      tiles.forEach(function (t) {\n        return _this2._drawTileAndCache(t);\n      });\n    } else {\n      this.writeZoomStencil();\n      var started = false;\n\n      for (var i = 0, l = tiles.length; i < l; i++) {\n        if (tiles[i].info.z !== this._tileZoom) {\n          if (!started) {\n            this.startZoomStencilTest();\n            started = true;\n          } else {\n            this.resumeZoomStencilTest();\n          }\n        } else if (started) {\n          this.pauseZoomStencilTest();\n        }\n\n        this._drawTileAndCache(tiles[i]);\n      }\n\n      this.endZoomStencilTest();\n    }\n\n    this.onDrawTileEnd(context);\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {};\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {};\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {};\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {};\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {};\n\n  _proto.onDrawTileStart = function onDrawTileStart() {};\n\n  _proto.onDrawTileEnd = function onDrawTileEnd() {};\n\n  _proto._drawTileOffset = function _drawTileOffset(info, image) {\n    if (!image) {\n      return;\n    }\n\n    var offset = this._tileOffset;\n\n    if (!offset[0] && !offset[1]) {\n      this.drawTile(info, image);\n      return;\n    }\n\n    var map = this.getMap();\n\n    var scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n\n    info.point._sub(offset);\n\n    info.extent2d._sub(offset);\n\n    this.drawTile(info, image);\n\n    info.point._add(offset);\n\n    info.extent2d._add(offset);\n\n    offset[0] /= scale;\n    offset[1] /= scale;\n  };\n\n  _proto._drawTileAndCache = function _drawTileAndCache(tile) {\n    tile.current = true;\n    this.tilesInView[tile.info.id] = tile;\n\n    this._drawTileOffset(tile.info, tile.image);\n\n    this.tileCache.add(tile.info.id, tile);\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CanvasRenderer.prototype.needToRedraw.call(this);\n    }\n\n    if (map.isRotating() || map.isZooming()) {\n      return true;\n    }\n\n    if (map.isMoving()) {\n      return !!this.layer.options['forceRenderOnMoving'];\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.hitDetect = function hitDetect() {\n    return false;\n  };\n\n  _proto._getLoadLimit = function _getLoadLimit() {\n    if (this.getMap().isInteracting()) {\n      return this.layer.options['loadingLimitOnInteracting'];\n    }\n\n    return 0;\n  };\n\n  _proto.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      this.clear();\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.clear = function clear() {\n    this._retireTiles(true);\n\n    this.tileCache.reset();\n    this.tilesInView = {};\n    this.tilesLoading = {};\n    this._parentTiles = [];\n    this._childTiles = [];\n\n    _CanvasRenderer.prototype.clear.call(this);\n  };\n\n  _proto._isLoadingTile = function _isLoadingTile(tileId) {\n    return !!this.tilesLoading[tileId];\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    return _CanvasRenderer.prototype.clipCanvas.call(this, context);\n  };\n\n  _proto._clipByPitch = function _clipByPitch(ctx) {\n    var map = this.getMap();\n\n    if (map.getPitch() <= map.options['maxVisualPitch']) {\n      return false;\n    }\n\n    if (!this.layer.options['clipByPitch']) {\n      return false;\n    }\n\n    var clipExtent = map.getContainerExtent();\n    var r = map.getDevicePixelRatio();\n    ctx.save();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n    ctx.beginPath();\n    ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n    ctx.stroke();\n    ctx.clip();\n    return true;\n  };\n\n  _proto.loadTileQueue = function loadTileQueue(tileQueue) {\n    for (var p in tileQueue) {\n      if (tileQueue.hasOwnProperty(p)) {\n        var tile = tileQueue[p];\n        var tileImage = this.loadTile(tile);\n\n        if (tileImage.loadTime === undefined) {\n          this.tilesLoading[tile['id']] = {\n            image: tileImage,\n            current: true,\n            info: tile\n          };\n        }\n      }\n    }\n  };\n\n  _proto.loadTile = function loadTile(tile) {\n    var tileSize = this.layer.getTileSize();\n    var tileImage = new Image();\n    tileImage.width = tileSize['width'];\n    tileImage.height = tileSize['height'];\n    tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n    tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n    this.loadTileImage(tileImage, tile['url']);\n    return tileImage;\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n\n    if (!isNil(crossOrigin)) {\n      tileImage.crossOrigin = crossOrigin;\n    }\n\n    return loadImage(tileImage, [url]);\n  };\n\n  _proto.abortTileLoading = function abortTileLoading(tileImage) {\n    if (!tileImage) return;\n    tileImage.onload = falseFn;\n    tileImage.onerror = falseFn;\n    tileImage.src = emptyImageUrl;\n  };\n\n  _proto.onTileLoad = function onTileLoad(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    var id = tileInfo['id'];\n\n    if (!this.tilesInView) {\n      return;\n    }\n\n    var e = {\n      tile: tileInfo,\n      tileImage: tileImage\n    };\n    this.layer.fire('tileload', e);\n    tileImage = e.tileImage;\n    tileImage.loadTime = now();\n    delete this.tilesLoading[id];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n  };\n\n  _proto.onTileError = function onTileError(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    tileImage.onerrorTick = tileImage.onerrorTick || 0;\n    var tileRetryCount = this.layer.options['tileRetryCount'];\n\n    if (tileRetryCount > tileImage.onerrorTick) {\n      tileImage.onerrorTick++;\n      tileImage.src = tileInfo.url;\n      return;\n    }\n\n    if (tileImage instanceof Image) {\n      this.abortTileLoading(tileImage, tileInfo);\n    }\n\n    tileImage.loadTime = 0;\n    delete this.tilesLoading[tileInfo['id']];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n    this.layer.fire('tileerror', {\n      tile: tileInfo\n    });\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    if (!tileImage || !this.getMap()) {\n      return;\n    }\n\n    var point = tileInfo.point,\n        tileZoom = tileInfo.z,\n        tileId = tileInfo.id;\n\n    var map = this.getMap(),\n        tileSize = tileInfo.size,\n        zoom = map.getZoom(),\n        ctx = this.context,\n        cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT$3),\n        bearing = map.getBearing(),\n        transformed = bearing || zoom !== tileZoom;\n\n    var opacity = this.getTileOpacity(tileImage);\n    var alpha = ctx.globalAlpha;\n\n    if (opacity < 1) {\n      ctx.globalAlpha = opacity;\n      this.setToRedraw();\n    }\n\n    if (!transformed) {\n      cp._round();\n    }\n\n    var x = cp.x,\n        y = cp.y;\n    var w = tileSize[0],\n        h = tileSize[1];\n\n    if (transformed) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n        w += 0.1;\n        h += 0.1;\n      }\n\n      if (zoom !== tileZoom) {\n        var scale = map._getResolution(tileZoom) / map._getResolution();\n\n        ctx.scale(scale, scale);\n      }\n\n      x = y = 0;\n    }\n\n    Canvas.image(ctx, tileImage, x, y, w, h);\n\n    if (this.layer.options['debug']) {\n      var color = this.layer.options['debugOutline'];\n      ctx.save();\n      ctx.strokeStyle = color;\n      ctx.fillStyle = color;\n      ctx.strokeWidth = 10;\n      ctx.font = '20px monospace';\n\n      var _point = new Point(x, y);\n\n      Canvas.rectangle(ctx, _point, {\n        width: w,\n        height: h\n      }, 1, 0);\n      Canvas.fillText(ctx, this.getDebugInfo(tileId), _point._add(10, 20), color);\n      Canvas.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n      ctx.restore();\n    }\n\n    if (transformed) {\n      ctx.restore();\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n\n    this.setCanvasUpdated();\n  };\n\n  _proto.getDebugInfo = function getDebugInfo(tileId) {\n    var xyz = tileId.split('_');\n    var length = xyz.length;\n    return 'x:' + xyz[length - 2] + ', y:' + xyz[length - 3] + ', z:' + xyz[length - 1];\n  };\n\n  _proto._findChildTiles = function _findChildTiles(info) {\n    var layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var children = [];\n\n    var min = info.extent2d.getMin(),\n        max = info.extent2d.getMax(),\n        pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1$2), TEMP_POINT1$2),\n        pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2$1), TEMP_POINT2$1);\n\n    var zoomDiff = 2;\n\n    for (var i = 1; i < zoomDiff; i++) {\n      this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n    }\n\n    return children;\n  };\n\n  _proto._findChildTilesAt = function _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n    var zoomOffset = layer.options['zoomOffset'];\n    var layerId = layer.getId(),\n        res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n\n    if (!res) {\n      return;\n    }\n\n    var dmin = layer._getTileConfig().getTileIndex(pmin, res),\n        dmax = layer._getTileConfig().getTileIndex(pmax, res);\n\n    var sx = Math.min(dmin.idx, dmax.idx),\n        ex = Math.max(dmin.idx, dmax.idx);\n    var sy = Math.min(dmin.idy, dmax.idy),\n        ey = Math.max(dmin.idy, dmax.idy);\n    var id, tile;\n\n    for (var i = sx; i < ex; i++) {\n      for (var ii = sy; ii < ey; ii++) {\n        id = layer._getTileId(i, ii, childZoom + zoomOffset, layerId);\n\n        if (this.tileCache.has(id)) {\n          tile = this.tileCache.getAndRemove(id);\n          children.push(tile);\n          this.tileCache.add(id, tile);\n        }\n      }\n    }\n  };\n\n  _proto._findParentTile = function _findParentTile(info) {\n    var map = this.getMap(),\n        layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return null;\n    }\n\n    var sr = layer.getSpatialReference();\n    var d = sr.getZoomDirection(),\n        zoomOffset = layer.options['zoomOffset'],\n        zoomDiff = layer.options['backgroundZoomDiff'];\n\n    var center = info.extent2d.getCenter(),\n        prj = layer._project(map._pointToPrj(center, info.z));\n\n    for (var diff = 1; diff <= zoomDiff; diff++) {\n      var z = info.z - d * diff;\n      var res = sr.getResolution(z + zoomOffset);\n      if (!res) continue;\n\n      var tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n\n      var id = layer._getTileId(tileIndex.x, tileIndex.y, z + zoomOffset, info.layer);\n\n      if (this.tileCache.has(id)) {\n        var tile = this.tileCache.getAndRemove(id);\n        this.tileCache.add(id, tile);\n        return tile;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._getLayerOfTile = function _getLayerOfTile(layerId) {\n    return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n  };\n\n  _proto._getCachedTile = function _getCachedTile(tileId) {\n    var tilesInView = this.tilesInView;\n    var cached = this.tileCache.getAndRemove(tileId);\n\n    if (cached) {\n      tilesInView[tileId] = cached;\n      var tilesLoading = this.tilesLoading;\n\n      if (tilesLoading && tilesLoading[tileId]) {\n        tilesLoading[tileId].current = false;\n        var _tilesLoading$tileId = tilesLoading[tileId],\n            image = _tilesLoading$tileId.image,\n            info = _tilesLoading$tileId.info;\n        this.abortTileLoading(image, info);\n        console.log('_getCachedTile');\n        delete tilesLoading[tileId];\n      }\n    } else {\n      cached = tilesInView[tileId];\n    }\n\n    return cached;\n  };\n\n  _proto._addTileToCache = function _addTileToCache(tileInfo, tileImage) {\n    this.tilesInView[tileInfo.id] = {\n      image: tileImage,\n      current: true,\n      info: tileInfo\n    };\n  };\n\n  _proto.getTileOpacity = function getTileOpacity(tileImage) {\n    if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n      return 1;\n    }\n\n    return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.clear();\n    delete this.tileCache;\n    delete this._tilePlaceHolder;\n\n    _CanvasRenderer.prototype.onRemove.call(this);\n  };\n\n  _proto._markTiles = function _markTiles() {\n    var a = 0,\n        b = 0;\n\n    if (this.tilesLoading) {\n      for (var p in this.tilesLoading) {\n        this.tilesLoading[p].current = false;\n        a++;\n      }\n    }\n\n    if (this.tilesInView) {\n      for (var _p in this.tilesInView) {\n        this.tilesInView[_p].current = false;\n        b++;\n      }\n    }\n\n    return [a, b];\n  };\n\n  _proto._retireTiles = function _retireTiles(force) {\n    for (var i in this.tilesLoading) {\n      var tile = this.tilesLoading[i];\n\n      if (force || !tile.current) {\n        if (tile.image) {\n          this.abortTileLoading(tile.image, tile.info);\n        }\n\n        this.deleteTile(tile);\n        delete this.tilesLoading[i];\n      }\n    }\n\n    for (var _i2 in this.tilesInView) {\n      var _tile = this.tilesInView[_i2];\n\n      if (!_tile.current) {\n        delete this.tilesInView[_i2];\n\n        if (!this.tileCache.has(_i2)) {\n          this.deleteTile(_tile);\n        }\n      }\n    }\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    if (!tile || !tile.image) {\n      return;\n    }\n\n    tile.image.onload = null;\n    tile.image.onerror = null;\n  };\n\n  _proto._generatePlaceHolder = function _generatePlaceHolder(z) {\n    var map = this.getMap();\n    var placeholder = this.layer.options['placeholder'];\n\n    if (!placeholder || map.getPitch()) {\n      return null;\n    }\n\n    var tileSize = this.layer.getTileSize(),\n        scale = map._getResolution(z) / map._getResolution(),\n        canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n\n    canvas.width = tileSize.width * scale;\n    canvas.height = tileSize.height * scale;\n\n    if (isFunction(placeholder)) {\n      placeholder(canvas);\n    } else {\n      defaultPlaceholder(canvas);\n    }\n\n    return canvas;\n  };\n\n  return TileLayerCanvasRenderer;\n}(CanvasRenderer);\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() {\n  return false;\n}\n\nfunction defaultPlaceholder(canvas) {\n  var ctx = canvas.getContext('2d'),\n      cw = canvas.width,\n      ch = canvas.height,\n      w = cw / 16,\n      h = ch / 16;\n  ctx.beginPath();\n\n  for (var i = 0; i < 16; i++) {\n    ctx.moveTo(0, i * h);\n    ctx.lineTo(cw, i * h);\n    ctx.moveTo(i * w, 0);\n    ctx.lineTo(i * w, ch);\n  }\n\n  ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  ctx.beginPath();\n  var path = [[0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]];\n\n  for (var _i3 = 1; _i3 < path.length; _i3 += 2) {\n    ctx.moveTo(path[_i3 - 1][0], path[_i3 - 1][1]);\n    ctx.lineTo(path[_i3][0], path[_i3][1]);\n  }\n\n  ctx.lineWidth = 1 * 4;\n  ctx.stroke();\n}\n\nvar TileLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(TileLayerGLRenderer, _ImageGLRenderable);\n\n  function TileLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto = TileLayerGLRenderer.prototype;\n\n  _proto.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n      return true;\n    }\n\n    return _ImageGLRenderable.prototype.needToRedraw.call(this);\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    var map = this.getMap();\n\n    if (!tileInfo || !map || !tileImage) {\n      return;\n    }\n\n    var scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n        w = tileInfo.size[0],\n        h = tileInfo.size[1];\n\n    if (tileInfo.cache !== false) {\n      this._bindGLBuffer(tileImage, w, h);\n    }\n\n    if (!this._gl()) {\n      _ImageGLRenderable.prototype.drawTile.call(this, tileInfo, tileImage);\n\n      return;\n    }\n\n    var point = tileInfo.point;\n    var x = point.x * scale,\n        y = point.y * scale;\n    var opacity = this.getTileOpacity(tileImage);\n    var debugInfo = null;\n\n    if (this.layer.options['debug']) {\n      debugInfo = this.getDebugInfo(tileInfo.id);\n    }\n\n    this.drawGLImage(tileImage, x, y, w, h, scale, opacity, debugInfo);\n\n    if (opacity < 1) {\n      this.setToRedraw();\n    } else {\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n  };\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {\n    this.pauseZoomStencilTest();\n  };\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n  };\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto._bindGLBuffer = function _bindGLBuffer(image, w, h) {\n    if (!image.glBuffer) {\n      image.glBuffer = this.bufferTileData(0, 0, w, h);\n    }\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n    tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n    tileImage.src = url;\n    return;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (!this.canvas.gl || !this.canvas.gl.wrap) {\n      this.createCanvas2();\n    }\n  };\n\n  _proto.createContext = function createContext() {\n    _ImageGLRenderable.prototype.createContext.call(this);\n\n    this.createGLContext();\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    if (!this._gl() || !this.canvas2) {\n      return _ImageGLRenderable.prototype.getCanvasImage.call(this);\n    }\n\n    var img = _ImageGLRenderable.prototype.getCanvasImage.call(this);\n\n    if (img) {\n      img.image = this.canvas2;\n    }\n\n    return img;\n  };\n\n  _proto._gl = function _gl() {\n    if (this.canvas.gl && this.canvas.gl.wrap) {\n      return true;\n    }\n\n    var map = this.getMap();\n    return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    _ImageGLRenderable.prototype.deleteTile.call(this, tile);\n\n    if (tile && tile.image) {\n      this.disposeImage(tile.image);\n    }\n\n    delete tile.image;\n  };\n\n  _proto.onRemove = function onRemove() {\n    _ImageGLRenderable.prototype.onRemove.call(this);\n\n    this.removeGLCanvas();\n  };\n\n  return TileLayerGLRenderer;\n}(ImageGLRenderable(TileLayerCanvasRenderer));\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nfunction _loadTile(tile) {\n  var tileSize = this.layer.getTileSize(),\n      canvasClass = this.canvas.constructor,\n      map = this.getMap();\n  var r = map.getDevicePixelRatio();\n  var tileCanvas = Canvas.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n  tileCanvas['layer'] = this.layer;\n  var me = this;\n  var extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n  this.layer.drawTile(tileCanvas, {\n    'url': tile['url'],\n    'point': tile['point'],\n    'center': map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n    'extent': extent,\n    'z': tile['z'],\n    'x': tile['x'],\n    'y': tile['y']\n  }, function (error) {\n    if (error) {\n      me.onTileError(tileCanvas, tile);\n      return;\n    }\n\n    me.onTileLoad(tileCanvas, tile);\n  });\n  return tileCanvas;\n}\n\nvar CanvasRenderer$1 = function (_TileLayerCanvasRende) {\n  _inheritsLoose(CanvasRenderer, _TileLayerCanvasRende);\n\n  function CanvasRenderer() {\n    return _TileLayerCanvasRende.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return CanvasRenderer;\n}(TileLayerCanvasRenderer);\n\nvar GLRenderer = function (_TileLayerGLRenderer) {\n  _inheritsLoose(GLRenderer, _TileLayerGLRenderer);\n\n  function GLRenderer() {\n    return _TileLayerGLRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = GLRenderer.prototype;\n\n  _proto2.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return GLRenderer;\n}(TileLayerGLRenderer);\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer$1);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nvar OverlayLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(OverlayLayerRenderer, _CanvasRenderer);\n\n  function OverlayLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = OverlayLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var geometries = this._geosToCheck;\n\n    if (!this._resourceChecked && !geometries) {\n      geometries = this.layer._geoList;\n    }\n\n    if (!isArrayHasData(geometries)) {\n      return [];\n    }\n\n    var resources = [];\n    var cache = {};\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      var res = geo._getExternalResources();\n\n      if (!res.length) {\n        continue;\n      }\n\n      if (!this.resources) {\n        resources.push.apply(resources, res);\n      } else {\n        for (var _i = 0; _i < res.length; _i++) {\n          var url = res[_i][0];\n\n          if (!this.resources.isResourceLoaded(res[_i]) && !cache[url]) {\n            resources.push(res[_i]);\n            cache[url] = 1;\n          }\n        }\n      }\n    }\n\n    this._resourceChecked = true;\n    delete this._geosToCheck;\n    return resources;\n  };\n\n  _proto.render = function render() {\n    this.layer._sortGeometries();\n\n    return _CanvasRenderer.prototype.render.apply(this, arguments);\n  };\n\n  _proto._addGeoToCheckRes = function _addGeoToCheckRes(res) {\n    if (!res) {\n      return;\n    }\n\n    if (!Array.isArray(res)) {\n      res = [res];\n    }\n\n    if (!this._geosToCheck) {\n      this._geosToCheck = [];\n    }\n\n    pushIn(this._geosToCheck, res);\n  };\n\n  _proto.onGeometryAdd = function onGeometryAdd(geometries) {\n    this._addGeoToCheckRes(geometries);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryRemove = function onGeometryRemove() {\n    redraw(this);\n  };\n\n  _proto.onGeometrySymbolChange = function onGeometrySymbolChange(e) {\n    this._addGeoToCheckRes(e.target);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryShapeChange = function onGeometryShapeChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryZIndexChange = function onGeometryZIndexChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryShow = function onGeometryShow() {\n    redraw(this);\n  };\n\n  _proto.onGeometryHide = function onGeometryHide() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange() {\n    redraw(this);\n  };\n\n  return OverlayLayerRenderer;\n}(CanvasRenderer);\n\nfunction redraw(renderer) {\n  if (renderer.layer.options['drawImmediate']) {\n    renderer.render();\n  }\n\n  renderer.setToRedraw();\n}\n\nvar TEMP_EXTENT$4 = new PointExtent();\n\nvar VectorLayerRenderer = function (_OverlayLayerCanvasRe) {\n  _inheritsLoose(VectorLayerRenderer, _OverlayLayerCanvasRe);\n\n  function VectorLayerRenderer() {\n    return _OverlayLayerCanvasRe.apply(this, arguments) || this;\n  }\n\n  var _proto = VectorLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var _this = this;\n\n    var resources = _OverlayLayerCanvasRe.prototype.checkResources.apply(this, arguments);\n\n    var style = this.layer.getStyle();\n\n    if (style) {\n      if (!Array.isArray(style)) {\n        style = [style];\n      }\n\n      style.forEach(function (s) {\n        var res = getExternalResources(s['symbol'], true);\n\n        for (var i = 0, l = res.length; i < l; i++) {\n          if (!_this.resources.isResourceLoaded(res[i])) {\n            resources.push(res[i]);\n          }\n        }\n      });\n    }\n\n    return resources;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() && this.layer.options['enableAltitude']) {\n      return true;\n    }\n\n    if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n      return false;\n    }\n\n    return _OverlayLayerCanvasRe.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    if (!this.getMap()) {\n      return;\n    }\n\n    if (!this.layer.isVisible() || this.layer.isEmpty()) {\n      this.clearCanvas();\n      this.completeRender();\n      return;\n    }\n\n    this.prepareCanvas();\n    this.drawGeos();\n    this.completeRender();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this.context) {\n      return false;\n    }\n\n    return !this.context.canvas._drawn;\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    if (!this._geosToDraw) {\n      return;\n    }\n\n    this._updateDisplayExtent();\n\n    var map = this.getMap();\n    var count = this.layer.getCount();\n    var res = this.getMap().getResolution();\n\n    if (map.isZooming() && map.options['seamlessZoom'] && this._drawnRes !== undefined && res > this._drawnRes * 1.5 && this._geosToDraw.length < count || map.isMoving() || map.isInteracting()) {\n      this.prepareToDraw();\n      this.forEachGeo(this.checkGeo, this);\n      this._drawnRes = res;\n    }\n\n    for (var i = 0, l = this._geosToDraw.length; i < l; i++) {\n      var geo = this._geosToDraw[i];\n\n      if (!geo.isVisible()) {\n        continue;\n      }\n\n      geo._paint(this._displayExtent);\n    }\n  };\n\n  _proto.show = function show() {\n    this.layer.forEach(function (geo) {\n      geo._repaint();\n    });\n\n    _OverlayLayerCanvasRe.prototype.show.apply(this, arguments);\n  };\n\n  _proto.forEachGeo = function forEachGeo(fn, context) {\n    this.layer.forEach(fn, context);\n  };\n\n  _proto.drawGeos = function drawGeos() {\n    this._drawnRes = this.getMap().getResolution();\n\n    this._updateDisplayExtent();\n\n    this.prepareToDraw();\n    this.forEachGeo(this.checkGeo, this);\n\n    for (var i = 0, len = this._geosToDraw.length; i < len; i++) {\n      this._geosToDraw[i]._paint();\n    }\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {\n    this._hasPoint = false;\n    this._geosToDraw = [];\n  };\n\n  _proto.checkGeo = function checkGeo(geo) {\n    if (!geo || !geo.isVisible() || !geo.getMap() || !geo.getLayer() || !geo.getLayer().isCanvasRender()) {\n      return;\n    }\n\n    var painter = geo._getPainter();\n\n    var extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT$4);\n\n    if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n      return;\n    }\n\n    if (painter.hasPoint()) {\n      this._hasPoint = true;\n    }\n\n    this._geosToDraw.push(geo);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    delete this.canvasExtent2D;\n\n    _OverlayLayerCanvasRe.prototype.onZoomEnd.apply(this, arguments);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.forEachGeo(function (g) {\n      g.onHide();\n    });\n    delete this._geosToDraw;\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange(param) {\n    if (param) {\n      this.layer._styleGeometry(param['target']);\n    }\n\n    _OverlayLayerCanvasRe.prototype.onGeometryPropertiesChange.call(this, param);\n  };\n\n  _proto._updateDisplayExtent = function _updateDisplayExtent() {\n    var extent2D = this.canvasExtent2D;\n\n    if (this._maskExtent) {\n      if (!this._maskExtent.intersects(extent2D)) {\n        this.completeRender();\n        return;\n      }\n\n      extent2D = extent2D.intersection(this._maskExtent);\n    }\n\n    this._displayExtent = extent2D;\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var geometries = this._geosToDraw;\n\n    if (!geometries) {\n      return [];\n    }\n\n    return this.layer._hitGeos(geometries, coordinate, options);\n  };\n\n  return VectorLayerRenderer;\n}(OverlayLayerRenderer);\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nvar MapRenderer = function (_Class) {\n  _inheritsLoose(MapRenderer, _Class);\n\n  function MapRenderer(map) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.map = map;\n    _this._handlerQueue = {};\n    return _this;\n  }\n\n  var _proto = MapRenderer.prototype;\n\n  _proto.callInNextFrame = function callInNextFrame(fn) {\n    this._handlerQueue.push(fn);\n  };\n\n  _proto.executeFrameCallbacks = function executeFrameCallbacks() {\n    var running = this._handlerQueue;\n    this._handlerQueue = [];\n\n    for (var i = 0, l = running.length; i < l; i++) {\n      running[i]();\n    }\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset, force) {\n    if (!this.map._panels.front) {\n      return this;\n    }\n\n    if (!force && offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var panels = this.map._panels;\n    var hasFront = this._frontCount = panels.back.layerDOM.childElementCount;\n    var hasBack = this._backCount = panels.front.layerDOM.childElementCount;\n    var hasUI = this._uiCount = panels.front.uiDOM.childElementCount;\n\n    if (hasFront || hasBack || hasUI) {\n      var pos = this.map.offsetPlatform();\n\n      if (offset) {\n        pos = pos.add(offset)._round();\n      } else {\n        pos = pos.round();\n      }\n\n      if (hasBack) {\n        offsetDom(panels.back, pos);\n      }\n\n      if (hasFront || hasUI) {\n        offsetDom(panels.front, pos);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.domChanged = function domChanged() {\n    var panels = this.map._panels;\n\n    if (!panels.front) {\n      return false;\n    }\n\n    var frontCount = panels.back.layerDOM.childElementCount;\n\n    if (this._frontCount === undefined || this._frontCount !== frontCount) {\n      return true;\n    }\n\n    var backCount = panels.front.layerDOM.childElementCount;\n\n    if (this._backCount === undefined || this._backCount !== backCount) {\n      return true;\n    }\n\n    var uiCount = panels.front.uiDOM.childElementCount;\n\n    if (this._uiCount === undefined || this._uiCount !== uiCount) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.resetContainer = function resetContainer() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map._resetMapViewPoint();\n\n    if (this.map._panels.front) {\n      var pos = new Point(0, 0);\n      offsetDom(this.map._panels.back, pos);\n      offsetDom(this.map._panels.front, pos);\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.resetContainer();\n  };\n\n  _proto.onLoad = function onLoad() {\n    this._frameLoop();\n  };\n\n  return MapRenderer;\n}(Class);\n\nvar MapCanvasRenderer = function (_MapRenderer) {\n  _inheritsLoose(MapCanvasRenderer, _MapRenderer);\n\n  function MapCanvasRenderer(map) {\n    var _this;\n\n    _this = _MapRenderer.call(this, map) || this;\n    _this._containerIsCanvas = !!map._containerDOM.getContext;\n    _this._thisVisibilitychange = _this._onVisibilitychange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._registerEvents();\n\n    _this._loopTime = 0;\n    return _this;\n  }\n\n  var _proto = MapCanvasRenderer.prototype;\n\n  _proto.load = function load() {\n    this.initContainer();\n  };\n\n  _proto.renderFrame = function renderFrame(framestamp) {\n    if (!this.map) {\n      return false;\n    }\n\n    delete this._isViewChanged;\n    var map = this.map;\n\n    map._fireEvent('framestart');\n\n    this.updateMapDOM();\n\n    var layers = this._getAllLayerToRender();\n\n    this.drawLayers(layers, framestamp);\n    var updated = this.drawLayerCanvas(layers);\n\n    if (updated) {\n      this._drawCenterCross();\n    }\n\n    map._fireEvent('frameend');\n\n    this._recordView();\n\n    this._mapview = this._getMapView();\n    delete this._spatialRefChanged;\n\n    this._fireLayerLoadEvents();\n\n    this.executeFrameCallbacks();\n    this._canvasUpdated = false;\n    return true;\n  };\n\n  _proto.updateMapDOM = function updateMapDOM() {\n    var map = this.map;\n\n    if (map.isZooming()) {\n      return;\n    }\n\n    var offset = map._getViewPointFrameOffset();\n\n    if (offset) {\n      map.offsetPlatform(offset);\n    } else if (this.domChanged()) {\n      this.offsetPlatform(null, true);\n    }\n  };\n\n  _proto.drawLayers = function drawLayers(layers, framestamp) {\n    var map = this.map,\n        isInteracting = map.isInteracting(),\n        canvasIds = [],\n        updatedIds = [],\n        fps = map.options['fpsOnInteracting'] || 0,\n        timeLimit = fps === 0 ? 0 : 1000 / fps,\n        layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n        l = layers.length;\n    var baseLayer = map.getBaseLayer();\n    var t = 0;\n\n    for (var i = 0; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.isVisible()) {\n        continue;\n      }\n\n      var isCanvas = layer.isCanvasRender();\n\n      if (isCanvas) {\n        canvasIds.push(layer.getId());\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var needsRedraw = this._checkLayerRedraw(layer);\n\n      if (isCanvas && renderer.isCanvasUpdated()) {\n        if (!needsRedraw) {\n          updatedIds.push(layer.getId());\n        }\n\n        this.setLayerCanvasUpdated();\n      }\n\n      var transformMatrix = renderer.__zoomTransformMatrix;\n      delete renderer.__zoomTransformMatrix;\n\n      if (!needsRedraw) {\n        if (isCanvas && isInteracting) {\n          if (map.isZooming() && !map.getPitch()) {\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n          } else if (map.getPitch() || map.isRotating()) {\n            renderer.clearCanvas();\n          }\n        }\n\n        continue;\n      }\n\n      if (isInteracting && isCanvas) {\n        if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n          layer._getRenderer().clearCanvas();\n\n          continue;\n        }\n\n        t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n      } else if (isInteracting && renderer.drawOnInteracting) {\n        if (renderer.prepareRender) {\n          renderer.prepareRender();\n        }\n\n        if (renderer.checkAndDraw) {\n          renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n        } else {\n          renderer.drawOnInteracting(this._eventParam, framestamp);\n        }\n      } else {\n        renderer.render(framestamp);\n\n        if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n          renderer.__zoomTransformMatrix = transformMatrix;\n        }\n      }\n\n      if (isCanvas) {\n        updatedIds.push(layer.getId());\n        this.setLayerCanvasUpdated();\n      }\n    }\n\n    var preCanvasIds = this._canvasIds || [];\n    var preUpdatedIds = this._updatedIds || [];\n    this._canvasIds = canvasIds;\n    this._updatedIds = updatedIds;\n\n    if (!this.isLayerCanvasUpdated()) {\n      var sep = '---';\n\n      if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n        this.setLayerCanvasUpdated();\n      }\n    }\n  };\n\n  _proto._checkLayerRedraw = function _checkLayerRedraw(layer) {\n    if (this.isSpatialReferenceChanged()) {\n      return true;\n    }\n\n    var map = this.map;\n\n    var renderer = layer._getRenderer();\n\n    if (layer.isCanvasRender()) {\n      return renderer.testIfNeedRedraw();\n    } else {\n      if (renderer.needToRedraw && renderer.needToRedraw()) {\n        return true;\n      }\n\n      return map.isInteracting() || this.isViewChanged();\n    }\n  };\n\n  _proto._drawCanvasLayerOnInteracting = function _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n    var map = this.map,\n        renderer = layer._getRenderer(),\n        drawTime = renderer.getDrawTime(),\n        inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n\n    if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n      renderer.render(framestamp);\n    } else if (renderer.drawOnInteracting && (layer === map.getBaseLayer() || inTime || map.isZooming() && layer.options['forceRenderOnZooming'] || map.isMoving() && layer.options['forceRenderOnMoving'] || map.isRotating() && layer.options['forceRenderOnRotating'])) {\n      renderer.prepareRender();\n      renderer.prepareCanvas();\n\n      if (renderer.checkAndDraw) {\n        renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n      } else {\n        renderer.drawOnInteracting(this._eventParam, framestamp);\n      }\n\n      return drawTime;\n    } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n      renderer.prepareRender();\n      renderer.__zoomTransformMatrix = this._zoomMatrix;\n    } else if (map.getPitch() || map.isRotating()) {\n      renderer.clearCanvas();\n    }\n\n    if (renderer.drawOnInteracting && !inTime) {\n      renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n    }\n\n    return 0;\n  };\n\n  _proto._fireLayerLoadEvents = function _fireLayerLoadEvents() {\n    if (this._updatedIds && this._updatedIds.length > 0) {\n      var map = this.map;\n\n      this._updatedIds.reverse().forEach(function (id) {\n        var layer = map.getLayer(id);\n\n        if (!layer) {\n          return;\n        }\n\n        var renderer = layer._getRenderer();\n\n        if (!renderer || !renderer.isRenderComplete()) {\n          return;\n        }\n\n        layer.fire('layerload');\n      });\n    }\n  };\n\n  _proto.isLayerCanvasUpdated = function isLayerCanvasUpdated() {\n    return this._canvasUpdated;\n  };\n\n  _proto.setLayerCanvasUpdated = function setLayerCanvasUpdated() {\n    this._canvasUpdated = true;\n  };\n\n  _proto.drawLayerCanvas = function drawLayerCanvas(layers) {\n    var map = this.map;\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n      return false;\n    }\n\n    if (!this.canvas) {\n      this.createCanvas();\n    }\n\n    map._fireEvent('renderstart', {\n      'context': this.context\n    });\n\n    if (!this._updateCanvasSize()) {\n      this.clearCanvas();\n    }\n\n    var interacting = map.isInteracting(),\n        limit = map.options['layerCanvasLimitOnInteracting'];\n    var len = layers.length;\n    var baseLayerImage;\n    var images = [];\n\n    for (var i = 0; i < len; i++) {\n      if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n        continue;\n      }\n\n      var renderer = layers[i]._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var layerImage = this._getLayerImage(layers[i]);\n\n      if (layerImage && layerImage['image']) {\n        if (layers[i] === map.getBaseLayer()) {\n          baseLayerImage = [layers[i], layerImage];\n        } else {\n          images.push([layers[i], layerImage]);\n        }\n      }\n    }\n\n    if (baseLayerImage) {\n      this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n\n      this._drawFog();\n    }\n\n    len = images.length;\n    var start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n\n    for (var _i = start; _i < len; _i++) {\n      this._drawLayerCanvasImage(images[_i][0], images[_i][1]);\n    }\n\n    map._fireEvent('renderend', {\n      'context': this.context\n    });\n\n    return true;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    var layers = this._getAllLayerToRender();\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var renderer = layers[i].getRenderer();\n\n      if (renderer && renderer.canvas && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.updateMapSize = function updateMapSize(size) {\n    if (!size || this._containerIsCanvas) {\n      return;\n    }\n\n    var width = size['width'] + 'px',\n        height = size['height'] + 'px';\n    var panels = this.map._panels;\n    panels.mapWrapper.style.width = width;\n    panels.mapWrapper.style.height = height;\n\n    this._updateCanvasSize();\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    if (!this.map) {\n      return null;\n    }\n\n    if (this._containerIsCanvas) {\n      return this.map._containerDOM;\n    }\n\n    if (this.map._panels) {\n      return this.map._panels.mapWrapper;\n    }\n\n    return null;\n  };\n\n  _proto.toDataURL = function toDataURL(mimeType) {\n    if (!this.canvas) {\n      return null;\n    }\n\n    return this.canvas.toDataURL(mimeType);\n  };\n\n  _proto.remove = function remove() {\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      removeDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n\n    if (this._resizeInterval) {\n      clearInterval(this._resizeInterval);\n    }\n\n    delete this.context;\n    delete this.canvas;\n    delete this.map;\n    delete this._spatialRefChanged;\n\n    this._cancelFrameLoop();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    var map = this.map;\n\n    if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n      return;\n    }\n\n    var layers = map._getLayers();\n\n    var cursor = 'default';\n    var limit = map.options['hitDetectLimit'] || 0;\n    var counter = 0;\n\n    for (var i = layers.length - 1; i >= 0; i--) {\n      var layer = layers[i];\n\n      if (!layer.options['hitDetect'] || layer.isEmpty && layer.isEmpty()) {\n        continue;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer || !renderer.hitDetect) {\n        continue;\n      }\n\n      if (renderer.isBlank && renderer.isBlank()) {\n        continue;\n      }\n\n      if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n        cursor = layer.options['cursor'] || 'pointer';\n        break;\n      }\n\n      counter++;\n\n      if (limit > 0 && counter > limit) {\n        break;\n      }\n    }\n\n    map._trySetCursor(cursor);\n  };\n\n  _proto._getLayerImage = function _getLayerImage(layer) {\n    var renderer = layer._getRenderer();\n\n    if (renderer.getCanvasImage) {\n      return renderer.getCanvasImage();\n    }\n\n    return null;\n  };\n\n  _proto.initContainer = function initContainer() {\n    var panels = this.map._panels;\n\n    function createContainer(name, className, cssText, enableSelect) {\n      var c = createEl('div', className);\n\n      if (cssText) {\n        c.style.cssText = cssText;\n      }\n\n      panels[name] = c;\n\n      if (!enableSelect) {\n        preventSelection(c);\n      }\n\n      return c;\n    }\n\n    var containerDOM = this.map._containerDOM;\n\n    if (this._containerIsCanvas) {\n      return;\n    }\n\n    containerDOM.innerHTML = '';\n    var POSITION0 = 'position:absolute;top:0px;left:0px;';\n    var mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n        mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n        backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n        back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n        backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n        canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n        frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n        front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n        frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n        ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n        control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n    containerDOM.appendChild(mapWrapper);\n    mapAllLayers.appendChild(backStatic);\n    back.appendChild(backLayer);\n    back.layerDOM = backLayer;\n    mapAllLayers.appendChild(back);\n    mapAllLayers.appendChild(canvasContainer);\n    front.appendChild(frontLayer);\n    front.layerDOM = frontLayer;\n    front.uiDOM = ui;\n    mapAllLayers.appendChild(frontStatic);\n    mapAllLayers.appendChild(front);\n    front.appendChild(ui);\n    mapWrapper.appendChild(mapAllLayers);\n    mapWrapper.appendChild(control);\n    this.createCanvas();\n    this.resetContainer();\n\n    var mapSize = this.map._getContainerDomSize();\n\n    this.updateMapSize(mapSize);\n  };\n\n  _proto.isViewChanged = function isViewChanged() {\n    if (this._isViewChanged !== undefined) {\n      return this._isViewChanged;\n    }\n\n    var previous = this._mapview;\n\n    var view = this._getMapView();\n\n    this._isViewChanged = !previous || !equalMapView(previous, view);\n    return this._isViewChanged;\n  };\n\n  _proto._recordView = function _recordView() {\n    var map = this.map;\n\n    if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n      return;\n    }\n\n    if (!equalMapView(map.getView(), map._getCurrentView())) {\n      map._onViewChange(map.getView());\n    }\n  };\n\n  _proto.isSpatialReferenceChanged = function isSpatialReferenceChanged() {\n    return this._spatialRefChanged;\n  };\n\n  _proto._getMapView = function _getMapView() {\n    var map = this.map;\n\n    var center = map._getPrjCenter();\n\n    return {\n      x: center.x,\n      y: center.y,\n      zoom: map.getZoom(),\n      pitch: map.getPitch(),\n      bearing: map.getBearing(),\n      width: map.width,\n      height: map.height\n    };\n  };\n\n  _proto._frameLoop = function _frameLoop(framestamp) {\n    var _this2 = this;\n\n    if (!this.map) {\n      this._cancelFrameLoop();\n\n      return;\n    }\n\n    this.renderFrame(framestamp);\n    this._animationFrame = requestAnimFrame(function (framestamp) {\n      _this2._frameLoop(framestamp);\n    });\n  };\n\n  _proto._cancelFrameLoop = function _cancelFrameLoop() {\n    if (this._animationFrame) {\n      cancelAnimFrame(this._animationFrame);\n    }\n  };\n\n  _proto._drawLayerCanvasImage = function _drawLayerCanvasImage(layer, layerImage) {\n    var ctx = this.context;\n    var point = layerImage['point'].round();\n    var dpr = this.map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      point._multi(dpr);\n    }\n\n    var canvasImage = layerImage['image'];\n    var width = canvasImage.width,\n        height = canvasImage.height;\n\n    if (point.x + width <= 0 || point.y + height <= 0) {\n      return;\n    }\n\n    var op = layer.options['opacity'];\n\n    if (!isNumber(op)) {\n      op = 1;\n    }\n\n    if (op <= 0) {\n      return;\n    }\n\n    var imgOp = layerImage['opacity'];\n\n    if (!isNumber(imgOp)) {\n      imgOp = 1;\n    }\n\n    if (imgOp <= 0) {\n      return;\n    }\n\n    var alpha = ctx.globalAlpha;\n\n    if (op < 1) {\n      ctx.globalAlpha *= op;\n    }\n\n    if (imgOp < 1) {\n      ctx.globalAlpha *= imgOp;\n    }\n\n    if (layer.options['cssFilter']) {\n      ctx.filter = layer.options['cssFilter'];\n    }\n\n    var renderer = layer.getRenderer();\n    var matrix = renderer.__zoomTransformMatrix;\n    var clipped = renderer.clipCanvas(this.context);\n\n    if (matrix) {\n      ctx.save();\n      ctx.setTransform.apply(ctx, matrix);\n    }\n\n    ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n\n    if (matrix) {\n      ctx.restore();\n    }\n\n    if (clipped) {\n      ctx.restore();\n    }\n\n    if (ctx.filter !== 'none') {\n      ctx.filter = 'none';\n    }\n\n    ctx.globalAlpha = alpha;\n  };\n\n  _proto._drawCenterCross = function _drawCenterCross() {\n    var cross = this.map.options['centerCross'];\n\n    if (cross) {\n      var ctx = this.context;\n      var p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n\n      if (isFunction(cross)) {\n        cross(ctx, p);\n      } else {\n        Canvas.drawCross(this.context, p.x, p.y, 2, '#f00');\n      }\n    }\n  };\n\n  _proto._drawContainerExtent = function _drawContainerExtent() {\n    var cascadePitches = this.map.options.cascadePitches;\n\n    var h30 = this.map.height - this.map._getVisualHeight(cascadePitches[0]);\n\n    var h60 = this.map.height - this.map._getVisualHeight(cascadePitches[1]);\n\n    var extent = this.map.getContainerExtent();\n    var ctx = this.context;\n    ctx.beginPath();\n    ctx.moveTo(0, extent.ymin);\n    ctx.lineTo(extent.xmax, extent.ymin);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h30);\n    ctx.lineTo(extent.xmax, h30);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h60);\n    ctx.lineTo(extent.xmax, h60);\n    ctx.stroke();\n  };\n\n  _proto._drawFog = function _drawFog() {\n    var map = this.map;\n\n    if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n      return;\n    }\n\n    var fogThickness = 30;\n    var r = map.getDevicePixelRatio();\n    var ctx = this.context,\n        clipExtent = map.getContainerExtent();\n    var top = (map.height - map._getVisualHeight(75)) * r;\n    if (top < 0) top = 0;\n    var bottom = clipExtent.ymin * r,\n        h = Math.ceil(bottom - top),\n        color = map.options['fogColor'].join();\n    var gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n    var landscape = 1 - fogThickness / (h + fogThickness);\n    gradient.addColorStop(0, \"rgba(\" + color + \", 0)\");\n    gradient.addColorStop(0.3, \"rgba(\" + color + \", 0.3)\");\n    gradient.addColorStop(landscape, \"rgba(\" + color + \", 1)\");\n    gradient.addColorStop(1, \"rgba(\" + color + \", 0)\");\n    ctx.beginPath();\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n  };\n\n  _proto._getAllLayerToRender = function _getAllLayerToRender() {\n    return this.map._getLayers();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto._updateCanvasSize = function _updateCanvasSize() {\n    if (!this.canvas || this._containerIsCanvas) {\n      return false;\n    }\n\n    var map = this.map,\n        mapSize = map.getSize(),\n        canvas = this.canvas,\n        r = map.getDevicePixelRatio();\n\n    if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n      return false;\n    }\n\n    canvas.height = r * mapSize['height'];\n    canvas.width = r * mapSize['width'];\n\n    if (canvas.style) {\n      canvas.style.width = mapSize['width'] + 'px';\n      canvas.style.height = mapSize['height'] + 'px';\n    }\n\n    return true;\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this._containerIsCanvas) {\n      this.canvas = this.map._containerDOM;\n    } else {\n      this.canvas = createEl('canvas');\n\n      this._updateCanvasSize();\n\n      this.map._panels.canvasContainer.appendChild(this.canvas);\n    }\n\n    this.context = this.canvas.getContext('2d');\n  };\n\n  _proto._checkSize = function _checkSize() {\n    if (!this.map || this.map.isInteracting()) {\n      return;\n    }\n\n    computeDomPosition(this.map._containerDOM);\n    this.map.checkSize();\n  };\n\n  _proto._setCheckSizeInterval = function _setCheckSizeInterval(interval) {\n    var _this3 = this;\n\n    clearInterval(this._resizeInterval);\n    this._checkSizeInterval = interval;\n    this._resizeInterval = setInterval(function () {\n      if (!_this3.map || _this3.map.isRemoved()) {\n        clearInterval(_this3._resizeInterval);\n      } else {\n        _this3._checkSize();\n      }\n    }, this._checkSizeInterval);\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    var _this4 = this;\n\n    var map = this.map;\n\n    if (map.options['checkSize'] && !IS_NODE && typeof window !== 'undefined') {\n      this._setCheckSizeInterval(map.options['checkSizeInterval']);\n    }\n\n    if (!Browser$1.mobile) {\n      map.on('_mousemove', this._onMapMouseMove, this);\n    }\n\n    map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', function (param) {\n      _this4._eventParam = param;\n    });\n    map.on('_zooming', function (param) {\n      if (!map.getPitch()) {\n        _this4._zoomMatrix = param['matrix']['container'];\n      }\n\n      _this4._eventParam = param;\n    });\n    map.on('_zoomend', function (param) {\n      _this4._eventParam = param;\n      delete _this4._zoomMatrix;\n    });\n    map.on('_spatialreferencechange', function () {\n      _this4._spatialRefChanged = true;\n    });\n\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      addDomEvent(document, 'visibilitychange', this._thisVisibilitychange, this);\n    }\n  };\n\n  _proto._onMapMouseMove = function _onMapMouseMove(param) {\n    var _this5 = this;\n\n    var map = this.map;\n\n    if (map.isInteracting() || !map.options['hitDetect']) {\n      return;\n    }\n\n    if (this._hitDetectFrame) {\n      cancelAnimFrame(this._hitDetectFrame);\n    }\n\n    this._hitDetectFrame = requestAnimFrame(function () {\n      _this5.hitDetect(param['containerPoint']);\n    });\n  };\n\n  _proto._getCanvasLayers = function _getCanvasLayers() {\n    return this.map._getLayers(function (layer) {\n      return layer.isCanvasRender();\n    });\n  };\n\n  _proto._onVisibilitychange = function _onVisibilitychange() {\n    if (document.visibilityState !== 'visible') {\n      return;\n    }\n\n    this.setToRedraw();\n  };\n\n  return MapCanvasRenderer;\n}(MapRenderer);\n\nMap$1.registerRenderer('canvas', MapCanvasRenderer);\nMap$1.mergeOptions({\n  'fog': false,\n  'fogColor': [233, 233, 233]\n});\n\n\n\nvar index$6 = /*#__PURE__*/Object.freeze({\n  ResourceCache: ResourceCache,\n  CanvasRenderer: CanvasRenderer,\n  ImageGLRenderable: ImageGLRenderable,\n  MapRenderer: MapRenderer,\n  MapCanvasRenderer: MapCanvasRenderer,\n  Renderable: Renderable,\n  ImageLayerCanvasRenderer: ImageLayerCanvasRenderer,\n  ImageLayerGLRenderer: ImageLayerGLRenderer,\n  TileLayerCanvasRenderer: TileLayerCanvasRenderer,\n  TileLayerGLRenderer: TileLayerGLRenderer,\n  CanvasTileLayerCanvasRenderer: CanvasRenderer$1,\n  CanvasTileLayerGLRenderer: GLRenderer,\n  OverlayLayerCanvasRenderer: OverlayLayerRenderer,\n  VectorLayerCanvasRenderer: VectorLayerRenderer,\n  CanvasLayerRenderer: CanvasLayerRenderer\n});\n\nvar CenterPointRenderer = {\n  _getRenderPoints: function _getRenderPoints() {\n    return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n  }\n};\nMarker.include(CenterPointRenderer);\nEllipse.include(CenterPointRenderer);\nCircle.include(CenterPointRenderer);\nSector.include(CenterPointRenderer);\nRectangle.include({\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n\n    if (placement === 'vertex') {\n      var shell = this._trimRing(this.getShell());\n\n      var points = [];\n\n      for (var i = 0, len = shell.length; i < len; i++) {\n        points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n      }\n\n      return [points, null];\n    } else {\n      var c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n      return [[c], null];\n    }\n  }\n});\nvar PolyRenderer = {\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var points,\n        rotations = null;\n\n    if (placement === 'point') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        points = points[0].concat(points[1]);\n      }\n    } else if (placement === 'vertex') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n      rotations = [];\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        for (var i = 0, l = points.length; i < l; i++) {\n          for (var ii = 0, ll = points[i].length; ii < ll; ii++) {\n            if (ii === 0) {\n              rotations.push([points[i][ii], points[i][ii + 1]]);\n            } else {\n              rotations.push([points[i][ii - 1], points[i][ii]]);\n            }\n          }\n        }\n\n        points = points[0].concat(points[1]);\n      } else {\n        for (var _i = 0, _l = points.length; _i < _l; _i++) {\n          if (_i === 0) {\n            rotations.push([points[_i], points[_i + 1]]);\n          } else {\n            rotations.push([points[_i - 1], points[_i]]);\n          }\n        }\n      }\n    } else if (placement === 'line') {\n      points = [];\n      rotations = [];\n\n      var vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n          isSplitted = vertice.length > 0 && Array.isArray(vertice[0]);\n\n      if (isSplitted) {\n        var ring;\n\n        for (var _i2 = 1, _l2 = vertice.length; _i2 < _l2; _i2++) {\n          ring = vertice[_i2];\n\n          if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n            ring.push(ring[0]);\n          }\n\n          for (var _ii = 1, _ll = ring.length; _ii < _ll; _ii++) {\n            points.push(ring[_ii].add(ring[_ii - 1])._multi(0.5));\n            rotations.push([ring[_ii - 1], ring[_ii]]);\n          }\n        }\n      } else {\n        if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n          vertice.push(vertice[0]);\n        }\n\n        for (var _i3 = 1, _l3 = vertice.length; _i3 < _l3; _i3++) {\n          points.push(vertice[_i3].add(vertice[_i3 - 1])._multi(0.5));\n          rotations.push([vertice[_i3 - 1], vertice[_i3]]);\n        }\n      }\n    } else if (placement === 'vertex-first') {\n      var coords = this._getPrjCoordinates();\n\n      points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n      rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n    } else if (placement === 'vertex-last') {\n      var _coords = this._getPrjCoordinates();\n\n      var _l4 = _coords.length;\n      points = _l4 ? [map._prjToPoint(_coords[_l4 - 1], glZoom)] : [];\n      var current = _l4 - 1,\n          previous = _l4 > 1 ? _l4 - 2 : _l4 - 1;\n      rotations = _l4 ? [[map._prjToPoint(_coords[previous], glZoom), map._prjToPoint(_coords[current], glZoom)]] : [];\n    } else {\n      var pcenter = this._getProjection().project(this.getCenter());\n\n      points = [map._prjToPoint(pcenter, glZoom)];\n    }\n\n    return [points, rotations];\n  }\n};\nLineString.include(PolyRenderer);\nPolygon.include(PolyRenderer);\n\nGeometry.include({\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return false;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return false;\n  }\n});\nvar el = {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return this instanceof Ellipse || this instanceof Sector;\n  },\n  _paintAsPath: function _paintAsPath() {\n    var map = this.getMap();\n    var altitude = this.getAltitude();\n    return altitude > 0 || map.getPitch() || this instanceof Ellipse && map.getBearing();\n  },\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pt = map._prjToPoint(pcenter, map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt].concat(size);\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      return Canvas.ellipse.apply(Canvas, arguments);\n    }\n  },\n  _getRenderSize: function _getRenderSize(pt) {\n    var map = this.getMap(),\n        z = map.getGLZoom();\n\n    var prjExtent = this._getPrjExtent();\n\n    var pmin = map._prjToPoint(prjExtent.getMin(), z),\n        pmax = map._prjToPoint(prjExtent.getMax(), z);\n\n    return [Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pt.y), Math.abs(pt.y - pmin.y)];\n  }\n};\nEllipse.include(el);\nCircle.include(el);\nRectangle.include({\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n    var pointZoom = map.getGLZoom();\n\n    var shell = this._getPrjShell();\n\n    var points = this._getPath2DPoints(shell, false, pointZoom);\n\n    return [points];\n  },\n  _paintOn: Canvas.polygon\n});\nSector.include(el, {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _getPaintParams: function _getPaintParams() {\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var map = this.getMap();\n\n    var pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt, size[0], [this.getStartAngle(), this.getEndAngle()]];\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      var r = this.getMap().getBearing();\n      var args = arguments;\n\n      if (r) {\n        args[3] = args[3].slice(0);\n        args[3][0] += r;\n        args[3][1] += r;\n      }\n\n      return Canvas.sector.apply(Canvas, args);\n    }\n  }\n});\nPath.include({\n  _paintAsPath: function _paintAsPath() {\n    return true;\n  }\n});\nLineString.include({\n  arrowStyles: {\n    'classic': [3, 4]\n  },\n  _getArrowShape: function _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n    if (!prePoint || !point || prePoint.equals(point)) {\n      return null;\n    }\n\n    if (!tolerance) {\n      tolerance = 0;\n    }\n\n    var width = lineWidth * arrowStyle[0],\n        height = lineWidth * arrowStyle[1] + tolerance,\n        hw = width / 2 + tolerance;\n    var normal;\n\n    if (point.nextCtrlPoint || point.prevCtrlPoint) {\n      if (point.prevCtrlPoint) {\n        normal = point.sub(new Point(point.prevCtrlPoint));\n      } else {\n        normal = point.sub(new Point(point.nextCtrlPoint));\n      }\n    } else {\n      normal = point.sub(prePoint);\n    }\n\n    normal._unit();\n\n    var p1 = point.sub(normal.multi(height));\n\n    normal._perp();\n\n    var p0 = p1.add(normal.multi(hw));\n\n    normal._multi(-1);\n\n    var p2 = p1.add(normal.multi(hw));\n    return [p0, point, p2, p0];\n  },\n  _getPaintParams: function _getPaintParams() {\n    var prjVertexes = this._getPrjCoordinates();\n\n    var points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    if (this.options['smoothness']) {\n      Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n    } else {\n      Canvas.path(ctx, points, lineOpacity, null, dasharray);\n    }\n\n    this._paintArrow(ctx, points, lineOpacity);\n  },\n  _getArrowPlacement: function _getArrowPlacement() {\n    return this.options['arrowPlacement'];\n  },\n  _getArrowStyle: function _getArrowStyle() {\n    var arrowStyle = this.options['arrowStyle'];\n\n    if (arrowStyle) {\n      return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n    }\n\n    return null;\n  },\n  _getArrows: function _getArrows(points, lineWidth, tolerance) {\n    var arrowStyle = this._getArrowStyle();\n\n    if (!arrowStyle || points.length < 2) {\n      return [];\n    }\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n    var segments = isSplitted ? points : [points];\n\n    var placement = this._getArrowPlacement();\n\n    var arrows = [];\n    var map = this.getMap(),\n        first = map.coordToContainerPoint(this.getFirstCoordinate()),\n        last = map.coordToContainerPoint(this.getLastCoordinate());\n\n    for (var i = segments.length - 1; i >= 0; i--) {\n      if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n        var arrow = this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance);\n\n        if (arrow) {\n          arrows.push(arrow);\n        }\n      }\n\n      if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n        var _arrow = this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      } else if (placement === 'point') {\n        this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n      }\n    }\n\n    return arrows;\n  },\n  _getArrowPoints: function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    for (var ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n      var arrow = this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n  },\n  _paintArrow: function _paintArrow(ctx, points, lineOpacity) {\n    var lineWidth = this._getInternalSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth) || lineWidth < 3) {\n      lineWidth = 3;\n    }\n\n    var arrows = this._getArrows(points, lineWidth);\n\n    if (!arrows.length) {\n      return;\n    }\n\n    if (ctx.setLineDash) {\n      ctx.setLineDash([]);\n    }\n\n    for (var i = arrows.length - 1; i >= 0; i--) {\n      ctx.fillStyle = ctx.strokeStyle;\n      Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n    }\n  }\n});\nPolygon.include({\n  _getPaintParams: function _getPaintParams(disableSimplify) {\n    var maxZoom = this.getMap().getGLZoom();\n\n    var prjVertexes = this._getPrjShell();\n\n    var points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      points = [[points[0]], [points[1]]];\n    }\n\n    var prjHoles = this._getPrjHoles();\n\n    var holePoints = [];\n\n    if (prjHoles && prjHoles.length > 0) {\n      var simplified = this._simplified;\n\n      for (var i = 0; i < prjHoles.length; i++) {\n        var hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n\n        if (Array.isArray(hole) && isSplitted) {\n          if (Array.isArray(hole[0])) {\n            points[0].push(hole[0]);\n            points[1].push(hole[1]);\n          } else {\n            points[0].push(hole);\n          }\n        } else {\n          holePoints.push(hole);\n        }\n      }\n\n      if (simplified) {\n        this._simplified = simplified;\n      }\n    }\n\n    if (!isSplitted) {\n      points = [points];\n      pushIn(points, holePoints);\n    }\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n  }\n});\n\nMap$1.VERSION = version;\n\nexport { index$1 as Util, dom as DomUtil, strings as StringUtil, index as MapboxUtil, Map$1 as Map, index$4 as ui, index$5 as control, index$6 as renderer, index$3 as symbolizer, Animation$1 as animation, Browser$1 as Browser, Ajax, Canvas, Promise$1 as Promise, Class, Eventable, JSONAble, Handlerable, Handler$1 as Handler, DragHandler, MapTool, DrawTool, AreaTool, DistanceTool, SpatialReference, INTERNAL_LAYER_PREFIX, GEOMETRY_COLLECTION_TYPES, GEOJSON_TYPES, RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES, NUMERICAL_PROPERTIES, COLOR_PROPERTIES, DEFAULT_TEXT_SIZE, projections as projection, index$2 as measurer, Coordinate, CRS, Extent, Point, PointExtent, Size, Transformation, Layer, TileLayer, GroupTileLayer, WMSTileLayer, CanvasTileLayer, ImageLayer, OverlayLayer, VectorLayer, CanvasLayer, ParticleLayer, TileSystem, TileConfig, ArcCurve, Circle, ConnectorLine, ArcConnectorLine, CubicBezierCurve, Curve, Ellipse, GeoJSON, Geometry, GeometryCollection, Label, LineString, Marker, MultiLineString, MultiPoint, MultiPolygon, Polygon, QuadBezierCurve, Rectangle, Sector, TextBox, TextMarker };\n"]},"metadata":{},"sourceType":"module"}