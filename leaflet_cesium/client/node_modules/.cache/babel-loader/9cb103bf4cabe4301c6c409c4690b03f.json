{"ast":null,"code":"import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport Credit from \"../Core/Credit.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport GeographicProjection from \"../Core/GeographicProjection.js\";\nimport GeographicTilingScheme from \"../Core/GeographicTilingScheme.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport TileProviderError from \"../Core/TileProviderError.js\";\nimport WebMercatorProjection from \"../Core/WebMercatorProjection.js\";\nimport WebMercatorTilingScheme from \"../Core/WebMercatorTilingScheme.js\";\nimport when from \"../ThirdParty/when.js\";\nimport DiscardMissingTileImagePolicy from \"./DiscardMissingTileImagePolicy.js\";\nimport ImageryLayerFeatureInfo from \"./ImageryLayerFeatureInfo.js\";\nimport ImageryProvider from \"./ImageryProvider.js\";\n/**\n * @typedef {Object} ArcGisMapServerImageryProvider.ConstructorOptions\n *\n * Initialization options for the ArcGisMapServerImageryProvider constructor\n *\n * @property {Resource|String} url The URL of the ArcGIS MapServer service.\n * @property {String} [token] The ArcGIS token used to authenticate with the ArcGIS MapServer service.\n * @property {TileDiscardPolicy} [tileDiscardPolicy] The policy that determines if a tile\n *        is invalid and should be discarded.  If this value is not specified, a default\n *        {@link DiscardMissingTileImagePolicy} is used for tiled map servers, and a\n *        {@link NeverTileDiscardPolicy} is used for non-tiled map servers.  In the former case,\n *        we request tile 0,0 at the maximum tile level and check pixels (0,0), (200,20), (20,200),\n *        (80,110), and (160, 130).  If all of these pixels are transparent, the discard check is\n *        disabled and no tiles are discarded.  If any of them have a non-transparent color, any\n *        tile that has the same values in these pixel locations is discarded.  The end result of\n *        these defaults should be correct tile discarding for a standard ArcGIS Server.  To ensure\n *        that no tiles are discarded, construct and pass a {@link NeverTileDiscardPolicy} for this\n *        parameter.\n * @property {Boolean} [usePreCachedTilesIfAvailable=true] If true, the server's pre-cached\n *        tiles are used if they are available.  If false, any pre-cached tiles are ignored and the\n *        'export' service is used.\n * @property {String} [layers] A comma-separated list of the layers to show, or undefined if all layers should be shown.\n * @property {Boolean} [enablePickFeatures=true] If true, {@link ArcGisMapServerImageryProvider#pickFeatures} will invoke\n *        the Identify service on the MapServer and return the features included in the response.  If false,\n *        {@link ArcGisMapServerImageryProvider#pickFeatures} will immediately return undefined (indicating no pickable features)\n *        without communicating with the server.  Set this property to false if you don't want this provider's features to\n *        be pickable. Can be overridden by setting the {@link ArcGisMapServerImageryProvider#enablePickFeatures} property on the object.\n * @property {Rectangle} [rectangle=Rectangle.MAX_VALUE] The rectangle of the layer.  This parameter is ignored when accessing\n *                    a tiled layer.\n * @property {TilingScheme} [tilingScheme=new GeographicTilingScheme()] The tiling scheme to use to divide the world into tiles.\n *                       This parameter is ignored when accessing a tiled server.\n * @property {Ellipsoid} [ellipsoid] The ellipsoid.  If the tilingScheme is specified and used,\n *                    this parameter is ignored and the tiling scheme's ellipsoid is used instead. If neither\n *                    parameter is specified, the WGS84 ellipsoid is used.\n * @property {Credit|String} [credit] A credit for the data source, which is displayed on the canvas.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [tileWidth=256] The width of each tile in pixels.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [tileHeight=256] The height of each tile in pixels.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [maximumLevel] The maximum tile level to request, or undefined if there is no maximum.  This parameter is ignored when accessing\n *                                        a tiled server.\n */\n\n/**\n * Provides tiled imagery hosted by an ArcGIS MapServer.  By default, the server's pre-cached tiles are\n * used, if available.\n *\n * @alias ArcGisMapServerImageryProvider\n * @constructor\n *\n * @param {ArcGisMapServerImageryProvider.ConstructorOptions} options Object describing initialization options\n *\n * @see BingMapsImageryProvider\n * @see GoogleEarthEnterpriseMapsProvider\n * @see OpenStreetMapImageryProvider\n * @see SingleTileImageryProvider\n * @see TileMapServiceImageryProvider\n * @see WebMapServiceImageryProvider\n * @see WebMapTileServiceImageryProvider\n * @see UrlTemplateImageryProvider\n *\n *\n * @example\n * var esri = new Cesium.ArcGisMapServerImageryProvider({\n *     url : 'https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'\n * });\n *\n * @see {@link https://developers.arcgis.com/rest/|ArcGIS Server REST API}\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n */\n\nfunction ArcGisMapServerImageryProvider(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT); //>>includeStart('debug', pragmas.debug);\n\n  if (!defined(options.url)) {\n    throw new DeveloperError(\"options.url is required.\");\n  } //>>includeEnd('debug');\n\n  /**\n   * The default alpha blending value of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n\n  this.defaultAlpha = undefined;\n  /**\n   * The default alpha blending value on the night side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultNightAlpha = undefined;\n  /**\n   * The default alpha blending value on the day side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultDayAlpha = undefined;\n  /**\n   * The default brightness of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0\n   * makes the imagery darker while greater than 1.0 makes it brighter.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultBrightness = undefined;\n  /**\n   * The default contrast of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0 reduces\n   * the contrast while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultContrast = undefined;\n  /**\n   * The default hue of this provider in radians. 0.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultHue = undefined;\n  /**\n   * The default saturation of this provider. 1.0 uses the unmodified imagery color. Less than 1.0 reduces the\n   * saturation while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultSaturation = undefined;\n  /**\n   * The default gamma correction to apply to this provider.  1.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n\n  this.defaultGamma = undefined;\n  /**\n   * The default texture minification filter to apply to this provider.\n   *\n   * @type {TextureMinificationFilter}\n   * @default undefined\n   */\n\n  this.defaultMinificationFilter = undefined;\n  /**\n   * The default texture magnification filter to apply to this provider.\n   *\n   * @type {TextureMagnificationFilter}\n   * @default undefined\n   */\n\n  this.defaultMagnificationFilter = undefined;\n  var resource = Resource.createIfNeeded(options.url);\n  resource.appendForwardSlash();\n\n  if (defined(options.token)) {\n    resource.setQueryParameters({\n      token: options.token\n    });\n  }\n\n  this._resource = resource;\n  this._tileDiscardPolicy = options.tileDiscardPolicy;\n  this._tileWidth = defaultValue(options.tileWidth, 256);\n  this._tileHeight = defaultValue(options.tileHeight, 256);\n  this._maximumLevel = options.maximumLevel;\n  this._tilingScheme = defaultValue(options.tilingScheme, new GeographicTilingScheme({\n    ellipsoid: options.ellipsoid\n  }));\n  this._useTiles = defaultValue(options.usePreCachedTilesIfAvailable, true);\n  this._rectangle = defaultValue(options.rectangle, this._tilingScheme.rectangle);\n  this._layers = options.layers;\n  var credit = options.credit;\n\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n\n  this._credit = credit;\n  /**\n   * Gets or sets a value indicating whether feature picking is enabled.  If true, {@link ArcGisMapServerImageryProvider#pickFeatures} will\n   * invoke the \"identify\" operation on the ArcGIS server and return the features included in the response.  If false,\n   * {@link ArcGisMapServerImageryProvider#pickFeatures} will immediately return undefined (indicating no pickable features)\n   * without communicating with the server.\n   * @type {Boolean}\n   * @default true\n   */\n\n  this.enablePickFeatures = defaultValue(options.enablePickFeatures, true);\n  this._errorEvent = new Event();\n  this._ready = false;\n  this._readyPromise = when.defer(); // Grab the details of this MapServer.\n\n  var that = this;\n  var metadataError;\n\n  function metadataSuccess(data) {\n    var tileInfo = data.tileInfo;\n\n    if (!defined(tileInfo)) {\n      that._useTiles = false;\n    } else {\n      that._tileWidth = tileInfo.rows;\n      that._tileHeight = tileInfo.cols;\n\n      if (tileInfo.spatialReference.wkid === 102100 || tileInfo.spatialReference.wkid === 102113) {\n        that._tilingScheme = new WebMercatorTilingScheme({\n          ellipsoid: options.ellipsoid\n        });\n      } else if (data.tileInfo.spatialReference.wkid === 4326) {\n        that._tilingScheme = new GeographicTilingScheme({\n          ellipsoid: options.ellipsoid\n        });\n      } else {\n        var message = \"Tile spatial reference WKID \" + data.tileInfo.spatialReference.wkid + \" is not supported.\";\n        metadataError = TileProviderError.handleError(metadataError, that, that._errorEvent, message, undefined, undefined, undefined, requestMetadata);\n        return;\n      }\n\n      that._maximumLevel = data.tileInfo.lods.length - 1;\n\n      if (defined(data.fullExtent)) {\n        if (defined(data.fullExtent.spatialReference) && defined(data.fullExtent.spatialReference.wkid)) {\n          if (data.fullExtent.spatialReference.wkid === 102100 || data.fullExtent.spatialReference.wkid === 102113) {\n            var projection = new WebMercatorProjection();\n            var extent = data.fullExtent;\n            var sw = projection.unproject(new Cartesian3(Math.max(extent.xmin, -that._tilingScheme.ellipsoid.maximumRadius * Math.PI), Math.max(extent.ymin, -that._tilingScheme.ellipsoid.maximumRadius * Math.PI), 0.0));\n            var ne = projection.unproject(new Cartesian3(Math.min(extent.xmax, that._tilingScheme.ellipsoid.maximumRadius * Math.PI), Math.min(extent.ymax, that._tilingScheme.ellipsoid.maximumRadius * Math.PI), 0.0));\n            that._rectangle = new Rectangle(sw.longitude, sw.latitude, ne.longitude, ne.latitude);\n          } else if (data.fullExtent.spatialReference.wkid === 4326) {\n            that._rectangle = Rectangle.fromDegrees(data.fullExtent.xmin, data.fullExtent.ymin, data.fullExtent.xmax, data.fullExtent.ymax);\n          } else {\n            var extentMessage = \"fullExtent.spatialReference WKID \" + data.fullExtent.spatialReference.wkid + \" is not supported.\";\n            metadataError = TileProviderError.handleError(metadataError, that, that._errorEvent, extentMessage, undefined, undefined, undefined, requestMetadata);\n            return;\n          }\n        }\n      } else {\n        that._rectangle = that._tilingScheme.rectangle;\n      } // Install the default tile discard policy if none has been supplied.\n\n\n      if (!defined(that._tileDiscardPolicy)) {\n        that._tileDiscardPolicy = new DiscardMissingTileImagePolicy({\n          missingImageUrl: buildImageResource(that, 0, 0, that._maximumLevel).url,\n          pixelsToCheck: [new Cartesian2(0, 0), new Cartesian2(200, 20), new Cartesian2(20, 200), new Cartesian2(80, 110), new Cartesian2(160, 130)],\n          disableCheckIfAllPixelsAreTransparent: true\n        });\n      }\n\n      that._useTiles = true;\n    }\n\n    if (defined(data.copyrightText) && data.copyrightText.length > 0) {\n      that._credit = new Credit(data.copyrightText);\n    }\n\n    that._ready = true;\n\n    that._readyPromise.resolve(true);\n\n    TileProviderError.handleSuccess(metadataError);\n  }\n\n  function metadataFailure(e) {\n    var message = \"An error occurred while accessing \" + that._resource.url + \".\";\n    metadataError = TileProviderError.handleError(metadataError, that, that._errorEvent, message, undefined, undefined, undefined, requestMetadata);\n\n    that._readyPromise.reject(new RuntimeError(message));\n  }\n\n  function requestMetadata() {\n    var resource = that._resource.getDerivedResource({\n      queryParameters: {\n        f: \"json\"\n      }\n    });\n\n    var metadata = resource.fetchJsonp();\n    when(metadata, metadataSuccess, metadataFailure);\n  }\n\n  if (this._useTiles) {\n    requestMetadata();\n  } else {\n    this._ready = true;\n\n    this._readyPromise.resolve(true);\n  }\n}\n\nfunction buildImageResource(imageryProvider, x, y, level, request) {\n  var resource;\n\n  if (imageryProvider._useTiles) {\n    resource = imageryProvider._resource.getDerivedResource({\n      url: \"tile/\" + level + \"/\" + y + \"/\" + x,\n      request: request\n    });\n  } else {\n    var nativeRectangle = imageryProvider._tilingScheme.tileXYToNativeRectangle(x, y, level);\n\n    var bbox = nativeRectangle.west + \",\" + nativeRectangle.south + \",\" + nativeRectangle.east + \",\" + nativeRectangle.north;\n    var query = {\n      bbox: bbox,\n      size: imageryProvider._tileWidth + \",\" + imageryProvider._tileHeight,\n      format: \"png32\",\n      transparent: true,\n      f: \"image\"\n    };\n\n    if (imageryProvider._tilingScheme.projection instanceof GeographicProjection) {\n      query.bboxSR = 4326;\n      query.imageSR = 4326;\n    } else {\n      query.bboxSR = 3857;\n      query.imageSR = 3857;\n    }\n\n    if (imageryProvider.layers) {\n      query.layers = \"show:\" + imageryProvider.layers;\n    }\n\n    resource = imageryProvider._resource.getDerivedResource({\n      url: \"export\",\n      request: request,\n      queryParameters: query\n    });\n  }\n\n  return resource;\n}\n\nObject.defineProperties(ArcGisMapServerImageryProvider.prototype, {\n  /**\n   * Gets the URL of the ArcGIS MapServer.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {String}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._resource._url;\n    }\n  },\n\n  /**\n   * Gets the ArcGIS token used to authenticate with the ArcGis MapServer service.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {String}\n   * @readonly\n   */\n  token: {\n    get: function () {\n      return this._resource.queryParameters.token;\n    }\n  },\n\n  /**\n   * Gets the proxy used by this provider.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Proxy}\n   * @readonly\n   */\n  proxy: {\n    get: function () {\n      return this._resource.proxy;\n    }\n  },\n\n  /**\n   * Gets the width of each tile, in pixels. This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileWidth: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"tileWidth must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._tileWidth;\n    }\n  },\n\n  /**\n   * Gets the height of each tile, in pixels.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileHeight: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"tileHeight must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._tileHeight;\n    }\n  },\n\n  /**\n   * Gets the maximum level-of-detail that can be requested.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number|undefined}\n   * @readonly\n   */\n  maximumLevel: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"maximumLevel must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._maximumLevel;\n    }\n  },\n\n  /**\n   * Gets the minimum level-of-detail that can be requested.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  minimumLevel: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"minimumLevel must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return 0;\n    }\n  },\n\n  /**\n   * Gets the tiling scheme used by this provider.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {TilingScheme}\n   * @readonly\n   */\n  tilingScheme: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"tilingScheme must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._tilingScheme;\n    }\n  },\n\n  /**\n   * Gets the rectangle, in radians, of the imagery provided by this instance.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Rectangle}\n   * @readonly\n   */\n  rectangle: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"rectangle must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._rectangle;\n    }\n  },\n\n  /**\n   * Gets the tile discard policy.  If not undefined, the discard policy is responsible\n   * for filtering out \"missing\" tiles via its shouldDiscardImage function.  If this function\n   * returns undefined, no tiles are filtered.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {TileDiscardPolicy}\n   * @readonly\n   */\n  tileDiscardPolicy: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\"tileDiscardPolicy must not be called before the imagery provider is ready.\");\n      } //>>includeEnd('debug');\n\n\n      return this._tileDiscardPolicy;\n    }\n  },\n\n  /**\n   * Gets an event that is raised when the imagery provider encounters an asynchronous error.  By subscribing\n   * to the event, you will be notified of the error and can potentially recover from it.  Event listeners\n   * are passed an instance of {@link TileProviderError}.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Event}\n   * @readonly\n   */\n  errorEvent: {\n    get: function () {\n      return this._errorEvent;\n    }\n  },\n\n  /**\n   * Gets a value indicating whether or not the provider is ready for use.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    }\n  },\n\n  /**\n   * Gets a promise that resolves to true when the provider is ready for use.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Promise.<Boolean>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    }\n  },\n\n  /**\n   * Gets the credit to display when this imagery provider is active.  Typically this is used to credit\n   * the source of the imagery.  This function should not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Credit}\n   * @readonly\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    }\n  },\n\n  /**\n   * Gets a value indicating whether this imagery provider is using pre-cached tiles from the\n   * ArcGIS MapServer.  If the imagery provider is not yet ready ({@link ArcGisMapServerImageryProvider#ready}), this function\n   * will return the value of `options.usePreCachedTilesIfAvailable`, even if the MapServer does\n   * not have pre-cached tiles.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   * @default true\n   */\n  usingPrecachedTiles: {\n    get: function () {\n      return this._useTiles;\n    }\n  },\n\n  /**\n   * Gets a value indicating whether or not the images provided by this imagery provider\n   * include an alpha channel.  If this property is false, an alpha channel, if present, will\n   * be ignored.  If this property is true, any images without an alpha channel will be treated\n   * as if their alpha is 1.0 everywhere.  When this property is false, memory usage\n   * and texture upload time are reduced.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   * @default true\n   */\n  hasAlphaChannel: {\n    get: function () {\n      return true;\n    }\n  },\n\n  /**\n   * Gets the comma-separated list of layer IDs to show.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {String}\n   */\n  layers: {\n    get: function () {\n      return this._layers;\n    }\n  }\n});\n/**\n * Gets the credits to be displayed when a given tile is displayed.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level;\n * @returns {Credit[]} The credits to be displayed when the tile is displayed.\n *\n * @exception {DeveloperError} <code>getTileCredits</code> must not be called before the imagery provider is ready.\n */\n\nArcGisMapServerImageryProvider.prototype.getTileCredits = function (x, y, level) {\n  return undefined;\n};\n/**\n * Requests the image for a given tile.  This function should\n * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level.\n * @param {Request} [request] The request object. Intended for internal use only.\n * @returns {Promise.<HTMLImageElement|HTMLCanvasElement>|undefined} A promise for the image that will resolve when the image is available, or\n *          undefined if there are too many active requests to the server, and the request\n *          should be retried later.  The resolved image may be either an\n *          Image or a Canvas DOM object.\n *\n * @exception {DeveloperError} <code>requestImage</code> must not be called before the imagery provider is ready.\n */\n\n\nArcGisMapServerImageryProvider.prototype.requestImage = function (x, y, level, request) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!this._ready) {\n    throw new DeveloperError(\"requestImage must not be called before the imagery provider is ready.\");\n  } //>>includeEnd('debug');\n\n\n  return ImageryProvider.loadImage(this, buildImageResource(this, x, y, level, request));\n};\n/**\n    /**\n     * Asynchronously determines what features, if any, are located at a given longitude and latitude within\n     * a tile.  This function should not be called before {@link ImageryProvider#ready} returns true.\n     *\n     * @param {Number} x The tile X coordinate.\n     * @param {Number} y The tile Y coordinate.\n     * @param {Number} level The tile level.\n     * @param {Number} longitude The longitude at which to pick features.\n     * @param {Number} latitude  The latitude at which to pick features.\n     * @return {Promise.<ImageryLayerFeatureInfo[]>|undefined} A promise for the picked features that will resolve when the asynchronous\n     *                   picking completes.  The resolved value is an array of {@link ImageryLayerFeatureInfo}\n     *                   instances.  The array may be empty if no features are found at the given location.\n     *\n     * @exception {DeveloperError} <code>pickFeatures</code> must not be called before the imagery provider is ready.\n     */\n\n\nArcGisMapServerImageryProvider.prototype.pickFeatures = function (x, y, level, longitude, latitude) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!this._ready) {\n    throw new DeveloperError(\"pickFeatures must not be called before the imagery provider is ready.\");\n  } //>>includeEnd('debug');\n\n\n  if (!this.enablePickFeatures) {\n    return undefined;\n  }\n\n  var rectangle = this._tilingScheme.tileXYToNativeRectangle(x, y, level);\n\n  var horizontal;\n  var vertical;\n  var sr;\n\n  if (this._tilingScheme.projection instanceof GeographicProjection) {\n    horizontal = CesiumMath.toDegrees(longitude);\n    vertical = CesiumMath.toDegrees(latitude);\n    sr = \"4326\";\n  } else {\n    var projected = this._tilingScheme.projection.project(new Cartographic(longitude, latitude, 0.0));\n\n    horizontal = projected.x;\n    vertical = projected.y;\n    sr = \"3857\";\n  }\n\n  var layers = \"visible\";\n\n  if (defined(this._layers)) {\n    layers += \":\" + this._layers;\n  }\n\n  var query = {\n    f: \"json\",\n    tolerance: 2,\n    geometryType: \"esriGeometryPoint\",\n    geometry: horizontal + \",\" + vertical,\n    mapExtent: rectangle.west + \",\" + rectangle.south + \",\" + rectangle.east + \",\" + rectangle.north,\n    imageDisplay: this._tileWidth + \",\" + this._tileHeight + \",96\",\n    sr: sr,\n    layers: layers\n  };\n\n  var resource = this._resource.getDerivedResource({\n    url: \"identify\",\n    queryParameters: query\n  });\n\n  return resource.fetchJson().then(function (json) {\n    var result = [];\n    var features = json.results;\n\n    if (!defined(features)) {\n      return result;\n    }\n\n    for (var i = 0; i < features.length; ++i) {\n      var feature = features[i];\n      var featureInfo = new ImageryLayerFeatureInfo();\n      featureInfo.data = feature;\n      featureInfo.name = feature.value;\n      featureInfo.properties = feature.attributes;\n      featureInfo.configureDescriptionFromProperties(feature.attributes); // If this is a point feature, use the coordinates of the point.\n\n      if (feature.geometryType === \"esriGeometryPoint\" && feature.geometry) {\n        var wkid = feature.geometry.spatialReference && feature.geometry.spatialReference.wkid ? feature.geometry.spatialReference.wkid : 4326;\n\n        if (wkid === 4326 || wkid === 4283) {\n          featureInfo.position = Cartographic.fromDegrees(feature.geometry.x, feature.geometry.y, feature.geometry.z);\n        } else if (wkid === 102100 || wkid === 900913 || wkid === 3857) {\n          var projection = new WebMercatorProjection();\n          featureInfo.position = projection.unproject(new Cartesian3(feature.geometry.x, feature.geometry.y, feature.geometry.z));\n        }\n      }\n\n      result.push(featureInfo);\n    }\n\n    return result;\n  });\n};\n\nexport default ArcGisMapServerImageryProvider;","map":{"version":3,"sources":["/home/usuario/davi/thalamus/wms/3dmaptestes/leaflet_cesium/client/node_modules/cesium/Source/Scene/ArcGisMapServerImageryProvider.js"],"names":["Cartesian2","Cartesian3","Cartographic","Credit","defaultValue","defined","DeveloperError","Event","GeographicProjection","GeographicTilingScheme","CesiumMath","Rectangle","Resource","RuntimeError","TileProviderError","WebMercatorProjection","WebMercatorTilingScheme","when","DiscardMissingTileImagePolicy","ImageryLayerFeatureInfo","ImageryProvider","ArcGisMapServerImageryProvider","options","EMPTY_OBJECT","url","defaultAlpha","undefined","defaultNightAlpha","defaultDayAlpha","defaultBrightness","defaultContrast","defaultHue","defaultSaturation","defaultGamma","defaultMinificationFilter","defaultMagnificationFilter","resource","createIfNeeded","appendForwardSlash","token","setQueryParameters","_resource","_tileDiscardPolicy","tileDiscardPolicy","_tileWidth","tileWidth","_tileHeight","tileHeight","_maximumLevel","maximumLevel","_tilingScheme","tilingScheme","ellipsoid","_useTiles","usePreCachedTilesIfAvailable","_rectangle","rectangle","_layers","layers","credit","_credit","enablePickFeatures","_errorEvent","_ready","_readyPromise","defer","that","metadataError","metadataSuccess","data","tileInfo","rows","cols","spatialReference","wkid","message","handleError","requestMetadata","lods","length","fullExtent","projection","extent","sw","unproject","Math","max","xmin","maximumRadius","PI","ymin","ne","min","xmax","ymax","longitude","latitude","fromDegrees","extentMessage","missingImageUrl","buildImageResource","pixelsToCheck","disableCheckIfAllPixelsAreTransparent","copyrightText","resolve","handleSuccess","metadataFailure","e","reject","getDerivedResource","queryParameters","f","metadata","fetchJsonp","imageryProvider","x","y","level","request","nativeRectangle","tileXYToNativeRectangle","bbox","west","south","east","north","query","size","format","transparent","bboxSR","imageSR","Object","defineProperties","prototype","get","_url","proxy","minimumLevel","errorEvent","ready","readyPromise","promise","usingPrecachedTiles","hasAlphaChannel","getTileCredits","requestImage","loadImage","pickFeatures","horizontal","vertical","sr","toDegrees","projected","project","tolerance","geometryType","geometry","mapExtent","imageDisplay","fetchJson","then","json","result","features","results","i","feature","featureInfo","name","value","properties","attributes","configureDescriptionFromProperties","position","z","push"],"mappings":"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","sourcesContent":["import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport Credit from \"../Core/Credit.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport GeographicProjection from \"../Core/GeographicProjection.js\";\nimport GeographicTilingScheme from \"../Core/GeographicTilingScheme.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport TileProviderError from \"../Core/TileProviderError.js\";\nimport WebMercatorProjection from \"../Core/WebMercatorProjection.js\";\nimport WebMercatorTilingScheme from \"../Core/WebMercatorTilingScheme.js\";\nimport when from \"../ThirdParty/when.js\";\nimport DiscardMissingTileImagePolicy from \"./DiscardMissingTileImagePolicy.js\";\nimport ImageryLayerFeatureInfo from \"./ImageryLayerFeatureInfo.js\";\nimport ImageryProvider from \"./ImageryProvider.js\";\n\n/**\n * @typedef {Object} ArcGisMapServerImageryProvider.ConstructorOptions\n *\n * Initialization options for the ArcGisMapServerImageryProvider constructor\n *\n * @property {Resource|String} url The URL of the ArcGIS MapServer service.\n * @property {String} [token] The ArcGIS token used to authenticate with the ArcGIS MapServer service.\n * @property {TileDiscardPolicy} [tileDiscardPolicy] The policy that determines if a tile\n *        is invalid and should be discarded.  If this value is not specified, a default\n *        {@link DiscardMissingTileImagePolicy} is used for tiled map servers, and a\n *        {@link NeverTileDiscardPolicy} is used for non-tiled map servers.  In the former case,\n *        we request tile 0,0 at the maximum tile level and check pixels (0,0), (200,20), (20,200),\n *        (80,110), and (160, 130).  If all of these pixels are transparent, the discard check is\n *        disabled and no tiles are discarded.  If any of them have a non-transparent color, any\n *        tile that has the same values in these pixel locations is discarded.  The end result of\n *        these defaults should be correct tile discarding for a standard ArcGIS Server.  To ensure\n *        that no tiles are discarded, construct and pass a {@link NeverTileDiscardPolicy} for this\n *        parameter.\n * @property {Boolean} [usePreCachedTilesIfAvailable=true] If true, the server's pre-cached\n *        tiles are used if they are available.  If false, any pre-cached tiles are ignored and the\n *        'export' service is used.\n * @property {String} [layers] A comma-separated list of the layers to show, or undefined if all layers should be shown.\n * @property {Boolean} [enablePickFeatures=true] If true, {@link ArcGisMapServerImageryProvider#pickFeatures} will invoke\n *        the Identify service on the MapServer and return the features included in the response.  If false,\n *        {@link ArcGisMapServerImageryProvider#pickFeatures} will immediately return undefined (indicating no pickable features)\n *        without communicating with the server.  Set this property to false if you don't want this provider's features to\n *        be pickable. Can be overridden by setting the {@link ArcGisMapServerImageryProvider#enablePickFeatures} property on the object.\n * @property {Rectangle} [rectangle=Rectangle.MAX_VALUE] The rectangle of the layer.  This parameter is ignored when accessing\n *                    a tiled layer.\n * @property {TilingScheme} [tilingScheme=new GeographicTilingScheme()] The tiling scheme to use to divide the world into tiles.\n *                       This parameter is ignored when accessing a tiled server.\n * @property {Ellipsoid} [ellipsoid] The ellipsoid.  If the tilingScheme is specified and used,\n *                    this parameter is ignored and the tiling scheme's ellipsoid is used instead. If neither\n *                    parameter is specified, the WGS84 ellipsoid is used.\n * @property {Credit|String} [credit] A credit for the data source, which is displayed on the canvas.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [tileWidth=256] The width of each tile in pixels.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [tileHeight=256] The height of each tile in pixels.  This parameter is ignored when accessing a tiled server.\n * @property {Number} [maximumLevel] The maximum tile level to request, or undefined if there is no maximum.  This parameter is ignored when accessing\n *                                        a tiled server.\n */\n\n/**\n * Provides tiled imagery hosted by an ArcGIS MapServer.  By default, the server's pre-cached tiles are\n * used, if available.\n *\n * @alias ArcGisMapServerImageryProvider\n * @constructor\n *\n * @param {ArcGisMapServerImageryProvider.ConstructorOptions} options Object describing initialization options\n *\n * @see BingMapsImageryProvider\n * @see GoogleEarthEnterpriseMapsProvider\n * @see OpenStreetMapImageryProvider\n * @see SingleTileImageryProvider\n * @see TileMapServiceImageryProvider\n * @see WebMapServiceImageryProvider\n * @see WebMapTileServiceImageryProvider\n * @see UrlTemplateImageryProvider\n *\n *\n * @example\n * var esri = new Cesium.ArcGisMapServerImageryProvider({\n *     url : 'https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'\n * });\n *\n * @see {@link https://developers.arcgis.com/rest/|ArcGIS Server REST API}\n * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\n */\nfunction ArcGisMapServerImageryProvider(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(options.url)) {\n    throw new DeveloperError(\"options.url is required.\");\n  }\n  //>>includeEnd('debug');\n\n  /**\n   * The default alpha blending value of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultAlpha = undefined;\n\n  /**\n   * The default alpha blending value on the night side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultNightAlpha = undefined;\n\n  /**\n   * The default alpha blending value on the day side of the globe of this provider, with 0.0 representing fully transparent and\n   * 1.0 representing fully opaque.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultDayAlpha = undefined;\n\n  /**\n   * The default brightness of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0\n   * makes the imagery darker while greater than 1.0 makes it brighter.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultBrightness = undefined;\n\n  /**\n   * The default contrast of this provider.  1.0 uses the unmodified imagery color.  Less than 1.0 reduces\n   * the contrast while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultContrast = undefined;\n\n  /**\n   * The default hue of this provider in radians. 0.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultHue = undefined;\n\n  /**\n   * The default saturation of this provider. 1.0 uses the unmodified imagery color. Less than 1.0 reduces the\n   * saturation while greater than 1.0 increases it.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultSaturation = undefined;\n\n  /**\n   * The default gamma correction to apply to this provider.  1.0 uses the unmodified imagery color.\n   *\n   * @type {Number|undefined}\n   * @default undefined\n   */\n  this.defaultGamma = undefined;\n\n  /**\n   * The default texture minification filter to apply to this provider.\n   *\n   * @type {TextureMinificationFilter}\n   * @default undefined\n   */\n  this.defaultMinificationFilter = undefined;\n\n  /**\n   * The default texture magnification filter to apply to this provider.\n   *\n   * @type {TextureMagnificationFilter}\n   * @default undefined\n   */\n  this.defaultMagnificationFilter = undefined;\n\n  var resource = Resource.createIfNeeded(options.url);\n  resource.appendForwardSlash();\n\n  if (defined(options.token)) {\n    resource.setQueryParameters({\n      token: options.token,\n    });\n  }\n\n  this._resource = resource;\n  this._tileDiscardPolicy = options.tileDiscardPolicy;\n\n  this._tileWidth = defaultValue(options.tileWidth, 256);\n  this._tileHeight = defaultValue(options.tileHeight, 256);\n  this._maximumLevel = options.maximumLevel;\n  this._tilingScheme = defaultValue(\n    options.tilingScheme,\n    new GeographicTilingScheme({ ellipsoid: options.ellipsoid })\n  );\n  this._useTiles = defaultValue(options.usePreCachedTilesIfAvailable, true);\n  this._rectangle = defaultValue(\n    options.rectangle,\n    this._tilingScheme.rectangle\n  );\n  this._layers = options.layers;\n\n  var credit = options.credit;\n  if (typeof credit === \"string\") {\n    credit = new Credit(credit);\n  }\n  this._credit = credit;\n\n  /**\n   * Gets or sets a value indicating whether feature picking is enabled.  If true, {@link ArcGisMapServerImageryProvider#pickFeatures} will\n   * invoke the \"identify\" operation on the ArcGIS server and return the features included in the response.  If false,\n   * {@link ArcGisMapServerImageryProvider#pickFeatures} will immediately return undefined (indicating no pickable features)\n   * without communicating with the server.\n   * @type {Boolean}\n   * @default true\n   */\n  this.enablePickFeatures = defaultValue(options.enablePickFeatures, true);\n\n  this._errorEvent = new Event();\n\n  this._ready = false;\n  this._readyPromise = when.defer();\n\n  // Grab the details of this MapServer.\n  var that = this;\n  var metadataError;\n\n  function metadataSuccess(data) {\n    var tileInfo = data.tileInfo;\n    if (!defined(tileInfo)) {\n      that._useTiles = false;\n    } else {\n      that._tileWidth = tileInfo.rows;\n      that._tileHeight = tileInfo.cols;\n\n      if (\n        tileInfo.spatialReference.wkid === 102100 ||\n        tileInfo.spatialReference.wkid === 102113\n      ) {\n        that._tilingScheme = new WebMercatorTilingScheme({\n          ellipsoid: options.ellipsoid,\n        });\n      } else if (data.tileInfo.spatialReference.wkid === 4326) {\n        that._tilingScheme = new GeographicTilingScheme({\n          ellipsoid: options.ellipsoid,\n        });\n      } else {\n        var message =\n          \"Tile spatial reference WKID \" +\n          data.tileInfo.spatialReference.wkid +\n          \" is not supported.\";\n        metadataError = TileProviderError.handleError(\n          metadataError,\n          that,\n          that._errorEvent,\n          message,\n          undefined,\n          undefined,\n          undefined,\n          requestMetadata\n        );\n        return;\n      }\n      that._maximumLevel = data.tileInfo.lods.length - 1;\n\n      if (defined(data.fullExtent)) {\n        if (\n          defined(data.fullExtent.spatialReference) &&\n          defined(data.fullExtent.spatialReference.wkid)\n        ) {\n          if (\n            data.fullExtent.spatialReference.wkid === 102100 ||\n            data.fullExtent.spatialReference.wkid === 102113\n          ) {\n            var projection = new WebMercatorProjection();\n            var extent = data.fullExtent;\n            var sw = projection.unproject(\n              new Cartesian3(\n                Math.max(\n                  extent.xmin,\n                  -that._tilingScheme.ellipsoid.maximumRadius * Math.PI\n                ),\n                Math.max(\n                  extent.ymin,\n                  -that._tilingScheme.ellipsoid.maximumRadius * Math.PI\n                ),\n                0.0\n              )\n            );\n            var ne = projection.unproject(\n              new Cartesian3(\n                Math.min(\n                  extent.xmax,\n                  that._tilingScheme.ellipsoid.maximumRadius * Math.PI\n                ),\n                Math.min(\n                  extent.ymax,\n                  that._tilingScheme.ellipsoid.maximumRadius * Math.PI\n                ),\n                0.0\n              )\n            );\n            that._rectangle = new Rectangle(\n              sw.longitude,\n              sw.latitude,\n              ne.longitude,\n              ne.latitude\n            );\n          } else if (data.fullExtent.spatialReference.wkid === 4326) {\n            that._rectangle = Rectangle.fromDegrees(\n              data.fullExtent.xmin,\n              data.fullExtent.ymin,\n              data.fullExtent.xmax,\n              data.fullExtent.ymax\n            );\n          } else {\n            var extentMessage =\n              \"fullExtent.spatialReference WKID \" +\n              data.fullExtent.spatialReference.wkid +\n              \" is not supported.\";\n            metadataError = TileProviderError.handleError(\n              metadataError,\n              that,\n              that._errorEvent,\n              extentMessage,\n              undefined,\n              undefined,\n              undefined,\n              requestMetadata\n            );\n            return;\n          }\n        }\n      } else {\n        that._rectangle = that._tilingScheme.rectangle;\n      }\n\n      // Install the default tile discard policy if none has been supplied.\n      if (!defined(that._tileDiscardPolicy)) {\n        that._tileDiscardPolicy = new DiscardMissingTileImagePolicy({\n          missingImageUrl: buildImageResource(that, 0, 0, that._maximumLevel)\n            .url,\n          pixelsToCheck: [\n            new Cartesian2(0, 0),\n            new Cartesian2(200, 20),\n            new Cartesian2(20, 200),\n            new Cartesian2(80, 110),\n            new Cartesian2(160, 130),\n          ],\n          disableCheckIfAllPixelsAreTransparent: true,\n        });\n      }\n\n      that._useTiles = true;\n    }\n\n    if (defined(data.copyrightText) && data.copyrightText.length > 0) {\n      that._credit = new Credit(data.copyrightText);\n    }\n\n    that._ready = true;\n    that._readyPromise.resolve(true);\n    TileProviderError.handleSuccess(metadataError);\n  }\n\n  function metadataFailure(e) {\n    var message =\n      \"An error occurred while accessing \" + that._resource.url + \".\";\n    metadataError = TileProviderError.handleError(\n      metadataError,\n      that,\n      that._errorEvent,\n      message,\n      undefined,\n      undefined,\n      undefined,\n      requestMetadata\n    );\n    that._readyPromise.reject(new RuntimeError(message));\n  }\n\n  function requestMetadata() {\n    var resource = that._resource.getDerivedResource({\n      queryParameters: {\n        f: \"json\",\n      },\n    });\n    var metadata = resource.fetchJsonp();\n    when(metadata, metadataSuccess, metadataFailure);\n  }\n\n  if (this._useTiles) {\n    requestMetadata();\n  } else {\n    this._ready = true;\n    this._readyPromise.resolve(true);\n  }\n}\n\nfunction buildImageResource(imageryProvider, x, y, level, request) {\n  var resource;\n  if (imageryProvider._useTiles) {\n    resource = imageryProvider._resource.getDerivedResource({\n      url: \"tile/\" + level + \"/\" + y + \"/\" + x,\n      request: request,\n    });\n  } else {\n    var nativeRectangle = imageryProvider._tilingScheme.tileXYToNativeRectangle(\n      x,\n      y,\n      level\n    );\n    var bbox =\n      nativeRectangle.west +\n      \",\" +\n      nativeRectangle.south +\n      \",\" +\n      nativeRectangle.east +\n      \",\" +\n      nativeRectangle.north;\n\n    var query = {\n      bbox: bbox,\n      size: imageryProvider._tileWidth + \",\" + imageryProvider._tileHeight,\n      format: \"png32\",\n      transparent: true,\n      f: \"image\",\n    };\n\n    if (\n      imageryProvider._tilingScheme.projection instanceof GeographicProjection\n    ) {\n      query.bboxSR = 4326;\n      query.imageSR = 4326;\n    } else {\n      query.bboxSR = 3857;\n      query.imageSR = 3857;\n    }\n    if (imageryProvider.layers) {\n      query.layers = \"show:\" + imageryProvider.layers;\n    }\n\n    resource = imageryProvider._resource.getDerivedResource({\n      url: \"export\",\n      request: request,\n      queryParameters: query,\n    });\n  }\n\n  return resource;\n}\n\nObject.defineProperties(ArcGisMapServerImageryProvider.prototype, {\n  /**\n   * Gets the URL of the ArcGIS MapServer.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {String}\n   * @readonly\n   */\n  url: {\n    get: function () {\n      return this._resource._url;\n    },\n  },\n\n  /**\n   * Gets the ArcGIS token used to authenticate with the ArcGis MapServer service.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {String}\n   * @readonly\n   */\n  token: {\n    get: function () {\n      return this._resource.queryParameters.token;\n    },\n  },\n\n  /**\n   * Gets the proxy used by this provider.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Proxy}\n   * @readonly\n   */\n  proxy: {\n    get: function () {\n      return this._resource.proxy;\n    },\n  },\n\n  /**\n   * Gets the width of each tile, in pixels. This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileWidth: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"tileWidth must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._tileWidth;\n    },\n  },\n\n  /**\n   * Gets the height of each tile, in pixels.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  tileHeight: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"tileHeight must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._tileHeight;\n    },\n  },\n\n  /**\n   * Gets the maximum level-of-detail that can be requested.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number|undefined}\n   * @readonly\n   */\n  maximumLevel: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"maximumLevel must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._maximumLevel;\n    },\n  },\n\n  /**\n   * Gets the minimum level-of-detail that can be requested.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Number}\n   * @readonly\n   */\n  minimumLevel: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"minimumLevel must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return 0;\n    },\n  },\n\n  /**\n   * Gets the tiling scheme used by this provider.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {TilingScheme}\n   * @readonly\n   */\n  tilingScheme: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"tilingScheme must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._tilingScheme;\n    },\n  },\n\n  /**\n   * Gets the rectangle, in radians, of the imagery provided by this instance.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Rectangle}\n   * @readonly\n   */\n  rectangle: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"rectangle must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._rectangle;\n    },\n  },\n\n  /**\n   * Gets the tile discard policy.  If not undefined, the discard policy is responsible\n   * for filtering out \"missing\" tiles via its shouldDiscardImage function.  If this function\n   * returns undefined, no tiles are filtered.  This function should\n   * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {TileDiscardPolicy}\n   * @readonly\n   */\n  tileDiscardPolicy: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"tileDiscardPolicy must not be called before the imagery provider is ready.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._tileDiscardPolicy;\n    },\n  },\n\n  /**\n   * Gets an event that is raised when the imagery provider encounters an asynchronous error.  By subscribing\n   * to the event, you will be notified of the error and can potentially recover from it.  Event listeners\n   * are passed an instance of {@link TileProviderError}.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Event}\n   * @readonly\n   */\n  errorEvent: {\n    get: function () {\n      return this._errorEvent;\n    },\n  },\n\n  /**\n   * Gets a value indicating whether or not the provider is ready for use.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets a promise that resolves to true when the provider is ready for use.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Promise.<Boolean>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n\n  /**\n   * Gets the credit to display when this imagery provider is active.  Typically this is used to credit\n   * the source of the imagery.  This function should not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   * @type {Credit}\n   * @readonly\n   */\n  credit: {\n    get: function () {\n      return this._credit;\n    },\n  },\n\n  /**\n   * Gets a value indicating whether this imagery provider is using pre-cached tiles from the\n   * ArcGIS MapServer.  If the imagery provider is not yet ready ({@link ArcGisMapServerImageryProvider#ready}), this function\n   * will return the value of `options.usePreCachedTilesIfAvailable`, even if the MapServer does\n   * not have pre-cached tiles.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   * @default true\n   */\n  usingPrecachedTiles: {\n    get: function () {\n      return this._useTiles;\n    },\n  },\n\n  /**\n   * Gets a value indicating whether or not the images provided by this imagery provider\n   * include an alpha channel.  If this property is false, an alpha channel, if present, will\n   * be ignored.  If this property is true, any images without an alpha channel will be treated\n   * as if their alpha is 1.0 everywhere.  When this property is false, memory usage\n   * and texture upload time are reduced.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   * @default true\n   */\n  hasAlphaChannel: {\n    get: function () {\n      return true;\n    },\n  },\n\n  /**\n   * Gets the comma-separated list of layer IDs to show.\n   * @memberof ArcGisMapServerImageryProvider.prototype\n   *\n   * @type {String}\n   */\n  layers: {\n    get: function () {\n      return this._layers;\n    },\n  },\n});\n\n/**\n * Gets the credits to be displayed when a given tile is displayed.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level;\n * @returns {Credit[]} The credits to be displayed when the tile is displayed.\n *\n * @exception {DeveloperError} <code>getTileCredits</code> must not be called before the imagery provider is ready.\n */\nArcGisMapServerImageryProvider.prototype.getTileCredits = function (\n  x,\n  y,\n  level\n) {\n  return undefined;\n};\n\n/**\n * Requests the image for a given tile.  This function should\n * not be called before {@link ArcGisMapServerImageryProvider#ready} returns true.\n *\n * @param {Number} x The tile X coordinate.\n * @param {Number} y The tile Y coordinate.\n * @param {Number} level The tile level.\n * @param {Request} [request] The request object. Intended for internal use only.\n * @returns {Promise.<HTMLImageElement|HTMLCanvasElement>|undefined} A promise for the image that will resolve when the image is available, or\n *          undefined if there are too many active requests to the server, and the request\n *          should be retried later.  The resolved image may be either an\n *          Image or a Canvas DOM object.\n *\n * @exception {DeveloperError} <code>requestImage</code> must not be called before the imagery provider is ready.\n */\nArcGisMapServerImageryProvider.prototype.requestImage = function (\n  x,\n  y,\n  level,\n  request\n) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!this._ready) {\n    throw new DeveloperError(\n      \"requestImage must not be called before the imagery provider is ready.\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  return ImageryProvider.loadImage(\n    this,\n    buildImageResource(this, x, y, level, request)\n  );\n};\n\n/**\n    /**\n     * Asynchronously determines what features, if any, are located at a given longitude and latitude within\n     * a tile.  This function should not be called before {@link ImageryProvider#ready} returns true.\n     *\n     * @param {Number} x The tile X coordinate.\n     * @param {Number} y The tile Y coordinate.\n     * @param {Number} level The tile level.\n     * @param {Number} longitude The longitude at which to pick features.\n     * @param {Number} latitude  The latitude at which to pick features.\n     * @return {Promise.<ImageryLayerFeatureInfo[]>|undefined} A promise for the picked features that will resolve when the asynchronous\n     *                   picking completes.  The resolved value is an array of {@link ImageryLayerFeatureInfo}\n     *                   instances.  The array may be empty if no features are found at the given location.\n     *\n     * @exception {DeveloperError} <code>pickFeatures</code> must not be called before the imagery provider is ready.\n     */\nArcGisMapServerImageryProvider.prototype.pickFeatures = function (\n  x,\n  y,\n  level,\n  longitude,\n  latitude\n) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!this._ready) {\n    throw new DeveloperError(\n      \"pickFeatures must not be called before the imagery provider is ready.\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  if (!this.enablePickFeatures) {\n    return undefined;\n  }\n\n  var rectangle = this._tilingScheme.tileXYToNativeRectangle(x, y, level);\n\n  var horizontal;\n  var vertical;\n  var sr;\n  if (this._tilingScheme.projection instanceof GeographicProjection) {\n    horizontal = CesiumMath.toDegrees(longitude);\n    vertical = CesiumMath.toDegrees(latitude);\n    sr = \"4326\";\n  } else {\n    var projected = this._tilingScheme.projection.project(\n      new Cartographic(longitude, latitude, 0.0)\n    );\n    horizontal = projected.x;\n    vertical = projected.y;\n    sr = \"3857\";\n  }\n\n  var layers = \"visible\";\n  if (defined(this._layers)) {\n    layers += \":\" + this._layers;\n  }\n\n  var query = {\n    f: \"json\",\n    tolerance: 2,\n    geometryType: \"esriGeometryPoint\",\n    geometry: horizontal + \",\" + vertical,\n    mapExtent:\n      rectangle.west +\n      \",\" +\n      rectangle.south +\n      \",\" +\n      rectangle.east +\n      \",\" +\n      rectangle.north,\n    imageDisplay: this._tileWidth + \",\" + this._tileHeight + \",96\",\n    sr: sr,\n    layers: layers,\n  };\n\n  var resource = this._resource.getDerivedResource({\n    url: \"identify\",\n    queryParameters: query,\n  });\n\n  return resource.fetchJson().then(function (json) {\n    var result = [];\n\n    var features = json.results;\n    if (!defined(features)) {\n      return result;\n    }\n\n    for (var i = 0; i < features.length; ++i) {\n      var feature = features[i];\n\n      var featureInfo = new ImageryLayerFeatureInfo();\n      featureInfo.data = feature;\n      featureInfo.name = feature.value;\n      featureInfo.properties = feature.attributes;\n      featureInfo.configureDescriptionFromProperties(feature.attributes);\n\n      // If this is a point feature, use the coordinates of the point.\n      if (feature.geometryType === \"esriGeometryPoint\" && feature.geometry) {\n        var wkid =\n          feature.geometry.spatialReference &&\n          feature.geometry.spatialReference.wkid\n            ? feature.geometry.spatialReference.wkid\n            : 4326;\n        if (wkid === 4326 || wkid === 4283) {\n          featureInfo.position = Cartographic.fromDegrees(\n            feature.geometry.x,\n            feature.geometry.y,\n            feature.geometry.z\n          );\n        } else if (wkid === 102100 || wkid === 900913 || wkid === 3857) {\n          var projection = new WebMercatorProjection();\n          featureInfo.position = projection.unproject(\n            new Cartesian3(\n              feature.geometry.x,\n              feature.geometry.y,\n              feature.geometry.z\n            )\n          );\n        }\n      }\n\n      result.push(featureInfo);\n    }\n\n    return result;\n  });\n};\nexport default ArcGisMapServerImageryProvider;\n"]},"metadata":{},"sourceType":"module"}